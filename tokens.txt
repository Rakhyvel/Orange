[const, std, =, @, import, (, "std", ), ;, pub, fn, build, (, b, :, *, std, ., Build, ), void, {, const, target, =, b, ., graph, ., host, ;, const, optimize, =, b, ., standardOptimizeOption, (, ., {, }, ), ;, executable, (, b, ,, optimize, ,, target, ,, "orng-test", ,, "src/test.zig", ,, "orng-test", ,, "Runs the integration tests", ), ;, executable, (, b, ,, optimize, ,, target, ,, "orng", ,, "src/main.zig", ,, "orng", ,, "Runs the compiler", ), ;, }, fn, executable, (, b, :, *, std, ., Build, ,, optimize, :, std, ., builtin, ., OptimizeMode, ,, target, :, std, ., Build, ., ResolvedTarget, ,, name, :, [, ], const, u8, ,, path, :, [, ], const, u8, ,, run, :, [, ], const, u8, ,, run_desc, :, [, ], const, u8, ), void, {, const, exe, =, b, ., addExecutable, (, ., {, ., name, =, name, ,, ., root_module, =, b, ., addModule, (, "string", ,, ., {, ., root_source_file, =, b, ., path, (, path, ), ,, ., target, =, target, ,, ., optimize, =, optimize, ,, }, ), ,, ., use_llvm, =, true, ,, }, ), ;, exe, ., want_lto, =, false, ;, const, install_cmd, =, b, ., addInstallArtifact, (, exe, ,, ., {, }, ), ;, const, install_step, =, b, ., step, (, run, ,, run_desc, ), ;, install_step, ., dependOn, (, &, install_cmd, ., step, ), ;, }, const, std, =, @, import, (, "std", ), ;, const, module_, =, @, import, (, "../hierarchy/module.zig", ), ;, const, core_, =, @, import, (, "../hierarchy/core.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, Scope, =, @, import, (, "../symbol/scope.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Monomorph_Map, =, @, import, (, "../types/type_map.zig", ), ., Monomorph_Map, ;, const, validation_state_, =, @, import, (, "../util/validation_state.zig", ), ;, const, unification_, =, @, import, (, "../types/unification.zig", ), ;, const, fmt_, =, @, import, (, "../util/fmt.zig", ), ;, pub, const, AST_Validation_State, =, validation_state_, ., Validation_State, ;, pub, const, Receiver_Kind, =, enum, {, value, ,, addr_of, ,, mut_addr_of, ,, pub, fn, to_string, (, self, :, @, This, (, ), ), [, ], const, u8, {, return, switch, (, self, ), {, ., value, =>, "self", ,, ., addr_of, =>, "&self", ,, ., mut_addr_of, =>, "&mut self", ,, }, ;, }, }, ;, pub, const, Sum_From, =, enum, {, optional, ,, @, "error", ,, none, ,, }, ;, pub, const, AST_Common, =, struct, {, _token, :, Token, ,, validation_state, :, AST_Validation_State, =, ., unvalidated, ,, ok_for_comptime, :, bool, =, false, ,, }, ;, pub, const, AST, =, union, (, enum, ), {, poison, :, struct, {, common, :, AST_Common, }, ,, unit_value, :, struct, {, common, :, AST_Common, }, ,, int, :, struct, {, common, :, AST_Common, ,, data, :, i128, ,, }, ,, float, :, struct, {, common, :, AST_Common, ,, data, :, f64, ,, }, ,, string, :, struct, {, common, :, AST_Common, ,, data, :, [, ], const, u8, ,, }, ,, true, :, struct, {, common, :, AST_Common, }, ,, false, :, struct, {, common, :, AST_Common, }, ,, field, :, struct, {, common, :, AST_Common, }, ,, identifier, :, struct, {, common, :, AST_Common, ,, _symbol, :, ?, *, Symbol, =, null, ,, }, ,, not, :, struct, {, common, :, AST_Common, ,, _expr, :, *, AST, }, ,, negate, :, struct, {, common, :, AST_Common, ,, _expr, :, *, AST, }, ,, dereference, :, struct, {, common, :, AST_Common, ,, _expr, :, *, AST, }, ,, @, "try", :, struct, {, common, :, AST_Common, ,, _expr, :, *, AST, ,, _symbol, :, ?, *, Symbol, ,, }, ,, @, "comptime", :, struct, {, common, :, AST_Common, ,, _expr, :, *, AST, ,, name, :, ?, *, AST, =, null, ,, result, :, ?, *, AST, =, null, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, assign, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, @, "or", :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, @, "and", :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, add, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, sub, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, mult, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, div, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, mod, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, equal, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, not_equal, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, greater, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, lesser, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, greater_equal, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, lesser_equal, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, @, "catch", :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, @, "orelse", :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, call, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _args, :, std, ., array_list, ., Managed, (, *, AST, ), ,, context_args, :, std, ., array_list, ., Managed, (, *, Symbol, ), ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, bit_and, :, struct, {, common, :, AST_Common, ,, _args, :, std, ., array_list, ., Managed, (, *, AST, ), }, ,, bit_or, :, struct, {, common, :, AST_Common, ,, _args, :, std, ., array_list, ., Managed, (, *, AST, ), }, ,, bit_xor, :, struct, {, common, :, AST_Common, ,, _args, :, std, ., array_list, ., Managed, (, *, AST, ), }, ,, bit_not, :, struct, {, common, :, AST_Common, ,, _expr, :, *, AST, }, ,, left_shift, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, right_shift, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, }, ,, index, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _children, :, std, ., array_list, ., Managed, (, *, AST, ), }, ,, generic_apply, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _children, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, _symbol, :, ?, *, Symbol, =, null, ,, state, :, enum, {, unmorphed, ,, morphing, ,, morphed, }, =, ., unmorphed, ,, }, ,, select, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, _pos, :, ?, usize, ,, }, ,, access, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, _symbol, :, ?, *, Symbol, =, null, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, trait, :, struct, {, common, :, AST_Common, ,, super_traits, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, method_decls, :, std, ., array_list, ., Managed, (, *, AST, ), ,, const_decls, :, std, ., array_list, ., Managed, (, *, AST, ), ,, num_virtual_methods, :, i64, =, 0, ,, _symbol, :, ?, *, Symbol, =, null, ,, _scope, :, ?, *, Scope, =, null, ,, pub, fn, find_method, (, self, :, @, This, (, ), ,, name, :, [, ], const, u8, ), ?, *, AST, {, for, (, self, ., method_decls, ., items, ), |, decl, |, {, if, (, std, ., mem, ., eql, (, u8, ,, decl, ., method_decl, ., name, ., token, (, ), ., data, ,, name, ), ), {, return, decl, ;, }, }, for, (, self, ., super_traits, ., items, ), |, super_trait, |, {, const, super_trait_decl, =, super_trait, ., symbol, (, ), .?, ., decl, .?, ;, if, (, super_trait_decl, ., trait, ., find_method, (, name, ), ), |, res, |, return, res, ;, }, return, null, ;, }, }, ,, impl, :, struct, {, common, :, AST_Common, ,, trait, :, ?, *, AST, ,, _type, :, *, Type_AST, ,, method_defs, :, std, ., array_list, ., Managed, (, *, AST, ), ,, const_defs, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _generic_params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, num_virtual_methods, :, i64, =, 0, ,, _scope, :, ?, *, Scope, =, null, ,, impls_anon_trait, :, bool, =, false, ,, instantiations, :, Monomorph_Map, (, *, AST, ), ,, }, ,, invoke, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, _args, :, std, ., array_list, ., Managed, (, *, AST, ), ,, context_args, :, std, ., array_list, ., Managed, (, *, Symbol, ), ,, _scope, :, ?, *, Scope, =, null, ,, method_decl, :, ?, *, AST, =, null, ,, prepended, :, bool, =, false, ,, }, ,, dyn_value, :, struct, {, common, :, AST_Common, ,, dyn_type, :, *, Type_AST, ,, _expr, :, *, AST, ,, mut, :, bool, ,, impl, :, ?, *, AST, =, null, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, enum_value, :, struct, {, common, :, AST_Common, ,, domain, :, ?, *, Type_AST, =, null, ,, init, :, ?, *, AST, =, null, ,, base, :, ?, *, Type_AST, =, null, ,, _pos, :, ?, usize, =, null, ,, pub, fn, get_name, (, self, :, *, const, @, This, (, ), ), [, ], const, u8, {, return, self, ., common, ., _token, ., data, ;, }, }, ,, context_value, :, struct, {, common, :, AST_Common, ,, parent, :, *, Type_AST, ,, _terms, :, std, ., array_list, ., Managed, (, *, AST, ), ,, }, ,, struct_value, :, struct, {, common, :, AST_Common, ,, parent, :, *, Type_AST, ,, _terms, :, std, ., array_list, ., Managed, (, *, AST, ), ,, was_slice, :, bool, ,, }, ,, tuple_value, :, struct, {, common, :, AST_Common, ,, _terms, :, std, ., array_list, ., Managed, (, *, AST, ), ,, }, ,, array_value, :, struct, {, common, :, AST_Common, ,, _terms, :, std, ., array_list, ., Managed, (, *, AST, ), ,, }, ,, as, :, struct, {, common, :, AST_Common, ,, _expr, :, *, AST, ,, _type, :, *, Type_AST, ,, }, ,, addr_of, :, struct, {, common, :, AST_Common, ,, _expr, :, *, AST, ,, mut, :, bool, ,, multiptr, :, bool, =, false, ,, anytptr, :, bool, =, false, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, slice_of, :, struct, {, common, :, AST_Common, ,, _expr, :, *, AST, ,, mut, :, bool, ,, }, ,, sub_slice, :, struct, {, common, :, AST_Common, ,, super, :, *, AST, ,, lower, :, ?, *, AST, ,, upper, :, ?, *, AST, }, ,, receiver, :, struct, {, common, :, AST_Common, ,, kind, :, Receiver_Kind, ,, _type, :, ?, *, Type_AST, =, null, ,, }, ,, default, :, struct, {, common, :, AST_Common, ,, _type, :, *, Type_AST, ,, }, ,, size_of, :, struct, {, common, :, AST_Common, ,, _type, :, *, Type_AST, ,, }, ,, write, :, struct, {, common, :, AST_Common, ,, writer, :, *, AST, ,, _children, :, std, ., array_list, ., Managed, (, *, AST, ), ,, }, ,, print, :, struct, {, common, :, AST_Common, ,, _children, :, std, ., array_list, ., Managed, (, *, AST, ), ,, }, ,, @, "if", :, struct, {, common, :, AST_Common, ,, _scope, :, ?, *, Scope, ,, let, :, ?, *, AST, ,, condition, :, *, AST, ,, _body_block, :, *, AST, ,, _else_block, :, ?, *, AST, ,, }, ,, match, :, struct, {, common, :, AST_Common, ,, _scope, :, ?, *, Scope, ,, let, :, ?, *, AST, ,, _expr, :, *, AST, ,, _mappings, :, std, ., array_list, ., Managed, (, *, AST, ), ,, }, ,, mapping, :, struct, {, common, :, AST_Common, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, captures, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _scope, :, ?, *, Scope, ,, }, ,, @, "while", :, struct, {, common, :, AST_Common, ,, _scope, :, ?, *, Scope, ,, let, :, ?, *, AST, ,, condition, :, *, AST, ,, post, :, ?, *, AST, ,, _body_block, :, *, AST, ,, _else_block, :, ?, *, AST, ,, }, ,, @, "for", :, struct, {, common, :, AST_Common, ,, _scope, :, ?, *, Scope, ,, let, :, ?, *, AST, ,, elem, :, *, AST, ,, iterable, :, *, AST, ,, _body_block, :, *, AST, ,, _else_block, :, ?, *, AST, ,, }, ,, with, :, struct, {, common, :, AST_Common, ,, contexts, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _body_block, :, *, AST, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, block, :, struct, {, common, :, AST_Common, ,, _scope, :, ?, *, Scope, ,, _statements, :, std, ., array_list, ., Managed, (, *, AST, ), ,, defers, :, std, ., array_list, ., Managed, (, *, AST, ), ,, final, :, ?, *, AST, ,, }, ,, @, "break", :, struct, {, common, :, AST_Common, }, ,, @, "continue", :, struct, {, common, :, AST_Common, }, ,, @, "unreachable", :, struct, {, common, :, AST_Common, }, ,, @, "return", :, struct, {, common, :, AST_Common, ,, _ret_expr, :, ?, *, AST, ,, _symbol, :, ?, *, Symbol, ,, }, ,, pattern_symbol, :, struct, {, common, :, AST_Common, ,, name, :, [, ], const, u8, ,, kind, :, Symbol, ., Kind, ,, storage, :, Symbol, ., Storage, ,, _symbol, :, ?, *, Symbol, =, null, ,, }, ,, binding, :, struct, {, common, :, AST_Common, ,, pattern, :, *, AST, ,, type, :, *, Type_AST, ,, init, :, ?, *, AST, ,, decls, :, std, ., array_list, ., Managed, (, *, AST, ), ,, }, ,, decl, :, struct, {, common, :, AST_Common, ,, name, :, *, AST, ,, type, :, *, Type_AST, ,, init, :, ?, *, AST, ,, }, ,, fn_decl, :, struct, {, common, :, AST_Common, ,, _generic_params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, name, :, ?, *, AST, ,, _params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _param_symbols, :, std, ., array_list, ., Managed, (, *, Symbol, ), ,, context_param_symbols, :, std, ., array_list, ., Managed, (, *, Symbol, ), ,, ret_type, :, *, Type_AST, ,, context_decls, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _decl_type, :, ?, *, Type_AST, =, null, ,, refinement, :, ?, *, AST, ,, init, :, *, AST, ,, _symbol, :, ?, *, Symbol, =, null, ,, _scope, :, ?, *, Scope, =, null, ,, infer_error, :, bool, ,, }, ,, context_value_decl, :, struct, {, common, :, AST_Common, ,, parent, :, *, Type_AST, ,, init, :, ?, *, AST, ,, _symbol, :, ?, *, Symbol, =, null, ,, }, ,, context_decl, :, struct, {, common, :, AST_Common, ,, name, :, *, AST, ,, fields, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, _type, :, *, Type_AST, ,, _symbol, :, ?, *, Symbol, =, null, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, type_param_decl, :, struct, {, common, :, AST_Common, ,, _symbol, :, ?, *, Symbol, =, null, ,, constraints, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, }, ,, struct_decl, :, struct, {, common, :, AST_Common, ,, name, :, *, AST, ,, fields, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, _generic_params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _type, :, *, Type_AST, ,, _symbol, :, ?, *, Symbol, =, null, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, enum_decl, :, struct, {, common, :, AST_Common, ,, name, :, *, AST, ,, fields, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, _generic_params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _type, :, *, Type_AST, ,, _symbol, :, ?, *, Symbol, =, null, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, type_alias, :, struct, {, common, :, AST_Common, ,, name, :, *, AST, ,, init, :, ?, *, Type_AST, ,, _generic_params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _symbol, :, ?, *, Symbol, =, null, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, method_decl, :, struct, {, common, :, AST_Common, ,, name, :, *, AST, ,, is_virtual, :, bool, ,, receiver, :, ?, *, AST, ,, _params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _param_symbols, :, std, ., array_list, ., Managed, (, *, Symbol, ), ,, context_param_symbols, :, std, ., array_list, ., Managed, (, *, Symbol, ), ,, c_type, :, ?, *, Type_AST, =, null, ,, ret_type, :, *, Type_AST, ,, context_decls, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _decl_type, :, ?, *, Type_AST, =, null, ,, refinement, :, ?, *, AST, ,, init, :, ?, *, AST, ,, impl, :, ?, *, AST, =, null, ,, _symbol, :, ?, *, Symbol, =, null, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, @, "test", :, struct, {, common, :, AST_Common, ,, name, :, ?, *, AST, ,, context_decls, :, std, ., array_list, ., Managed, (, *, AST, ), ,, init, :, *, AST, ,, _decl_type, :, ?, *, Type_AST, =, null, ,, context_param_symbols, :, std, ., array_list, ., Managed, (, *, Symbol, ), ,, _symbol, :, ?, *, Symbol, =, null, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, module, :, struct, {, common, :, AST_Common, ,, _scope, :, ?, *, Scope, ,, module, :, *, module_, ., Module, ,, }, ,, import, :, struct, {, common, :, AST_Common, ,, pattern, :, *, AST, ,, }, ,, cinclude, :, struct, {, common, :, AST_Common, ,, _expr, :, *, AST, ,, }, ,, @, "defer", :, struct, {, common, :, AST_Common, ,, _statement, :, *, AST, }, ,, @, "errdefer", :, struct, {, common, :, AST_Common, ,, _statement, :, *, AST, }, ,, pub, fn, create_poison, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., poison, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, ,, }, }, }, ,, allocator, ), ;, }, pub, fn, create_unit_value, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., unit_value, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, ,, }, }, }, ,, allocator, ), ;, }, pub, fn, create_int, (, _token, :, Token, ,, data, :, i128, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., int, =, ., {, ., common, =, _common, ,, ., data, =, data, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_float, (, _token, :, Token, ,, data, :, f64, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., float, =, ., {, ., common, =, _common, ,, ., data, =, data, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_string, (, _token, :, Token, ,, data, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., string, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, ,, }, ,, ., data, =, data, }, }, ,, allocator, ), ;, }, pub, fn, create_field, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., field, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, ,, }, }, }, ,, allocator, ), ;, }, pub, fn, create_identifier, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., identifier, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, ,, }, }, }, ,, allocator, ), ;, }, pub, fn, create_unreachable, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., @, "unreachable", =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, ,, }, }, }, ,, allocator, ), ;, }, pub, fn, create_true, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., true, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, ,, }, }, }, ,, allocator, ), ;, }, pub, fn, create_false, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., false, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, ,, }, }, }, ,, allocator, ), ;, }, pub, fn, create_not, (, _token, :, Token, ,, _expr, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., not, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _expr, =, _expr, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_negate, (, _token, :, Token, ,, _expr, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., negate, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _expr, =, _expr, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_dereference, (, _token, :, Token, ,, _expr, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., dereference, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _expr, =, _expr, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_try, (, _token, :, Token, ,, _expr, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., @, "try", =, ., {, ., common, =, _common, ,, ., _expr, =, _expr, ,, ., _symbol, =, null, }, }, ,, allocator, ), ;, }, pub, fn, create_comptime, (, _token, :, Token, ,, _expr, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., @, "comptime", =, ., {, ., common, =, _common, ,, ., _expr, =, _expr, ,, ., name, =, null, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_default, (, _token, :, Token, ,, _expr, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., default, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _type, =, _expr, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_size_of, (, _token, :, Token, ,, _expr, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., size_of, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _type, =, _expr, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_write, (, _token, :, Token, ,, writer, :, *, AST, ,, _children, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., write, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., writer, =, writer, ,, ., _children, =, _children, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_print, (, _token, :, Token, ,, _children, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., print, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _children, =, _children, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_assign, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., assign, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_or, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., @, "or", =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_and, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., @, "and", =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_equal, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., equal, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_not_equal, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., not_equal, =, ., {, ., common, =, _common, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_greater, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., greater, =, ., {, ., common, =, _common, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_lesser, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., lesser, =, ., {, ., common, =, _common, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_greater_equal, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., greater_equal, =, ., {, ., common, =, _common, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_lesser_equal, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., lesser_equal, =, ., {, ., common, =, _common, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_add, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., add, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_sub, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., sub, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_mult, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., mult, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_div, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., div, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_mod, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., mod, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_catch, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., @, "catch", =, ., {, ., common, =, _common, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, }, }, ,, allocator, ), ;, }, pub, fn, create_orelse, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., @, "orelse", =, ., {, ., common, =, _common, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, }, }, ,, allocator, ), ;, }, pub, fn, create_call, (, _token, :, Token, ,, _lhs, :, *, AST, ,, args, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., call, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _args, =, args, ,, ., context_args, =, std, ., array_list, ., Managed, (, *, Symbol, ), ., init, (, allocator, ), ,, }, }, ,, allocator, ), ;, }, pub, fn, create_bit_and, (, _token, :, Token, ,, args, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., bit_and, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _args, =, args, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_bit_or, (, _token, :, Token, ,, args, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., bit_or, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _args, =, args, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_bit_xor, (, _token, :, Token, ,, args, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., bit_xor, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _args, =, args, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_bit_not, (, _token, :, Token, ,, _expr, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., bit_not, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _expr, =, _expr, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_left_shift, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., left_shift, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_right_shift, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., right_shift, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_index, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _children, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., index, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _children, =, _children, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_generic_apply, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _children, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., generic_apply, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _children, =, _children, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_select, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., select, =, ., {, ., common, =, _common, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, ., _pos, =, null, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_access, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., access, =, ., {, ., common, =, _common, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_enum_value, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., enum_value, =, ., {, ., common, =, _common, }, }, ,, allocator, ), ;, }, pub, fn, create_trait, (, _token, :, Token, ,, super_traits, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, method_decls, :, std, ., array_list, ., Managed, (, *, AST, ), ,, const_decls, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., trait, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., super_traits, =, super_traits, ,, ., method_decls, =, method_decls, ,, ., const_decls, =, const_decls, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_impl, (, _token, :, Token, ,, _trait, :, ?, *, AST, ,, _type, :, *, Type_AST, ,, method_defs, :, std, ., array_list, ., Managed, (, *, AST, ), ,, const_defs, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _generic_params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., impl, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., trait, =, _trait, ,, ., _type, =, _type, ,, ., method_defs, =, method_defs, ,, ., const_defs, =, const_defs, ,, ., _generic_params, =, _generic_params, ,, ., instantiations, =, Monomorph_Map, (, *, AST, ), ., init, (, allocator, ), ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_invoke, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, args, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., invoke, =, ., {, ., common, =, _common, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, ., _args, =, args, ,, ., context_args, =, std, ., array_list, ., Managed, (, *, Symbol, ), ., init, (, allocator, ), ,, }, }, ,, allocator, ), ;, }, pub, fn, create_dyn_value, (, _token, :, Token, ,, dyn_type, :, *, Type_AST, ,, _expr, :, *, AST, ,, _scope, :, *, Scope, ,, _mut, :, bool, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., dyn_value, =, ., {, ., common, =, _common, ,, ., dyn_type, =, dyn_type, ,, ., _expr, =, _expr, ,, ., _scope, =, _scope, ,, ., mut, =, _mut, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_context_value, (, _token, :, Token, ,, parent, :, *, Type_AST, ,, terms, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., context_value, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., parent, =, parent, ,, ., _terms, =, terms, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_struct_value, (, _token, :, Token, ,, parent, :, *, Type_AST, ,, terms, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., struct_value, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., parent, =, parent, ,, ., _terms, =, terms, ,, ., was_slice, =, false, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_tuple_value, (, _token, :, Token, ,, terms, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., tuple_value, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _terms, =, terms, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_array_value, (, _token, :, Token, ,, terms, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., array_value, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _terms, =, terms, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_as, (, _token, :, Token, ,, _expr, :, *, AST, ,, _type, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., as, =, ., {, ., common, =, _common, ,, ., _expr, =, _expr, ,, ., _type, =, _type, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_addr_of, (, _token, :, Token, ,, _expr, :, *, AST, ,, _mut, :, bool, ,, multiptr, :, bool, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., addr_of, =, ., {, ., common, =, _common, ,, ., _expr, =, _expr, ,, ., mut, =, _mut, ,, ., multiptr, =, multiptr, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_slice_of, (, _token, :, Token, ,, _expr, :, *, AST, ,, _mut, :, bool, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., slice_of, =, ., {, ., common, =, _common, ,, ., _expr, =, _expr, ,, ., mut, =, _mut, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_sub_slice, (, _token, :, Token, ,, super, :, *, AST, ,, lower, :, ?, *, AST, ,, upper, :, ?, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., sub_slice, =, ., {, ., common, =, _common, ,, ., super, =, super, ,, ., lower, =, lower, ,, ., upper, =, upper, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_receiver, (, _token, :, Token, ,, kind, :, Receiver_Kind, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., receiver, =, ., {, ., common, =, _common, ,, ., kind, =, kind, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_if, (, _token, :, Token, ,, let, :, ?, *, AST, ,, condition, :, *, AST, ,, _body_block, :, *, AST, ,, _else_block, :, ?, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, const, _common, :, AST_Common, =, ., {, ., _token, =, _token, }, ;, return, AST, ., box, (, AST, {, ., @, "if", =, ., {, ., common, =, _common, ,, ., _scope, =, null, ,, ., let, =, let, ,, ., condition, =, condition, ,, ., _body_block, =, _body_block, ,, ., _else_block, =, _else_block, ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_match, (, _token, :, Token, ,, let, :, ?, *, AST, ,, _expr, :, *, AST, ,, mappings, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., match, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _scope, =, null, ,, ., let, =, let, ,, ., _expr, =, _expr, ,, ., _mappings, =, mappings, ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_mapping, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., mapping, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _lhs, =, _lhs, ,, ., _rhs, =, _rhs, ,, ., _scope, =, null, ,, ., captures, =, std, ., array_list, ., Managed, (, *, AST, ), ., init, (, allocator, ), ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_while, (, _token, :, Token, ,, let, :, ?, *, AST, ,, condition, :, *, AST, ,, post, :, ?, *, AST, ,, _body_block, :, *, AST, ,, _else_block, :, ?, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., @, "while", =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _scope, =, null, ,, ., let, =, let, ,, ., condition, =, condition, ,, ., post, =, post, ,, ., _body_block, =, _body_block, ,, ., _else_block, =, _else_block, ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_for, (, _token, :, Token, ,, let, :, ?, *, AST, ,, elem, :, *, AST, ,, iterable, :, *, AST, ,, _body_block, :, *, AST, ,, _else_block, :, ?, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., @, "for", =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _scope, =, null, ,, ., let, =, let, ,, ., elem, =, elem, ,, ., iterable, =, iterable, ,, ., _body_block, =, _body_block, ,, ., _else_block, =, _else_block, ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_with, (, _token, :, Token, ,, contexts, :, std, ., array_list, ., Managed, (, *, AST, ), ,, _body_block, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., with, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., contexts, =, contexts, ,, ., _body_block, =, _body_block, ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_block, (, _token, :, Token, ,, statements, :, std, ., array_list, ., Managed, (, *, AST, ), ,, final, :, ?, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, if, (, final, ), |, _final, |, {, std, ., debug, ., assert, (, _final, .*, ==, ., @, "return", or, _final, .*, ==, ., @, "continue", or, _final, .*, ==, ., @, "break", ), ;, }, return, AST, ., box, (, AST, {, ., block, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _scope, =, null, ,, ., _statements, =, statements, ,, ., defers, =, std, ., array_list, ., Managed, (, *, AST, ), ., init, (, allocator, ), ,, ., final, =, final, ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_break, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., @, "break", =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, }, ,, }, ,, allocator, ), ;, }, pub, fn, create_continue, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., @, "continue", =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_return, (, _token, :, Token, ,, _ret_expr, :, ?, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., @, "return", =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _ret_expr, =, _ret_expr, ,, ., _symbol, =, null, ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_pattern_symbol, (, _token, :, Token, ,, kind, :, Symbol, ., Kind, ,, storage, :, Symbol, ., Storage, ,, name, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., pattern_symbol, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., kind, =, kind, ,, ., storage, =, storage, ,, ., name, =, name, ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_binding, (, _token, :, Token, ,, pattern, :, *, AST, ,, _type, :, *, Type_AST, ,, init, :, ?, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., binding, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., pattern, =, pattern, ,, ., type, =, _type, ,, ., init, =, init, ,, ., decls, =, std, ., array_list, ., Managed, (, *, AST, ), ., init, (, allocator, ), ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_decl, (, _token, :, Token, ,, name, :, *, AST, ,, _type, :, *, Type_AST, ,, init, :, ?, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, std, ., debug, ., assert, (, name, .*, ==, ., pattern_symbol, ), ;, return, AST, ., box, (, AST, {, ., decl, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., name, =, name, ,, ., type, =, _type, ,, ., init, =, init, ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_fn_decl, (, _token, :, Token, ,, name, :, ?, *, AST, ,, _generic_params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, ret_type, :, *, Type_AST, ,, context_decls, :, std, ., array_list, ., Managed, (, *, AST, ), ,, refinement, :, ?, *, AST, ,, init, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., fn_decl, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., name, =, name, ,, ., _generic_params, =, _generic_params, ,, ., _params, =, params, ,, ., _param_symbols, =, std, ., array_list, ., Managed, (, *, Symbol, ), ., init, (, allocator, ), ,, ., context_param_symbols, =, std, ., array_list, ., Managed, (, *, Symbol, ), ., init, (, allocator, ), ,, ., ret_type, =, ret_type, ,, ., context_decls, =, context_decls, ,, ., refinement, =, refinement, ,, ., init, =, init, ,, ., infer_error, =, false, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_context_value_decl, (, _token, :, Token, ,, parent, :, *, Type_AST, ,, init, :, ?, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., context_value_decl, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., parent, =, parent, ,, ., init, =, init, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_context_decl, (, _token, :, Token, ,, name, :, *, AST, ,, fields, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., context_decl, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., name, =, name, ,, ., fields, =, fields, ,, ., _type, =, Type_AST, ., create_context_type, (, _token, ,, fields, ,, allocator, ), ,, }, }, ,, allocator, ), ;, }, pub, fn, create_type_param_decl, (, _token, :, Token, ,, constraints, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., type_param_decl, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., constraints, =, constraints, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_struct_decl, (, _token, :, Token, ,, name, :, *, AST, ,, fields, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, _generic_params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., struct_decl, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., name, =, name, ,, ., fields, =, fields, ,, ., _generic_params, =, _generic_params, ,, ., _type, =, Type_AST, ., create_struct_type, (, _token, ,, fields, ,, allocator, ), ,, }, }, ,, allocator, ), ;, }, pub, fn, create_enum_decl, (, _token, :, Token, ,, name, :, *, AST, ,, fields, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, _generic_params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., enum_decl, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., name, =, name, ,, ., fields, =, fields, ,, ., _generic_params, =, _generic_params, ,, ., _type, =, Type_AST, ., create_enum_type, (, _token, ,, fields, ,, allocator, ), ,, }, }, ,, allocator, ), ;, }, pub, fn, create_type_alias, (, _token, :, Token, ,, name, :, *, AST, ,, init, :, ?, *, Type_AST, ,, _generic_params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., type_alias, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., name, =, name, ,, ., init, =, init, ,, ., _generic_params, =, _generic_params, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_method_decl, (, _token, :, Token, ,, name, :, *, AST, ,, is_virtual, :, bool, ,, receiver, :, ?, *, AST, ,, params, :, std, ., array_list, ., Managed, (, *, AST, ), ,, ret_type, :, *, Type_AST, ,, context_decls, :, std, ., array_list, ., Managed, (, *, AST, ), ,, refinement, :, ?, *, AST, ,, init, :, ?, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., method_decl, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., name, =, name, ,, ., is_virtual, =, is_virtual, ,, ., receiver, =, receiver, ,, ., _params, =, params, ,, ., _param_symbols, =, std, ., array_list, ., Managed, (, *, Symbol, ), ., init, (, allocator, ), ,, ., ret_type, =, ret_type, ,, ., context_decls, =, context_decls, ,, ., refinement, =, refinement, ,, ., init, =, init, ,, ., context_param_symbols, =, std, ., array_list, ., Managed, (, *, Symbol, ), ., init, (, allocator, ), ,, }, }, ,, allocator, ), ;, }, pub, fn, create_test, (, _token, :, Token, ,, name, :, ?, *, AST, ,, context_decls, :, std, ., array_list, ., Managed, (, *, AST, ), ,, init, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., @, "test", =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., name, =, name, ,, ., context_decls, =, context_decls, ,, ., init, =, init, ,, ., context_param_symbols, =, std, ., array_list, ., Managed, (, *, Symbol, ), ., init, (, allocator, ), ,, }, }, ,, allocator, ), ;, }, pub, fn, create_module, (, _token, :, Token, ,, _scope, :, *, Scope, ,, module, :, *, module_, ., Module, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., module, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _scope, =, _scope, ,, ., module, =, module, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_import, (, _token, :, Token, ,, pattern, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., import, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., pattern, =, pattern, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_cinclude, (, _token, :, Token, ,, _expr, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, AST, {, return, AST, ., box, (, AST, {, ., cinclude, =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _expr, =, _expr, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_defer, (, _token, :, Token, ,, _statement, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., @, "defer", =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _statement, =, _statement, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_errdefer, (, _token, :, Token, ,, _statement, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, return, AST, ., box, (, AST, {, ., @, "errdefer", =, ., {, ., common, =, AST_Common, {, ., _token, =, _token, }, ,, ., _statement, =, _statement, ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, clone, (, self, :, *, AST, ,, substs, :, *, unification_, ., Substitutions, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, switch, (, self, .*, ), {, ., poison, =>, unreachable, ,, ., unit_value, =>, return, create_unit_value, (, self, ., token, (, ), ,, allocator, ), ,, ., int, =>, return, create_int, (, self, ., token, (, ), ,, self, ., int, ., data, ,, allocator, ), ,, ., float, =>, return, create_float, (, self, ., token, (, ), ,, self, ., float, ., data, ,, allocator, ), ,, ., string, =>, return, create_string, (, self, ., token, (, ), ,, self, ., string, ., data, ,, allocator, ), ,, ., field, =>, return, create_field, (, self, ., token, (, ), ,, allocator, ), ,, ., identifier, =>, {, if, (, self, ., refers_to_type, (, ), ), {, if, (, substs, ., get, (, self, ., token, (, ), ., data, ), ), |, replacement, |, {, return, create_identifier, (, replacement, ., token, (, ), ,, allocator, ), ;, }, }, return, create_identifier, (, self, ., token, (, ), ,, allocator, ), ;, }, ,, ., @, "unreachable", =>, return, create_unreachable, (, self, ., token, (, ), ,, allocator, ), ,, ., true, =>, return, create_true, (, self, ., token, (, ), ,, allocator, ), ,, ., false, =>, return, create_false, (, self, ., token, (, ), ,, allocator, ), ,, ., not, =>, return, create_not, (, self, ., token, (, ), ,, self, ., expr, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., negate, =>, return, create_negate, (, self, ., token, (, ), ,, self, ., expr, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., dereference, =>, return, create_dereference, (, self, ., token, (, ), ,, self, ., expr, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., @, "try", =>, return, create_try, (, self, ., token, (, ), ,, self, ., expr, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., default, =>, return, create_default, (, self, ., token, (, ), ,, self, ., default, ., _type, ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., size_of, =>, return, create_size_of, (, self, ., token, (, ), ,, self, ., size_of, ., _type, ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., write, =>, {, const, cloned_args, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_write, (, self, ., token, (, ), ,, self, ., write, ., writer, ., clone, (, substs, ,, allocator, ), ,, cloned_args, ,, allocator, ), ;, }, ,, ., print, =>, {, const, cloned_args, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_print, (, self, ., token, (, ), ,, cloned_args, ,, allocator, ), ;, }, ,, ., @, "comptime", =>, return, create_comptime, (, self, ., token, (, ), ,, self, ., expr, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., assign, =>, return, create_assign, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., @, "or", =>, return, create_or, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., @, "and", =>, return, create_and, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., add, =>, return, create_add, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., sub, =>, return, create_sub, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., mult, =>, return, create_mult, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., div, =>, return, create_div, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., mod, =>, return, create_mod, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., equal, =>, return, create_equal, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., not_equal, =>, return, create_not_equal, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., greater, =>, return, create_greater, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., lesser, =>, return, create_lesser, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., greater_equal, =>, return, create_greater_equal, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., lesser_equal, =>, return, create_lesser_equal, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., @, "catch", =>, return, create_catch, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., @, "orelse", =>, return, create_orelse, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., call, =>, {, const, cloned_args, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_call, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, cloned_args, ,, allocator, ), ;, }, ,, ., bit_and, =>, {, const, cloned_args, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_bit_and, (, self, ., token, (, ), ,, cloned_args, ,, allocator, ), ;, }, ,, ., bit_or, =>, {, const, cloned_args, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_bit_or, (, self, ., token, (, ), ,, cloned_args, ,, allocator, ), ;, }, ,, ., bit_xor, =>, {, const, cloned_args, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_bit_xor, (, self, ., token, (, ), ,, cloned_args, ,, allocator, ), ;, }, ,, ., bit_not, =>, return, create_bit_not, (, self, ., token, (, ), ,, self, ., expr, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., left_shift, =>, return, create_left_shift, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., right_shift, =>, return, create_right_shift, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., index, =>, return, create_index, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., generic_apply, =>, return, create_generic_apply, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, Type_AST, ., clone_types, (, self, ., generic_apply, ., _children, ,, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., select, =>, return, create_select, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., access, =>, return, create_access, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., trait, =>, {, const, cloned_super_traits, =, Type_AST, ., clone_types, (, self, ., trait, ., super_traits, ,, substs, ,, allocator, ), ;, const, cloned_method_decls, =, clone_children, (, self, ., trait, ., method_decls, ,, substs, ,, allocator, ), ;, const, cloned_const_decls, =, clone_children, (, self, ., trait, ., const_decls, ,, substs, ,, allocator, ), ;, return, create_trait, (, self, ., token, (, ), ,, cloned_super_traits, ,, cloned_method_decls, ,, cloned_const_decls, ,, allocator, ,, ), ;, }, ,, ., impl, =>, {, const, cloned_method_defs, =, clone_children, (, self, ., impl, ., method_defs, ,, substs, ,, allocator, ), ;, const, cloned_const_defs, =, clone_children, (, self, ., impl, ., const_defs, ,, substs, ,, allocator, ), ;, const, cloned_generic_params, =, clone_children, (, self, ., impl, ., _generic_params, ,, substs, ,, allocator, ), ;, var, retval, =, create_impl, (, self, ., token, (, ), ,, if, (, self, ., impl, ., trait, ), |, _trait, |, _trait, ., clone, (, substs, ,, allocator, ), else, null, ,, self, ., impl, ., _type, ., clone, (, substs, ,, allocator, ), ,, cloned_method_defs, ,, cloned_const_defs, ,, cloned_generic_params, ,, allocator, ,, ), ;, for, (, cloned_method_defs, ., items, ), |, method_def, |, {, method_def, ., method_decl, ., impl, =, retval, ;, }, retval, ., impl, ., impls_anon_trait, =, self, ., impl, ., impls_anon_trait, ;, return, retval, ;, }, ,, ., invoke, =>, {, const, cloned_args, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, var, retval, =, create_invoke, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, cloned_args, ,, allocator, ,, ), ;, retval, ., invoke, ., prepended, =, self, ., invoke, ., prepended, ;, return, retval, ;, }, ,, ., dyn_value, =>, unreachable, ,, ., enum_value, =>, {, var, retval, =, create_enum_value, (, self, ., token, (, ), ,, allocator, ), ;, retval, ., enum_value, ., init, =, if, (, self, ., enum_value, ., init, ), |, init, |, init, ., clone, (, substs, ,, allocator, ), else, null, ;, return, retval, ;, }, ,, ., type_param_decl, =>, return, create_type_param_decl, (, self, ., token, (, ), ,, Type_AST, ., clone_types, (, self, ., type_param_decl, ., constraints, ,, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., struct_value, =>, {, const, cloned_terms, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, var, retval, =, create_struct_value, (, self, ., token, (, ), ,, self, ., struct_value, ., parent, ., clone, (, substs, ,, allocator, ), ,, cloned_terms, ,, allocator, ,, ), ;, retval, ., struct_value, ., was_slice, =, self, ., struct_value, ., was_slice, ;, return, retval, ;, }, ,, ., tuple_value, =>, {, const, cloned_terms, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_tuple_value, (, self, ., token, (, ), ,, cloned_terms, ,, allocator, ,, ), ;, }, ,, ., array_value, =>, {, const, cloned_terms, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_array_value, (, self, ., token, (, ), ,, cloned_terms, ,, allocator, ,, ), ;, }, ,, ., context_value, =>, return, create_context_value, (, self, ., token, (, ), ,, self, ., context_value, ., parent, ., clone, (, substs, ,, allocator, ), ,, clone_children, (, self, ., context_value, ., _terms, ,, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., context_value_decl, =>, return, create_context_value_decl, (, self, ., token, (, ), ,, self, ., context_value_decl, ., parent, ., clone, (, substs, ,, allocator, ), ,, if, (, self, ., context_value_decl, ., init, ), |, init, |, init, ., clone, (, substs, ,, allocator, ), else, null, ,, allocator, ,, ), ,, ., context_decl, =>, {, const, cloned_terms, =, Type_AST, ., clone_types, (, self, ., context_decl, ., fields, ,, substs, ,, allocator, ), ;, const, retval, =, create_context_decl, (, self, ., token, (, ), ,, self, ., context_decl, ., name, ., clone, (, substs, ,, allocator, ), ,, cloned_terms, ,, allocator, ,, ), ;, return, retval, ;, }, ,, ., struct_decl, =>, {, const, cloned_terms, =, Type_AST, ., clone_types, (, self, ., struct_decl, ., fields, ,, substs, ,, allocator, ), ;, const, cloned_generic_params, =, clone_children, (, self, ., struct_decl, ., _generic_params, ,, substs, ,, allocator, ), ;, const, retval, =, create_struct_decl, (, self, ., token, (, ), ,, self, ., struct_decl, ., name, ., clone, (, substs, ,, allocator, ), ,, cloned_terms, ,, cloned_generic_params, ,, allocator, ,, ), ;, return, retval, ;, }, ,, ., enum_decl, =>, {, const, cloned_terms, =, Type_AST, ., clone_types, (, self, ., enum_decl, ., fields, ,, substs, ,, allocator, ), ;, const, cloned_generic_params, =, clone_children, (, self, ., enum_decl, ., _generic_params, ,, substs, ,, allocator, ), ;, const, retval, =, create_enum_decl, (, self, ., token, (, ), ,, self, ., enum_decl, ., name, ., clone, (, substs, ,, allocator, ), ,, cloned_terms, ,, cloned_generic_params, ,, allocator, ,, ), ;, return, retval, ;, }, ,, ., type_alias, =>, {, const, cloned_generic_params, =, clone_children, (, self, ., type_alias, ., _generic_params, ,, substs, ,, allocator, ), ;, const, retval, =, create_type_alias, (, self, ., token, (, ), ,, self, ., type_alias, ., name, ., clone, (, substs, ,, allocator, ), ,, if, (, self, ., type_alias, ., init, ==, null, ), null, else, self, ., type_alias, ., init, .?, ., clone, (, substs, ,, allocator, ), ,, cloned_generic_params, ,, allocator, ,, ), ;, return, retval, ;, }, ,, ., as, =>, return, create_as, (, self, ., token, (, ), ,, self, ., expr, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., type, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., addr_of, =>, return, create_addr_of, (, self, ., token, (, ), ,, self, ., expr, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., mut, (, ), ,, self, ., addr_of, ., multiptr, ,, allocator, ,, ), ,, ., slice_of, =>, return, create_slice_of, (, self, ., token, (, ), ,, self, ., expr, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., slice_of, ., mut, ,, allocator, ,, ), ,, ., sub_slice, =>, return, create_sub_slice, (, self, ., token, (, ), ,, self, ., sub_slice, ., super, ., clone, (, substs, ,, allocator, ), ,, if, (, self, ., sub_slice, ., lower, ), |, lower, |, lower, ., clone, (, substs, ,, allocator, ), else, null, ,, if, (, self, ., sub_slice, ., upper, ), |, upper, |, upper, ., clone, (, substs, ,, allocator, ), else, null, ,, allocator, ,, ), ,, ., receiver, =>, {, var, retval, =, create_receiver, (, self, ., token, (, ), ,, self, ., receiver, ., kind, ,, allocator, ,, ), ;, retval, ., receiver, ., _type, =, if, (, retval, ., receiver, ., _type, ), |, _type, |, _type, ., clone, (, substs, ,, allocator, ), else, null, ;, return, retval, ;, }, ,, ., @, "if", =>, return, create_if, (, self, ., token, (, ), ,, if, (, self, ., @, "if", ., let, ), |, let, |, let, ., clone, (, substs, ,, allocator, ), else, null, ,, self, ., @, "if", ., condition, ., clone, (, substs, ,, allocator, ), ,, self, ., body_block, (, ), ., clone, (, substs, ,, allocator, ), ,, if, (, self, ., else_block, (, ), ), |, _else, |, _else, ., clone, (, substs, ,, allocator, ), else, null, ,, allocator, ,, ), ,, ., match, =>, {, const, cloned_mappings, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_match, (, self, ., token, (, ), ,, if, (, self, ., match, ., let, ), |, let, |, let, ., clone, (, substs, ,, allocator, ), else, null, ,, self, ., expr, (, ), ., clone, (, substs, ,, allocator, ), ,, cloned_mappings, ,, allocator, ,, ), ;, }, ,, ., mapping, =>, return, create_mapping, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, self, ., rhs, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ,, ., @, "while", =>, return, create_while, (, self, ., token, (, ), ,, if, (, self, ., @, "while", ., let, ), |, let, |, let, ., clone, (, substs, ,, allocator, ), else, null, ,, self, ., @, "while", ., condition, ., clone, (, substs, ,, allocator, ), ,, if, (, self, ., @, "while", ., post, ), |, post, |, post, ., clone, (, substs, ,, allocator, ), else, null, ,, self, ., body_block, (, ), ., clone, (, substs, ,, allocator, ), ,, if, (, self, ., else_block, (, ), ), |, _else, |, _else, ., clone, (, substs, ,, allocator, ), else, null, ,, allocator, ,, ), ,, ., @, "for", =>, unreachable, ,, ., with, =>, {, const, cloned_contexts, =, clone_children, (, self, ., with, ., contexts, ,, substs, ,, allocator, ), ;, return, create_with, (, self, ., token, (, ), ,, cloned_contexts, ,, self, ., with, ., _body_block, ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ;, }, ,, ., block, =>, {, const, cloned_statements, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_block, (, self, ., token, (, ), ,, cloned_statements, ,, if, (, self, ., block, ., final, ), |, final, |, final, ., clone, (, substs, ,, allocator, ), else, null, ,, allocator, ,, ), ;, }, ,, ., @, "break", =>, return, create_break, (, self, ., token, (, ), ,, allocator, ), ,, ., @, "continue", =>, return, create_continue, (, self, ., token, (, ), ,, allocator, ), ,, ., @, "return", =>, return, create_return, (, self, ., token, (, ), ,, if, (, self, ., @, "return", ., _ret_expr, ), |, ret_expr, |, ret_expr, ., clone, (, substs, ,, allocator, ), else, null, ,, allocator, ,, ), ,, ., pattern_symbol, =>, return, create_pattern_symbol, (, self, ., token, (, ), ,, self, ., pattern_symbol, ., kind, ,, self, ., pattern_symbol, ., storage, ,, self, ., pattern_symbol, ., name, ,, allocator, ,, ), ,, ., binding, =>, {, const, retval, =, create_binding, (, self, ., token, (, ), ,, self, ., binding, ., pattern, ., clone, (, substs, ,, allocator, ), ,, self, ., binding, ., type, ., clone, (, substs, ,, allocator, ), ,, if, (, self, ., binding, ., init, ), |, init, |, init, ., clone, (, substs, ,, allocator, ), else, null, ,, allocator, ,, ), ;, return, retval, ;, }, ,, ., decl, =>, {, const, retval, =, create_decl, (, self, ., token, (, ), ,, self, ., decl, ., name, ., clone, (, substs, ,, allocator, ), ,, self, ., decl, ., type, ., clone, (, substs, ,, allocator, ), ,, if, (, self, ., decl, ., init, ), |, init, |, init, ., clone, (, substs, ,, allocator, ), else, null, ,, allocator, ,, ), ;, return, retval, ;, }, ,, ., fn_decl, =>, {, const, cloned_generic_params, =, clone_children, (, self, ., fn_decl, ., _generic_params, ,, substs, ,, allocator, ), ;, const, cloned_contexts, =, clone_children, (, self, ., fn_decl, ., context_decls, ,, substs, ,, allocator, ), ;, const, cloned_params, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, var, retval, =, create_fn_decl, (, self, ., token, (, ), ,, if, (, self, ., fn_decl, ., name, ), |, name, |, name, ., clone, (, substs, ,, allocator, ), else, null, ,, cloned_generic_params, ,, cloned_params, ,, self, ., fn_decl, ., ret_type, ., clone, (, substs, ,, allocator, ), ,, cloned_contexts, ,, if, (, self, ., fn_decl, ., refinement, ), |, refinement, |, refinement, ., clone, (, substs, ,, allocator, ), else, null, ,, self, ., fn_decl, ., init, ., clone, (, substs, ,, allocator, ), ,, allocator, ,, ), ;, retval, ., fn_decl, ., _decl_type, =, if, (, self, ., fn_decl, ., _decl_type, !=, null, ), self, ., fn_decl, ., _decl_type, .?, ., clone, (, substs, ,, allocator, ), else, null, ;, return, retval, ;, }, ,, ., method_decl, =>, {, const, cloned_params, =, clone_children, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, const, cloned_contexts, =, clone_children, (, self, ., method_decl, ., context_decls, ,, substs, ,, allocator, ), ;, var, retval, =, create_method_decl, (, self, ., token, (, ), ,, self, ., method_decl, ., name, ., clone, (, substs, ,, allocator, ), ,, self, ., method_decl, ., is_virtual, ,, if, (, self, ., method_decl, ., receiver, ), |, receiver, |, receiver, ., clone, (, substs, ,, allocator, ), else, null, ,, cloned_params, ,, self, ., method_decl, ., ret_type, ., clone, (, substs, ,, allocator, ), ,, cloned_contexts, ,, if, (, self, ., method_decl, ., refinement, ), |, refinement, |, refinement, ., clone, (, substs, ,, allocator, ), else, null, ,, if, (, self, ., method_decl, ., init, ), |, init, |, init, ., clone, (, substs, ,, allocator, ), else, null, ,, allocator, ,, ), ;, retval, ., method_decl, ., impl, =, self, ., method_decl, ., impl, ;, retval, ., method_decl, ., _decl_type, =, if, (, self, ., method_decl, ., _decl_type, !=, null, ), self, ., method_decl, ., _decl_type, .?, ., clone, (, substs, ,, allocator, ), else, null, ;, return, retval, ;, }, ,, ., @, "test", =>, return, create_test, (, self, ., token, (, ), ,, self, ., @, "test", ., name, ,, clone_children, (, self, ., @, "test", ., context_decls, ,, substs, ,, allocator, ), ,, self, ., @, "test", ., init, ,, allocator, ,, ), ,, ., import, =>, return, create_import, (, self, ., token, (, ), ,, self, ., import, ., pattern, ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., cinclude, =>, return, create_cinclude, (, self, ., token, (, ), ,, self, ., cinclude, ., _expr, ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., module, =>, return, create_module, (, self, ., token, (, ), ,, self, ., scope, (, ), .?, ,, self, ., module, ., module, ,, allocator, ), ,, ., @, "defer", =>, return, create_defer, (, self, ., token, (, ), ,, self, ., statement, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., @, "errdefer", =>, return, create_errdefer, (, self, ., token, (, ), ,, self, ., statement, (, ), ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, }, }, pub, fn, clone_children, (, children_terms, :, std, ., array_list, ., Managed, (, *, AST, ), ,, substs, :, *, unification_, ., Substitutions, ,, allocator, :, std, ., mem, ., Allocator, ), std, ., array_list, ., Managed, (, *, AST, ), {, var, retval, =, std, ., array_list, ., Managed, (, *, AST, ), ., init, (, allocator, ), ;, for, (, children_terms, ., items, ), |, child, |, {, retval, ., append, (, child, ., clone, (, substs, ,, allocator, ), ), catch, unreachable, ;, }, return, retval, ;, }, fn, box, (, ast, :, AST, ,, alloc, :, std, ., mem, ., Allocator, ), *, AST, {, const, retval, =, alloc, ., create, (, AST, ), catch, unreachable, ;, retval, .*, =, ast, ;, return, retval, ;, }, pub, fn, common, (, self, :, *, AST, ), *, AST_Common, {, return, get_field_ref, (, self, ,, "common", ), ;, }, pub, fn, token, (, self, :, *, AST, ), Token, {, return, self, ., common, (, ), ., _token, ;, }, pub, fn, expr, (, self, :, AST, ), *, AST, {, return, get_struct_field, (, self, ,, "_expr", ), ;, }, pub, fn, set_expr, (, self, :, *, AST, ,, val, :, *, AST, ), void, {, set_field, (, self, ,, "_expr", ,, val, ), ;, }, pub, fn, @, "type", (, self, :, AST, ), *, Type_AST, {, return, switch, (, self, ), {, ., as, =>, self, ., as, ., _type, ,, ., size_of, =>, self, ., size_of, ., _type, ,, ., default, =>, self, ., default, ., _type, ,, else, =>, std, ., debug, ., panic, (, "can't call type on {s}\n", ,, ., {, @, tagName, (, self, ), }, ), ,, }, ;, }, pub, fn, symbol, (, self, :, AST, ), ?, *, Symbol, {, return, get_struct_field, (, self, ,, "_symbol", ), ;, }, pub, fn, set_symbol, (, self, :, *, AST, ,, val, :, ?, *, Symbol, ), void, {, set_field, (, self, ,, "_symbol", ,, val, ), ;, }, pub, fn, scope, (, self, :, AST, ), ?, *, Scope, {, return, get_struct_field, (, self, ,, "_scope", ), ;, }, pub, fn, set_scope, (, self, :, *, AST, ,, val, :, ?, *, Scope, ), void, {, set_field, (, self, ,, "_scope", ,, val, ), ;, }, pub, fn, lhs, (, self, :, AST, ), *, AST, {, return, get_struct_field, (, self, ,, "_lhs", ), ;, }, pub, fn, set_lhs, (, self, :, *, AST, ,, val, :, *, AST, ), void, {, set_field, (, self, ,, "_lhs", ,, val, ), ;, }, pub, fn, rhs, (, self, :, AST, ), *, AST, {, return, get_struct_field, (, self, ,, "_rhs", ), ;, }, pub, fn, set_rhs, (, self, :, *, AST, ,, val, :, *, AST, ), void, {, set_field, (, self, ,, "_rhs", ,, val, ), ;, }, pub, fn, children, (, self, :, *, AST, ), *, std, ., array_list, ., Managed, (, *, AST, ), {, return, switch, (, self, .*, ), {, ., call, =>, &, self, ., call, ., _args, ,, ., index, =>, &, self, ., index, ., _children, ,, ., context_value, =>, &, self, ., context_value, ., _terms, ,, ., struct_value, =>, &, self, ., struct_value, ., _terms, ,, ., tuple_value, =>, &, self, ., tuple_value, ., _terms, ,, ., array_value, =>, &, self, ., array_value, ., _terms, ,, ., match, =>, &, self, ., match, ., _mappings, ,, ., block, =>, &, self, ., block, ., _statements, ,, ., fn_decl, =>, &, self, ., fn_decl, ., _params, ,, ., method_decl, =>, &, self, ., method_decl, ., _params, ,, ., invoke, =>, &, self, ., invoke, ., _args, ,, ., write, =>, &, self, ., write, ., _children, ,, ., print, =>, &, self, ., print, ., _children, ,, ., bit_and, =>, &, self, ., bit_and, ., _args, ,, ., bit_or, =>, &, self, ., bit_or, ., _args, ,, ., bit_xor, =>, &, self, ., bit_xor, ., _args, ,, ., binding, =>, &, self, ., binding, ., decls, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.children()` on the AST `{f}`", ,, ., {, self, .*, }, ), ,, }, ;, }, pub, fn, set_children, (, self, :, *, AST, ,, val, :, std, ., array_list, ., Managed, (, *, AST, ), ), void, {, switch, (, self, .*, ), {, ., call, =>, self, ., call, ., _args, =, val, ,, ., context_value, =>, self, ., context_value, ., _terms, =, val, ,, ., struct_value, =>, self, ., struct_value, ., _terms, =, val, ,, ., tuple_value, =>, self, ., tuple_value, ., _terms, =, val, ,, ., array_value, =>, self, ., array_value, ., _terms, =, val, ,, ., match, =>, self, ., match, ., _mappings, =, val, ,, ., block, =>, self, ., block, ., _statements, =, val, ,, ., fn_decl, =>, self, ., fn_decl, ., _params, =, val, ,, ., method_decl, =>, self, ., method_decl, ., _params, =, val, ,, ., invoke, =>, self, ., invoke, ., _args, =, val, ,, ., bit_and, =>, self, ., bit_and, ., _args, =, val, ,, ., bit_or, =>, self, ., bit_or, ., _args, =, val, ,, ., bit_xor, =>, self, ., bit_xor, ., _args, =, val, ,, ., binding, =>, self, ., binding, ., decls, =, val, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.set_children()` on the AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, }, pub, fn, context_args, (, self, :, *, AST, ), *, std, ., array_list, ., Managed, (, *, Symbol, ), {, return, switch, (, self, .*, ), {, ., call, =>, &, self, ., call, ., context_args, ,, ., invoke, =>, &, self, ., invoke, ., context_args, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.context_args()` on the AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, ;, }, pub, fn, decl_type, (, self, :, *, AST, ), *, Type_AST, {, return, switch, (, self, .*, ), {, ., decl, =>, self, ., decl, ., type, ,, ., fn_decl, =>, self, ., fn_decl, ., _decl_type, .?, ,, ., method_decl, =>, self, ., method_decl, ., _decl_type, .?, ,, ., @, "test", =>, self, ., @, "test", ., _decl_type, .?, ,, ., module, ,, ., trait, =>, prelude_, ., unit_type, ,, ., receiver, =>, self, ., receiver, ., _type, .?, ,, ., context_value_decl, =>, self, ., context_value_decl, ., parent, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.decl_type()` on the AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, ;, }, pub, fn, decl_init, (, self, :, *, AST, ), ?, *, AST, {, return, switch, (, self, .*, ), {, ., decl, =>, self, ., decl, ., init, ,, ., fn_decl, =>, self, ., fn_decl, ., init, ,, ., method_decl, =>, self, ., method_decl, ., init, ,, ., @, "test", =>, self, ., @, "test", ., init, ,, ., module, ,, ., trait, =>, self, ,, ., struct_decl, ,, ., enum_decl, ,, ., type_alias, ,, ., receiver, ,, ., type_param_decl, ,, ., context_decl, ,, ., context_value, =>, null, ,, ., context_value_decl, =>, self, ., context_value_decl, ., init, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.decl_init()` on the AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, ;, }, pub, fn, set_decl_init, (, self, :, *, AST, ,, init, :, *, AST, ), void, {, return, switch, (, self, .*, ), {, ., decl, =>, self, ., decl, ., init, =, init, ,, ., fn_decl, =>, self, ., fn_decl, ., init, =, init, ,, ., method_decl, =>, self, ., method_decl, ., init, =, init, ,, ., @, "test", =>, self, ., @, "test", ., init, =, init, ,, ., trait, =>, self, .*, =, init, .*, ,, ., module, =>, {, }, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.set_decl_init()` on the AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, ;, }, pub, fn, decl_typedef, (, self, :, *, AST, ), ?, *, Type_AST, {, return, switch, (, self, .*, ), {, ., context_decl, =>, self, ., context_decl, ., _type, ,, ., struct_decl, =>, self, ., struct_decl, ., _type, ,, ., enum_decl, =>, self, ., enum_decl, ., _type, ,, ., type_alias, =>, self, ., type_alias, ., init, ,, ., type_param_decl, =>, null, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.decl_typedef()` on the AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, ;, }, pub, fn, decl_name, (, self, :, *, AST, ), *, AST, {, return, switch, (, self, .*, ), {, ., struct_decl, =>, self, ., struct_decl, ., name, ,, ., enum_decl, =>, self, ., enum_decl, ., name, ,, ., type_alias, =>, self, ., type_alias, ., name, ,, ., context_decl, =>, self, ., context_decl, ., name, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.decl_name()` on the AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, ;, }, pub, fn, set_decl_name, (, self, :, *, AST, ,, name, :, *, AST, ), void, {, switch, (, self, .*, ), {, ., struct_decl, =>, self, ., struct_decl, ., name, =, name, ,, ., enum_decl, =>, self, ., enum_decl, ., name, =, name, ,, ., type_alias, =>, self, ., type_alias, ., name, =, name, ,, ., fn_decl, =>, self, ., fn_decl, ., name, =, name, ,, ., context_decl, =>, self, ., context_decl, ., name, =, name, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.decl_name()` on the AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, }, pub, fn, param_symbols, (, self, :, *, AST, ), ?, *, std, ., array_list, ., Managed, (, *, Symbol, ), {, return, switch, (, self, .*, ), {, ., fn_decl, =>, &, self, ., fn_decl, ., _param_symbols, ,, ., method_decl, =>, &, self, ., method_decl, ., _param_symbols, ,, ., @, "test", =>, null, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.param_symbols()` on the AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, ;, }, pub, fn, context_param_symbols, (, self, :, *, AST, ), ?, *, std, ., array_list, ., Managed, (, *, Symbol, ), {, return, switch, (, self, .*, ), {, ., fn_decl, =>, &, self, ., fn_decl, ., context_param_symbols, ,, ., @, "test", =>, &, self, ., @, "test", ., context_param_symbols, ,, ., method_decl, =>, &, self, ., method_decl, ., context_param_symbols, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.context_param_symbols()` on the AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, ;, }, pub, fn, num_generic_params, (, self, :, *, AST, ), usize, {, return, switch, (, self, .*, ), {, ., struct_decl, ,, ., enum_decl, ,, ., type_alias, ,, ., impl, ,, ., fn_decl, =>, self, ., generic_params, (, ), ., items, ., len, ,, else, =>, 0, ,, }, ;, }, pub, fn, generic_params, (, self, :, *, AST, ), *, std, ., array_list, ., Managed, (, *, AST, ), {, return, switch, (, self, .*, ), {, ., struct_decl, =>, &, self, ., struct_decl, ., _generic_params, ,, ., enum_decl, =>, &, self, ., enum_decl, ., _generic_params, ,, ., type_alias, =>, &, self, ., type_alias, ., _generic_params, ,, ., impl, =>, &, self, ., impl, ., _generic_params, ,, ., fn_decl, =>, &, self, ., fn_decl, ., _generic_params, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.generic_params()` on the AST `{t}`", ,, ., {, self, .*, }, ), ,, }, ;, }, pub, fn, set_generic_params, (, self, :, *, AST, ,, _generic_params, :, std, ., array_list, ., Managed, (, *, AST, ), ), void, {, switch, (, self, .*, ), {, ., struct_decl, =>, self, ., struct_decl, ., _generic_params, =, _generic_params, ,, ., enum_decl, =>, self, ., enum_decl, ., _generic_params, =, _generic_params, ,, ., type_alias, =>, self, ., type_alias, ., _generic_params, =, _generic_params, ,, ., impl, =>, self, ., impl, ., _generic_params, =, _generic_params, ,, ., fn_decl, =>, self, ., fn_decl, ., _generic_params, =, _generic_params, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.set_generic_params()` on the AST `{t}`", ,, ., {, self, .*, }, ), ,, }, }, pub, fn, top_level, (, self, :, *, AST, ), bool, {, return, switch, (, self, .*, ), {, ., decl, ,, ., context_value_decl, =>, false, ,, ., fn_decl, ,, ., method_decl, ,, ., @, "test", =>, true, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.top_level()` on the AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, ;, }, pub, fn, get_field, (, self, :, *, AST, ,, _type, :, *, Type_AST, ,, field_name, :, [, ], const, u8, ), *, AST, {, for, (, 0.., ,, _type, ., children, (, ), ., items, ), |, i, ,, child, |, {, if, (, child, .*, ==, ., annotation, and, std, ., mem, ., eql, (, u8, ,, field_name, ,, child, ., annotation, ., pattern, ., token, (, ), ., data, ), ), {, return, self, ., children, (, ), ., items, [, i, ], ;, }, }, std, ., debug, ., panic, (, "compiler error: {s} didn't have field `{s}`", ,, ., {, @, tagName, (, self, .*, ), ,, field_name, }, ), ;, }, pub, fn, pos, (, self, :, AST, ), ?, usize, {, return, get_struct_field, (, self, ,, "_pos", ), ;, }, pub, fn, set_pos, (, self, :, *, AST, ,, val, :, ?, usize, ), void, {, set_field, (, self, ,, "_pos", ,, val, ), ;, }, pub, fn, statement, (, self, :, AST, ), *, AST, {, return, get_struct_field, (, self, ,, "_statement", ), ;, }, pub, fn, set_statement, (, self, :, *, AST, ,, val, :, *, AST, ), void, {, set_field, (, self, ,, "_statement", ,, val, ), ;, }, pub, fn, body_block, (, self, :, AST, ), *, AST, {, return, get_struct_field, (, self, ,, "_body_block", ), ;, }, pub, fn, set_body_block, (, self, :, *, AST, ,, val, :, *, AST, ), void, {, set_field, (, self, ,, "_body_block", ,, val, ), ;, }, pub, fn, else_block, (, self, :, AST, ), ?, *, AST, {, return, get_struct_field, (, self, ,, "_else_block", ), ;, }, pub, fn, set_else_block, (, self, :, *, AST, ,, val, :, ?, *, AST, ), void, {, set_field, (, self, ,, "_else_block", ,, val, ), ;, }, pub, fn, mut, (, self, :, AST, ), bool, {, return, get_struct_field, (, self, ,, "mut", ), ;, }, pub, fn, set_mut, (, self, :, *, AST, ,, val, :, bool, ), void, {, set_field, (, self, ,, "mut", ,, val, ), ;, }, fn, Unwrapped, (, comptime, Union, :, type, ,, comptime, field, :, [, ], const, u8, ), type, {, return, inline, for, (, std, ., meta, ., fields, (, Union, ), ), |, variant, |, {, const, Struct, =, variant, ., type, ;, const, s, :, Struct, =, undefined, ;, if, (, @, hasField, (, Struct, ,, field, ), ), break, @, TypeOf, (, @, field, (, s, ,, field, ), ), ;, }, else, @, compileError, (, "No such field in any of the variants!", ), ;, }, fn, get_struct_field, (, u, :, anytype, ,, comptime, field, :, [, ], const, u8, ), Unwrapped, (, @, TypeOf, (, u, ), ,, field, ), {, return, switch, (, u, ), {, inline, else, =>, |, v, |, if, (, @, hasField, (, @, TypeOf, (, v, ), ,, field, ), ), @, field, (, v, ,, field, ), else, error, ., NoField, ,, }, catch, {, std, ., debug, ., panic, (, "compiler error: `{s}` does not have field `{s}` {}", ,, ., {, @, tagName, (, u, ), ,, field, ,, Unwrapped, (, @, TypeOf, (, u, ), ,, field, ), }, ), ;, }, ;, }, fn, get_field_ref, (, u, :, anytype, ,, comptime, field, :, [, ], const, u8, ), *, Unwrapped, (, @, TypeOf, (, u, .*, ), ,, field, ), {, return, switch, (, u, .*, ), {, inline, else, =>, |, *, v, |, &, @, field, (, v, ,, field, ), ,, }, ;, }, fn, set_field, (, u, :, anytype, ,, comptime, field, :, [, ], const, u8, ,, val, :, Unwrapped, (, @, TypeOf, (, u, .*, ), ,, field, ), ), void, {, switch, (, u, .*, ), {, inline, else, =>, |, *, v, |, if, (, @, hasField, (, @, TypeOf, (, v, .*, ), ,, field, ), ), {, @, field, (, v, ,, field, ), =, val, ;, }, else, {, std, ., debug, ., panic, (, "compiler error: `{s}` does not have field `{s}`", ,, ., {, @, tagName, (, u, .*, ), ,, field, }, ), ;, }, ,, }, }, pub, fn, create_slice_value, (, _expr, :, *, AST, ,, _mut, :, bool, ,, expr_type, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, var, new_terms, =, std, ., array_list, ., Managed, (, *, AST, ), ., init, (, allocator, ), ;, const, zero, =, (, AST, ., create_int, (, _expr, ., token, (, ), ,, 0, ,, allocator, ), ), ;, var, index_rhs, =, std, ., array_list, ., Managed, (, *, AST, ), ., init, (, allocator, ), ;, index_rhs, ., append, (, zero, ), catch, unreachable, ;, const, index, =, (, AST, ., create_index, (, _expr, ., token, (, ), ,, _expr, ,, index_rhs, ,, allocator, ,, ), ), ;, const, addr, =, (, AST, ., create_addr_of, (, _expr, ., token, (, ), ,, index, ,, _mut, ,, true, ,, allocator, ,, ), ), ;, new_terms, ., append, (, addr, ), catch, unreachable, ;, const, length, =, expr_type, ., array_of, ., len, ;, new_terms, ., append, (, length, ), catch, unreachable, ;, const, elem_type, =, expr_type, ., child, (, ), ;, const, slice_type, =, Type_AST, ., create_slice_type, (, elem_type, ,, _mut, ,, allocator, ), ;, var, retval, =, AST, ., create_struct_value, (, _expr, ., token, (, ), ,, slice_type, ,, new_terms, ,, allocator, ), ;, retval, ., struct_value, ., was_slice, =, true, ;, return, retval, ;, }, pub, fn, create_some_value, (, opt_type, :, *, Type_AST, ,, value, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, member, =, create_enum_value, (, value, ., token, (, ), ,, allocator, ), ;, member, ., enum_value, ., base, =, opt_type, ;, member, ., enum_value, ., init, =, value, ;, member, ., set_pos, (, opt_type, ., get_pos, (, "some", ), ), ;, return, member, ., assert_ast_valid, (, ), ;, }, pub, fn, create_none_value, (, opt_type, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, const, member, =, create_enum_value, (, Token, ., init_simple, (, "none", ), ,, allocator, ), ;, member, ., enum_value, ., base, =, opt_type, ;, member, ., set_pos, (, opt_type, ., get_pos, (, "none", ), ), ;, return, member, ., assert_ast_valid, (, ), ;, }, pub, fn, create_binop, (, _token, :, Token, ,, _lhs, :, *, AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, AST, {, switch, (, _token, ., kind, ), {, ., plus_equals, =>, return, create_add, (, _token, ,, _lhs, ,, _rhs, ,, allocator, ), ,, ., minus_equals, =>, return, create_sub, (, _token, ,, _lhs, ,, _rhs, ,, allocator, ), ,, ., star_equals, =>, return, create_mult, (, _token, ,, _lhs, ,, _rhs, ,, allocator, ), ,, ., slash_equals, =>, return, create_div, (, _token, ,, _lhs, ,, _rhs, ,, allocator, ), ,, ., percent_equals, =>, return, create_mod, (, _token, ,, _lhs, ,, _rhs, ,, allocator, ), ,, else, =>, std, ., debug, ., panic, (, "compiler error: {s} is not a operator-assign token", ,, ., {, @, tagName, (, _token, ., kind, ), }, ), ,, }, }, pub, fn, is_comptime_expr, (, self, :, *, AST, ), bool, {, return, !, (, self, .*, ==, ., @, "try", or, self, .*, ==, ., block, or, self, .*, ==, ., call, ), ;, }, pub, fn, refers_to_type, (, self, :, *, AST, ), bool, {, return, switch, (, self, .*, ), {, else, =>, false, ,, ., identifier, ,, ., access, =>, if, (, self, ., symbol, (, ), ), |, sym, |, sym, ., is_type, (, ), else, false, ,, ., index, =>, self, ., lhs, (, ), ., refers_to_type, (, ), ,, ., generic_apply, =>, self, ., lhs, (, ), ., refers_to_type, (, ), ,, }, ;, }, pub, fn, enpoison, (, self, :, *, AST, ), void, {, self, ., common, (, ), ., validation_state, =, ., invalid, ;, }, pub, fn, assert_ast_valid, (, self, :, *, AST, ), *, AST, {, self, ., common, (, ), ., validation_state, =, ., valid, ;, return, self, ;, }, pub, fn, pprint, (, self, :, AST, ,, allocator, :, std, ., mem, ., Allocator, ), !, [, ], const, u8, {, var, out, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, out, ., deinit, (, ), ;, switch, (, self, ), {, ., poison, =>, try, out, ., print, (, "poison", ,, ., {, }, ), ,, ., unit_value, =>, try, out, ., print, (, "unit_value", ,, ., {, }, ), ,, ., int, =>, try, out, ., print, (, "int({})", ,, ., {, self, ., int, ., data, }, ), ,, ., float, =>, try, out, ., print, (, "float()", ,, ., {, }, ), ,, ., string, =>, try, out, ., print, (, "string({s})", ,, ., {, self, ., string, ., data, }, ), ,, ., field, =>, try, out, ., print, (, "field(\"{s}\")", ,, ., {, self, ., field, ., common, ., _token, ., data, }, ), ,, ., identifier, =>, try, out, ., print, (, "identifier(\"{s}\")", ,, ., {, self, ., identifier, ., common, ., _token, ., data, }, ), ,, ., @, "unreachable", =>, try, out, ., print, (, "unreachable", ,, ., {, }, ), ,, ., true, =>, try, out, ., print, (, "true", ,, ., {, }, ), ,, ., false, =>, try, out, ., print, (, "false", ,, ., {, }, ), ,, ., not, =>, try, out, ., print, (, "not()", ,, ., {, }, ), ,, ., negate, =>, try, out, ., print, (, "negate({f})", ,, ., {, self, ., expr, (, ), }, ), ,, ., dereference, =>, try, out, ., print, (, "dereference()", ,, ., {, }, ), ,, ., @, "try", =>, try, out, ., print, (, "try()", ,, ., {, }, ), ,, ., default, =>, {, try, out, ., print, (, "default(", ,, ., {, }, ), ;, var, writer, =, out, ., writer, (, ), ., adaptToNewApi, (, &, ., {, }, ), ., new_interface, ;, try, self, ., default, ., _type, ., print_type, (, &, writer, ), ;, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., size_of, =>, try, out, ., print, (, "size_of({f})", ,, ., {, self, ., type, (, ), }, ), ,, ., @, "comptime", =>, try, out, ., print, (, "comptime({f})", ,, ., {, self, ., expr, (, ), }, ), ,, ., assign, =>, {, try, out, ., print, (, "assign({f}, {f})", ,, ., {, self, ., lhs, (, ), ,, self, ., rhs, (, ), }, ), ;, }, ,, ., @, "or", =>, try, out, ., print, (, "or()", ,, ., {, }, ), ,, ., @, "and", =>, try, out, ., print, (, "and()", ,, ., {, }, ), ,, ., add, =>, try, out, ., print, (, "add()", ,, ., {, }, ), ,, ., sub, =>, try, out, ., print, (, "sub()", ,, ., {, }, ), ,, ., mult, =>, try, out, ., print, (, "mult()", ,, ., {, }, ), ,, ., div, =>, try, out, ., print, (, "div()", ,, ., {, }, ), ,, ., mod, =>, try, out, ., print, (, "mod()", ,, ., {, }, ), ,, ., equal, =>, try, out, ., print, (, "equal()", ,, ., {, }, ), ,, ., not_equal, =>, try, out, ., print, (, "not_equal()", ,, ., {, }, ), ,, ., greater, =>, try, out, ., print, (, "greater()", ,, ., {, }, ), ,, ., lesser, =>, try, out, ., print, (, "lesser()", ,, ., {, }, ), ,, ., greater_equal, =>, try, out, ., print, (, "greater_equal()", ,, ., {, }, ), ,, ., lesser_equal, =>, try, out, ., print, (, "lesser_equal()", ,, ., {, }, ), ,, ., @, "catch", =>, try, out, ., print, (, "catch()", ,, ., {, }, ), ,, ., @, "orelse", =>, try, out, ., print, (, "orelse()", ,, ., {, }, ), ,, ., call, =>, {, try, out, ., print, (, "call(lhs={f},args=[", ,, ., {, self, ., call, ., _lhs, }, ), ;, for, (, self, ., call, ., _args, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., call, ., _args, ., items, ., len, -, 1, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, "])", ,, ., {, }, ), ;, }, ,, ., write, =>, {, try, out, ., print, (, "write(", ,, ., {, }, ), ;, for, (, self, ., write, ., _children, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., write, ., _children, ., items, ., len, -, 1, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., print, =>, {, try, out, ., print, (, "print(", ,, ., {, }, ), ;, for, (, self, ., print, ., _children, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., print, ., _children, ., items, ., len, -, 1, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., bit_and, =>, {, try, out, ., print, (, "@bit_and(", ,, ., {, }, ), ;, for, (, self, ., bit_and, ., _args, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., bit_and, ., _args, ., items, ., len, -, 1, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., bit_or, =>, {, try, out, ., print, (, "@bit_or(", ,, ., {, }, ), ;, for, (, self, ., bit_or, ., _args, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., bit_or, ., _args, ., items, ., len, -, 1, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., bit_xor, =>, {, try, out, ., print, (, "@bit_xor(", ,, ., {, }, ), ;, for, (, self, ., bit_xor, ., _args, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., bit_xor, ., _args, ., items, ., len, -, 1, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., bit_not, =>, try, out, ., print, (, "@bit_not({f})", ,, ., {, self, ., expr, (, ), }, ), ,, ., left_shift, =>, try, out, ., print, (, "@left_shift({f}, {f})", ,, ., {, self, ., lhs, (, ), ,, self, ., rhs, (, ), }, ), ,, ., right_shift, =>, try, out, ., print, (, "@right_shift({f}, {f})", ,, ., {, self, ., lhs, (, ), ,, self, ., rhs, (, ), }, ), ,, ., index, =>, {, try, out, ., print, (, "index(lhs={f},args=[", ,, ., {, self, ., index, ., _lhs, }, ), ;, for, (, self, ., index, ., _children, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., index, ., _children, ., items, ., len, -, 1, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, "])", ,, ., {, }, ), ;, }, ,, ., generic_apply, =>, {, try, out, ., print, (, "generic_apply(lhs={f},args=[", ,, ., {, self, ., generic_apply, ., _lhs, }, ), ;, for, (, self, ., generic_apply, ., _children, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., generic_apply, ., _children, ., items, ., len, -, 1, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, "])", ,, ., {, }, ), ;, }, ,, ., select, =>, {, try, out, ., print, (, "select({f},{f})", ,, ., {, self, ., lhs, (, ), ,, self, ., rhs, (, ), }, ), ;, }, ,, ., access, =>, {, try, out, ., print, (, "access({f},{f})", ,, ., {, self, ., lhs, (, ), ,, self, ., rhs, (, ), }, ), ;, }, ,, ., trait, =>, try, out, ., print, (, "trait({*})", ,, ., {, if, (, self, ., symbol, (, ), !=, null, ), self, ., symbol, (, ), else, null, }, ), ,, ., impl, =>, {, try, out, ., print, (, "impl(\n    .trait={?f},\n    .type={f}\n    .method_defs=[\n", ,, ., {, self, ., impl, ., trait, ,, self, ., impl, ., _type, }, ), ;, for, (, self, ., impl, ., method_defs, ., items, ), |, method, |, {, try, out, ., print, (, "        {f}\n", ,, ., {, method, }, ), ;, }, try, out, ., print, (, "    ],\n    .generic_params=[\n", ,, ., {, }, ), ;, for, (, self, ., impl, ., _generic_params, ., items, ), |, gen_param, |, {, try, out, ., print, (, "        {f}\n", ,, ., {, gen_param, }, ), ;, }, try, out, ., print, (, "    ],\n)", ,, ., {, }, ), ;, }, ,, ., invoke, =>, try, out, ., print, (, "invoke()", ,, ., {, }, ), ,, ., dyn_value, =>, try, out, ., print, (, "dyn_value()", ,, ., {, }, ), ,, ., enum_value, =>, {, try, out, ., print, (, "enum_value(.name={s}, .init={?f}, .tag={?})", ,, ., {, self, ., enum_value, ., get_name, (, ), ,, self, ., enum_value, ., init, ,, self, ., enum_value, ., _pos, }, ), ;, }, ,, ., context_value, =>, try, out, ., print, (, "context_value({s})", ,, ., {, self, ., context_value, ., common, ., _token, ., data, }, ), ,, ., context_value_decl, =>, try, out, ., print, (, "context_value_decl()", ,, ., {, }, ), ,, ., context_decl, =>, {, try, out, ., print, (, "context_decl(\n", ,, ., {, }, ), ;, try, out, ., print, (, "\t.name = {f}\n", ,, ., {, self, ., context_decl, ., name, }, ), ;, try, out, ., print, (, "\t.fields = {f}\n", ,, ., {, fmt_, ., List_Printer, (, Type_AST, ), {, ., list, =, &, self, ., context_decl, ., fields, }, }, ), ;, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., type_param_decl, =>, try, out, ., print, (, "type_param_decl({s})", ,, ., {, self, ., type_param_decl, ., common, ., _token, ., data, }, ), ,, ., struct_decl, =>, {, try, out, ., print, (, "struct_decl(\n", ,, ., {, }, ), ;, try, out, ., print, (, "\t.name = {f}\n", ,, ., {, self, ., struct_decl, ., name, }, ), ;, try, out, ., print, (, "\t.fields = {f}\n", ,, ., {, fmt_, ., List_Printer, (, Type_AST, ), {, ., list, =, &, self, ., struct_decl, ., fields, }, }, ), ;, try, out, ., print, (, "\t.generic_params = {f}\n", ,, ., {, fmt_, ., List_Printer, (, AST, ), {, ., list, =, &, self, ., struct_decl, ., _generic_params, }, }, ), ;, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., enum_decl, =>, {, try, out, ., print, (, "enum()", ,, ., {, }, ), ;, }, ,, ., type_alias, =>, {, try, out, ., print, (, "type_alias()", ,, ., {, }, ), ;, }, ,, ., struct_value, =>, {, try, out, ., print, (, "struct_value(", ,, ., {, }, ), ;, for, (, self, ., struct_value, ., _terms, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., struct_value, ., _terms, ., items, ., len, -, 1, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., tuple_value, =>, {, try, out, ., print, (, "tuple_value(", ,, ., {, }, ), ;, for, (, self, ., tuple_value, ., _terms, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., tuple_value, ., _terms, ., items, ., len, -, 1, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., array_value, =>, {, try, out, ., print, (, "array_value(", ,, ., {, }, ), ;, for, (, self, ., array_value, ., _terms, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., array_value, ., _terms, ., items, ., len, -, 1, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., as, =>, try, out, ., print, (, "as({f}, {f})", ,, ., {, self, ., expr, (, ), ,, self, ., type, (, ), }, ), ,, ., addr_of, =>, try, out, ., print, (, "addr_of({f})", ,, ., {, self, ., expr, (, ), }, ), ,, ., slice_of, =>, try, out, ., print, (, "slice_of()", ,, ., {, }, ), ,, ., sub_slice, =>, try, out, ., print, (, "sub_slice()", ,, ., {, }, ), ,, ., receiver, =>, try, out, ., print, (, "receiver({?f})", ,, ., {, self, ., receiver, ., _type, }, ), ,, ., @, "if", =>, try, out, ., print, (, "if()", ,, ., {, }, ), ,, ., match, =>, try, out, ., print, (, "match()", ,, ., {, }, ), ,, ., mapping, =>, try, out, ., print, (, "mapping()", ,, ., {, }, ), ,, ., @, "while", =>, try, out, ., print, (, "while()", ,, ., {, }, ), ,, ., @, "for", =>, try, out, ., print, (, "for()", ,, ., {, }, ), ,, ., with, =>, try, out, ., print, (, "with()", ,, ., {, }, ), ,, ., block, =>, {, try, out, ., print, (, "block(", ,, ., {, }, ), ;, for, (, self, ., block, ., _statements, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., block, ., _statements, ., items, ., len, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, ".final={?f})", ,, ., {, self, ., block, ., final, }, ), ;, }, ,, ., @, "break", =>, try, out, ., print, (, "break", ,, ., {, }, ), ,, ., @, "continue", =>, try, out, ., print, (, "continue", ,, ., {, }, ), ,, ., @, "return", =>, try, out, ., print, (, "return()", ,, ., {, }, ), ,, ., pattern_symbol, =>, try, out, ., print, (, "pattern_symbol({s}, {s}@{?})", ,, ., {, @, tagName, (, self, ., pattern_symbol, ., kind, ), ,, self, ., pattern_symbol, ., name, ,, if, (, self, ., pattern_symbol, ., _symbol, ), |, sym, |, sym, ., scope, ., uid, else, null, ,, }, ), ,, ., binding, =>, {, try, out, ., print, (, "binding(.type={f})", ,, ., {, self, ., binding, ., type, }, ), ;, }, ,, ., decl, =>, {, try, out, ., print, (, "decl(\n", ,, ., {, }, ), ;, try, out, ., print, (, "    .pattern = {f},\n", ,, ., {, self, ., decl, ., name, }, ), ;, try, out, ., print, (, "    .type = {f},\n", ,, ., {, self, ., decl, ., type, }, ), ;, try, out, ., print, (, "    .init = {?f},\n", ,, ., {, self, ., decl, ., init, }, ), ;, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., fn_decl, =>, {, try, out, ., print, (, "fn_decl(\n", ,, ., {, }, ), ;, try, out, ., print, (, "    .name = {?f},\n", ,, ., {, self, ., fn_decl, ., name, }, ), ;, try, out, ., print, (, "    ._params = [", ,, ., {, }, ), ;, for, (, self, ., fn_decl, ., _params, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., fn_decl, ., _params, ., items, ., len, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, "],\n", ,, ., {, }, ), ;, try, out, ., print, (, "    .param_symbols = [", ,, ., {, }, ), ;, for, (, self, ., fn_decl, ., _param_symbols, ., items, ,, 0.., ), |, item, ,, i, |, {, try, out, ., print, (, "{s}", ,, ., {, item, ., name, }, ), ;, if, (, i, <, self, ., fn_decl, ., _param_symbols, ., items, ., len, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, "],\n", ,, ., {, }, ), ;, try, out, ., print, (, "    .ret_type = {f},\n", ,, ., {, self, ., fn_decl, ., ret_type, }, ), ;, try, out, ., print, (, "    .refinement = {?f},\n", ,, ., {, self, ., fn_decl, ., refinement, }, ), ;, try, out, ., print, (, "    ._symbol = {?s},\n", ,, ., {, if, (, self, ., fn_decl, ., _symbol, ), |, sym, |, sym, ., name, else, null, }, ), ;, try, out, ., print, (, "    .infer_error = {},\n", ,, ., {, self, ., fn_decl, ., infer_error, }, ), ;, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., module, =>, try, out, ., print, (, "module()", ,, ., {, }, ), ,, ., import, =>, try, out, ., print, (, "import({f})", ,, ., {, self, ., import, ., pattern, }, ), ,, ., cinclude, =>, try, out, ., print, (, "cinclude({f})", ,, ., {, self, ., cinclude, ., _expr, }, ), ,, ., method_decl, =>, {, try, out, ., print, (, "method_decl(.name={f}, .receiver={?f}, . .params=[", ,, ., {, self, ., method_decl, ., name, ,, self, ., method_decl, ., receiver, ,, }, ), ;, for, (, self, ., method_decl, ., _params, ., items, ,, 0.., ), |, param, ,, i, |, {, try, out, ., print, (, "{f}", ,, ., {, param, }, ), ;, if, (, i, <, self, ., method_decl, ., _params, ., items, ., len, ), {, try, out, ., print, (, ",", ,, ., {, }, ), ;, }, }, try, out, ., print, (, "], .ret_type={f})", ,, ., {, self, ., method_decl, ., ret_type, }, ), ;, }, ,, ., @, "test", =>, try, out, ., print, (, "test(.name={?f})", ,, ., {, self, ., @, "test", ., name, }, ), ,, ., @, "defer", =>, try, out, ., print, (, "defer()", ,, ., {, }, ), ,, ., @, "errdefer", =>, try, out, ., print, (, "errdefer()", ,, ., {, }, ), ,, }, return, try, out, ., toOwnedSlice, (, ), ;, }, pub, fn, format, (, self, :, AST, ,, writer, :, *, std, ., io, ., Writer, ), !, void, {, try, fmt_, ., indirect_format, (, self, ,, writer, ), ;, }, }, ;, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, walker_, =, @, import, (, "../ast/walker.zig", ), ;, cincludes, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, const, Self, =, @, This, (, ), ;, pub, fn, new, (, cincludes, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ), Self, {, return, Self, {, ., cincludes, =, cincludes, }, ;, }, pub, fn, flat, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ,, asts, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, idx, :, usize, ), walker_, ., Error, !, usize, {, return, self, ., cinclude_flat, (, ast, ,, asts, ,, idx, ), ;, }, fn, cinclude_flat, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ,, asts, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, idx, :, usize, ), walker_, ., Error, !, usize, {, _, =, asts, ;, _, =, idx, ;, if, (, ast, .*, ==, ., cinclude, ), {, try, self, ., cincludes, ., append, (, ast, ., expr, (, ), ), ;, }, return, 0, ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, core_, =, @, import, (, "../hierarchy/core.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Scope, =, @, import, (, "../symbol/scope.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, token_, =, @, import, (, "../lexer/token.zig", ), ;, const, Tree_Writer, =, @, import, (, "../ast/tree_writer.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, walk_, =, @, import, (, "../ast/walker.zig", ), ;, scope, :, *, Scope, ,, ctx, :, *, Compiler_Context, ,, const, Self, =, @, This, (, ), ;, pub, fn, new, (, scope, :, *, Scope, ,, ctx, :, *, Compiler_Context, ), Self, {, return, Self, {, ., scope, =, scope, ,, ., ctx, =, ctx, ,, }, ;, }, pub, fn, prefix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, ?, Self, {, return, self, ., decorate_prefix, (, ast, ), ;, }, pub, fn, postfix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, void, {, return, self, ., decorate_postfix, (, ast, ), ;, }, pub, fn, prefix_type, (, self, :, Self, ,, _type, :, *, Type_AST, ), walk_, ., Error, !, ?, Self, {, return, self, ., decorate_prefix_type, (, _type, ), ;, }, pub, fn, postfix_type, (, self, :, Self, ,, _type, :, *, Type_AST, ), walk_, ., Error, !, void, {, return, self, ., decorate_postfix_type, (, _type, ), ;, }, fn, decorate_prefix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, ?, Self, {, switch, (, ast, .*, ), {, else, =>, return, self, ,, ., identifier, =>, {, if, (, ast, ., symbol, (, ), !=, null, ), {, return, self, ;, }, const, res, =, self, ., scope, ., lookup, (, ast, ., token, (, ), ., data, ,, ., {, ., allow_modules, =, false, }, ), ;, switch, (, res, ), {, ., found, =>, ast, ., set_symbol, (, res, ., found, ), ,, ., not_found, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., undeclared_identifier, =, ., {, ., identifier, =, ast, ., token, (, ), ,, ., expected, =, null, }, }, ), ;, return, error, ., CompileError, ;, }, ,, ., found_but_rt, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., comptime_access_runtime, =, ., {, ., identifier, =, ast, ., token, (, ), }, }, ), ;, return, error, ., CompileError, ;, }, ,, ., found_but_fn, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., inner_fn_access_runtime, =, ., {, ., identifier, =, ast, ., token, (, ), }, }, ), ;, return, error, ., CompileError, ;, }, ,, }, if, (, (, ast, ., symbol, (, ), .?, ., kind, ==, ., let, or, ast, ., symbol, (, ), .?, ., kind, ==, ., mut, ), and, ast, ., symbol, (, ), .?, ., decl, .?, ., decl_init, (, ), !=, null, and, !, ast, ., symbol, (, ), .?, ., defined, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., use_before_def, =, ., {, ., identifier, =, ast, ., token, (, ), }, }, ), ;, return, error, ., CompileError, ;, }, return, self, ;, }, ,, ., @, "if", ,, ., match, ,, ., mapping, ,, ., @, "while", ,, ., @, "for", ,, ., block, ,, ., impl, ,, ., trait, ,, ., struct_decl, ,, ., enum_decl, ,, ., type_alias, ,, ., fn_decl, =>, {, var, new_context, =, self, ;, new_context, ., scope, =, ast, ., scope, (, ), .?, ;, return, new_context, ;, }, ,, ., method_decl, =>, {, var, new_context, =, self, ;, if, (, ast, ., symbol, (, ), !=, null, ), {, new_context, ., scope, =, ast, ., symbol, (, ), .?, ., scope, ;, }, return, new_context, ;, }, ,, ., access, =>, {, ast, ., set_scope, (, self, ., scope, ), ;, return, self, ;, }, ,, }, }, fn, decorate_prefix_type, (, self, :, Self, ,, _type, :, *, Type_AST, ), walk_, ., Error, !, ?, Self, {, switch, (, _type, .*, ), {, else, =>, return, self, ,, ., identifier, =>, {, if, (, _type, ., symbol, (, ), ), |, _, |, {, return, self, ;, }, const, res, =, self, ., scope, ., lookup, (, _type, ., token, (, ), ., data, ,, ., {, }, ), ;, switch, (, res, ), {, ., found, =>, _type, ., set_symbol, (, res, ., found, ), ,, ., not_found, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., undeclared_identifier, =, ., {, ., identifier, =, _type, ., token, (, ), ,, ., expected, =, null, }, }, ), ;, return, error, ., CompileError, ;, }, ,, ., found_but_rt, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., comptime_access_runtime, =, ., {, ., identifier, =, _type, ., token, (, ), }, }, ), ;, return, error, ., CompileError, ;, }, ,, ., found_but_fn, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., inner_fn_access_runtime, =, ., {, ., identifier, =, _type, ., token, (, ), }, }, ), ;, return, error, ., CompileError, ;, }, ,, }, return, self, ;, }, ,, }, }, fn, decorate_postfix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, void, {, switch, (, ast, .*, ), {, else, =>, {, }, ,, ., access, =>, ast, ., set_symbol, (, try, self, ., resolve_access_ast, (, ast, ), ), ,, ., call, =>, {, if, (, ast, ., lhs, (, ), .*, ==, ., enum_value, ), {, ast, ., lhs, (, ), ., enum_value, ., init, =, ast, ., children, (, ), ., items, [, 0, ], ;, ast, .*, =, ast, ., lhs, (, ), .*, ;, }, else, if, (, ast, ., lhs, (, ), ., refers_to_type, (, ), ), {, const, struct_type, =, Type_AST, ., from_ast, (, ast, ., lhs, (, ), ,, self, ., ctx, ., allocator, (, ), ), ;, const, struct_value, =, ast_, ., AST, ., create_struct_value, (, ast, ., lhs, (, ), ., token, (, ), ,, struct_type, ,, ast, ., children, (, ), .*, ,, self, ., ctx, ., allocator, (, ), ,, ), ;, ast, .*, =, struct_value, .*, ;, }, }, ,, ., index, =>, {, var, child, =, ast, ., lhs, (, ), ;, if, (, child, .*, !=, ., identifier, and, child, .*, !=, ., access, ), return, ;, const, sym, =, child, ., symbol, (, ), orelse, return, ;, const, decl, =, sym, ., decl, orelse, return, ;, if, (, decl, ., num_generic_params, (, ), >, 0, ), {, var, types, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, for, (, ast, ., children, (, ), ., items, ), |, arg, |, {, try, types, ., append, (, Type_AST, ., from_ast, (, arg, ,, self, ., ctx, ., allocator, (, ), ), ), ;, }, ast, .*, =, ast_, ., AST, ., create_generic_apply, (, ast, ., token, (, ), ,, child, ,, types, ,, self, ., ctx, ., allocator, (, ), ), .*, ;, try, self, ., monomorphize_generic_apply, (, ast, ), ;, }, }, ,, ., select, =>, {, var, child, =, ast, ., lhs, (, ), ;, if, (, child, .*, ==, ., identifier, and, child, ., symbol, (, ), !=, null, and, child, ., symbol, (, ), .?, ., is_type, (, ), ), {, const, enum_value, =, ast_, ., AST, ., create_enum_value, (, ast, ., rhs, (, ), ., token, (, ), ,, self, ., ctx, ., allocator, (, ), ), ;, enum_value, ., enum_value, ., base, =, Type_AST, ., create_type_identifier, (, child, ., token, (, ), ,, self, ., ctx, ., allocator, (, ), ), ;, enum_value, ., enum_value, ., base, .?, ., set_symbol, (, child, ., symbol, (, ), ), ;, ast, .*, =, enum_value, .*, ;, return, ;, }, if, (, child, .*, !=, ., identifier, and, child, .*, !=, ., access, ), return, ;, const, sym, =, child, ., symbol, (, ), orelse, return, ;, const, decl, =, sym, ., decl, orelse, return, ;, if, (, decl, .*, ==, ., context_decl, ), {, const, fn_ctx, =, decl, ., decl_typedef, (, ), .?, ;, const, context_val_symbol, =, self, ., scope, ., parent, .?, ., context_lookup, (, fn_ctx, ,, self, ., ctx, ), orelse, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., missing_context, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., context, =, Type_AST, ., create_type_identifier, (, decl, ., token, (, ), ,, self, ., ctx, ., allocator, (, ), ), ,, }, }, ), ;, return, error, ., CompileError, ;, }, ;, var, token, =, ast, ., token, (, ), ;, token, ., data, =, context_val_symbol, ., name, ;, const, context_val_ident, =, ast_, ., AST, ., create_identifier, (, token, ,, self, ., ctx, ., allocator, (, ), ), ;, context_val_ident, ., set_symbol, (, context_val_symbol, ), ;, ast, ., set_lhs, (, context_val_ident, ), ;, }, }, ,, ., write, =>, {, const, format_all_call, =, try, self, ., create_format_all_call, (, ast, ,, ast, ., write, ., writer, ), ;, ast, .*, =, format_all_call, .*, ;, }, ,, ., print, =>, {, const, context_val_symbol, =, self, ., scope, ., parent, .?, ., context_lookup, (, core_, ., io_context, ,, self, ., ctx, ), orelse, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., missing_context, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., context, =, Type_AST, ., create_type_identifier, (, core_, ., io_context, ., token, (, ), ,, self, ., ctx, ., allocator, (, ), ), ,, }, }, ), ;, return, error, ., CompileError, ;, }, ;, var, writer_token, =, ast, ., token, (, ), ;, writer_token, ., data, =, context_val_symbol, ., name, ;, const, io_context, =, ast_, ., AST, ., create_identifier, (, writer_token, ,, self, ., ctx, ., allocator, (, ), ), ;, io_context, ., set_symbol, (, context_val_symbol, ), ;, var, writer_field_token, =, ast, ., token, (, ), ;, writer_field_token, ., data, =, "writer", ;, const, writer_field, =, ast_, ., AST, ., create_field, (, writer_field_token, ,, self, ., ctx, ., allocator, (, ), ), ;, const, writer, =, ast_, ., AST, ., create_select, (, writer_token, ,, io_context, ,, writer_field, ,, self, ., ctx, ., allocator, (, ), ), ;, const, format_all_call, =, try, self, ., create_format_all_call, (, ast, ,, writer, ), ;, ast, .*, =, format_all_call, .*, ;, }, ,, ., binding, =>, {, for, (, ast, ., binding, ., decls, ., items, ), |, decl, |, {, if, (, decl, .*, ==, ., decl, ), {, decl, ., decl, ., name, ., symbol, (, ), .?, ., defined, =, true, ;, }, }, }, ,, ., decl, =>, {, if, (, ast, ., decl, ., init, !=, null, and, ast, ., decl, ., init, .?, .*, ==, ., access, and, ast, ., decl, ., init, .?, ., symbol, (, ), .?, ., kind, ==, ., type, ), {, const, init_symbol, =, ast, ., decl, ., init, .?, ., symbol, (, ), .?, ;, ast, .*, =, ast_, ., AST, ., create_type_alias, (, ast, ., token, (, ), ,, ast, ., decl, ., name, ,, Type_AST, ., from_ast, (, ast, ., decl, ., init, .?, ,, self, ., ctx, ., allocator, (, ), ), ,, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ,, self, ., ctx, ., allocator, (, ), ,, ), .*, ;, ast, ., type_alias, ., init, .?, ., set_symbol, (, init_symbol, ), ;, }, }, ,, ., generic_apply, =>, return, self, ., monomorphize_generic_apply, (, ast, ), ,, ., trait, =>, try, self, ., scope, ., traits, ., put, (, ast, ,, void, {, }, ), ,, ., @, "test", =>, try, self, ., scope, ., tests, ., append, (, ast, ), ,, }, }, fn, decorate_postfix_type, (, self, :, Self, ,, ast, :, *, Type_AST, ), walk_, ., Error, !, void, {, switch, (, ast, .*, ), {, ., access, =>, ast, ., set_symbol, (, try, self, ., resolve_access_ast, (, ast, ., access, ., inner_access, ), ), ,, else, =>, {, }, ,, }, }, fn, resolve_access_ast, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, *, Symbol, {, const, stripped_lhs, =, if, (, ast, ., lhs, (, ), .*, ==, ., addr_of, ), ast, ., lhs, (, ), ., expr, (, ), else, ast, ., lhs, (, ), ;, const, symbol, =, stripped_lhs, ., symbol, (, ), .?, ;, return, self, ., resolve_access_symbol, (, symbol, ,, ast, ,, stripped_lhs, ), ;, }, fn, resolve_access_symbol, (, self, :, Self, ,, symbol, :, *, Symbol, ,, ast, :, *, ast_, ., AST, ,, stripped_lhs, :, *, ast_, ., AST, ), walk_, ., Error, !, *, Symbol, {, switch, (, symbol, ., kind, ), {, ., module, =>, return, try, self, ., resolve_access_module, (, symbol, ,, ast, ., rhs, (, ), ), ,, ., import, =>, {, const, module_symbol, =, symbol, ., kind, ., import, ., real_symbol, .?, ;, return, try, self, ., resolve_access_module, (, module_symbol, ,, ast, ., rhs, (, ), ), ;, }, ,, ., import_inner, =>, {, const, new_symbol, =, if, (, symbol, ., decl, .?, .*, ==, ., type_alias, ), try, self, ., resolve_access_ast, (, symbol, ., init_typedef, (, ), .?, ., access, ., inner_access, ), else, try, self, ., resolve_access_ast, (, symbol, ., init_value, (, ), .?, ), ;, return, self, ., resolve_access_symbol, (, new_symbol, ,, ast, ,, stripped_lhs, ), ;, }, ,, ., type, =>, return, try, self, ., resolve_access_const, (, Type_AST, ., from_ast, (, stripped_lhs, ,, self, ., ctx, ., allocator, (, ), ), ,, ast, ., rhs, (, ), ,, ast, ., scope, (, ), .?, ), ,, else, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., member_not_in_module, =, ., {, ., span, =, ast, ., rhs, (, ), ., token, (, ), ., span, ,, ., identifier, =, ast, ., rhs, (, ), ., token, (, ), ., data, ,, ., name, =, "symbol", ,, ., module_name, =, symbol, ., name, ,, }, ,, }, ), ;, return, error, ., CompileError, ;, }, ,, }, }, fn, monomorphize_generic_apply, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, void, {, const, sym, =, ast, ., lhs, (, ), ., symbol, (, ), .?, ;, const, params, =, sym, ., decl, .?, ., generic_params, (, ), ;, if, (, params, ., items, ., len, !=, ast, ., generic_apply, ., _children, ., items, ., len, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_arity, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., takes, =, params, ., items, ., len, ,, ., given, =, ast, ., generic_apply, ., _children, ., items, ., len, ,, ., thing_name, =, sym, ., name, ,, ., takes_name, =, "type parameter", ,, ., given_name, =, "argument", ,, }, }, ), ;, return, error, ., CompileError, ;, }, for, (, ast, ., generic_apply, ., _children, ., items, ,, 0.., ), |, child, ,, i, |, {, try, self, ., ctx, ., validate_type, ., validate_type, (, child, ), ;, const, param, =, params, ., items, [, i, ], ;, for, (, param, ., type_param_decl, ., constraints, ., items, ), |, constraint, |, {, if, (, constraint, ., symbol, (, ), !=, null, ), {, const, trait, =, constraint, ., symbol, (, ), .?, ;, const, res, =, self, ., scope, ., impl_trait_lookup, (, child, ,, trait, ), ;, if, (, res, ., count, ==, 0, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., type_not_impl_trait, =, ., {, ., span, =, child, ., token, (, ), ., span, ,, ., trait_name, =, trait, ., name, ,, ., _type, =, child, ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, }, }, if, (, ast, ., generic_apply, ., state, ==, ., unmorphed, ), {, ast, ., generic_apply, ., state, =, ., morphing, ;, ast, ., generic_apply, ., _symbol, =, try, sym, ., monomorphize, (, ast, ., generic_apply, ., _children, ,, self, ., ctx, ), ;, ast, ., generic_apply, ., state, =, ., morphed, ;, }, }, fn, resolve_symbol_from_ast, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, *, Symbol, {, switch, (, ast, .*, ), {, ., access, =>, return, self, ., resolve_symbol_from_access, (, ast, ), ,, ., identifier, ,, ., pattern_symbol, =>, return, self, ., resolve_symbol_from_identlike, (, ast, ), ,, ., generic_apply, =>, return, ast, ., symbol, (, ), .?, ,, else, =>, std, ., debug, ., panic, (, "compiler error: fell through {f}", ,, ., {, ast, }, ), ,, }, }, fn, resolve_symbol_from_access, (, self, :, Self, ,, access_ast, :, *, ast_, ., AST, ), walk_, ., Error, !, *, Symbol, {, const, stripped_lhs, =, if, (, access_ast, ., lhs, (, ), .*, ==, ., addr_of, ), access_ast, ., lhs, (, ), ., expr, (, ), else, access_ast, ., lhs, (, ), ;, const, expanded_lhs, =, stripped_lhs, ., symbol, (, ), .?, ;, const, symbol, =, try, self, ., resolve_access_symbol, (, expanded_lhs, ,, access_ast, ., rhs, (, ), ,, access_ast, ., scope, (, ), .?, ), ;, access_ast, ., set_symbol, (, symbol, ), ;, return, symbol, ;, }, fn, resolve_symbol_from_identlike, (, self, :, Self, ,, identlike_ast, :, *, ast_, ., AST, ), walk_, ., Error, !, *, Symbol, {, switch, (, identlike_ast, ., symbol, (, ), .?, ., kind, ), {, ., module, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., undeclared_identifier, =, ., {, ., identifier, =, identlike_ast, ., token, (, ), ,, ., expected, =, null, }, }, ), ;, return, error, ., CompileError, ;, }, ,, ., import, =>, return, try, self, ., resolve_symbol_from_import_identlike, (, identlike_ast, ), ,, else, =>, return, identlike_ast, ., symbol, (, ), .?, ,, }, }, fn, resolve_symbol_from_import_identlike, (, self, :, Self, ,, identlike_ast, :, *, ast_, ., AST, ), !, *, Symbol, {, const, this_module, =, identlike_ast, ., symbol, (, ), .?, ., scope, ., module, .?, ;, const, curr_package_path, =, this_module, ., get_package_abs_path, (, ), ;, var, module_path_name, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, module_path_name, ., deinit, (, ), ;, try, module_path_name, ., print, (, "{s}.orng", ,, ., {, identlike_ast, ., token, (, ), ., data, }, ), ;, const, package_build_paths, =, [, _, ], [, ], const, u8, {, curr_package_path, ,, module_path_name, ., items, }, ;, const, other_module_dir, =, try, std, ., fs, ., path, ., join, (, self, ., ctx, ., allocator, (, ), ,, &, package_build_paths, ), ;, if, (, std, ., mem, ., eql, (, u8, ,, identlike_ast, ., symbol, (, ), .?, ., kind, ., import, ., real_name, ,, "core", ), ), {, return, core_, ., core_symbol, .?, ;, }, const, local_module_lookup, =, self, ., ctx, ., lookup_module, (, other_module_dir, ), ;, const, foreign_module_lookup, =, self, ., ctx, ., lookup_package_root_module, (, curr_package_path, ,, identlike_ast, ., symbol, (, ), .?, ., kind, ., import, ., real_name, ), ;, return, (, local_module_lookup, orelse, foreign_module_lookup, ), orelse, {, std, ., debug, ., panic, (, "couldn't find module {s} or package {s}", ,, ., {, other_module_dir, ,, identlike_ast, ., symbol, (, ), .?, ., kind, ., import, ., real_name, }, ), ;, }, ;, }, fn, resolve_access_module, (, self, :, Self, ,, module_symbol, :, *, Symbol, ,, rhs, :, *, ast_, ., AST, ), walk_, ., Error, !, *, Symbol, {, std, ., debug, ., assert, (, module_symbol, ., kind, ==, ., module, ), ;, const, module_lookup_res, =, module_symbol, ., init_value, (, ), .?, ., scope, (, ), .?, ., lookup, (, rhs, ., token, (, ), ., data, ,, ., {, }, ,, ), ;, const, rhs_decl, =, switch, (, module_lookup_res, ), {, ., found, =>, module_lookup_res, ., found, ., decl, .?, ,, else, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., member_not_in_module, =, ., {, ., span, =, rhs, ., token, (, ), ., span, ,, ., identifier, =, rhs, ., token, (, ), ., data, ,, ., name, =, "module", ,, ., module_name, =, module_symbol, ., name, ,, }, ,, }, ), ;, return, error, ., CompileError, ;, }, ,, }, ;, return, extract_symbol_from_decl, (, rhs_decl, ), ;, }, fn, resolve_access_const, (, self, :, Self, ,, lhs, :, *, Type_AST, ,, rhs, :, *, ast_, ., AST, ,, scope, :, *, Scope, ), walk_, ., Error, !, *, Symbol, {, const, rhs_decl, =, scope, ., lookup_impl_member, (, lhs, ,, rhs, ., token, (, ), ., data, ,, self, ., ctx, ), catch, return, error, ., CompileError, ;, if, (, rhs_decl, ==, null, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., type_not_impl_method, =, ., {, ., span, =, rhs, ., token, (, ), ., span, ,, ., method_name, =, rhs, ., token, (, ), ., data, ,, ., _type, =, lhs, ,, }, ,, }, ), ;, return, error, ., CompileError, ;, }, else, {, return, extract_symbol_from_decl, (, rhs_decl, .?, ), ;, }, }, fn, extract_symbol_from_decl, (, decl, :, *, ast_, ., AST, ), *, Symbol, {, if, (, decl, .*, ==, ., decl, ), {, return, decl, ., decl, ., name, ., symbol, (, ), .?, ;, }, else, if, (, decl, .*, ==, ., method_decl, or, decl, .*, ==, ., fn_decl, or, decl, .*, ==, ., trait, or, decl, .*, ==, ., struct_decl, or, decl, .*, ==, ., enum_decl, or, decl, .*, ==, ., type_alias, or, decl, .*, ==, ., context_decl, ), {, return, decl, ., symbol, (, ), .?, ;, }, else, if, (, decl, .*, ==, ., binding, ), {, return, decl, ., binding, ., pattern, ., symbol, (, ), .?, ;, }, else, {, std, ., debug, ., panic, (, "compiler error: unsupported access symbol resolution for decl-like AST: {s}", ,, ., {, @, tagName, (, decl, .*, ), }, ), ;, }, }, fn, create_format_all_call, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ,, writer, :, *, ast_, ., AST, ), !, *, ast_, ., AST, {, var, format_all, =, ast_, ., AST, ., create_identifier, (, ast, ., token, (, ), ,, self, ., ctx, ., allocator, (, ), ), ;, format_all, ., set_symbol, (, self, ., ctx, ., get_core_symbol, (, "format_all", ), ), ;, var, args, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, try, args, ., append, (, writer, ), ;, var, array_terms, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, var, format_ident_token, =, ast, ., token, (, ), ;, format_ident_token, ., data, =, "Format", ;, var, format_ident, =, Type_AST, ., create_type_identifier, (, format_ident_token, ,, self, ., ctx, ., allocator, (, ), ), ;, format_ident, ., set_symbol, (, self, ., ctx, ., get_core_symbol, (, "Format", ), ), ;, const, dyn_type, =, Type_AST, ., create_dyn_type, (, ast, ., token, (, ), ,, format_ident, ,, false, ,, self, ., ctx, ., allocator, (, ), ), ;, for, (, ast, ., children, (, ), ., items, ), |, child, |, {, const, dyn_value, =, ast_, ., AST, ., create_dyn_value, (, child, ., token, (, ), ,, dyn_type, ,, child, ,, self, ., scope, ,, false, ,, self, ., ctx, ., allocator, (, ), ,, ), ;, try, array_terms, ., append, (, dyn_value, ), ;, }, const, args_array, =, ast_, ., AST, ., create_array_value, (, ast, ., token, (, ), ,, array_terms, ,, self, ., ctx, ., allocator, (, ), ), ;, const, args_slice, =, ast_, ., AST, ., create_slice_of, (, ast, ., token, (, ), ,, args_array, ,, false, ,, self, ., ctx, ., allocator, (, ), ), ;, try, args, ., append, (, args_slice, ), ;, const, format_all_call, =, ast_, ., AST, ., create_call, (, ast, ., token, (, ), ,, format_all, ,, args, ,, self, ., ctx, ., allocator, (, ), ), ;, return, format_all_call, ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, walk_, =, @, import, (, "../ast/walker.zig", ), ;, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ,, const, Self, =, @, This, (, ), ;, pub, fn, new, (, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ), Self, {, return, Self, {, ., errors, =, errors, ,, ., allocator, =, allocator, ,, }, ;, }, pub, fn, prefix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, ?, Self, {, return, self, ., expand_prefix, (, ast, ), ;, }, fn, expand_prefix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, ?, Self, {, switch, (, ast, .*, ), {, else, =>, {, }, ,, ., sub_slice, =>, self, ., expand_subslice, (, ast, ), ,, }, return, self, ;, }, fn, expand_subslice, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), void, {, if, (, ast, ., sub_slice, ., lower, ==, null, ), {, ast, ., sub_slice, ., lower, =, ast_, ., AST, ., create_int, (, ast, ., token, (, ), ,, 0, ,, self, ., allocator, ), ;, }, if, (, ast, ., sub_slice, ., upper, ==, null, ), {, const, length, =, ast_, ., AST, ., create_field, (, Token, ., init, (, "length", ,, null, ,, "", ,, "", ,, 0, ,, 0, ), ,, self, ., allocator, ), ;, ast, ., sub_slice, ., upper, =, ast_, ., AST, ., create_select, (, ast, ., token, (, ), ,, ast, ., sub_slice, ., super, ,, length, ,, self, ., allocator, ,, ), ;, }, }, const, std, =, @, import, (, "std", ), ;, const, anon_name_, =, @, import, (, "../util/anon_name.zig", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, Module, =, @, import, (, "../hierarchy/module.zig", ), ., Module, ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, walker_, =, @, import, (, "../ast/walker.zig", ), ;, package_absolute_path, :, [, ], const, u8, ,, local_imported_modules, :, *, std, ., AutoArrayHashMap, (, *, Module, ,, void, ), ,, compiler, :, *, Compiler_Context, ,, const, Self, =, @, This, (, ), ;, pub, fn, new, (, compiler, :, *, Compiler_Context, ,, package_absolute_path, :, [, ], const, u8, ,, local_imported_modules, :, *, std, ., AutoArrayHashMap, (, *, Module, ,, void, ), ,, ), Self, {, return, Self, {, ., compiler, =, compiler, ,, ., package_absolute_path, =, package_absolute_path, ,, ., local_imported_modules, =, local_imported_modules, ,, }, ;, }, pub, fn, flat, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ,, asts, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, idx, :, usize, ), walker_, ., Error, !, usize, {, return, self, ., import_flat, (, ast, ,, asts, ,, idx, ), ;, }, fn, import_flat, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ,, asts, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, idx, :, usize, ), walker_, ., Error, !, usize, {, if, (, ast, .*, !=, ., import, ), {, return, 0, ;, }, if, (, ast, ., import, ., pattern, .*, ==, ., pattern_symbol, and, ast, ., import, ., pattern, ., pattern_symbol, ., kind, ==, ., import, ), {, const, common, =, ast_, ., AST_Common, {, ., _token, =, ast, ., token, (, ), }, ;, ast, .*, =, ast_, ., AST, {, ., binding, =, ., {, ., common, =, common, ,, ., pattern, =, ast, ., import, ., pattern, ,, ., type, =, prelude_, ., unit_type, ,, ., init, =, null, ,, ., decls, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., compiler, ., allocator, (, ), ), ,, }, }, ;, ast, ., binding, ., pattern, ., pattern_symbol, ., kind, ., import, ., real_symbol, =, try, self, ., resolve_import, (, ast, ., binding, ., pattern, ), ;, return, 0, ;, }, else, if, (, ast, ., import, ., pattern, .*, ==, ., access, ), {, return, self, ., unwrap_access_imports, (, ast, ,, asts, ,, idx, ), ;, }, return, 0, ;, }, fn, unwrap_access_imports, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ,, asts, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, idx, :, usize, ), !, usize, {, var, terms, =, try, self, ., create_terms, (, ast, ), ;, defer, terms, ., deinit, (, ), ;, var, anon_names, =, try, self, ., create_anon_names, (, &, terms, ), ;, defer, anon_names, ., deinit, (, ), ;, for, (, 0.., ,, terms, ., items, ), |, i, ,, term, |, {, if, (, i, <, terms, ., items, ., len, -, 1, ), {, const, init, =, ast_, ., AST, ., create_access, (, ast, ., token, (, ), ,, ast_, ., AST, ., create_identifier, (, Token, ., init_simple, (, anon_names, ., items, [, i, +, 1, ], ), ,, self, ., compiler, ., allocator, (, ), ), ,, terms, ., items, [, i, ], ,, self, ., compiler, ., allocator, (, ), ,, ), ;, const, const_decl, =, ast_, ., AST, ., create_binding, (, ast, ., import, ., pattern, ., token, (, ), ,, ast_, ., AST, ., create_pattern_symbol, (, ast, ., token, (, ), ,, ., import_inner, ,, ., local, ,, anon_names, ., items, [, i, ], ,, self, ., compiler, ., allocator, (, ), ,, ), ,, Type_AST, ., create_type_of, (, ast, ., token, (, ), ,, init, ,, self, ., compiler, ., allocator, (, ), ), ,, init, ,, self, ., compiler, ., allocator, (, ), ,, ), ;, try, asts, ., insert, (, idx, ,, const_decl, ), ;, }, else, {, const, common, =, ast_, ., AST_Common, {, ., _token, =, ast, ., token, (, ), }, ;, ast, .*, =, ast_, ., AST, {, ., binding, =, ., {, ., common, =, common, ,, ., pattern, =, ast_, ., AST, ., create_pattern_symbol, (, ast, ., token, (, ), ,, ., {, ., import, =, ., {, ., real_name, =, term, ., token, (, ), ., data, }, }, ,, ., local, ,, anon_names, ., items, [, i, ], ,, self, ., compiler, ., allocator, (, ), ,, ), ,, ., type, =, prelude_, ., unit_type, ,, ., init, =, null, ,, ., decls, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., compiler, ., allocator, (, ), ), ,, }, }, ;, const, symb, =, try, self, ., resolve_import, (, ast, ., binding, ., pattern, ), ;, symb, ., defined, =, true, ;, ast, ., binding, ., pattern, ., pattern_symbol, ., kind, ., import, ., real_symbol, =, symb, ;, }, }, return, terms, ., items, ., len, -, 1, ;, }, fn, create_terms, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), !, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, var, curr, =, ast, ., import, ., pattern, ;, var, terms, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., compiler, ., allocator, (, ), ), ;, while, (, curr, .*, ==, ., access, ), :, (, curr, =, curr, ., lhs, (, ), ), {, try, terms, ., append, (, curr, ., rhs, (, ), ), ;, }, try, terms, ., append, (, curr, ), ;, return, terms, ;, }, fn, create_anon_names, (, self, :, Self, ,, terms, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ), !, std, ., array_list, ., Managed, (, [, ], const, u8, ), {, var, anon_names, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, self, ., compiler, ., allocator, (, ), ), ;, for, (, 0.., ,, terms, ., items, ), |, i, ,, term, |, {, try, anon_names, ., append, (, if, (, i, ==, 0, ), term, ., token, (, ), ., data, else, anon_name_, ., next_anon_name, (, "anon_import", ,, self, ., compiler, ., allocator, (, ), ), ,, ), ;, }, return, anon_names, ;, }, fn, resolve_import, (, self, :, Self, ,, pattern_ast, :, *, ast_, ., AST, ), walker_, ., Error, !, *, Symbol, {, std, ., debug, ., assert, (, pattern_ast, .*, ==, ., pattern_symbol, and, pattern_ast, ., pattern_symbol, ., kind, ==, ., import, ), ;, const, import_name, =, pattern_ast, ., pattern_symbol, ., kind, ., import, ., real_name, ;, const, import_file_path, =, try, self, ., build_import_path, (, import_name, ), ;, const, import_symbol, :, *, Symbol, =, try, self, ., lookup_import_module, (, pattern_ast, ,, import_name, ,, import_file_path, ), ;, try, self, ., local_imported_modules, ., put, (, import_symbol, ., init_value, (, ), .?, ., module, ., module, ,, void, {, }, ), ;, return, import_symbol, ;, }, fn, build_import_path, (, self, :, Self, ,, import_name, :, [, ], const, u8, ), !, [, ], const, u8, {, var, import_filename, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, self, ., compiler, ., allocator, (, ), ), ;, defer, import_filename, ., deinit, (, ), ;, try, import_filename, ., print, (, "{s}.orng", ,, ., {, import_name, }, ), ;, const, import_file_paths, =, [, _, ], [, ], const, u8, {, self, ., package_absolute_path, ,, import_filename, ., items, }, ;, return, try, std, ., fs, ., path, ., join, (, self, ., compiler, ., allocator, (, ), ,, &, import_file_paths, ), ;, }, fn, lookup_import_module, (, self, :, Self, ,, pattern_ast, :, *, ast_, ., AST, ,, import_name, :, [, ], const, u8, ,, import_file_path, :, [, ], const, u8, ), walker_, ., Error, !, *, Symbol, {, if, (, self, ., compiler, ., lookup_package, (, self, ., package_absolute_path, ), !=, null, and, self, ., compiler, ., lookup_package_root_module, (, self, ., package_absolute_path, ,, import_name, ), !=, null, ), {, return, self, ., compiler, ., lookup_package_root_module, (, self, ., package_absolute_path, ,, import_name, ), .?, ;, }, else, {, return, self, ., compiler, ., compile_module, (, import_file_path, ,, null, ,, false, ), catch, |, err, |, switch, (, err, ), {, error, ., FileNotFound, =>, {, self, ., compiler, ., errors, ., add_error, (, ., {, ., import_file_not_found, =, ., {, ., filename, =, import_name, ,, ., span, =, pattern_ast, ., token, (, ), ., span, ,, }, }, ), ;, return, error, ., CompileError, ;, }, ,, error, ., CompileError, ,, error, ., ParseError, ,, error, ., LexerError, =>, {, return, error, ., CompileError, ;, }, ,, else, =>, std, ., debug, ., panic, (, "compiler error: this shouldn't be reachable\n", ,, ., {, }, ), ,, }, ;, }, }, const, std, =, @, import, (, "std", ), ;, const, AST, =, @, import, (, "ast.zig", ), ., AST, ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, pub, var, poisoned, :, *, AST, =, undefined, ;, pub, var, poisoned_type, :, *, Type_AST, =, undefined, ;, var, inited, :, bool, =, false, ;, pub, fn, init_structures, (, allocator, :, std, ., mem, ., Allocator, ), void, {, if, (, !, inited, ), {, poisoned, =, AST, ., create_poison, (, Token, ., init_simple, (, "LMAO GET POISONED!", ), ,, allocator, ,, ), ;, poisoned_type, =, Type_AST, ., create_poisoned_type, (, Token, ., init_simple, (, "LMAO GET POISONED!", ), ,, allocator, ,, ), ;, _, =, poisoned, ., enpoison, (, ), ;, inited, =, true, ;, }, }, pub, fn, deinit, (, ), void, {, inited, =, false, ;, }, pub, fn, assert_none_poisoned, (, value, :, anytype, ), error, {, CompileError, }, !, void, {, const, T, =, @, TypeOf, (, value, ), ;, if, (, T, ==, *, std, ., array_list, ., Managed, (, *, AST, ), ), {, for, (, value, ., items, ), |, ast, |, {, if, (, ast, .*, ==, ., poison, ), {, return, error, ., CompileError, ;, }, }, }, else, switch, (, @, typeInfo, (, T, ), ), {, ., @, "struct", =>, |, info, |, {, inline, for, (, info, ., fields, ), |, f, |, {, try, assert_none_poisoned, (, @, field, (, value, ,, f, ., name, ), ), ;, }, }, ,, ., optional, =>, if, (, value, !=, null, and, value, .?, .*, ==, ., poison, ), return, error, ., CompileError, ,, ., pointer, =>, |, info, |, switch, (, info, ., size, ), {, ., one, =>, if, (, value, .*, ==, ., poison, ), return, error, ., CompileError, ,, ., slice, =>, for, (, value, ), |, f, |, {, try, assert_none_poisoned, (, f, ), ;, }, ,, else, =>, unreachable, ,, }, ,, else, =>, {, }, ,, }, }, const, std, =, @, import, (, "std", ), ;, const, anon_name_, =, @, import, (, "../util/anon_name.zig", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Canonical_Type_Fmt, =, @, import, (, "../types/canonical_type_fmt.zig", ), ;, const, core_, =, @, import, (, "../hierarchy/core.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, Scope, =, @, import, (, "../symbol/scope.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, walk_, =, @, import, (, "../ast/walker.zig", ), ;, scope, :, *, Scope, ,, in_loop, :, bool, ,, is_param_scope, :, bool, ,, defers, :, ?, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ,, const, Self, =, @, This, (, ), ;, const, Error, =, walk_, ., Error, ;, pub, fn, new, (, scope, :, *, Scope, ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ), Self, {, return, Self, {, ., scope, =, scope, ,, ., in_loop, =, false, ,, ., is_param_scope, =, false, ,, ., defers, =, null, ,, ., errors, =, errors, ,, ., allocator, =, allocator, ,, }, ;, }, pub, fn, prefix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, ?, Self, {, return, self, ., symbol_tree_prefix, (, ast, ), ;, }, pub, fn, postfix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, void, {, return, self, ., symbol_tree_postfix, (, ast, ), ;, }, fn, symbol_tree_prefix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, ?, Self, {, switch, (, ast, .*, ), {, else, =>, {, }, ,, ., @, "comptime", ,, ., access, ,, ., call, ,, ., invoke, ,, ., addr_of, =>, ast, ., set_scope, (, self, ., scope, ), ,, ., @, "break", ,, ., @, "continue", =>, try, self, ., in_loop_check, (, ast, ,, self, ., errors, ), ,, ., @, "try", ,, ., @, "return", =>, ast, ., set_symbol, (, try, in_function_check, (, ast, ,, self, ., scope, ,, self, ., errors, ), ), ,, ., @, "defer", =>, if, (, self, ., defers, ), |, defers, |, {, try, defers, ., append, (, ast, ), ;, }, else, {, }, ,, ., @, "errdefer", =>, if, (, self, ., defers, ), |, defers, |, {, try, defers, ., append, (, ast, ), ;, }, else, {, }, ,, ., @, "if", ,, ., match, ,, ., @, "while", ,, ., @, "for", =>, {, var, new_self, =, self, ., new_scope, (, ast, ), ;, new_self, ., in_loop, =, new_self, ., in_loop, or, ast, .*, ==, ., @, "while", or, ast, .*, ==, ., @, "for", ;, return, new_self, ;, }, ,, ., block, =>, {, var, new_self, =, self, ., new_scope, (, ast, ), ;, if, (, ast, ., block, ., defers, ., items, ., len, ==, 0, ), {, new_self, ., defers, =, &, ast, ., block, ., defers, ;, }, new_self, ., in_loop, =, new_self, ., in_loop, or, ast, .*, ==, ., @, "while", or, ast, .*, ==, ., @, "for", ;, return, new_self, ;, }, ,, ., binding, =>, {, var, symbols, =, std, ., array_list, ., Managed, (, *, Symbol, ), ., init, (, self, ., allocator, ), ;, try, create_symbol, (, &, symbols, ,, ast, ., binding, ., pattern, ,, ast, ,, ast, ., binding, ., type, ,, ast, ., binding, ., init, ,, self, ., scope, ,, self, ., errors, ,, self, ., allocator, ,, ), ;, for, (, symbols, ., items, ), |, symbol, |, {, try, ast, ., binding, ., decls, ., append, (, symbol, ., decl, .?, ), ;, }, try, self, ., scope, ., put_all_symbols, (, &, symbols, ,, self, ., errors, ), ;, }, ,, ., struct_decl, ,, ., enum_decl, ,, ., type_alias, =>, {, std, ., debug, ., assert, (, ast, ., symbol, (, ), ==, null, ), ;, const, new_self, =, self, ., new_scope, (, ast, ), ;, const, symbol, =, Symbol, ., init, (, self, ., scope, ,, ast, ., decl_name, (, ), ., token, (, ), ., data, ,, ast, ,, ., type, ,, ast, ., decl_name, (, ), ., pattern_symbol, ., storage, ,, self, ., allocator, ,, ), ;, try, self, ., register_symbol, (, ast, ,, symbol, ), ;, return, new_self, ;, }, ,, ., context_value_decl, =>, {, std, ., debug, ., assert, (, ast, ., symbol, (, ), ==, null, ), ;, const, number, =, self, ., scope, ., num_visible_contexts, (, ), ;, var, out, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, self, ., allocator, ), ;, defer, out, ., deinit, (, ), ;, try, out, ., print, (, "context_value__{}", ,, ., {, number, }, ), ;, const, symbol, =, Symbol, ., init, (, self, ., scope, ,, try, out, ., toOwnedSlice, (, ), ,, ast, ,, ., let, ,, ., local, ,, self, ., allocator, ,, ), ;, try, self, ., register_symbol, (, ast, ,, symbol, ), ;, return, self, ;, }, ,, ., context_decl, =>, {, std, ., debug, ., assert, (, ast, ., symbol, (, ), ==, null, ), ;, const, new_self, =, self, ., new_scope, (, ast, ), ;, const, symbol, =, Symbol, ., init, (, self, ., scope, ,, ast, ., decl_name, (, ), ., token, (, ), ., data, ,, ast, ,, ., context, ,, ast, ., decl_name, (, ), ., pattern_symbol, ., storage, ,, self, ., allocator, ,, ), ;, try, self, ., register_symbol, (, ast, ,, symbol, ), ;, return, new_self, ;, }, ,, ., type_param_decl, =>, {, const, symbol, =, Symbol, ., init, (, self, ., scope, ,, ast, ., token, (, ), ., data, ,, ast, ,, ., type, ,, ., local, ,, self, ., allocator, ,, ), ;, try, self, ., register_symbol, (, ast, ,, symbol, ), ;, }, ,, ., @, "test", =>, {, var, new_self, =, self, ., new_scope, (, ast, ), ;, const, symbol, =, try, create_test_symbol, (, ast, ,, self, ., allocator, ), ;, try, self, ., register_symbol, (, ast, ,, symbol, ), ;, new_self, ., scope, ., function_depth, =, self, ., scope, ., function_depth, +, 1, ;, return, new_self, ;, }, ,, ., fn_decl, =>, {, if, (, ast, ., symbol, (, ), !=, null, ), return, null, ;, var, new_self, =, self, ., new_scope, (, ast, ), ;, const, symbol, =, try, create_function_symbol, (, ast, ,, self, ., allocator, ), ;, try, self, ., register_symbol, (, ast, ,, symbol, ), ;, new_self, ., scope, ., function_depth, =, self, ., scope, ., function_depth, +, 1, ;, return, new_self, ;, }, ,, ., trait, =>, {, if, (, ast, ., symbol, (, ), !=, null, ), return, null, ;, const, new_self, =, self, ., new_scope, (, ast, ), ;, const, symbol, =, try, create_trait_symbol, (, ast, ,, self, ., scope, ,, self, ., allocator, ), ;, try, self, ., register_symbol, (, ast, ,, symbol, ), ;, const, self_type_decl, =, ast_, ., AST, ., create_type_alias, (, ast, ., token, (, ), ,, ast_, ., AST, ., create_pattern_symbol, (, Token, ., init_simple, (, "Self", ), ,, ., type, ,, ., local, ,, "Self", ,, self, ., allocator, ,, ), ,, null, ,, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ,, self, ., allocator, ,, ), ;, try, walk_, ., walk_ast, (, self_type_decl, ,, new_self, ), ;, return, new_self, ;, }, ,, ., impl, =>, {, const, new_self, =, self, ., new_scope, (, ast, ), ;, const, self_type_decl, =, ast_, ., AST, ., create_type_alias, (, ast, ., token, (, ), ,, ast_, ., AST, ., create_pattern_symbol, (, Token, ., init_simple, (, "Self", ), ,, ., type, ,, ., local, ,, "Self", ,, self, ., allocator, ,, ), ,, ast, ., impl, ., _type, ,, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ,, self, ., allocator, ,, ), ;, try, walk_, ., walk_ast, (, self_type_decl, ,, new_self, ), ;, for, (, ast, ., impl, ., method_defs, ., items, ,, 0.., ), |, method_def, ,, i, |, {, var, subst, =, std, ., StringArrayHashMap, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ;, defer, subst, ., deinit, (, ), ;, try, subst, ., put, (, "Self", ,, ast, ., impl, ., _type, ), ;, ast, ., impl, ., method_defs, ., items, [, i, ], =, method_def, ., clone, (, &, subst, ,, self, ., allocator, ), ;, }, if, (, ast, ., impl, ., trait, ==, null, ), {, var, new_self_for_anon_trait, =, self, ;, new_self_for_anon_trait, ., scope, =, Scope, ., init, (, self, ., scope, ,, self, ., scope, ., uid_gen, ,, self, ., allocator, ), ;, var, subst, =, std, ., StringArrayHashMap, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ;, defer, subst, ., deinit, (, ), ;, var, token, =, ast, ., token, (, ), ;, token, ., kind, =, ., identifier, ;, token, ., data, =, anon_name_, ., next_anon_name, (, "Trait", ,, self, ., allocator, ), ;, const, cloned_methods, =, ast_, ., AST, ., clone_children, (, ast, ., impl, ., method_defs, ,, &, subst, ,, self, ., allocator, ), ;, for, (, cloned_methods, ., items, ), |, cloned_method, |, {, cloned_method, ., method_decl, ., init, =, null, ;, }, const, anon_trait, =, ast_, ., AST, ., create_trait, (, token, ,, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ,, cloned_methods, ,, ast_, ., AST, ., clone_children, (, ast, ., impl, ., const_defs, ,, &, subst, ,, self, ., allocator, ), ,, self, ., allocator, ,, ), ;, try, new_self_for_anon_trait, ., scope, ., traits, ., put, (, anon_trait, ,, void, {, }, ), ;, try, walk_, ., walk_ast, (, anon_trait, ,, new_self_for_anon_trait, ), ;, ast, ., impl, ., trait, =, ast_, ., AST, ., create_identifier, (, token, ,, self, ., allocator, ), ;, ast, ., impl, ., trait, .?, ., set_symbol, (, anon_trait, ., symbol, (, ), .?, ), ;, ast, ., impl, ., impls_anon_trait, =, true, ;, }, try, self, ., scope, ., impls, ., append, (, ast, ), ;, return, new_self, ;, }, ,, ., method_decl, =>, {, if, (, ast, ., symbol, (, ), !=, null, ), return, null, ;, var, new_self, =, self, ., new_scope, (, ast, ), ;, const, symbol, =, try, create_method_symbol, (, ast, ,, self, ., errors, ,, self, ., allocator, ), ;, try, self, ., register_symbol, (, ast, ,, symbol, ), ;, new_self, ., scope, ., function_depth, =, new_self, ., scope, ., function_depth, +, 1, ;, std, ., debug, ., assert, (, ast, ., symbol, (, ), !=, null, ), ;, return, new_self, ;, }, ,, }, return, self, ;, }, fn, register_symbol, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ,, symbol, :, *, Symbol, ), walk_, ., Error, !, void, {, try, self, ., scope, ., put_symbol, (, symbol, ,, self, ., errors, ), ;, ast, ., set_symbol, (, symbol, ), ;, }, fn, new_scope, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), Self, {, var, new_self, =, self, ;, new_self, ., scope, =, Scope, ., init, (, self, ., scope, ,, self, ., scope, ., uid_gen, ,, self, ., allocator, ), ;, ast, ., set_scope, (, new_self, ., scope, ), ;, return, new_self, ;, }, fn, symbol_tree_postfix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, void, {, switch, (, ast, .*, ), {, else, =>, {, }, ,, ., match, =>, {, try, create_match_pattern_symbol, (, ast, ,, self, ., scope, ,, self, ., errors, ,, self, ., allocator, ), ;, }, ,, ., trait, =>, {, for, (, ast, ., trait, ., method_decls, ., items, ), |, method_decl, |, {, method_decl, ., method_decl, ., c_type, =, try, create_method_type, (, method_decl, ,, self, ., allocator, ), ;, }, }, ,, ., fn_decl, =>, {, for, (, ast, ., children, (, ), ., items, ), |, param_binding, |, {, const, symbol, =, param_binding, ., binding, ., decls, ., items, [, 0, ], ., decl, ., name, ., symbol, (, ), .?, ;, try, ast, ., param_symbols, (, ), .?, ., append, (, symbol, ), ;, symbol, ., defined, =, true, ;, symbol, ., param, =, true, ;, }, for, (, ast, ., fn_decl, ., context_decls, ., items, ), |, context_param, |, {, const, symbol, =, context_param, ., symbol, (, ), .?, ;, try, ast, ., context_param_symbols, (, ), .?, ., append, (, symbol, ), ;, symbol, ., defined, =, true, ;, symbol, ., param, =, true, ;, }, }, ,, ., @, "test", =>, {, for, (, ast, ., @, "test", ., context_decls, ., items, ), |, context_param, |, {, const, symbol, =, context_param, ., symbol, (, ), .?, ;, try, ast, ., context_param_symbols, (, ), .?, ., append, (, symbol, ), ;, symbol, ., defined, =, true, ;, symbol, ., param, =, true, ;, }, }, ,, ., method_decl, =>, {, for, (, ast, ., children, (, ), ., items, ), |, param_binding, |, {, const, symbol, =, param_binding, ., binding, ., decls, ., items, [, 0, ], ., decl, ., name, ., symbol, (, ), .?, ;, try, ast, ., param_symbols, (, ), .?, ., append, (, symbol, ), ;, symbol, ., defined, =, true, ;, symbol, ., param, =, true, ;, }, for, (, ast, ., method_decl, ., context_decls, ., items, ), |, context_param, |, {, const, symbol, =, context_param, ., symbol, (, ), .?, ;, try, ast, ., context_param_symbols, (, ), .?, ., append, (, symbol, ), ;, symbol, ., defined, =, true, ;, symbol, ., param, =, true, ;, }, }, ,, }, }, fn, in_loop_check, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ,, errors, :, *, errs_, ., Errors, ), Error, !, void, {, if, (, !, self, ., in_loop, ), {, errors, ., add_error, (, errs_, ., Error, {, ., not_inside_loop, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., name, =, @, tagName, (, ast, .*, ), ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, fn, in_function_check, (, ast, :, *, ast_, ., AST, ,, scope, :, *, Scope, ,, errors, :, *, errs_, ., Errors, ), Error, !, *, Symbol, {, if, (, scope, ., inner_function, ==, null, ), {, errors, ., add_error, (, errs_, ., Error, {, ., not_inside_function, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., name, =, @, tagName, (, ast, .*, ), ,, }, }, ), ;, return, error, ., CompileError, ;, }, else, {, return, scope, ., inner_function, .?, ;, }, }, fn, create_symbol, (, symbols, :, *, std, ., array_list, ., Managed, (, *, Symbol, ), ,, pattern, :, *, ast_, ., AST, ,, decl, :, ?, *, ast_, ., AST, ,, _type, :, *, Type_AST, ,, init, :, ?, *, ast_, ., AST, ,, scope, :, *, Scope, ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ,, ), Error, !, void, {, switch, (, pattern, .*, ), {, ., pattern_symbol, =>, {, if, (, std, ., mem, ., eql, (, u8, ,, pattern, ., pattern_symbol, ., name, ,, "_", ), ), {, if, (, pattern, ., pattern_symbol, ., kind, !=, ., let, ), {, errors, ., add_error, (, errs_, ., Error, {, ., discard_marked, =, ., {, ., span, =, pattern, ., token, (, ), ., span, ,, ., kind, =, pattern, ., pattern_symbol, ., kind, ,, }, }, ), ;, return, error, ., CompileError, ;, }, else, {, pattern, ., set_symbol, (, prelude_, ., blackhole, ), ;, return, ;, }, }, if, (, pattern, ., symbol, (, ), ), |, sym, |, {, try, symbols, ., append, (, sym, ), ;, return, ;, }, const, symbol, =, Symbol, ., init, (, scope, ,, pattern, ., pattern_symbol, ., name, ,, ast_, ., AST, ., create_decl, (, pattern, ., token, (, ), ,, pattern, ,, _type, ,, init, ,, allocator, ), ,, pattern, ., pattern_symbol, ., kind, ,, pattern, ., pattern_symbol, ., storage, ,, allocator, ,, ), ;, pattern, ., set_symbol, (, symbol, ), ;, try, symbols, ., append, (, symbol, ), ;, }, ,, ., tuple_value, ,, ., array_value, =>, {, for, (, pattern, ., children, (, ), ., items, ,, 0.., ), |, term, ,, i, |, {, const, index, =, ast_, ., AST, ., create_int, (, pattern, ., token, (, ), ,, i, ,, allocator, ), ;, const, new_type, :, *, Type_AST, =, Type_AST, ., create_index_type, (, _type, ., token, (, ), ,, _type, ,, index, ,, allocator, ), ;, var, index_rhs, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, allocator, ), ;, try, index_rhs, ., append, (, index, ), ;, const, new_init, :, *, ast_, ., AST, =, ast_, ., AST, ., create_index, (, init, .?, ., token, (, ), ,, init, .?, ,, index_rhs, ,, allocator, ), ;, try, create_symbol, (, symbols, ,, term, ,, decl, ,, new_type, ,, new_init, ,, scope, ,, errors, ,, allocator, ), ;, }, }, ,, ., enum_value, =>, {, const, lhs_type, =, Type_AST, ., create_type_of, (, pattern, ., token, (, ), ,, init, .?, ,, allocator, ), ;, const, rhs_type, =, Type_AST, ., create_domain_of, (, pattern, ., token, (, ), ,, lhs_type, ,, pattern, ., enum_value, ., get_name, (, ), ,, allocator, ), ;, if, (, pattern, ., enum_value, ., init, !=, null, ), {, try, create_symbol, (, symbols, ,, pattern, ., enum_value, ., init, .?, ,, decl, ,, rhs_type, ,, pattern, ., enum_value, ., init, .?, ,, scope, ,, errors, ,, allocator, ), ;, }, }, ,, else, =>, {, }, ,, }, }, fn, create_match_pattern_symbol, (, match, :, *, ast_, ., AST, ,, scope, :, *, Scope, ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ), Error, !, void, {, for, (, match, ., children, (, ), ., items, ), |, mapping, |, {, const, mpaping_scope, =, Scope, ., init, (, scope, ,, scope, ., uid_gen, ,, allocator, ), ;, mapping, ., set_scope, (, mpaping_scope, ), ;, var, symbols, =, std, ., array_list, ., Managed, (, *, Symbol, ), ., init, (, allocator, ), ;, defer, symbols, ., deinit, (, ), ;, const, match_expr, =, match, ., expr, (, ), ;, const, match_expr_token, =, match_expr, ., token, (, ), ;, const, _type, =, Type_AST, ., create_type_of, (, match_expr_token, ,, match_expr, ,, allocator, ), ;, try, create_symbol, (, &, symbols, ,, mapping, ., lhs, (, ), ,, null, ,, _type, ,, match_expr, ,, mpaping_scope, ,, errors, ,, allocator, ), ;, for, (, symbols, ., items, ), |, symbol, |, {, symbol, ., defined, =, true, ;, }, for, (, symbols, ., items, ), |, symbol, |, {, try, mapping, ., mapping, ., captures, ., append, (, symbol, ., decl, .?, ), ;, }, try, mpaping_scope, ., put_all_symbols, (, &, symbols, ,, errors, ), ;, try, walk_, ., walk_ast, (, mapping, ., rhs, (, ), ,, Self, ., new, (, mpaping_scope, ,, errors, ,, allocator, ), ), ;, }, }, pub, fn, create_function_symbol, (, ast, :, *, ast_, ., AST, ,, allocator, :, std, ., mem, ., Allocator, ), !, *, Symbol, {, const, domain, =, try, extract_domain, (, ast, ., children, (, ), .*, ,, allocator, ), ;, var, contexts, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, for, (, ast, ., fn_decl, ., context_decls, ., items, ), |, ctx, |, {, try, contexts, ., append, (, ctx, ., context_value_decl, ., parent, ), ;, }, const, _type, =, Type_AST, ., create_function, (, ast, ., fn_decl, ., ret_type, ., token, (, ), ,, domain, ,, ast, ., fn_decl, ., ret_type, ,, contexts, ,, allocator, ,, ), ;, ast, ., fn_decl, ., _decl_type, =, _type, ;, var, buf, :, [, ], const, u8, =, undefined, ;, if, (, ast, ., fn_decl, ., name, ), |, name, |, {, buf, =, name, ., token, (, ), ., data, ;, }, else, {, buf, =, anon_name_, ., next_anon_name, (, "anon", ,, allocator, ), ;, }, const, retval, =, Symbol, ., init, (, ast, ., scope, (, ), .?, ,, buf, ,, ast, ,, ., @, "fn", ,, ., local, ,, allocator, ,, ), ;, ast, ., scope, (, ), .?, ., inner_function, =, retval, ;, return, retval, ;, }, pub, fn, create_test_symbol, (, ast, :, *, ast_, ., AST, ,, allocator, :, std, ., mem, ., Allocator, ), Error, !, *, Symbol, {, var, contexts, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, for, (, ast, ., @, "test", ., context_decls, ., items, ), |, ctx, |, {, try, contexts, ., append, (, ctx, ., context_value_decl, ., parent, ), ;, }, const, args, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, const, _type, =, Type_AST, ., create_function, (, ast, ., token, (, ), ,, args, ,, core_, ., test_result_type, ,, contexts, ,, allocator, ,, ), ;, ast, ., @, "test", ., _decl_type, =, _type, ;, const, buf, :, [, ], const, u8, =, anon_name_, ., next_anon_name, (, "test", ,, allocator, ), ;, const, retval, =, Symbol, ., init, (, ast, ., scope, (, ), .?, ,, buf, ,, ast, ,, ., @, "test", ,, ., local, ,, allocator, ,, ), ;, ast, ., scope, (, ), .?, ., inner_function, =, retval, ;, return, retval, ;, }, pub, fn, extract_domain, (, params, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), !, std, ., array_list, ., Managed, (, *, Type_AST, ), {, var, param_types, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, for, (, 0..params.items.len, ), |, i, |, {, try, param_types, ., append, (, Type_AST, ., create_annotation, (, params, ., items, [, i, ], ., token, (, ), ,, params, ., items, [, i, ], ., binding, ., pattern, ,, params, ., items, [, i, ], ., binding, ., type, ,, params, ., items, [, i, ], ., binding, ., init, ,, allocator, ,, ), ), ;, }, return, param_types, ;, }, fn, extract_domain_with_receiver, (, impl_type, :, *, Type_AST, ,, receiver, :, *, ast_, ., AST, ,, params, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), !, std, ., array_list, ., Managed, (, *, Type_AST, ), {, const, receiver_addr_type, =, create_receiver_addr, (, impl_type, ,, receiver, ,, allocator, ), ;, receiver, ., receiver, ., _type, =, receiver_addr_type, ;, const, _receiver_type, =, create_receiver_annot, (, receiver_addr_type, ,, receiver, ,, allocator, ), ;, var, param_types, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, try, param_types, ., append, (, _receiver_type, ), ;, for, (, 0..params.items.len, ), |, i, |, {, try, param_types, ., append, (, Type_AST, ., create_annotation, (, params, ., items, [, i, ], ., token, (, ), ,, params, ., items, [, i, ], ., binding, ., pattern, ,, params, ., items, [, i, ], ., binding, ., type, ,, params, ., items, [, i, ], ., binding, ., init, ,, allocator, ,, ), ), ;, }, return, param_types, ;, }, fn, create_receiver_addr, (, impl_type, :, *, Type_AST, ,, receiver, :, *, ast_, ., AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, if, (, impl_type, .*, ==, ., anyptr_type, ), return, impl_type, ;, return, switch, (, receiver, ., receiver, ., kind, ), {, ., value, ,, ., addr_of, =>, Type_AST, ., create_addr_of_type, (, receiver, ., token, (, ), ,, impl_type, ,, false, ,, false, ,, allocator, ), ,, ., mut_addr_of, =>, Type_AST, ., create_addr_of_type, (, receiver, ., token, (, ), ,, impl_type, ,, true, ,, false, ,, allocator, ), ,, }, ;, }, fn, create_receiver_annot, (, receiver_addr, :, *, Type_AST, ,, receiver, :, *, ast_, ., AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., create_annotation, (, receiver, ., token, (, ), ,, receiver, ,, receiver_addr, ,, null, ,, allocator, ,, ), ;, }, pub, fn, create_temp_comptime_symbol, (, ast, :, *, ast_, ., AST, ,, rhs_type_hint, :, ?, *, Type_AST, ,, scope, :, *, Scope, ,, allocator, :, std, ., mem, ., Allocator, ,, ), Error, !, *, Symbol, {, const, args, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, const, rhs, =, Type_AST, ., create_type_of, (, ast, ., token, (, ), ,, ast, ,, allocator, ), ;, const, _type, =, Type_AST, ., create_function, (, ast, ., token, (, ), ,, args, ,, rhs_type_hint, orelse, rhs, ,, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ,, allocator, ,, ), ;, var, comptime_scope, =, Scope, ., init, (, scope, ,, scope, ., uid_gen, ,, allocator, ), ;, comptime_scope, ., function_depth, =, scope, ., function_depth, +, 1, ;, var, buf, :, [, ], const, u8, =, undefined, ;, buf, =, anon_name_, ., next_anon_name, (, "comptime", ,, allocator, ), ;, const, decl, =, ast_, ., AST, ., create_decl, (, ast, ., token, (, ), ,, ast_, ., AST, ., create_pattern_symbol, (, ast, ., token, (, ), ,, ., @, "comptime", ,, ., local, ,, buf, ,, allocator, ,, ), ,, _type, ,, ast, ,, allocator, ,, ), ;, const, retval, =, Symbol, ., init, (, comptime_scope, ,, buf, ,, decl, ,, ., @, "comptime", ,, ., local, ,, allocator, ,, ), ;, comptime_scope, ., inner_function, =, retval, ;, return, retval, ;, }, fn, create_trait_symbol, (, ast, :, *, ast_, ., AST, ,, scope, :, *, Scope, ,, allocator, :, std, ., mem, ., Allocator, ,, ), Error, !, *, Symbol, {, const, retval, =, Symbol, ., init, (, scope, ,, ast, ., token, (, ), ., data, ,, ast, ,, ., trait, ,, ., local, ,, allocator, ,, ), ;, retval, ., defined, =, true, ;, return, retval, ;, }, fn, create_method_type, (, ast, :, *, ast_, ., AST, ,, allocator, :, std, ., mem, ., Allocator, ), !, *, Type_AST, {, const, receiver_base_type, :, *, Type_AST, =, if, (, ast, ., method_decl, ., impl, !=, null, ), ast, ., method_decl, ., impl, .?, ., impl, ., _type, else, Type_AST, ., create_anyptr_type, (, ast, ., token, (, ), ,, allocator, ), ;, const, args, =, if, (, ast, ., method_decl, ., receiver, ), |, receiver, |, try, extract_domain_with_receiver, (, receiver_base_type, ,, receiver, ,, ast, ., children, (, ), .*, ,, allocator, ), else, try, extract_domain, (, ast, ., children, (, ), .*, ,, allocator, ), ;, var, contexts, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, for, (, ast, ., method_decl, ., context_decls, ., items, ), |, ctx, |, {, try, contexts, ., append, (, ctx, ., context_value_decl, ., parent, ), ;, }, const, _type, =, Type_AST, ., create_function, (, ast, ., method_decl, ., ret_type, ., token, (, ), ,, args, ,, ast, ., method_decl, ., ret_type, ,, contexts, ,, allocator, ,, ), ;, return, _type, ;, }, fn, create_method_symbol, (, ast, :, *, ast_, ., AST, ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ,, ), Error, !, *, Symbol, {, const, receiver_base_type, :, ?, *, Type_AST, =, if, (, ast, ., method_decl, ., impl, ), |, impl, |, impl, ., impl, ., _type, else, null, ;, ast, ., method_decl, ., _decl_type, =, try, create_method_type, (, ast, ,, allocator, ), ;, if, (, ast, ., method_decl, ., receiver, !=, null, and, receiver_base_type, !=, null, ), {, const, recv_type, =, create_receiver_addr, (, receiver_base_type, .?, ,, ast, ., method_decl, ., receiver, .?, ,, allocator, ), ;, recv_type, ., addr_of, ., anytptr, =, true, ;, const, receiver_symbol, =, Symbol, ., init, (, ast, ., scope, (, ), .?, ,, if, (, ast, ., method_decl, ., receiver, .?, ., receiver, ., kind, ==, ., value, ), "self__ptr", else, "self", ,, ast, ., method_decl, ., receiver, ,, ., let, ,, ., local, ,, allocator, ,, ), ;, receiver_symbol, ., param, =, true, ;, try, ast, ., scope, (, ), .?, ., put_symbol, (, receiver_symbol, ,, errors, ), ;, try, ast, ., param_symbols, (, ), .?, ., append, (, receiver_symbol, ), ;, if, (, ast, ., method_decl, ., receiver, .?, ., receiver, ., kind, ==, ., value, ), {, const, self_type, =, recv_type, ., child, (, ), ;, const, self_init, =, ast_, ., AST, ., create_dereference, (, ast, ., token, (, ), ,, ast_, ., AST, ., create_identifier, (, Token, ., init_simple, (, "self__ptr", ), ,, allocator, ), ,, allocator, ), ;, const, receiver_span, =, ast, ., method_decl, ., receiver, .?, ., token, (, ), ., span, ;, const, self_decl, =, ast_, ., AST, ., create_binding, (, ast, ., token, (, ), ,, ast_, ., AST, ., create_pattern_symbol, (, Token, ., init, (, "self", ,, ., identifier, ,, receiver_span, ., filename, ,, receiver_span, ., line_text, ,, receiver_span, ., line_number, ,, receiver_span, ., col, ), ,, ., let, ,, ., local, ,, "self", ,, allocator, ), ,, self_type, ,, self_init, ,, allocator, ,, ), ;, if, (, ast, ., method_decl, ., init, !=, null, ), {, if, (, ast, ., method_decl, ., init, .?, .*, !=, ., unit_value, ), {, const, method_block_statements, =, ast, ., method_decl, ., init, .?, ., children, (, ), ;, try, method_block_statements, ., insert, (, 0, ,, self_decl, ), ;, }, else, {, var, statements, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, allocator, ), ;, try, statements, ., append, (, self_decl, ), ;, ast, ., method_decl, ., init, =, ast_, ., AST, ., create_block, (, ast, ., method_decl, ., init, .?, ., token, (, ), ,, statements, ,, null, ,, allocator, ), ;, }, }, }, }, const, retval, =, Symbol, ., init, (, ast, ., scope, (, ), .?, ,, ast, ., method_decl, ., name, ., token, (, ), ., data, ,, ast, ,, ., @, "fn", ,, ., local, ,, allocator, ,, ), ;, ast, ., scope, (, ), .?, ., inner_function, =, retval, ;, return, retval, ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, walker_, =, @, import, (, "../ast/walker.zig", ), ;, indent, :, usize, ,, const, Self, =, @, This, (, ), ;, pub, fn, new, (, indent, :, usize, ), Self, {, return, Self, {, ., indent, =, indent, }, ;, }, pub, fn, print_tree, (, ast, :, *, ast_, ., AST, ), void, {, walker_, ., walk_ast, (, ast, ,, new, (, 0, ), ), catch, unreachable, ;, }, pub, fn, print_type_tree, (, _type, :, *, Type_AST, ), void, {, walker_, ., walk_type, (, _type, ,, new, (, 0, ), ), catch, unreachable, ;, }, pub, fn, prefix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walker_, ., Error, !, ?, Self, {, return, self, ., tree_writer_prefix, (, ast, ), ;, }, pub, fn, prefix_type, (, self, :, Self, ,, _type, :, *, Type_AST, ), walker_, ., Error, !, ?, Self, {, return, self, ., tree_writer_prefix_type, (, _type, ), ;, }, fn, tree_writer_prefix, (, self, :, Self, ,, ast, :, *, ast_, ., AST, ), walker_, ., Error, !, ?, Self, {, for, (, 0..self.indent, ), |, _, |, {, std, ., debug, ., print, (, " ", ,, ., {, }, ), ;, }, std, ., debug, ., print, (, "{t}(", ,, ., {, ast, .*, }, ), ;, switch, (, ast, .*, ), {, else, =>, {, }, ,, ., access, =>, std, ., debug, ., print, (, ".symbol={?s}@{?}", ,, ., {, if, (, ast, ., symbol, (, ), ), |, sym, |, sym, ., name, else, null, ,, if, (, ast, ., symbol, (, ), ), |, sym, |, sym, ., scope, ., uid, else, null, ,, }, ), ,, ., identifier, =>, std, ., debug, ., print, (, ".data={s}, .symbol={?s}@{?}", ,, ., {, ast, ., token, (, ), ., data, ,, if, (, ast, ., symbol, (, ), ), |, sym, |, sym, ., name, else, null, ,, if, (, ast, ., symbol, (, ), ), |, sym, |, sym, ., scope, ., uid, else, null, ,, }, ), ,, ., fn_decl, =>, std, ., debug, ., print, (, ".name={?f}", ,, ., {, ast, ., fn_decl, ., name, }, ), ,, ., method_decl, =>, std, ., debug, ., print, (, ".name={f}, .symbol={?*}", ,, ., {, ast, ., method_decl, ., name, ,, if, (, ast, ., symbol, (, ), ), |, sym, |, sym, else, null, }, ), ,, ., binding, =>, std, ., debug, ., print, (, ".pattern={f}, .type={f}, .init={?f}", ,, ., {, ast, ., binding, ., pattern, ,, ast, ., binding, ., type, ,, ast, ., binding, ., init, }, ), ,, ., field, =>, std, ., debug, ., print, (, ".data={s}", ,, ., {, ast, ., token, (, ), ., data, }, ), ,, }, std, ., debug, ., print, (, ")\n", ,, ., {, }, ), ;, return, Self, ., new, (, self, ., indent, +, 4, ), ;, }, fn, tree_writer_prefix_type, (, self, :, Self, ,, _type, :, *, Type_AST, ), walker_, ., Error, !, ?, Self, {, for, (, 0..self.indent, ), |, _, |, {, std, ., debug, ., print, (, " ", ,, ., {, }, ), ;, }, std, ., debug, ., print, (, "{t}(", ,, ., {, _type, .*, }, ), ;, switch, (, _type, .*, ), {, else, =>, {, }, ,, ., identifier, =>, std, ., debug, ., print, (, ".data={s}", ,, ., {, _type, ., token, (, ), ., data, }, ), ,, ., annotation, =>, std, ., debug, ., print, (, ".name={f}", ,, ., {, _type, ., annotation, ., pattern, }, ), ,, }, std, ., debug, ., print, (, ")\n", ,, ., {, }, ), ;, return, Self, ., new, (, self, ., indent, +, 4, ), ;, }, const, std, =, @, import, (, "std", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, walk_, =, @, import, (, "../ast/walker.zig", ), ;, ctx, :, *, Compiler_Context, ,, const, Self, =, @, This, (, ), ;, pub, fn, new, (, ctx, :, *, Compiler_Context, ), Self, {, return, Self, {, ., ctx, =, ctx, }, ;, }, pub, fn, postfix_type, (, self, :, Self, ,, _type, :, *, Type_AST, ), walk_, ., Error, !, void, {, const, depth_limit, :, usize, =, 100, ;, var, depth, :, usize, =, 0, ;, while, (, _type, .*, ==, ., type_of, or, _type, .*, ==, ., domain_of, or, _type, .*, ==, ., index, ), {, if, (, depth, >, depth_limit, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., msg, =, "recursive type detected", ,, ., span, =, _type, ., token, (, ), ., span, }, }, ), ;, return, error, ., CompileError, ;, }, switch, (, _type, .*, ), {, ., type_of, =>, {, const, typeof_expr, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, _type, ., type_of, ., _expr, ,, null, ), catch, |, e, |, switch, (, e, ), {, error, ., UnexpectedTypeType, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., unexpected_type_type, =, ., {, ., expected, =, null, ,, ., span, =, _type, ., type_of, ., _expr, ., token, (, ), ., span, }, }, ), ;, return, error, ., CompileError, ;, }, ,, error, ., CompileError, =>, return, error, ., CompileError, ,, error, ., OutOfMemory, =>, return, error, ., OutOfMemory, ,, }, ;, _type, .*, =, typeof_expr, .*, ;, }, ,, ., domain_of, =>, {, var, child, =, _type, ., domain_of, ., _child, ;, try, self, ., postfix_type, (, child, ), ;, const, domain_ptr, =, child, ., expand_identifier, (, ), ., enum_type, ., get_ctor, (, _type, ., domain_of, ., ctor_name, ), orelse, std, ., debug, ., panic, (, "{s} not in {f}\n", ,, ., {, _type, ., domain_of, ., ctor_name, ,, child, }, ), ;, _type, .*, =, domain_ptr, .*, ;, }, ,, ., index, =>, {, var, child, =, _type, ., child, (, ), ;, try, self, ., postfix_type, (, child, ), ;, child, =, child, ., expand_identifier, (, ), ;, if, (, child, .*, ==, ., array_of, ), {, _type, .*, =, child, ., child, (, ), .*, ;, }, else, if, (, child, .*, ==, ., tuple_type, ), {, if, (, _type, ., index, ., idx, ., int, ., data, >=, child, ., children, (, ), ., items, ., len, ), {, break, ;, }, _type, .*, =, child, ., children, (, ), ., items, [, @, intCast, (, _type, ., index, ., idx, ., int, ., data, ), ], .*, ;, }, else, {, _type, .*, =, Type_AST, ., create_poisoned_type, (, _type, ., token, (, ), ,, self, ., ctx, ., allocator, (, ), ), .*, ;, }, }, ,, else, =>, unreachable, ,, }, depth, +=, 1, ;, }, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, pub, const, Error, =, error, {, OutOfMemory, ,, CompileError, }, ;, pub, fn, Apply_Ast_Walk, (, Context_Type, :, type, ), type, {, return, struct, {, const, Self, :, type, =, @, This, (, ), ;, context, :, Context_Type, ,, pub, fn, init, (, context, :, Context_Type, ), Self, {, return, Self, {, ., context, =, context, }, ;, }, pub, fn, run, (, self, :, *, Self, ,, asts, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ), Error, !, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, try, walk_asts, (, asts, ,, self, ., context, ), ;, return, asts, ;, }, }, ;, }, pub, fn, Apply_Flat_Ast_Walk, (, Context_Type, :, type, ), type, {, return, struct, {, const, Self, :, type, =, @, This, (, ), ;, context, :, Context_Type, ,, pub, fn, init, (, context, :, Context_Type, ), Self, {, return, Self, {, ., context, =, context, }, ;, }, pub, fn, run, (, self, :, *, Self, ,, asts, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ), Error, !, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, try, walk_asts_flat, (, asts, ,, self, ., context, ), ;, return, asts, ;, }, }, ;, }, pub, fn, walk_asts, (, asts, :, *, const, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, context, :, anytype, ), Error, !, void, {, for, (, asts, ., items, ), |, ast, |, {, try, walk_ast, (, ast, ,, context, ), ;, }, }, pub, fn, walk_asts_flat, (, asts, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, context, :, anytype, ), Error, !, void, {, var, i, :, usize, =, 0, ;, while, (, i, <, asts, ., items, ., len, ), :, (, i, +=, 1, ), {, const, ast, =, asts, ., items, [, i, ], ;, i, +=, try, context, ., flat, (, ast, ,, asts, ,, i, ), ;, }, }, pub, fn, walk_ast, (, maybe_ast, :, ?, *, ast_, ., AST, ,, context, :, anytype, ), Error, !, void, {, if, (, maybe_ast, ==, null, ), {, return, ;, }, const, ast, =, maybe_ast, .?, ;, var, new_context, =, context, ;, if, (, @, hasDecl, (, @, TypeOf, (, context, ), ,, "prefix", ), ), {, const, maybe_new_context, =, try, new_context, ., prefix, (, ast, ), ;, if, (, maybe_new_context, ==, null, ), {, return, ;, }, else, {, new_context, =, maybe_new_context, .?, ;, }, }, switch, (, ast, .*, ), {, ., unit_value, ,, ., int, ,, ., float, ,, ., string, ,, ., field, ,, ., @, "unreachable", ,, ., true, ,, ., false, ,, ., @, "break", ,, ., @, "continue", ,, ., poison, ,, ., pattern_symbol, ,, ., receiver, ,, ., identifier, ,, ., import, ,, =>, {, }, ,, ., type_param_decl, =>, try, walk_types, (, &, ast, ., type_param_decl, ., constraints, ,, new_context, ), ,, ., context_value_decl, =>, {, try, walk_ast, (, ast, ., context_value_decl, ., init, ,, new_context, ), ;, try, walk_type, (, ast, ., context_value_decl, ., parent, ,, new_context, ), ;, }, ,, ., context_decl, =>, try, walk_type, (, ast, ., decl_typedef, (, ), ,, new_context, ), ,, ., struct_decl, ,, ., enum_decl, ,, ., type_alias, ,, =>, {, try, walk_asts, (, ast, ., generic_params, (, ), ,, new_context, ), ;, try, walk_type, (, ast, ., decl_typedef, (, ), ,, new_context, ), ;, }, ,, ., module, =>, {, }, ,, ., size_of, ,, ., default, =>, try, walk_type, (, ast, ., type, (, ), ,, new_context, ), ,, ., not, ,, ., negate, ,, ., dereference, ,, ., @, "try", ,, ., @, "comptime", ,, ., addr_of, ,, ., slice_of, ,, ., dyn_value, ,, ., bit_not, ,, ., cinclude, ,, =>, try, walk_ast, (, ast, ., expr, (, ), ,, new_context, ), ,, ., as, =>, {, try, walk_ast, (, ast, ., expr, (, ), ,, new_context, ), ;, try, walk_type, (, ast, ., type, (, ), ,, new_context, ), ;, }, ,, ., assign, ,, ., @, "or", ,, ., @, "and", ,, ., add, ,, ., sub, ,, ., mult, ,, ., div, ,, ., mod, ,, ., equal, ,, ., not_equal, ,, ., greater, ,, ., lesser, ,, ., greater_equal, ,, ., lesser_equal, ,, ., @, "catch", ,, ., @, "orelse", ,, ., select, ,, ., access, ,, ., left_shift, ,, ., right_shift, ,, =>, {, try, walk_ast, (, ast, ., lhs, (, ), ,, new_context, ), ;, try, walk_ast, (, ast, ., rhs, (, ), ,, new_context, ), ;, }, ,, ., invoke, =>, {, try, walk_ast, (, ast, ., lhs, (, ), ,, new_context, ), ;, try, walk_ast, (, ast, ., rhs, (, ), ,, new_context, ), ;, try, walk_asts, (, ast, ., children, (, ), ,, new_context, ), ;, }, ,, ., call, ,, ., index, =>, {, try, walk_ast, (, ast, ., lhs, (, ), ,, new_context, ), ;, try, walk_asts, (, ast, ., children, (, ), ,, new_context, ), ;, }, ,, ., generic_apply, =>, {, try, walk_ast, (, ast, ., lhs, (, ), ,, new_context, ), ;, try, walk_types, (, &, ast, ., generic_apply, ., _children, ,, new_context, ), ;, }, ,, ., context_value, =>, {, try, walk_asts, (, ast, ., children, (, ), ,, new_context, ), ;, try, walk_type, (, ast, ., context_value, ., parent, ,, new_context, ), ;, }, ,, ., struct_value, ,, ., tuple_value, ,, ., array_value, ,, ., print, ,, ., bit_and, ,, ., bit_or, ,, ., bit_xor, ,, =>, try, walk_asts, (, ast, ., children, (, ), ,, new_context, ), ,, ., write, =>, {, try, walk_ast, (, ast, ., write, ., writer, ,, new_context, ), ;, try, walk_asts, (, ast, ., children, (, ), ,, new_context, ), ;, }, ,, ., binding, =>, {, try, walk_asts, (, ast, ., children, (, ), ,, new_context, ), ;, try, walk_ast, (, ast, ., binding, ., init, ,, new_context, ), ;, try, walk_type, (, ast, ., binding, ., type, ,, new_context, ), ;, }, ,, ., enum_value, =>, {, try, walk_ast, (, ast, ., enum_value, ., init, ,, new_context, ), ;, if, (, ast, ., enum_value, ., base, !=, null, ), {, try, walk_type, (, ast, ., enum_value, ., base, ,, new_context, ), ;, }, }, ,, ., sub_slice, =>, {, try, walk_ast, (, ast, ., sub_slice, ., super, ,, new_context, ), ;, try, walk_ast, (, ast, ., sub_slice, ., lower, ,, new_context, ), ;, try, walk_ast, (, ast, ., sub_slice, ., upper, ,, new_context, ), ;, }, ,, ., @, "if", =>, {, try, walk_ast, (, ast, ., @, "if", ., let, ,, new_context, ), ;, try, walk_ast, (, ast, ., @, "if", ., condition, ,, new_context, ), ;, try, walk_ast, (, ast, ., body_block, (, ), ,, new_context, ), ;, try, walk_ast, (, ast, ., else_block, (, ), ,, new_context, ), ;, }, ,, ., match, =>, {, try, walk_ast, (, ast, ., match, ., let, ,, new_context, ), ;, try, walk_ast, (, ast, ., expr, (, ), ,, new_context, ), ;, try, walk_asts, (, ast, ., children, (, ), ,, new_context, ), ;, }, ,, ., mapping, =>, {, try, walk_ast, (, ast, ., lhs, (, ), ,, new_context, ), ;, try, walk_ast, (, ast, ., rhs, (, ), ,, new_context, ), ;, try, walk_asts, (, &, ast, ., mapping, ., captures, ,, new_context, ), ;, }, ,, ., @, "while", =>, {, try, walk_ast, (, ast, ., @, "while", ., let, ,, new_context, ), ;, try, walk_ast, (, ast, ., @, "while", ., condition, ,, new_context, ), ;, try, walk_ast, (, ast, ., @, "while", ., post, ,, new_context, ), ;, try, walk_ast, (, ast, ., body_block, (, ), ,, new_context, ), ;, try, walk_ast, (, ast, ., else_block, (, ), ,, new_context, ), ;, }, ,, ., @, "for", =>, {, try, walk_ast, (, ast, ., @, "for", ., let, ,, new_context, ), ;, try, walk_ast, (, ast, ., @, "for", ., elem, ,, new_context, ), ;, try, walk_ast, (, ast, ., @, "for", ., iterable, ,, new_context, ), ;, try, walk_ast, (, ast, ., body_block, (, ), ,, new_context, ), ;, try, walk_ast, (, ast, ., else_block, (, ), ,, new_context, ), ;, }, ,, ., with, =>, {, try, walk_asts, (, &, ast, ., with, ., contexts, ,, new_context, ), ;, try, walk_ast, (, ast, ., with, ., _body_block, ,, new_context, ), ;, }, ,, ., block, =>, {, try, walk_asts, (, ast, ., children, (, ), ,, new_context, ), ;, if, (, ast, ., block, ., final, ), |, final, |, {, try, walk_ast, (, final, ,, new_context, ), ;, }, }, ,, ., @, "return", =>, try, walk_ast, (, ast, ., @, "return", ., _ret_expr, ,, new_context, ), ,, ., decl, =>, {, try, walk_type, (, ast, ., decl, ., type, ,, new_context, ), ;, if, (, !, (, ast, ., decl, ., init, !=, null, and, ast, ., decl, ., init, .?, .*, ==, ., default, and, ast, ., decl, ., init, .?, ., default, ., _type, ==, ast, ., decl, ., type, ), ), {, try, walk_ast, (, ast, ., decl, ., init, ,, new_context, ), ;, }, }, ,, ., fn_decl, =>, {, try, walk_asts, (, &, ast, ., fn_decl, ., context_decls, ,, new_context, ), ;, try, walk_asts, (, ast, ., generic_params, (, ), ,, new_context, ), ;, try, walk_type, (, ast, ., fn_decl, ., _decl_type, ,, new_context, ), ;, try, walk_ast, (, ast, ., fn_decl, ., init, ,, new_context, ), ;, try, walk_asts, (, ast, ., children, (, ), ,, new_context, ), ;, try, walk_type, (, ast, ., fn_decl, ., ret_type, ,, new_context, ), ;, }, ,, ., @, "test", =>, {, try, walk_asts, (, &, ast, ., @, "test", ., context_decls, ,, new_context, ), ;, try, walk_ast, (, ast, ., @, "test", ., name, ,, new_context, ), ;, try, walk_ast, (, ast, ., @, "test", ., init, ,, new_context, ), ;, }, ,, ., trait, =>, {, try, walk_types, (, &, ast, ., trait, ., super_traits, ,, new_context, ), ;, try, walk_asts, (, &, ast, ., trait, ., method_decls, ,, new_context, ), ;, try, walk_asts, (, &, ast, ., trait, ., const_decls, ,, new_context, ), ;, }, ,, ., impl, =>, {, try, walk_asts, (, ast, ., generic_params, (, ), ,, new_context, ), ;, try, walk_type, (, ast, ., impl, ., _type, ,, new_context, ), ;, try, walk_ast, (, ast, ., impl, ., trait, ,, new_context, ), ;, try, walk_asts, (, &, ast, ., impl, ., method_defs, ,, new_context, ), ;, try, walk_asts, (, &, ast, ., impl, ., const_defs, ,, new_context, ), ;, if, (, ast, ., impl, ., trait, !=, null, and, ast, ., impl, ., trait, .?, ., symbol, (, ), !=, null, and, ast, ., impl, ., trait, .?, ., symbol, (, ), .?, ., decl, .?, ., scope, (, ), !=, null, ), {, try, walk_ast, (, ast, ., impl, ., trait, .?, ., symbol, (, ), .?, ., decl, .?, ,, new_context, ), ;, }, }, ,, ., method_decl, =>, {, try, walk_asts, (, &, ast, ., method_decl, ., context_decls, ,, new_context, ), ;, try, walk_ast, (, ast, ., method_decl, ., init, ,, new_context, ), ;, try, walk_asts, (, ast, ., children, (, ), ,, new_context, ), ;, try, walk_type, (, ast, ., method_decl, ., _decl_type, ,, new_context, ), ;, try, walk_type, (, ast, ., method_decl, ., ret_type, ,, new_context, ), ;, }, ,, ., @, "defer", ,, ., @, "errdefer", =>, try, walk_ast, (, ast, ., statement, (, ), ,, new_context, ), ,, }, if, (, @, hasDecl, (, @, TypeOf, (, context, ), ,, "postfix", ), ), {, try, context, ., postfix, (, ast, ), ;, }, }, pub, fn, walk_types, (, types, :, *, const, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, context, :, anytype, ), Error, !, void, {, for, (, types, ., items, ), |, _type, |, {, try, walk_type, (, _type, ,, context, ), ;, }, }, pub, fn, walk_types_flat, (, types, :, *, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, context, :, anytype, ), Error, !, void, {, var, i, :, usize, =, 0, ;, while, (, i, <, types, ., items, ., len, ), :, (, i, +=, 1, ), {, const, _type, =, types, ., items, [, i, ], ;, i, +=, try, context, ., flat_type, (, _type, ,, types, ,, i, ), ;, }, }, pub, fn, walk_type, (, maybe_type, :, ?, *, Type_AST, ,, context, :, anytype, ), Error, !, void, {, if, (, maybe_type, ==, null, ), {, return, ;, }, const, _type, =, maybe_type, .?, ;, var, new_context, =, context, ;, if, (, @, hasDecl, (, @, TypeOf, (, context, ), ,, "prefix_type", ), ), {, const, maybe_new_context, =, try, context, ., prefix_type, (, _type, ), ;, if, (, maybe_new_context, ==, null, ), {, return, ;, }, else, {, new_context, =, maybe_new_context, .?, ;, }, }, switch, (, _type, .*, ), {, ., poison, ,, ., anyptr_type, ,, ., unit_type, ,, ., identifier, =>, {, }, ,, ., type_of, =>, try, walk_ast, (, _type, ., type_of, ., _expr, ,, new_context, ), ,, ., access, =>, try, walk_ast, (, _type, ., access, ., inner_access, ,, new_context, ), ,, ., generic_apply, =>, {, try, walk_type, (, _type, ., lhs, (, ), ,, new_context, ), ;, try, walk_types, (, _type, ., children, (, ), ,, new_context, ), ;, }, ,, ., array_of, =>, {, try, walk_type, (, _type, ., child, (, ), ,, new_context, ), ;, try, walk_ast, (, _type, ., array_of, ., len, ,, new_context, ), ;, }, ,, ., annotation, =>, {, try, walk_type, (, _type, ., child, (, ), ,, new_context, ), ;, try, walk_ast, (, _type, ., annotation, ., init, ,, new_context, ), ;, }, ,, ., untagged_sum_type, ,, ., addr_of, ,, ., dyn_type, ,, ., index, ,, ., domain_of, ,, =>, {, try, walk_type, (, _type, ., child, (, ), ,, new_context, ), ;, }, ,, ., function, =>, {, try, walk_types, (, &, _type, ., function, ., args, ,, new_context, ), ;, try, walk_type, (, _type, ., rhs, (, ), ,, new_context, ), ;, try, walk_types, (, &, _type, ., function, ., contexts, ,, new_context, ), ;, }, ,, ., context_type, ,, ., enum_type, ,, ., struct_type, ,, ., tuple_type, ,, =>, {, try, walk_types, (, _type, ., children, (, ), ,, new_context, ), ;, }, ,, }, if, (, @, hasDecl, (, @, TypeOf, (, context, ), ,, "postfix_type", ), ), {, try, context, ., postfix_type, (, _type, ), ;, }, }, const, std, =, @, import, (, "std", ), ;, const, core_, =, @, import, (, "../hierarchy/core.zig", ), ;, const, Module_Iterator, =, @, import, (, "../util/dfs.zig", ), ., Dfs_Iterator, (, *, Module, ), ;, const, Dependency_Node, =, @, import, (, "../types/dependency_node.zig", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, Interned_String_Set, =, @, import, (, "../ir/interned_string_set.zig", ), ;, const, Module, =, @, import, (, "../hierarchy/module.zig", ), ., Module, ;, const, Header_Emitter, =, @, import, (, "header_emitter.zig", ), ;, const, Source_Emitter, =, @, import, (, "source_emitter.zig", ), ;, const, Emitter, =, @, import, (, "emitter.zig", ), ;, const, Test_Emitter, =, @, import, (, "test_emitter.zig", ), ;, const, Typedef_Emitter, =, @, import, (, "typedef_emitter.zig", ), ;, const, Type_Map, =, @, import, (, "../types/type_map.zig", ), ., Type_Map, ;, const, Type_Set, =, @, import, (, "../types/type_set.zig", ), ;, const, Canonical_Type_Fmt, =, @, import, (, "../types/canonical_type_fmt.zig", ), ;, pub, fn, output_modules, (, compiler, :, *, Compiler_Context, ), !, void, {, for, (, compiler, ., packages, ., keys, (, ), ), |, package_name, |, {, const, package, =, compiler, ., lookup_package, (, package_name, ), .?, ;, const, package_root_module, =, package, ., root, ., init_value, (, ), .?, ., module, ., module, ;, if, (, !, package, ., modified, .?, ), {, continue, ;, }, const, build_path, =, package, ., get_build_path, (, compiler, ., allocator, (, ), ), ;, _, =, std, ., fs, ., openDirAbsolute, (, build_path, ,, ., {, }, ), catch, {, std, ., fs, ., makeDirAbsolute, (, build_path, ), catch, return, error, ., MakeDirError, ;, }, ;, const, types_path, =, package, ., get_types_path, (, compiler, ., allocator, (, ), ), ;, _, =, std, ., fs, ., openDirAbsolute, (, types_path, ,, ., {, }, ), catch, {, std, ., fs, ., makeDirAbsolute, (, types_path, ), catch, return, error, ., MakeDirError, ;, }, ;, try, output_types, (, &, package, ., type_set, ,, types_path, ,, compiler, ., allocator, (, ), ), ;, var, modules, =, std, ., array_list, ., Managed, (, *, Module, ), ., init, (, compiler, ., allocator, (, ), ), ;, defer, modules, ., deinit, (, ), ;, var, dfs_iter, :, Module_Iterator, =, Module_Iterator, ., init, (, package_root_module, ,, compiler, ., allocator, (, ), ), ;, defer, dfs_iter, ., deinit, (, ), ;, while, (, dfs_iter, ., next, (, ), ), |, module, |, {, if, (, std, ., mem, ., eql, (, u8, ,, module, ., get_package_abs_path, (, ), ,, package, ., absolute_path, ), ), {, try, output_module, (, module, ,, &, compiler, ., module_interned_strings, ,, build_path, ,, compiler, ., allocator, (, ), ), ;, try, modules, ., append, (, module, ), ;, if, (, package, ., kind, ==, ., test_executable, ), {, try, output_tests, (, module, ,, &, compiler, ., module_interned_strings, ,, build_path, ,, compiler, ., allocator, (, ), ), ;, }, }, }, switch, (, package, ., kind, ), {, ., test_executable, =>, try, output_testrunner, (, modules, ,, build_path, ,, compiler, ., allocator, (, ), ), ,, ., executable, =>, try, output_start, (, package_root_module, ,, &, compiler, ., module_interned_strings, ,, build_path, ,, compiler, ., allocator, (, ), ), ,, else, =>, {, }, ,, }, }, }, fn, output_module, (, module, :, *, Module, ,, module_interned_strings, :, *, const, std, ., AutoArrayHashMap, (, u32, ,, *, Interned_String_Set, ), ,, build_path, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ,, ), !, void, {, var, output_h_file, =, try, open_file, (, module, ., package_name, ,, module, ., name, (, ), ,, ".h", ,, build_path, ,, allocator, ), ;, defer, output_h_file, ., close, (, ), ;, var, h_buffer, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, h_buffer, ., deinit, (, ), ;, var, header_emitter, =, Header_Emitter, ., init, (, module, ,, &, h_buffer, ), ;, header_emitter, ., generate, (, ), catch, return, error, ., CompileError, ;, var, output_c_file, =, try, open_file, (, module, ., package_name, ,, module, ., name, (, ), ,, ".c", ,, build_path, ,, allocator, ), ;, defer, output_c_file, ., close, (, ), ;, var, c_buffer, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, c_buffer, ., deinit, (, ), ;, var, source_emitter, =, Source_Emitter, ., init, (, module, ,, module_interned_strings, ,, &, c_buffer, ), ;, source_emitter, ., generate, (, ), catch, return, error, ., CompileError, ;, output_c_file, ., writeAll, (, c_buffer, ., items, ), catch, return, error, ., WriteFailed, ;, output_h_file, ., writeAll, (, h_buffer, ., items, ), catch, return, error, ., WriteFailed, ;, }, fn, output_types, (, type_set, :, *, const, Type_Set, ,, types_path, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ,, ), !, void, {, for, (, type_set, ., types, ., items, ), |, dag, |, {, try, output_type, (, dag, ,, types_path, ,, allocator, ), ;, }, }, fn, output_type, (, dep, :, *, Dependency_Node, ,, types_path, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ,, ), !, void, {, if, (, dep, ., visited, ), {, return, ;, }, dep, ., mark_visited, (, ), ;, for, (, dep, ., dependencies, ., items, ), |, depen, |, {, try, output_type, (, depen, ,, types_path, ,, allocator, ), ;, }, if, (, dep, ., base, ., sizeof, (, ), ==, 0, ), {, return, ;, }, var, output_filename, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, output_filename, ., deinit, (, ), ;, try, output_filename, ., print, (, "{f}.h", ,, ., {, Canonical_Type_Fmt, {, ., type, =, dep, ., base, }, }, ), ;, const, out_paths, =, [, _, ], [, ], const, u8, {, types_path, ,, output_filename, ., items, }, ;, const, out_path, =, try, std, ., fs, ., path, ., join, (, allocator, ,, &, out_paths, ), ;, const, output_type_h_file, =, std, ., fs, ., createFileAbsolute, (, out_path, ,, ., {, }, ), catch, unreachable, ;, var, type_h_buffer, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, type_h_buffer, ., deinit, (, ), ;, var, test_emitter, =, Typedef_Emitter, ., init, (, dep, ,, &, type_h_buffer, ), ;, test_emitter, ., generate, (, ), catch, return, error, ., CompileError, ;, output_type_h_file, ., writeAll, (, type_h_buffer, ., items, ), catch, return, error, ., WriteFailed, ;, }, fn, output_tests, (, module, :, *, Module, ,, module_interned_strings, :, *, const, std, ., AutoArrayHashMap, (, u32, ,, *, Interned_String_Set, ), ,, build_path, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ,, ), !, void, {, var, output_h_file, =, try, open_file, (, module, ., package_name, ,, module, ., name, (, ), ,, "-tests.h", ,, build_path, ,, allocator, ), ;, defer, output_h_file, ., close, (, ), ;, var, h_buffer, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, h_buffer, ., deinit, (, ), ;, var, output_c_file, =, try, open_file, (, module, ., package_name, ,, module, ., name, (, ), ,, "-tests.c", ,, build_path, ,, allocator, ), ;, defer, output_c_file, ., close, (, ), ;, var, c_buffer, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, c_buffer, ., deinit, (, ), ;, var, test_emitter, =, Test_Emitter, ., init, (, module, ,, module_interned_strings, ,, &, c_buffer, ,, &, h_buffer, ), ;, test_emitter, ., generate, (, ), catch, return, error, ., CompileError, ;, output_c_file, ., writeAll, (, c_buffer, ., items, ), catch, return, error, ., WriteFailed, ;, output_h_file, ., writeAll, (, h_buffer, ., items, ), catch, return, error, ., WriteFailed, ;, }, fn, output_start, (, module, :, *, Module, ,, module_interned_strings, :, *, const, std, ., AutoArrayHashMap, (, u32, ,, *, Interned_String_Set, ), ,, build_path, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ,, ), !, void, {, const, paths, =, [, _, ], [, ], const, u8, {, build_path, ,, "start.c", }, ;, const, path, =, try, std, ., fs, ., path, ., join, (, allocator, ,, &, paths, ), ;, var, start_file, =, std, ., fs, ., createFileAbsolute, (, path, ,, ., {, }, ), catch, unreachable, ;, defer, start_file, ., close, (, ), ;, var, buf, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, buf, ., deinit, (, ), ;, var, source_emitter, =, Source_Emitter, ., init, (, module, ,, module_interned_strings, ,, &, buf, ,, ), ;, source_emitter, ., output_header_include, (, ), catch, return, error, ., CompileError, ;, buf, ., print, (, "#include <stdio.h>\n\n", ,, ., {, }, ), catch, return, error, ., CompileError, ;, var, contexts_used, =, Type_Map, (, void, ), ., init, (, allocator, ), ;, defer, contexts_used, ., deinit, (, ), ;, for, (, module, ., cfgs, ., items, ), |, @, "test", |, {, contexts_used, ., put_many, (, @, "test", ., symbol, ., type, (, ), ., function, ., contexts, ., items, ,, void, {, }, ), catch, return, error, ., CompileError, ;, }, source_emitter, ., emitter, ., output_context_includes, (, &, contexts_used, ), catch, return, error, ., CompileError, ;, source_emitter, ., output_main_function, (, ), catch, return, error, ., CompileError, ;, start_file, ., writeAll, (, buf, ., items, ), catch, return, error, ., WriteFailed, ;, }, fn, output_testrunner, (, modules, :, std, ., array_list, ., Managed, (, *, Module, ), ,, build_path, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ,, ), !, void, {, const, paths, =, [, _, ], [, ], const, u8, {, build_path, ,, "test-runner.c", }, ;, const, path, =, try, std, ., fs, ., path, ., join, (, allocator, ,, &, paths, ), ;, var, testrunner_file, =, std, ., fs, ., createFileAbsolute, (, path, ,, ., {, }, ), catch, unreachable, ;, defer, testrunner_file, ., close, (, ), ;, var, buf, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, buf, ., deinit, (, ), ;, buf, ., print, (, \, \, /, *, Code, generated, using, the, Orange, compiler, http, :, \, \, \, \, #, include, <, stdio, ., h, >, \, \, #, include, <, stdlib, ., h, >, \, \, #, include, <, string, ., h, >, \, \, \, \, ,, ., {, }, ), catch, return, error, ., CompileError, ;, for, (, modules, ., items, ), |, module, |, {, try, buf, ., print, (, "#include \"{s}-{s}-tests.h\"\n", ,, ., {, module, ., package_name, ,, module, ., name, (, ), }, ), ;, }, var, mod_0_emitter, =, Emitter, ., init, (, &, buf, ), ;, var, contexts_used, =, Type_Map, (, void, ), ., init, (, allocator, ), ;, defer, contexts_used, ., deinit, (, ), ;, for, (, modules, ., items, ), |, module, |, {, for, (, module, ., tests, ., items, ), |, @, "test", |, {, contexts_used, ., put_many, (, @, "test", ., symbol, ., type, (, ), ., function, ., contexts, ., items, ,, void, {, }, ), catch, return, error, ., CompileError, ;, }, }, mod_0_emitter, ., output_context_includes, (, &, contexts_used, ), catch, return, error, ., CompileError, ;, buf, ., print, (, \, \, \, \, typedef, ,, ., {, }, ), catch, return, error, ., CompileError, ;, mod_0_emitter, ., output_type, (, core_, ., test_result_type, ), catch, return, error, ., CompileError, ;, buf, ., print, (, \, \, test_result, ;, \, \, ,, ., {, }, ), catch, return, error, ., CompileError, ;, buf, ., print, (, \, \, \, \, int, main, (, int, argc, ,, char, *, argv, [, ], ), \, \, {, {, \, \, const, char, *, substr, =, NULL, ;, \, \, const, char, *, prev_filename, =, NULL, ;, \, \, test_result, res, ;, \, \, int, failed_tests, =, 0, ;, \, \, ,, ., {, }, ), catch, return, error, ., CompileError, ;, mod_0_emitter, ., output_context_defs, (, &, contexts_used, ), catch, return, error, ., CompileError, ;, buf, ., print, (, \, \, if, (, argc, >=, 2, ), \, \, {, {, \, \, substr, =, argv, [, 1, ], ;, \, \, }, }, \, \, \, \, printf, (, "[============]\n", ), ;, \, \, ,, ., {, }, ), catch, return, error, ., CompileError, ;, for, (, modules, ., items, ), |, module, |, {, var, emitter, =, Emitter, ., init, (, &, buf, ), ;, for, (, module, ., tests, ., items, ), |, @, "test", |, {, const, test_filename, =, @, "test", ., symbol, ., scope, ., module, .?, ., name, (, ), ;, const, test_name, =, @, "test", ., symbol, ., decl, .?, ., @, "test", ., name, .?, ., string, ., data, ;, buf, ., print, (, \, \, if, (, substr, ==, NULL, ||, strstr, (, "{1s}", ,, substr, ), ), \, \, {, {, \, \, if, (, prev_filename, ==, NULL, ), \, \, {, {, \, \, prev_filename, =, "{0s}", ;, \, \, }, }, \, \, else, if, (, strcmp, (, prev_filename, ,, "{0s}", ), ), \, \, {, {, \, \, prev_filename, =, "{0s}", ;, \, \, printf, (, "[------------]\n", ), ;, \, \, }, }, \, \, printf, (, "[ RUN        ] %s.orng: %s\n", ,, "{0s}", ,, "{1s}", ), ;, \, \, res, =, ,, ., {, test_filename, ,, test_name, }, ), catch, return, error, ., CompileError, ;, emitter, ., output_symbol, (, @, "test", ., symbol, ), catch, return, error, ., CompileError, ;, buf, ., print, (, "(", ,, ., {, }, ), catch, return, error, ., CompileError, ;, emitter, ., output_context_args, (, @, "test", ., symbol, ., type, (, ), ., function, ., contexts, ., items, ), catch, return, error, ., CompileError, ;, buf, ., print, (, ");\n", ,, ., {, }, ), catch, return, error, ., CompileError, ;, buf, ., print, (, \, \, if, (, res, ., tag, ==, 0, ), \, \, {, {, \, \, printf, (, "[         OK ]\n", ), ;, \, \, }, }, \, \, else, \, \, {, {, \, \, printf, (, "[     FAILED ]\n", ), ;, \, \, failed_tests, +=, 1, ;, \, \, }, }, \, \, }, }, \, \, ,, ., {, }, ), catch, return, error, ., CompileError, ;, }, }, buf, ., print, (, \, \, printf, (, "[============]\n", ), ;, \, \, return, failed_tests, ;, \, \, }, }, \, \, ,, ., {, }, ), catch, return, error, ., CompileError, ;, testrunner_file, ., writeAll, (, buf, ., items, ), catch, return, error, ., WriteFailed, ;, }, fn, open_file, (, package_name, :, [, ], const, u8, ,, module_name, :, [, ], const, u8, ,, ext, :, [, ], const, u8, ,, build_path, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), !, std, ., fs, ., File, {, var, output_filename, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, output_filename, ., deinit, (, ), ;, try, output_filename, ., print, (, "{s}-{s}{s}", ,, ., {, package_name, ,, module_name, ,, ext, }, ), ;, const, out_paths, =, [, _, ], [, ], const, u8, {, build_path, ,, output_filename, ., items, }, ;, const, out_path, =, try, std, ., fs, ., path, ., join, (, allocator, ,, &, out_paths, ), ;, const, output_file, =, std, ., fs, ., createFileAbsolute, (, out_path, ,, ., {, }, ), catch, unreachable, ;, return, output_file, ;, }, const, std, =, @, import, (, "std", ), ;, const, AST, =, @, import, (, "../ast/ast.zig", ), ., AST, ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, core_, =, @, import, (, "../hierarchy/core.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Type_Map, =, @, import, (, "../types/type_map.zig", ), ., Type_Map, ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Canonical_Type_Fmt, =, @, import, (, "../types/canonical_type_fmt.zig", ), ;, pub, const, CodeGen_Error, =, error, {, OutOfMemory, ,, WriteFailed, }, ;, const, Self, :, type, =, @, This, (, ), ;, writer, :, *, std, ., array_list, ., Managed, (, u8, ), ,, pub, fn, init, (, writer, :, *, std, ., array_list, ., Managed, (, u8, ), ), Self, {, return, Self, {, ., writer, =, writer, ,, }, ;, }, pub, fn, output_type, (, self, :, *, Self, ,, old_type, :, *, Type_AST, ), CodeGen_Error, !, void, {, if, (, old_type, ., unexpand_type, (, ), !=, old_type, ), {, return, try, self, ., output_type, (, old_type, ., unexpand_type, (, ), ), ;, }, if, (, old_type, .*, ==, ., identifier, and, old_type, ., symbol, (, ), !=, null, and, old_type, ., symbol, (, ), .?, ., storage, ==, ., @, "extern", ), {, try, self, ., writer, ., print, (, "{s}", ,, ., {, old_type, ., symbol, (, ), .?, ., storage, ., @, "extern", ., c_name, .?, ., string, ., data, }, ), ;, return, ;, }, var, _type, =, old_type, ., expand_identifier, (, ), ;, switch, (, _type, .*, ), {, ., identifier, =>, if, (, _type, ., common, (, ), ., _expanded_type, !=, null, and, _type, ., common, (, ), ., _expanded_type, .?, !=, _type, ), {, try, self, ., output_type, (, _type, ., common, (, ), ., _expanded_type, .?, ), ;, }, else, {, const, info, =, prelude_, ., info_from_name, (, _type, ., token, (, ), ., data, ), ;, if, (, info, !=, null, ), {, try, self, ., writer, ., print, (, "{s}", ,, ., {, info, .?, ., c_name, }, ), ;, }, else, {, try, self, ., writer, ., print, (, "{s} /*{?f}*/", ,, ., {, _type, ., token, (, ), ., data, ,, _type, ., symbol, (, ), .?, ., init_typedef, (, ), }, ,, ), ;, }, }, ,, ., addr_of, =>, {, try, self, ., output_type, (, _type, ., child, (, ), ), ;, try, self, ., writer, ., print, (, " *", ,, ., {, }, ), ;, }, ,, ., anyptr_type, =>, try, self, ., writer, ., print, (, "void *", ,, ., {, }, ), ,, ., unit_type, =>, try, self, ., writer, ., print, (, "void", ,, ., {, }, ), ,, ., annotation, =>, try, self, ., output_type, (, _type, ., child, (, ), ), ,, ., function, =>, try, self, ., writer, ., print, (, "{f}", ,, ., {, Canonical_Type_Fmt, {, ., type, =, _type, }, }, ), ,, ., enum_type, ,, ., tuple_type, ,, ., struct_type, ,, ., array_of, ,, ., dyn_type, ,, ., context_type, ,, =>, try, self, ., writer, ., print, (, "struct {f}", ,, ., {, Canonical_Type_Fmt, {, ., type, =, _type, }, }, ), ,, ., untagged_sum_type, =>, try, self, ., writer, ., print, (, "union {f}", ,, ., {, Canonical_Type_Fmt, {, ., type, =, _type, }, }, ), ,, else, =>, std, ., debug, ., panic, (, "compiler error: unimplemented output_type() for {f}", ,, ., {, _type, .*, }, ), ,, }, }, pub, fn, forall_functions, (, self, :, *, Self, ,, sub, :, anytype, ,, cfgs, :, [, ], const, *, CFG, ,, header_comment, :, [, ], const, u8, ,, comptime, f, :, fn, (, @, TypeOf, (, sub, ), ,, *, CFG, ), CodeGen_Error, !, void, ,, ), CodeGen_Error, !, void, {, if, (, cfgs, ., len, >, 0, ), {, try, self, ., writer, ., print, (, "\n/* {s} */\n", ,, ., {, header_comment, }, ), ;, }, for, (, cfgs, ), |, cfg, |, {, if, (, !, cfg, ., needed_at_runtime, ), {, continue, ;, }, if, (, cfg, ., symbol, ., decl, .?, .*, ==, ., fn_decl, or, cfg, ., symbol, ., decl, .?, .*, ==, ., method_decl, ), {, try, f, (, sub, ,, cfg, ), ;, }, }, }, pub, fn, output_function_prototype, (, self, :, *, Self, ,, cfg, :, *, CFG, ,, ), CodeGen_Error, !, void, {, try, self, ., output_type, (, cfg, ., symbol, ., expanded_type, (, ), ., rhs, (, ), ), ;, try, self, ., writer, ., print, (, " ", ,, ., {, }, ), ;, try, self, ., output_symbol, (, cfg, ., symbol, ), ;, const, decl, =, cfg, ., symbol, ., decl, .?, ;, const, param_symbols, =, decl, ., param_symbols, (, ), ;, const, context_param_symbols, =, decl, ., context_param_symbols, (, ), ;, const, has_params, =, param_symbols, !=, null, and, param_symbols, .?, ., items, ., len, >, 0, ;, const, has_contexts, =, context_param_symbols, !=, null, and, context_param_symbols, .?, ., items, ., len, >, 0, ;, var, num_non_unit_params, :, i64, =, 0, ;, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, if, (, param_symbols, !=, null, ), {, for, (, param_symbols, .?, ., items, ,, 0.., ), |, term, ,, i, |, {, if, (, !, term, ., expanded_type, (, ), ., is_c_void_type, (, ), ), {, if, (, decl, .*, ==, ., method_decl, and, decl, ., method_decl, ., receiver, !=, null, and, i, ==, 0, ), {, try, self, ., writer, ., print, (, "void *", ,, ., {, }, ), ;, try, self, ., output_symbol, (, term, ), ;, }, else, {, try, self, ., output_var_decl, (, term, ,, true, ), ;, }, if, (, i, +, 1, <, param_symbols, .?, ., items, ., len, and, !, param_symbols, .?, ., items, [, i, +, 1, ], ., expanded_type, (, ), ., is_c_void_type, (, ), ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, num_non_unit_params, +=, 1, ;, }, }, }, if, (, context_param_symbols, !=, null, ), {, if, (, has_contexts, and, has_params, ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, for, (, context_param_symbols, .?, ., items, ,, 0.., ), |, term, ,, i, |, {, try, self, ., output_var_decl, (, term, ,, true, ), ;, if, (, i, +, 1, <, context_param_symbols, .?, ., items, ., len, and, !, context_param_symbols, .?, ., items, [, i, +, 1, ], ., expanded_type, (, ), ., is_c_void_type, (, ), ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, num_non_unit_params, +=, 1, ;, }, }, if, (, num_non_unit_params, ==, 0, ), {, try, self, ., writer, ., print, (, "void", ,, ., {, }, ), ;, }, try, self, ., writer, ., print, (, ")", ,, ., {, }, ), ;, }, pub, fn, output_var_decl, (, self, :, *, Self, ,, symbol, :, *, Symbol, ,, is_parameter, :, bool, ,, ), CodeGen_Error, !, void, {, if, (, !, is_parameter, ), {, try, self, ., writer, ., print, (, "    ", ,, ., {, }, ), ;, }, try, self, ., output_type, (, symbol, ., type, (, ), ), ;, var, str, =, try, Canonical_Type_Fmt, ., canonical_rep, (, symbol, ., type, (, ), ), ;, defer, str, ., deinit, (, ), ;, try, self, ., writer, ., print, (, " /*{s}*/ ", ,, ., {, str, ., str, (, ), }, ), ;, try, self, ., output_symbol, (, symbol, ), ;, if, (, !, is_parameter, ), {, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, }, pub, fn, output_symbol, (, self, :, *, Self, ,, symbol, :, *, Symbol, ), CodeGen_Error, !, void, {, if, (, symbol, ., storage, ==, ., @, "extern", ), {, try, self, ., writer, ., print, (, "{s}", ,, ., {, symbol, ., storage, ., @, "extern", ., c_name, .?, ., string, ., data, }, ), ;, }, else, if, (, symbol, ., decl, !=, null, and, symbol, ., decl, .?, .*, !=, ., receiver, and, symbol, ., decl, .?, ., top_level, (, ), ), {, if, (, symbol, ., decl, .?, .*, ==, ., method_decl, or, !, symbol, ., decl, .?, ., top_level, (, ), ), {, try, self, ., writer, ., print, (, "{s}__{s}__{}_{s}", ,, ., {, symbol, ., scope, ., module, .?, ., package_name, ,, symbol, ., scope, ., module, .?, ., name, (, ), ,, symbol, ., scope, ., uid, ,, symbol, ., name, }, ), ;, }, else, {, try, self, ., writer, ., print, (, "{s}__{s}__{s}", ,, ., {, symbol, ., scope, ., module, .?, ., package_name, ,, symbol, ., scope, ., module, .?, ., name, (, ), ,, symbol, ., name, }, ), ;, }, }, else, {, try, self, ., writer, ., print, (, "_{}_{s}", ,, ., {, symbol, ., scope, ., uid, ,, symbol, ., name, }, ), ;, }, }, pub, fn, output_context_includes, (, self, :, *, Self, ,, contexts_used, :, *, Type_Map, (, void, ), ), CodeGen_Error, !, void, {, for, (, contexts_used, ., pairs, ., items, ), |, pair, |, {, var, ctx, =, pair, ., key, ., child, (, ), ;, if, (, ctx, ., types_match, (, core_, ., allocating_context, ), ), {, try, self, ., writer, ., print, (, "#include \"alloc.inc\"\n", ,, ., {, }, ), ;, }, else, if, (, ctx, ., types_match, (, core_, ., io_context, ), ), {, try, self, ., writer, ., print, (, "#include \"io.inc\"\n", ,, ., {, }, ), ;, }, else, if, (, ctx, ., types_match, (, core_, ., args_context, ), ), {, try, self, ., writer, ., print, (, "#include \"args.inc\"\n", ,, ., {, }, ), ;, }, else, if, (, ctx, ., types_match, (, core_, ., file_io_context, ), ), {, try, self, ., writer, ., print, (, "#include \"file_io.inc\"\n", ,, ., {, }, ), ;, }, }, }, pub, fn, output_context_defs, (, self, :, *, Self, ,, contexts_used, :, *, Type_Map, (, void, ), ), CodeGen_Error, !, void, {, for, (, contexts_used, ., pairs, ., items, ), |, pair, |, {, const, ctx, =, pair, ., key, ., child, (, ), ;, if, (, ctx, ., types_match, (, core_, ., allocating_context, ), ), {, try, self, ., output_type, (, core_, ., allocating_context, ), ;, try, self, ., writer, ., print, (, \, \, allocator_context, =, {, {, ., _0, =, {, {, ., data_ptr, =, NULL, ,, ., vtable, =, &, orange__core__allocator_vtable, }, }, }, }, ;, \, \, ,, ., {, }, ), ;, }, else, if, (, ctx, ., types_match, (, core_, ., io_context, ), ), {, try, self, ., output_type, (, core_, ., io_context, ), ;, try, self, ., writer, ., print, (, \, \, io_context, =, {, {, ., _0, =, {, {, ., data_ptr, =, NULL, ,, ., vtable, =, &, orange__core__writer_vtable, }, }, ,, ., _1, =, {, {, ., data_ptr, =, NULL, ,, ., vtable, =, &, orange__core__reader_vtable, }, }, }, }, ;, \, \, ,, ., {, }, ), ;, }, else, if, (, ctx, ., types_match, (, core_, ., args_context, ), ), {, try, self, ., output_type, (, core_, ., args_context, ), ;, try, self, ., writer, ., print, (, \, \, args_context, =, orange__core__convert_args, (, argc, ,, argv, ), ;, \, \, ,, ., {, }, ), ;, }, else, if, (, ctx, ., types_match, (, core_, ., file_io_context, ), ), {, try, self, ., output_type, (, core_, ., file_io_context, ), ;, try, self, ., writer, ., print, (, \, \, file_io_context, =, {, {, ., _0, =, {, {, ., data_ptr, =, NULL, ,, ., vtable, =, &, orange__core__file_system_vtable, }, }, }, }, ;, \, \, ,, ., {, }, ), ;, }, }, }, pub, fn, output_context_args, (, self, :, *, Self, ,, contexts, :, [, ], const, *, Type_AST, ), CodeGen_Error, !, void, {, for, (, contexts, ,, 0.., ), |, ctx, ,, i, |, {, std, ., debug, ., assert, (, ctx, .*, ==, ., addr_of, ), ;, if, (, ctx, ., child, (, ), ., types_match, (, core_, ., allocating_context, ), ), {, try, self, ., writer, ., print, (, "&allocator_context", ,, ., {, }, ), ;, }, else, if, (, ctx, ., child, (, ), ., types_match, (, core_, ., io_context, ), ), {, try, self, ., writer, ., print, (, "&io_context", ,, ., {, }, ), ;, }, else, if, (, ctx, ., child, (, ), ., types_match, (, core_, ., args_context, ), ), {, try, self, ., writer, ., print, (, "&args_context", ,, ., {, }, ), ;, }, else, if, (, ctx, ., child, (, ), ., types_match, (, core_, ., file_io_context, ), ), {, try, self, ., writer, ., print, (, "&file_io_context", ,, ., {, }, ), ;, }, if, (, i, +, 1, <, contexts, ., len, ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, }, }, const, std, =, @, import, (, "std", ), ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, Emitter, =, @, import, (, "emitter.zig", ), ;, const, module_, =, @, import, (, "../hierarchy/module.zig", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, Type_Set, =, @, import, (, "../types/type_set.zig", ), ;, const, Dependency_Node, =, @, import, (, "../types/dependency_node.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Canonical_Type_Fmt, =, @, import, (, "../types/canonical_type_fmt.zig", ), ;, const, Self, =, @, This, (, ), ;, module, :, *, module_, ., Module, ,, emitter, :, Emitter, ,, writer, :, *, std, ., array_list, ., Managed, (, u8, ), ,, pub, const, CodeGen_Error, =, error, {, WriteFailed, ,, OutOfMemory, }, ;, pub, fn, init, (, module, :, *, module_, ., Module, ,, writer, :, *, std, ., array_list, ., Managed, (, u8, ), ), Self, {, const, emitter, =, Emitter, ., init, (, writer, ), ;, return, Self, {, ., module, =, module, ,, ., emitter, =, emitter, ,, ., writer, =, writer, }, ;, }, pub, fn, generate, (, self, :, *, Self, ), CodeGen_Error, !, void, {, try, self, ., output_include_guard_begin, (, ), ;, try, self, ., output_common_includes, (, ), ;, try, self, ., output_includes, (, ), ;, try, self, ., output_typedefs, (, ), ;, try, self, ., output_traits, (, ), ;, try, self, ., output_impls, (, ), ;, try, self, ., emitter, ., forall_functions, (, self, ,, self, ., module, ., cfgs, ., items, ,, "Function declarations", ,, output_forward_function, ), ;, try, self, ., output_include_guard_end, (, ), ;, }, pub, fn, output_include_guard_begin, (, self, :, *, Self, ), CodeGen_Error, !, void, {, var, guard_macro, =, String, ., init, (, std, ., heap, ., page_allocator, ), ;, defer, guard_macro, ., deinit, (, ), ;, var, guard_macro_writer, =, guard_macro, ., writer, (, &, ., {, }, ), ;, const, guard_macro_writer_intfc, =, &, guard_macro_writer, ., interface, ;, try, guard_macro_writer_intfc, ., print, (, "{s}__{s}_H", ,, ., {, self, ., module, ., package_name, ,, self, ., module, ., name, (, ), }, ), ;, guard_macro, ., toUppercase, (, ), ;, try, self, ., writer, ., print, (, \, \, /, *, Code, generated, using, the, Orange, compiler, http, :, \, \, \, \, #, ifndef, {, 0s, }, \, \, #, define, {, 0s, }, ,, ., {, guard_macro, ., str, (, ), }, ), ;, }, pub, fn, output_common_includes, (, self, :, *, Self, ), CodeGen_Error, !, void, {, try, self, ., writer, ., print, (, \, \, \, \, \, \, #, include, <, stdio, ., h, >, \, \, #, include, <, stdint, ., h, >, \, \, #, include, <, stdlib, ., h, >, \, \, \, \, #, include, "debug.inc", \, \, ,, ., {, }, ), ;, }, pub, fn, output_include_guard_end, (, self, :, *, Self, ), CodeGen_Error, !, void, {, try, self, ., writer, ., print, (, \, \, \, \, #, endif, \, \, ,, ., {, }, ), ;, }, pub, fn, output_includes, (, self, :, *, Self, ), CodeGen_Error, !, void, {, if, (, self, ., module, ., cincludes, ., items, ., len, !=, 0, ), {, try, self, ., writer, ., print, (, "\n/* Special module includes */\n", ,, ., {, }, ), ;, for, (, self, ., module, ., cincludes, ., items, ), |, cinclude, |, {, try, self, ., writer, ., print, (, "#include \"{s}\"\n", ,, ., {, cinclude, ., string, ., data, }, ), ;, }, }, if, (, self, ., module, ., local_imported_modules, ., keys, (, ), ., len, !=, 0, ), {, try, self, ., writer, ., print, (, "\n/* Module imports */\n", ,, ., {, }, ), ;, for, (, self, ., module, ., local_imported_modules, ., keys, (, ), ), |, module, |, {, try, self, ., writer, ., print, (, "#include \"{s}-{s}.h\"\n", ,, ., {, module, ., package_name, ,, module, ., name, (, ), }, ), ;, }, }, }, fn, output_typedefs, (, self, :, *, Self, ), CodeGen_Error, !, void, {, if, (, self, ., module, ., type_set, ., types, ., items, ., len, >, 0, ), {, try, self, ., writer, ., print, (, "\n/* Type definitions */\n", ,, ., {, }, ), ;, }, for, (, self, ., module, ., type_set, ., types, ., items, ), |, dag, |, {, try, self, ., output_typedef_include, (, dag, ), ;, }, }, fn, output_typedef_include, (, self, :, *, Self, ,, dep, :, *, Dependency_Node, ), CodeGen_Error, !, void, {, if, (, dep, ., visited, ), {, return, ;, }, dep, ., mark_visited, (, ), ;, for, (, dep, ., dependencies, ., items, ), |, depen, |, {, try, self, ., output_typedef_include, (, depen, ), ;, }, if, (, dep, ., base, ., sizeof, (, ), ==, 0, ), {, return, ;, }, var, str, =, try, Canonical_Type_Fmt, ., canonical_rep, (, dep, ., base, ), ;, defer, str, ., deinit, (, ), ;, try, self, ., writer, ., print, (, "#include \"types/{f}.h\"\n", ,, ., {, Canonical_Type_Fmt, {, ., type, =, dep, ., base, }, }, ), ;, }, fn, output_field_list, (, self, :, *, Self, ,, fields, :, *, const, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, spaces, :, usize, ), CodeGen_Error, !, void, {, for, (, fields, ., items, ,, 0.., ), |, term, ,, i, |, {, if, (, !, term, ., is_c_void_type, (, ), ), {, for, (, 0..spaces, ), |, _, |, {, try, self, ., writer, ., print, (, " ", ,, ., {, }, ), ;, }, try, self, ., emitter, ., output_type, (, term, ), ;, try, self, ., writer, ., print, (, " _{};\n", ,, ., {, i, }, ), ;, }, }, }, fn, output_traits, (, self, :, *, Self, ), CodeGen_Error, !, void, {, if, (, self, ., module, ., traits, ., keys, (, ), ., len, >, 0, ), {, try, self, ., writer, ., print, (, "\n/* Trait vtable type definitions */\n", ,, ., {, }, ), ;, }, for, (, self, ., module, ., traits, ., keys, (, ), ), |, trait, |, {, if, (, trait, ., trait, ., num_virtual_methods, ==, 0, and, trait, ., trait, ., super_traits, ., items, ., len, ==, 0, ), {, continue, ;, }, try, self, ., writer, ., print, (, "struct vtable_{s}__{s}__{}_{s} {{\n", ,, ., {, self, ., module, ., package_name, ,, self, ., module, ., name, (, ), ,, trait, ., symbol, (, ), .?, ., scope, ., uid, ,, trait, ., symbol, (, ), .?, ., name, ,, }, ), ;, for, (, trait, ., trait, ., method_decls, ., items, ), |, decl, |, {, if, (, !, decl, ., method_decl, ., is_virtual, ), {, continue, ;, }, const, method_decl_has_receiver, =, decl, ., method_decl, ., receiver, !=, null, ;, const, num_method_params, =, decl, ., children, (, ), ., items, ., len, ;, const, has_params, =, num_method_params, +, @, intFromBool, (, method_decl_has_receiver, ), ==, 0, ;, const, has_contexts, =, decl, ., method_decl, ., context_decls, ., items, ., len, >, 0, ;, try, self, ., writer, ., print, (, "    ", ,, ., {, }, ), ;, try, self, ., emitter, ., output_type, (, decl, ., method_decl, ., ret_type, ), ;, try, self, ., writer, ., print, (, "(*_{s})(", ,, ., {, decl, ., method_decl, ., name, ., token, (, ), ., data, }, ), ;, if, (, method_decl_has_receiver, ), {, try, self, ., writer, ., print, (, "void *", ,, ., {, }, ), ;, if, (, (, decl, ., children, (, ), ., items, ., len, >, 0, and, !, decl, ., children, (, ), ., items, [, 0, ], ., binding, ., type, ., is_c_void_type, (, ), ), or, has_contexts, ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, }, for, (, decl, ., children, (, ), ., items, ,, 0.., ), |, param_decl, ,, i, |, {, if, (, !, param_decl, ., binding, ., type, ., is_c_void_type, (, ), ), {, try, self, ., emitter, ., output_type, (, param_decl, ., binding, ., type, ), ;, if, (, (, i, +, 1, <, num_method_params, and, !, decl, ., children, (, ), ., items, [, i, +, 1, ], ., binding, ., type, ., is_c_void_type, (, ), ), or, has_contexts, ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, }, }, for, (, decl, ., method_decl, ., context_decls, ., items, ), |, param_decl, |, {, if, (, has_params, ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, try, self, ., emitter, ., output_type, (, param_decl, ., context_value_decl, ., parent, ), ;, }, if, (, has_params, ), {, try, self, ., writer, ., print, (, "void", ,, ., {, }, ), ;, }, try, self, ., writer, ., print, (, ");\n", ,, ., {, }, ), ;, }, for, (, trait, ., trait, ., super_traits, ., items, ,, 0.., ), |, super_trait, ,, i, |, {, const, super_trait_symbol, =, super_trait, ., symbol, (, ), .?, ;, const, super_trait_decl, =, super_trait_symbol, ., decl, .?, ;, if, (, super_trait_decl, ., trait, ., num_virtual_methods, ==, 0, and, super_trait_decl, ., trait, ., super_traits, ., items, ., len, ==, 0, ), continue, ;, try, self, ., writer, ., print, (, "    const struct vtable_{s}__{s}__{}_{s} *_{};\n", ,, ., {, super_trait_symbol, ., scope, ., module, .?, ., package_name, ,, super_trait_symbol, ., scope, ., module, .?, ., name, (, ), ,, super_trait_symbol, ., scope, ., uid, ,, super_trait_symbol, ., name, ,, i, ,, }, ), ;, }, try, self, ., writer, ., print, (, "}};\n\n", ,, ., {, }, ), ;, }, }, fn, output_impls, (, self, :, *, Self, ), CodeGen_Error, !, void, {, var, vtable_count, :, usize, =, 0, ;, for, (, self, ., module, ., impls, ., items, ), |, impl, |, {, if, (, impl, ., impl, ., num_virtual_methods, !=, 0, ), {, vtable_count, +=, 1, ;, }, }, if, (, vtable_count, >, 0, ), {, try, self, ., writer, ., print, (, "\n/* Trait vtable implementation declarations */\n", ,, ., {, }, ), ;, }, for, (, self, ., module, ., impls, ., items, ), |, impl, |, {, if, (, impl, ., impl, ., num_virtual_methods, ==, 0, ), {, continue, ;, }, const, trait, =, impl, ., impl, ., trait, .?, ;, const, trait_module, =, trait, ., symbol, (, ), .?, ., scope, ., module, .?, ;, try, self, ., writer, ., print, (, "extern const struct vtable_{s}__{s}__{}_{s} {s}__{s}_{}__vtable;\n", ,, ., {, trait_module, ., package_name, ,, trait_module, ., name, (, ), ,, trait, ., symbol, (, ), .?, ., scope, ., uid, ,, trait, ., symbol, (, ), .?, ., name, ,, self, ., module, ., package_name, ,, self, ., module, ., name, (, ), ,, impl, ., scope, (, ), .?, ., uid, ,, }, ), ;, }, }, pub, fn, output_forward_function, (, self, :, *, Self, ,, cfg, :, *, CFG, ), CodeGen_Error, !, void, {, if, (, cfg, ., symbol, ., is_monomorphed, ), {, return, ;, }, try, self, ., emitter, ., output_function_prototype, (, cfg, ), ;, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Basic_Block, =, @, import, (, "../ir/basic-block.zig", ), ;, const, core_, =, @, import, (, "../hierarchy/core.zig", ), ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, Emitter, =, @, import, (, "emitter.zig", ), ;, const, Interned_String_Set, =, @, import, (, "../ir/interned_string_set.zig", ), ;, const, Instruction, =, @, import, (, "../ir/instruction.zig", ), ;, const, lval_, =, @, import, (, "../ir/lval.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, module_, =, @, import, (, "../hierarchy/module.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Type_Map, =, @, import, (, "../types/type_map.zig", ), ., Type_Map, ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Self, =, @, This, (, ), ;, module, :, *, module_, ., Module, ,, module_interned_strings, :, *, const, std, ., AutoArrayHashMap, (, u32, ,, *, Interned_String_Set, ), ,, emitter, :, Emitter, ,, writer, :, *, std, ., array_list, ., Managed, (, u8, ), ,, pub, const, CodeGen_Error, =, error, {, WriteFailed, ,, OutOfMemory, }, ;, pub, fn, init, (, module, :, *, module_, ., Module, ,, module_interned_strings, :, *, const, std, ., AutoArrayHashMap, (, u32, ,, *, Interned_String_Set, ), ,, writer, :, *, std, ., array_list, ., Managed, (, u8, ), ,, ), Self, {, const, emitter, =, Emitter, ., init, (, writer, ), ;, return, Self, {, ., module, =, module, ,, ., module_interned_strings, =, module_interned_strings, ,, ., emitter, =, emitter, ,, ., writer, =, writer, ,, }, ;, }, pub, fn, generate, (, self, :, *, Self, ), CodeGen_Error, !, void, {, try, self, ., output_header_include, (, ), ;, try, self, ., output_impls, (, ), ;, try, self, ., emitter, ., forall_functions, (, self, ,, self, ., module, ., cfgs, ., items, ,, "Monomorphed function declarations", ,, output_monomprphed_decl, ), ;, try, self, ., emitter, ., forall_functions, (, self, ,, self, ., module, ., cfgs, ., items, ,, "Monomorphed function definitions", ,, output_monomprphed_def, ), ;, try, self, ., emitter, ., forall_functions, (, self, ,, self, ., module, ., cfgs, ., items, ,, "Function definitions", ,, output_non_monomorphed_def, ), ;, }, pub, fn, output_header_include, (, self, :, *, Self, ), CodeGen_Error, !, void, {, try, self, ., writer, ., print, (, \, \, /, *, Code, generated, using, the, Orange, compiler, http, :, \, \, \, \, #, include, "{s}-{s}.h", \, \, ,, ., {, self, ., module, ., package_name, ,, self, ., module, ., name, (, ), }, ), ;, }, fn, output_impls, (, self, :, *, Self, ,, ), CodeGen_Error, !, void, {, var, vtable_count, :, usize, =, 0, ;, for, (, self, ., module, ., impls, ., items, ), |, impl, |, {, if, (, impl, ., impl, ., num_virtual_methods, !=, 0, ), {, vtable_count, +=, 1, ;, }, }, if, (, vtable_count, >, 0, ), {, try, self, ., writer, ., print, (, "\n/* Trait vtable implementations */\n", ,, ., {, }, ), ;, }, for, (, self, ., module, ., impls, ., items, ), |, impl, |, {, const, trait, =, impl, ., impl, ., trait, .?, ;, const, trait_symbol, =, trait, ., symbol, (, ), .?, ;, const, trait_decl, =, trait_symbol, ., decl, .?, ;, const, trait_module, =, trait_symbol, ., scope, ., module, .?, ;, if, (, impl, ., impl, ., num_virtual_methods, ==, 0, and, trait_decl, ., trait, ., super_traits, ., items, ., len, ==, 0, ), {, continue, ;, }, try, self, ., writer, ., print, (, "const struct vtable_{s}__{s}__{}_{s} {s}__{s}_{}__vtable = {{\n", ,, ., {, trait_module, ., package_name, ,, trait_module, ., name, (, ), ,, trait_symbol, ., scope, ., uid, ,, trait_symbol, ., name, ,, self, ., module, ., package_name, ,, self, ., module, ., name, (, ), ,, impl, ., scope, (, ), .?, ., uid, ,, }, ), ;, for, (, impl, ., impl, ., method_defs, ., items, ), |, decl, |, {, if, (, !, decl, ., method_decl, ., is_virtual, ), {, continue, ;, }, try, self, ., writer, ., print, (, "    ._{s} = ", ,, ., {, decl, ., method_decl, ., name, ., token, (, ), ., data, }, ), ;, try, self, ., emitter, ., output_symbol, (, decl, ., symbol, (, ), .?, ), ;, try, self, ., writer, ., print, (, ",\n", ,, ., {, }, ), ;, }, for, (, trait_decl, ., trait, ., super_traits, ., items, ,, 0.., ), |, super_trait, ,, i, |, {, const, super_trait_symbol, =, super_trait, ., symbol, (, ), .?, ;, const, super_trait_decl, =, super_trait_symbol, ., decl, .?, ;, if, (, super_trait_decl, ., trait, ., num_virtual_methods, ==, 0, and, super_trait_decl, ., trait, ., super_traits, ., items, ., len, ==, 0, ), continue, ;, try, self, ., writer, ., print, (, "    ._{} = &{s}__{s}_{}__vtable,\n", ,, ., {, i, ,, self, ., module, ., package_name, ,, self, ., module, ., name, (, ), ,, impl, ., scope, (, ), .?, ., impl_trait_lookup, (, impl, ., impl, ., _type, ,, super_trait_symbol, ), ., ast, .?, ., scope, (, ), .?, ., uid, ,, }, ), ;, }, try, self, ., writer, ., print, (, "}};\n", ,, ., {, }, ), ;, }, }, pub, fn, output_monomprphed_decl, (, self, :, *, Self, ,, cfg, :, *, CFG, ), CodeGen_Error, !, void, {, if, (, !, cfg, ., symbol, ., is_monomorphed, ), {, return, ;, }, try, self, ., writer, ., print, (, "static ", ,, ., {, }, ), ;, try, self, ., emitter, ., output_function_prototype, (, cfg, ), ;, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, pub, fn, output_monomprphed_def, (, self, :, *, Self, ,, cfg, :, *, CFG, ), CodeGen_Error, !, void, {, if, (, !, cfg, ., symbol, ., is_monomorphed, ), {, return, ;, }, try, self, ., writer, ., print, (, "static ", ,, ., {, }, ), ;, try, self, ., output_function_definition, (, cfg, ), ;, }, fn, output_non_monomorphed_def, (, self, :, *, Self, ,, cfg, :, *, CFG, ), CodeGen_Error, !, void, {, if, (, cfg, ., symbol, ., is_monomorphed, or, cfg, ., symbol, ., scope, ., module, !=, self, ., module, ), {, return, ;, }, try, self, ., output_function_definition, (, cfg, ), ;, }, pub, fn, output_function_definition, (, self, :, *, Self, ,, cfg, :, *, CFG, ), CodeGen_Error, !, void, {, if, (, cfg, !=, self, ., module, ., cfgs, ., items, [, 0, ], ), try, self, ., writer, ., print, (, "\n", ,, ., {, }, ), ;, try, self, ., emitter, ., output_function_prototype, (, cfg, ), ;, try, self, ., writer, ., print, (, "\n{{\n", ,, ., {, }, ), ;, for, (, cfg, ., symbvers, ., items, ), |, symbver, |, {, if, (, symbver, ., symbol, ., expanded_type, (, ), ., sizeof, (, ), ==, 0, or, (, symbver, ., symbol, ., uses, ==, 0, and, symbver, ., symbol, ., name, [, 0, ], !=, '_', ), ), {, continue, ;, }, try, self, ., emitter, ., output_var_decl, (, symbver, ., symbol, ,, false, ), ;, }, const, param_symbols, =, cfg, ., symbol, ., decl, .?, ., param_symbols, (, ), ;, if, (, param_symbols, !=, null, ), {, for, (, param_symbols, .?, ., items, ), |, param, |, {, if, (, !, param, ., expanded_type, (, ), ., is_c_void_type, (, ), and, param, ., uses, ==, 0, ), {, try, self, ., writer, ., print, (, "    (void)", ,, ., {, }, ), ;, try, self, ., emitter, ., output_symbol, (, param, ), ;, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, }, }, if, (, cfg, ., block_graph_head, ), |, block_graph_head, |, {, try, self, ., output_basic_block, (, cfg, ,, block_graph_head, ,, cfg, ., return_symbol, ), ;, cfg, ., clear_visited_BBs, (, ), ;, }, try, self, ., writer, ., print, (, "}}\n", ,, ., {, }, ), ;, }, pub, fn, output_main_function, (, self, :, *, Self, ), CodeGen_Error, !, void, {, if, (, self, ., module, ., entry, ==, null, ), {, return, ;, }, const, symbol, =, self, ., module, ., entry, .?, ., symbol, ;, const, codomain, =, symbol, ., expanded_type, (, ), ., rhs, (, ), ., expand_identifier, (, ), ;, var, string_access, :, [, ], const, u8, =, "", ;, var, specifier, :, ?, [, ], const, u8, =, null, ;, switch, (, codomain, .*, ), {, ., identifier, =>, {, const, info, =, prelude_, ., info_from_name, (, codomain, ., token, (, ), ., data, ), .?, ;, specifier, =, switch, (, info, ., type_kind, ), {, ., boolean, ,, ., signed_integer, =>, "d", ,, ., unsigned_integer, =>, "u", ,, ., floating_point, =>, "f", ,, else, =>, unreachable, ,, }, ;, }, ,, ., struct_type, =>, |, p, |, if, (, p, ., was_slice, ), {, string_access, =, "._0", ;, specifier, =, "s", ;, }, ,, else, =>, {, }, ,, }, try, self, ., writer, ., print, (, \, \, int, main, (, int, argc, ,, char, *, argv, [, ], ), {, {, \, \, ,, ., {, }, ), ;, var, contexts_used, =, Type_Map, (, void, ), ., init, (, std, ., heap, ., page_allocator, ), ;, defer, contexts_used, ., deinit, (, ), ;, try, contexts_used, ., put_many, (, symbol, ., type, (, ), ., function, ., contexts, ., items, ,, void, {, }, ), ;, try, self, ., emitter, ., output_context_defs, (, &, contexts_used, ), ;, if, (, specifier, !=, null, ), {, try, self, ., writer, ., print, (, "printf(\"%{s}{s}\", ", ,, ., {, if, (, codomain, ., sizeof, (, ), ==, 8, ), "l", else, "", ,, specifier, .?, }, ), ;, try, self, ., emitter, ., output_symbol, (, symbol, ), ;, try, self, ., writer, ., print, (, "(){s});", ,, ., {, string_access, }, ), ;, }, else, {, if, (, codomain, .*, ==, ., enum_type, and, codomain, ., enum_type, ., from, ==, ., @, "error", ), {, try, self, ., emitter, ., output_type, (, codomain, ), ;, try, self, ., writer, ., print, (, "  retcode = ", ,, ., {, }, ), ;, }, try, self, ., emitter, ., output_symbol, (, symbol, ), ;, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, try, self, ., emitter, ., output_context_args, (, symbol, ., type, (, ), ., function, ., contexts, ., items, ), ;, try, self, ., writer, ., print, (, ");\n", ,, ., {, }, ), ;, }, if, (, codomain, .*, ==, ., enum_type, and, codomain, ., enum_type, ., from, ==, ., @, "error", ), {, try, self, ., writer, ., print, (, \, \, return, (, int, ), retcode, ., tag, ;, \, \, }, }, \, \, ,, ., {, }, ), ;, }, else, {, try, self, ., writer, ., print, (, \, \, return, 0, ;, \, \, }, }, \, \, ,, ., {, }, ), ;, }, }, fn, output_basic_block, (, self, :, *, Self, ,, cfg, :, *, CFG, ,, start_bb, :, *, Basic_Block, ,, return_symbol, :, *, Symbol, ,, ), CodeGen_Error, !, void, {, var, bb_queue, =, std, ., array_list, ., Managed, (, *, Basic_Block, ), ., init, (, std, ., heap, ., page_allocator, ), ;, defer, bb_queue, ., deinit, (, ), ;, try, bb_queue, ., append, (, start_bb, ), ;, start_bb, ., visited, =, true, ;, var, head, :, usize, =, 0, ;, while, (, head, <, bb_queue, ., items, ., len, ), {, const, bb, :, *, Basic_Block, =, bb_queue, ., items, [, head, ], ;, head, +=, 1, ;, const, is_head_bb, =, cfg, ., block_graph_head, !=, null, and, cfg, ., block_graph_head, .?, ==, bb, ;, const, more_than_one_incoming, =, bb, ., number_predecessors, >, 1, ;, if, (, !, is_head_bb, or, more_than_one_incoming, ), {, try, self, ., writer, ., print, (, "BB{}:\n", ,, ., {, bb, ., uid, }, ), ;, }, for, (, bb, ., instructions, ., items, ), |, instr, |, {, try, self, ., output_instruction, (, instr, ), ;, }, switch, (, bb, ., terminator, ), {, ., unconditional, =>, {, if, (, bb, ., terminator, ., unconditional, ), |, next, |, {, if, (, !, next, ., visited, ), {, try, bb_queue, ., append, (, next, ), ;, next, ., visited, =, true, ;, }, try, self, ., writer, ., print, (, "    goto BB{};\n", ,, ., {, next, ., uid, }, ), ;, }, else, {, try, self, ., output_return, (, return_symbol, ), ;, }, }, ,, ., conditional, =>, {, try, self, ., writer, ., print, (, "    if (", ,, ., {, }, ), ;, try, self, ., output_rvalue, (, bb, ., terminator, ., conditional, ., condition, ,, Instruction, ., Precedence, ., highest, ), ;, try, self, ., writer, ., print, (, ")\n    {{\n", ,, ., {, }, ), ;, if, (, bb, ., terminator, ., conditional, ., true_target, ), |, next, |, {, try, self, ., writer, ., print, (, "        goto BB{};\n    }}", ,, ., {, next, ., uid, }, ), ;, if, (, !, next, ., visited, ), {, try, bb_queue, ., append, (, next, ), ;, next, ., visited, =, true, ;, }, }, else, {, try, self, ., writer, ., print, (, "    ", ,, ., {, }, ), ;, try, self, ., output_return, (, return_symbol, ), ;, try, self, ., writer, ., print, (, "    }}", ,, ., {, }, ), ;, }, if, (, bb, ., terminator, ., conditional, ., false_target, ), |, branch, |, {, if, (, !, branch, ., visited, ), {, try, bb_queue, ., append, (, branch, ), ;, branch, ., visited, =, true, ;, }, try, self, ., writer, ., print, (, "\n    else\n    {{\n        goto BB{};\n    }}\n", ,, ., {, branch, ., uid, }, ), ;, }, else, {, try, self, ., writer, ., print, (, "\n    else\n    {{\n    ", ,, ., {, }, ), ;, try, self, ., output_return, (, return_symbol, ), ;, try, self, ., writer, ., print, (, "    }}\n", ,, ., {, }, ), ;, }, }, ,, ., panic, =>, {, }, ,, }, }, }, fn, output_instruction, (, self, :, *, Self, ,, instr, :, *, Instruction, ), CodeGen_Error, !, void, {, if, (, instr, ., dest, !=, null, ), {, try, self, ., output_lvalue_check, (, instr, ., span, ,, instr, ., dest, .?, ), ;, }, if, (, instr, ., src1, !=, null, ), {, try, self, ., output_lvalue_check, (, instr, ., span, ,, instr, ., src1, .?, ), ;, }, if, (, instr, ., src2, !=, null, ), {, try, self, ., output_lvalue_check, (, instr, ., span, ,, instr, ., src2, .?, ), ;, }, if, (, instr, ., data, ==, ., lval_list, ), {, for, (, instr, ., data, ., lval_list, ., items, ), |, lval, |, {, try, self, ., output_lvalue_check, (, instr, ., span, ,, lval, ), ;, }, }, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, ., get_expanded_type, (, ), ., is_c_void_type, (, ), and, instr, ., kind, !=, ., call, and, instr, ., kind, !=, ., invoke, ), {, return, ;, }, try, self, ., output_instruction_post_check, (, instr, ), ;, }, fn, output_instruction_post_check, (, self, :, *, Self, ,, instr, :, *, Instruction, ), CodeGen_Error, !, void, {, switch, (, instr, ., kind, ), {, ., load_unit, =>, {, }, ,, ., load_symbol, =>, {, if, (, instr, ., dest, .?, ., get_expanded_type, (, ), .*, ==, ., function, ), {, try, self, ., output_var_assign_cast, (, instr, ., dest, .?, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ), ;, }, else, {, try, self, ., output_var_assign, (, instr, ., dest, .?, ), ;, }, try, self, ., emitter, ., output_symbol, (, instr, ., data, ., symbol, ), ;, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, ,, ., load_int, =>, {, try, self, ., output_var_assign, (, instr, ., dest, .?, ), ;, try, self, ., writer, ., print, (, "{}", ,, ., {, instr, ., data, ., int, }, ), ;, if, (, prelude_, ., info_from_ast, (, instr, ., dest, .?, ., get_expanded_type, (, ), ), .?, ., type_kind, ==, ., unsigned_integer, ), {, if, (, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ==, 8, ), {, try, self, ., writer, ., print, (, "ULL", ,, ., {, }, ), ;, }, else, {, try, self, ., writer, ., print, (, "U", ,, ., {, }, ), ;, }, }, else, if, (, prelude_, ., info_from_ast, (, instr, ., dest, .?, ., get_expanded_type, (, ), ), .?, ., type_kind, ==, ., signed_integer, ), {, if, (, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ==, 8, ), {, try, self, ., writer, ., print, (, "LL", ,, ., {, }, ), ;, }, }, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, ,, ., load_float, =>, {, try, self, ., output_var_assign, (, instr, ., dest, .?, ), ;, try, self, ., writer, ., print, (, "{};\n", ,, ., {, instr, ., data, ., float, }, ), ;, }, ,, ., load_string, =>, {, try, self, ., output_var_assign_cast, (, instr, ., dest, .?, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ), ;, const, interned_strings, =, self, ., module_interned_strings, ., get, (, instr, ., data, ., string_id, ., module_uid, ), .?, ;, try, self, ., writer, ., print, (, "{{(uint8_t *)\"", ,, ., {, }, ), ;, const, str, =, interned_strings, ., items, (, ), [, instr, ., data, ., string_id, ., string_idx, ], ;, for, (, str, ), |, byte, |, {, try, self, ., writer, ., print, (, "\\x{X:0>2}", ,, ., {, byte, }, ), ;, }, try, self, ., writer, ., print, (, "\", {}}};\n", ,, ., {, interned_strings, ., items, (, ), [, instr, ., data, ., string_id, ., string_idx, ], ., len, }, ), ;, }, ,, ., load_struct, =>, {, try, self, ., output_var_assign_cast, (, instr, ., dest, .?, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ), ;, try, self, ., writer, ., print, (, "{{", ,, ., {, }, ), ;, const, dest_type, =, instr, ., dest, .?, ., get_expanded_type, (, ), ;, if, (, dest_type, .*, ==, ., struct_type, or, dest_type, .*, ==, ., tuple_type, ), {, var, product_list, =, dest_type, ., children, (, ), .*, ;, for, (, instr, ., data, ., lval_list, ., items, ,, product_list, ., items, ,, 1.., ), |, term, ,, expected, ,, i, |, {, if, (, !, expected, ., is_c_void_type, (, ), ), {, try, self, ., output_rvalue, (, term, ,, instr, ., kind, ., precedence, (, ), ), ;, if, (, i, <, product_list, ., items, ., len, and, !, product_list, ., items, [, i, -, 1, ], ., is_c_void_type, (, ), ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, }, }, }, else, {, for, (, instr, ., data, ., lval_list, ., items, ,, 1.., ), |, term, ,, i, |, {, try, self, ., output_rvalue, (, term, ,, instr, ., kind, ., precedence, (, ), ), ;, if, (, i, <, instr, ., data, ., lval_list, ., items, ., len, ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, }, }, try, self, ., writer, ., print, (, "}};\n", ,, ., {, }, ), ;, }, ,, ., load_union, =>, {, try, self, ., output_var_assign_cast, (, instr, ., dest, .?, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ), ;, try, self, ., writer, ., print, (, "{{.tag = {}", ,, ., {, instr, ., data, ., int, }, ), ;, if, (, instr, ., src1, !=, null, and, !, instr, ., src1, .?, ., get_expanded_type, (, ), ., is_c_void_type, (, ), ), {, try, self, ., writer, ., print, (, ", ._{} = ", ,, ., {, instr, ., data, ., int, }, ), ;, try, self, ., output_rvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, }, try, self, ., writer, ., print, (, "}};\n", ,, ., {, }, ), ;, }, ,, ., copy, =>, {, try, self, ., output_var_assign, (, instr, ., dest, .?, ), ;, try, self, ., output_rvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, ,, ., mut_addr_of, ,, ., addr_of, =>, {, try, self, ., output_var_assign, (, instr, ., dest, .?, ), ;, try, self, ., output_lvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, ,, ., mut_dyn_value, ,, ., dyn_value, =>, {, try, self, ., output_var_assign_cast, (, instr, ., dest, .?, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ), ;, try, self, ., writer, ., print, (, "{{", ,, ., {, }, ), ;, try, self, ., output_lvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, const, dyn_type, =, instr, ., dest, .?, ., get_expanded_type, (, ), ;, const, trait_decl, =, dyn_type, ., child, (, ), ., symbol, (, ), .?, ., decl, .?, ;, if, (, trait_decl, ., trait, ., num_virtual_methods, !=, 0, ), {, try, self, ., writer, ., print, (, "&", ,, ., {, }, ), ;, try, self, ., output_vtable_impl, (, instr, ., data, ., dyn, ., impl, ), ;, }, else, {, try, self, ., writer, ., print, (, "NULL", ,, ., {, }, ), ;, }, try, self, ., writer, ., print, (, "}};\n", ,, ., {, }, ), ;, }, ,, ., not, ,, ., negate_int, ,, ., negate_float, ,, ., bit_not, ,, ., equal, ,, ., not_equal, ,, ., greater_int, ,, ., greater_float, ,, ., greater_equal_int, ,, ., greater_equal_float, ,, ., lesser_int, ,, ., lesser_float, ,, ., lesser_equal_int, ,, ., lesser_equal_float, ,, ., add_int, ,, ., add_float, ,, ., sub_int, ,, ., sub_float, ,, ., mult_int, ,, ., mult_float, ,, ., div_int, ,, ., div_float, ,, ., mod, ,, ., bit_and, ,, ., bit_or, ,, ., bit_xor, ,, ., left_shift, ,, ., right_shift, ,, =>, try, self, ., output_operator, (, instr, ), ,, ., get_tag, =>, {, try, self, ., output_var_assign, (, instr, ., dest, .?, ), ;, try, self, ., output_rvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, try, self, ., writer, ., print, (, ".tag;\n", ,, ., {, }, ), ;, }, ,, ., cast, =>, {, if, (, instr, ., dest, .?, ., get_expanded_type, (, ), .*, ==, ., dyn_type, ), {, const, super_dyn_type, =, instr, ., dest, .?, ., get_expanded_type, (, ), ;, const, super_trait_symbol, =, super_dyn_type, ., child, (, ), ., symbol, (, ), .?, ;, const, super_trait_decl, =, super_trait_symbol, ., decl, .?, ;, const, sub_dyn_type, =, instr, ., src1, .?, ., get_expanded_type, (, ), ;, const, sub_trait_decl, =, sub_dyn_type, ., child, (, ), ., symbol, (, ), .?, ., decl, .?, ;, try, self, ., output_var_assign_cast, (, instr, ., dest, .?, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ), ;, try, self, ., writer, ., print, (, "{{", ,, ., {, }, ), ;, try, self, ., output_rvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, try, self, ., writer, ., print, (, ".data_ptr, ", ,, ., {, }, ), ;, if, (, super_trait_decl, ., trait, ., num_virtual_methods, !=, 0, ), {, var, vtables, =, std, ., array_list, ., Managed, (, usize, ), ., init, (, std, ., heap, ., page_allocator, ), ;, defer, vtables, ., deinit, (, ), ;, _, =, try, self, ., append_vtable_to_super, (, sub_trait_decl, ,, super_trait_symbol, ,, &, vtables, ), ;, try, self, ., output_rvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, try, self, ., writer, ., print, (, ".vtable", ,, ., {, }, ), ;, for, (, 0..vtables.items.len, ), |, i, |, {, try, self, ., writer, ., print, (, "->_{}", ,, ., {, vtables, ., items, [, vtables, ., items, ., len, -, i, -, 1, ], }, ), ;, }, }, else, {, try, self, ., writer, ., print, (, "NULL", ,, ., {, }, ), ;, }, try, self, ., writer, ., print, (, "}};\n", ,, ., {, }, ), ;, }, else, {, try, self, ., output_var_assign, (, instr, ., dest, .?, ), ;, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, try, self, ., emitter, ., output_type, (, instr, ., dest, .?, ., get_expanded_type, (, ), ), ;, try, self, ., writer, ., print, (, ")", ,, ., {, }, ), ;, try, self, ., output_rvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, }, ,, ., call, =>, {, try, self, ., output_call_prefix, (, instr, ), ;, try, self, ., output_rvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, for, (, instr, ., data, ., call, ., arg_lval_list, ., items, ,, 0.., ), |, term, ,, i, |, {, if, (, !, term, ., get_expanded_type, (, ), ., is_c_void_type, (, ), ), {, try, self, ., output_rvalue, (, term, ,, Instruction, ., Precedence, ., highest, ), ;, if, (, i, +, 1, <, instr, ., data, ., call, ., arg_lval_list, ., items, ., len, and, !, instr, ., data, ., call, ., arg_lval_list, ., items, [, i, +, 1, ], ., get_expanded_type, (, ), ., is_c_void_type, (, ), ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, }, }, try, self, ., writer, ., print, (, ");\n", ,, ., {, }, ), ;, }, ,, ., invoke, =>, {, try, self, ., output_call_prefix, (, instr, ), ;, if, (, instr, ., data, ., invoke, ., method_decl, ., method_decl, ., init, !=, null, and, !, instr, ., data, ., invoke, ., method_decl, ., method_decl, ., is_virtual, ), {, try, self, ., output_rvalue, (, instr, ., data, ., invoke, ., method_decl_lval, .?, ,, Instruction, ., Precedence, ., prefix, ), ;, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, }, else, if, (, instr, ., data, ., invoke, ., dyn_value, !=, null, ), {, try, self, ., output_vtable_invoke, (, instr, ), ;, }, else, {, try, self, ., output_vtable_impl, (, instr, ., data, ., invoke, ., method_decl, ., method_decl, ., impl, .?, ), ;, try, self, ., writer, ., print, (, "._{s}(", ,, ., {, instr, ., data, ., invoke, ., method_decl, ., method_decl, ., name, ., token, (, ), ., data, }, ), ;, }, const, num_invoke_args, =, instr, ., data, ., invoke, ., arg_lval_list, ., items, ., len, ;, for, (, instr, ., data, ., invoke, ., arg_lval_list, ., items, ,, 0.., ), |, term, ,, i, |, {, if, (, !, term, ., get_expanded_type, (, ), ., is_c_void_type, (, ), ), {, try, self, ., output_rvalue, (, term, ,, Instruction, ., Precedence, ., highest, ), ;, if, (, instr, ., data, ., invoke, ., dyn_value, !=, null, and, instr, ., data, ., invoke, ., dyn_value, ==, term, and, i, ==, 0, ), {, try, self, ., writer, ., print, (, ".data_ptr", ,, ., {, }, ), ;, }, if, (, i, +, 1, <, num_invoke_args, and, !, instr, ., data, ., invoke, ., arg_lval_list, ., items, [, i, +, 1, ], ., get_expanded_type, (, ), ., is_c_void_type, (, ), ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, }, }, try, self, ., writer, ., print, (, ");\n", ,, ., {, }, ), ;, }, ,, ., label, ,, ., jump, ,, ., branch_if_false, ,, =>, {, }, ,, ., push_stack_trace, =>, {, var, spaces, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, std, ., heap, ., page_allocator, ), ;, defer, spaces, ., deinit, (, ), ;, for, (, 1..instr.span.col, -, 1, ), |, _, |, {, try, spaces, ., print, (, " ", ,, ., {, }, ), ;, }, try, self, ., writer, ., print, (, "    orange_debug__lines[orange_debug__line_idx++] = ", ,, ., {, }, ), ;, try, instr, ., span, ., print_debug_line, (, self, ., writer, ,, Span, ., c_format, ), ;, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, ,, ., pop_stack_trace, =>, {, try, self, ., writer, ., print, (, \, \, orange_debug__line_idx, -, -, ;, \, \, ,, ., {, }, ), ;, }, ,, ., panic, =>, {, try, self, ., writer, ., print, (, \, \, orange_debug__panic, (, "{s}\n", ), ;, \, \, ,, ., {, instr, ., data, ., string, }, ,, ), ;, }, ,, else, =>, std, ., debug, ., panic, (, "compiler error: unimplemented output_instr() for: Kind.{s}", ,, ., {, @, tagName, (, instr, ., kind, ), }, ), ,, }, }, fn, output_call_prefix, (, self, :, *, Self, ,, instr, :, *, Instruction, ), !, void, {, const, void_fn, =, instr, ., dest, .?, ., get_expanded_type, (, ), ., is_c_void_type, (, ), ;, const, symbol_used, =, if, (, instr, ., dest, .?, .*, ==, ., symbver, ), instr, ., dest, .?, ., symbver, ., symbol, ., uses, >, 0, else, false, ;, if, (, !, symbol_used, ), {, try, self, ., writer, ., print, (, "    (void)", ,, ., {, }, ), ;, }, else, if, (, !, void_fn, ), {, try, self, ., output_var_assign, (, instr, ., dest, .?, ), ;, }, else, {, try, self, ., writer, ., print, (, "    ", ,, ., {, }, ), ;, }, }, fn, output_vtable_invoke, (, self, :, *, Self, ,, instr, :, *, Instruction, ), !, void, {, std, ., debug, ., assert, (, instr, ., data, ., invoke, ., dyn_value, .?, ., get_expanded_type, (, ), .*, ==, ., dyn_type, ), ;, const, method_name, =, instr, ., data, ., invoke, ., method_decl, ., method_decl, ., name, ., token, (, ), ., data, ;, const, dyn_type, =, instr, ., data, ., invoke, ., dyn_value, .?, ., get_expanded_type, (, ), ;, const, trait_decl, =, dyn_type, ., child, (, ), ., symbol, (, ), .?, ., decl, .?, ;, var, vtables, =, std, ., array_list, ., Managed, (, usize, ), ., init, (, std, ., heap, ., page_allocator, ), ;, defer, vtables, ., deinit, (, ), ;, _, =, try, self, ., append_vtable_indirection, (, trait_decl, ,, method_name, ,, &, vtables, ), ;, try, self, ., output_rvalue, (, instr, ., data, ., invoke, ., dyn_value, .?, ,, Instruction, ., Precedence, ., prefix, ), ;, try, self, ., writer, ., print, (, ".vtable->", ,, ., {, }, ), ;, for, (, 0..vtables.items.len, ), |, i, |, {, try, self, ., writer, ., print, (, "_{}->", ,, ., {, vtables, ., items, [, vtables, ., items, ., len, -, i, -, 1, ], }, ), ;, }, try, self, ., writer, ., print, (, "_{s}(", ,, ., {, method_name, }, ), ;, }, fn, append_vtable_indirection, (, self, :, *, Self, ,, trait_decl, :, *, ast_, ., AST, ,, method_name, :, [, ], const, u8, ,, vtables, :, *, std, ., array_list, ., Managed, (, usize, ), ), !, bool, {, for, (, trait_decl, ., trait, ., method_decls, ., items, ), |, item, |, {, if, (, std, ., mem, ., eql, (, u8, ,, method_name, ,, item, ., method_decl, ., name, ., token, (, ), ., data, ), ), {, return, true, ;, }, }, for, (, trait_decl, ., trait, ., super_traits, ., items, ,, 0.., ), |, super_trait, ,, i, |, {, const, super_trait_decl, =, super_trait, ., symbol, (, ), .?, ., decl, .?, ;, if, (, try, self, ., append_vtable_indirection, (, super_trait_decl, ,, method_name, ,, vtables, ), ), {, try, vtables, ., append, (, i, ), ;, return, true, ;, }, }, return, false, ;, }, fn, append_vtable_to_super, (, self, :, *, Self, ,, sub_trait_decl, :, *, ast_, ., AST, ,, target_super_trait_symbol, :, *, Symbol, ,, vtables, :, *, std, ., array_list, ., Managed, (, usize, ), ), !, bool, {, for, (, sub_trait_decl, ., trait, ., super_traits, ., items, ,, 0.., ), |, super_trait, ,, i, |, {, const, super_trait_symbol, =, super_trait, ., symbol, (, ), .?, ;, const, super_trait_decl, =, super_trait, ., symbol, (, ), .?, ., decl, .?, ;, if, (, super_trait_symbol, ==, target_super_trait_symbol, ), {, try, vtables, ., append, (, i, ), ;, return, true, ;, }, if, (, try, self, ., append_vtable_to_super, (, super_trait_decl, ,, target_super_trait_symbol, ,, vtables, ), ), {, try, vtables, ., append, (, i, ), ;, return, true, ;, }, }, return, false, ;, }, fn, output_lvalue_check, (, self, :, *, Self, ,, span, :, Span, ,, lvalue, :, *, lval_, ., L_Value, ), CodeGen_Error, !, void, {, switch, (, lvalue, .*, ), {, ., symbver, =>, {, }, ,, ., dereference, =>, try, self, ., output_lvalue_check, (, span, ,, lvalue, ., dereference, ., expr, ), ,, ., index, =>, {, try, self, ., output_lvalue_check, (, span, ,, lvalue, ., index, ., lhs, ), ;, try, self, ., output_lvalue_check, (, span, ,, lvalue, ., index, ., rhs, ), ;, if, (, lvalue, ., index, ., length, !=, null, ), {, try, self, ., writer, ., print, (, "    orange_debug__bounds_check(", ,, ., {, }, ), ;, try, self, ., output_rvalue, (, lvalue, ., index, ., rhs, ,, Instruction, ., Precedence, ., highest, ), ;, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, try, self, ., output_rvalue, (, lvalue, ., index, ., length, .?, ,, Instruction, ., Precedence, ., highest, ), ;, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, try, span, ., print_debug_line, (, self, ., writer, ,, Span, ., c_format, ), ;, try, self, ., writer, ., print, (, ");\n", ,, ., {, }, ), ;, }, }, ,, ., select, =>, {, try, self, ., output_lvalue_check, (, span, ,, lvalue, ., select, ., lhs, ), ;, if, (, lvalue, ., select, ., tag, !=, null, ), {, try, self, ., writer, ., print, (, "    orange_debug__tag_check(", ,, ., {, }, ), ;, try, self, ., output_rvalue, (, lvalue, ., select, ., tag, .?, ,, Instruction, ., Precedence, ., highest, ), ;, try, self, ., writer, ., print, (, ", {}, ", ,, ., {, lvalue, ., select, ., field, }, ), ;, try, span, ., print_debug_line, (, self, ., writer, ,, Span, ., c_format, ), ;, try, self, ., writer, ., print, (, ");\n", ,, ., {, }, ), ;, }, }, ,, ., raw_address, =>, std, ., debug, ., panic, (, "compiler error: cannot output raw address lvalue", ,, ., {, }, ), ,, }, }, fn, output_rvalue, (, self, :, *, Self, ,, lvalue, :, *, lval_, ., L_Value, ,, outer_precedence, :, Instruction, ., Precedence, ), CodeGen_Error, !, void, {, if, (, @, intFromEnum, (, outer_precedence, ), <, @, intFromEnum, (, lvalue, ., lval_precedence, (, ), ), ), {, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, }, switch, (, lvalue, .*, ), {, ., dereference, =>, {, try, self, ., writer, ., print, (, "*", ,, ., {, }, ), ;, if, (, lvalue, ., dereference, ., expr, ., get_expanded_type, (, ), ., addr_of, ., anytptr, ), {, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, try, self, ., emitter, ., output_type, (, lvalue, ., get_expanded_type, (, ), ), ;, try, self, ., writer, ., print, (, " *)", ,, ., {, }, ), ;, }, try, self, ., output_rvalue, (, lvalue, ., dereference, ., expr, ,, lvalue, ., lval_precedence, (, ), ), ;, }, ,, ., index, =>, {, try, self, ., writer, ., print, (, "*", ,, ., {, }, ), ;, try, self, ., output_lvalue, (, lvalue, ,, lvalue, ., lval_precedence, (, ), ), ;, }, ,, ., select, =>, {, try, self, ., output_rvalue, (, lvalue, ., select, ., lhs, ,, lvalue, ., lval_precedence, (, ), ), ;, const, unexpanded_type, :, ?, *, Type_AST, =, lvalue, ., select, ., lhs, ., get_expanded_type, (, ), ., common, (, ), ., _unexpanded_type, ;, if, (, unexpanded_type, !=, null, and, unexpanded_type, .?, .*, ==, ., identifier, and, unexpanded_type, .?, ., symbol, (, ), !=, null, and, unexpanded_type, .?, ., symbol, (, ), .?, ., storage, ==, ., @, "extern", ), {, const, field_name, =, lvalue, ., select, ., lhs, ., get_expanded_type, (, ), ., children, (, ), ., items, [, @, intCast, (, lvalue, ., select, ., field, ), ], ., annotation, ., pattern, ., token, (, ), ., data, ;, try, self, ., writer, ., print, (, ".{s}", ,, ., {, field_name, }, ), ;, }, else, {, try, self, ., writer, ., print, (, "._{}", ,, ., {, lvalue, ., select, ., field, }, ), ;, }, }, ,, ., symbver, =>, {, if, (, lvalue, ., symbver, ., symbol, ., decl, .?, .*, ==, ., receiver, ), {, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, try, self, ., emitter, ., output_type, (, lvalue, ., get_expanded_type, (, ), ), ;, try, self, ., writer, ., print, (, ")", ,, ., {, }, ), ;, }, try, self, ., emitter, ., output_symbol, (, lvalue, ., symbver, ., symbol, ), ;, }, ,, ., raw_address, =>, std, ., debug, ., panic, (, "compiler error: cannot output raw address lvalue", ,, ., {, }, ), ,, }, if, (, @, intFromEnum, (, outer_precedence, ), <, @, intFromEnum, (, lvalue, ., lval_precedence, (, ), ), ), {, try, self, ., writer, ., print, (, ")", ,, ., {, }, ), ;, }, }, fn, output_lvalue, (, self, :, *, Self, ,, lvalue, :, *, lval_, ., L_Value, ,, outer_precedence, :, Instruction, ., Precedence, ), CodeGen_Error, !, void, {, if, (, lvalue, ., expanded_type_sizeof, (, ), ==, 0, ), {, try, self, ., writer, ., print, (, "(void *)0xAAAAAAAA", ,, ., {, }, ), ;, return, ;, }, switch, (, lvalue, .*, ), {, ., dereference, =>, {, try, self, ., output_rvalue, (, lvalue, ., dereference, ., expr, ,, outer_precedence, ), ;, }, ,, ., index, =>, {, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, try, self, ., emitter, ., output_type, (, lvalue, ., get_expanded_type, (, ), ), ;, try, self, ., writer, ., print, (, " *)", ,, ., {, }, ), ;, if, (, lvalue, ., index, ., lhs, ., get_expanded_type, (, ), .*, ==, ., addr_of, ), {, std, ., debug, ., assert, (, lvalue, ., index, ., lhs, ., get_expanded_type, (, ), ., addr_of, ., multiptr, ), ;, try, self, ., output_rvalue, (, lvalue, ., index, ., lhs, ,, Instruction, ., Precedence, ., prefix, ), ;, }, else, {, try, self, ., output_lvalue, (, lvalue, ., index, ., lhs, ,, Instruction, ., Precedence, ., prefix, ), ;, }, try, self, ., writer, ., print, (, " + ", ,, ., {, }, ), ;, try, self, ., output_rvalue, (, lvalue, ., index, ., rhs, ,, lvalue, ., lval_precedence, (, ), ), ;, try, self, ., writer, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., symbver, ,, ., select, =>, {, if, (, @, intFromEnum, (, outer_precedence, ), <, @, intFromEnum, (, Instruction, ., Precedence, ., prefix, ), ), {, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, }, try, self, ., writer, ., print, (, "&", ,, ., {, }, ), ;, try, self, ., output_rvalue, (, lvalue, ,, Instruction, ., Precedence, ., prefix, ), ;, if, (, @, intFromEnum, (, outer_precedence, ), <, @, intFromEnum, (, Instruction, ., Precedence, ., prefix, ), ), {, try, self, ., writer, ., print, (, ")", ,, ., {, }, ), ;, }, }, ,, ., raw_address, =>, std, ., debug, ., panic, (, "compiler error: cannot output raw address lvalue", ,, ., {, }, ), ,, }, }, fn, output_return, (, self, :, *, Self, ,, return_symbol, :, *, Symbol, ), CodeGen_Error, !, void, {, try, self, ., writer, ., print, (, "    return", ,, ., {, }, ), ;, if, (, return_symbol, ., defs, >, 0, and, !, return_symbol, ., expanded_type, (, ), ., is_c_void_type, (, ), ), {, try, self, ., writer, ., print, (, " ", ,, ., {, }, ), ;, try, self, ., emitter, ., output_symbol, (, return_symbol, ), ;, }, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, fn, output_var_assign, (, self, :, *, Self, ,, lval, :, *, lval_, ., L_Value, ), CodeGen_Error, !, void, {, try, self, ., writer, ., print, (, "    ", ,, ., {, }, ), ;, try, self, ., output_rvalue, (, lval, ,, Instruction, ., Precedence, ., highest, ), ;, try, self, ., writer, ., print, (, " = ", ,, ., {, }, ), ;, }, fn, output_var_assign_cast, (, self, :, *, Self, ,, lval, :, *, lval_, ., L_Value, ,, _type, :, *, Type_AST, ), CodeGen_Error, !, void, {, try, self, ., output_var_assign, (, lval, ), ;, try, self, ., writer, ., print, (, "(", ,, ., {, }, ), ;, try, self, ., emitter, ., output_type, (, _type, ), ;, try, self, ., writer, ., print, (, ")", ,, ., {, }, ), ;, }, fn, output_operator, (, self, :, *, Self, ,, instr, :, *, Instruction, ), CodeGen_Error, !, void, {, try, self, ., output_var_assign, (, instr, ., dest, .?, ), ;, const, info, =, prelude_, ., info_from_ast, (, instr, ., dest, .?, ., get_expanded_type, (, ), ), ;, if, (, info, !=, null, and, instr, ., kind, ., is_checked, (, ), and, instr, ., dest, .?, ., get_expanded_type, (, ), ., can_expanded_represent_int, (, ), and, (, info, .?, ., type_kind, !=, ., unsigned_integer, or, instr, ., kind, ==, ., mod, ), ), {, try, self, ., writer, ., print, (, "orange_debug__{s}_{s}(", ,, ., {, instr, ., kind, ., checked_name, (, ), ,, info, .?, ., c_name, }, ), ;, try, self, ., output_rvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, if, (, instr, ., kind, ., arity, (, ), ==, ., binop, ), {, try, self, ., output_rvalue, (, instr, ., src2, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, try, instr, ., span, ., print_debug_line, (, self, ., writer, ,, Span, ., c_format, ), ;, try, self, ., writer, ., print, (, ")", ,, ., {, }, ), ;, }, else, if, (, instr, ., kind, ., arity, (, ), ==, ., unop, ), {, try, self, ., writer, ., print, (, "{s}", ,, ., {, instr, ., kind, ., c_token, (, ), }, ), ;, try, self, ., output_rvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, }, else, {, try, self, ., output_rvalue, (, instr, ., src1, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, try, self, ., writer, ., print, (, " {s} ", ,, ., {, instr, ., kind, ., c_token, (, ), }, ), ;, try, self, ., output_rvalue, (, instr, ., src2, .?, ,, instr, ., kind, ., precedence, (, ), ), ;, }, try, self, ., writer, ., print, (, ";\n", ,, ., {, }, ), ;, }, fn, output_vtable_impl, (, self, :, *, Self, ,, impl, :, *, ast_, ., AST, ), CodeGen_Error, !, void, {, const, impl_module, =, impl, ., scope, (, ), .?, ., module, .?, ;, try, self, ., writer, ., print, (, "{s}__{s}_{}__vtable", ,, ., {, impl_module, ., package_name, ,, impl_module, ., name, (, ), ,, impl, ., scope, (, ), .?, ., uid, }, ), ;, }, const, std, =, @, import, (, "std", ), ;, const, Source_Emitter, =, @, import, (, "source_emitter.zig", ), ;, const, Header_Emitter, =, @, import, (, "header_emitter.zig", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, module_, =, @, import, (, "../hierarchy/module.zig", ), ;, const, Interned_String_Set, =, @, import, (, "../ir/interned_string_set.zig", ), ;, const, Self, =, @, This, (, ), ;, module, :, *, module_, ., Module, ,, source_emitter, :, Source_Emitter, ,, header_emitter, :, Header_Emitter, ,, header_writer, :, *, std, ., array_list, ., Managed, (, u8, ), ,, pub, const, CodeGen_Error, =, error, {, WriteFailed, ,, OutOfMemory, }, ;, pub, fn, init, (, module, :, *, module_, ., Module, ,, module_interned_strings, :, *, const, std, ., AutoArrayHashMap, (, u32, ,, *, Interned_String_Set, ), ,, source_writer, :, *, std, ., array_list, ., Managed, (, u8, ), ,, header_writer, :, *, std, ., array_list, ., Managed, (, u8, ), ,, ), Self, {, const, source_emitter, =, Source_Emitter, ., init, (, module, ,, module_interned_strings, ,, source_writer, ), ;, const, header_emitter, =, Header_Emitter, ., init, (, module, ,, header_writer, ), ;, return, Self, {, ., module, =, module, ,, ., source_emitter, =, source_emitter, ,, ., header_emitter, =, header_emitter, ,, ., header_writer, =, header_writer, ,, }, ;, }, pub, fn, generate, (, self, :, *, Self, ), CodeGen_Error, !, void, {, try, self, ., source_emitter, ., output_header_include, (, ), ;, try, self, ., source_emitter, ., emitter, ., forall_functions, (, &, self, ., source_emitter, ,, self, ., module, ., cfgs, ., items, ,, "Monomorphed function declarations", ,, Source_Emitter, ., output_monomprphed_decl, ), ;, try, self, ., source_emitter, ., emitter, ., forall_functions, (, &, self, ., source_emitter, ,, self, ., module, ., cfgs, ., items, ,, "Monomorphed function definitions", ,, Source_Emitter, ., output_monomprphed_def, ), ;, for, (, self, ., module, ., tests, ., items, ), |, @, "test", |, {, try, self, ., source_emitter, ., output_function_definition, (, @, "test", ), ;, }, try, self, ., output_test_include_guard_begin, (, ), ;, for, (, self, ., module, ., tests, ., items, ), |, @, "test", |, {, try, self, ., header_emitter, ., output_forward_function, (, @, "test", ), ;, }, try, self, ., header_emitter, ., output_include_guard_end, (, ), ;, }, pub, fn, output_test_include_guard_begin, (, self, :, *, Self, ), CodeGen_Error, !, void, {, var, guard_macro, =, String, ., init, (, std, ., heap, ., page_allocator, ), ;, defer, guard_macro, ., deinit, (, ), ;, var, guard_macro_writer, =, guard_macro, ., writer, (, &, ., {, }, ), ;, const, guard_macro_writer_intfc, =, &, guard_macro_writer, ., interface, ;, try, guard_macro_writer_intfc, ., print, (, "{s}__{s}__TESTS_H", ,, ., {, self, ., module, ., package_name, ,, self, ., module, ., name, (, ), }, ), ;, guard_macro, ., toUppercase, (, ), ;, try, self, ., header_writer, ., print, (, \, \, /, *, Code, generated, using, the, Orange, compiler, http, :, \, \, \, \, #, ifndef, {, 0s, }, \, \, #, define, {, 0s, }, \, \, \, \, #, include, "{1s}-{2s}.h", \, \, \, \, ,, ., {, guard_macro, ., str, (, ), ,, self, ., module, ., package_name, ,, self, ., module, ., name, (, ), }, ), ;, }, const, std, =, @, import, (, "std", ), ;, const, Emitter, =, @, import, (, "emitter.zig", ), ;, const, Dependency_Node, =, @, import, (, "../types/dependency_node.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Canonical_Type_Fmt, =, @, import, (, "../types/canonical_type_fmt.zig", ), ;, const, Self, =, @, This, (, ), ;, emitter, :, Emitter, ,, dep, :, *, Dependency_Node, ,, writer, :, *, std, ., array_list, ., Managed, (, u8, ), ,, pub, const, CodeGen_Error, =, error, {, WriteFailed, ,, OutOfMemory, }, ;, pub, fn, init, (, dep, :, *, Dependency_Node, ,, writer, :, *, std, ., array_list, ., Managed, (, u8, ), ), Self, {, const, emitter, =, Emitter, ., init, (, writer, ), ;, return, Self, {, ., emitter, =, emitter, ,, ., dep, =, dep, ,, ., writer, =, writer, }, ;, }, pub, fn, generate, (, self, :, *, Self, ), CodeGen_Error, !, void, {, try, self, ., output_include_guard_begin, (, ), ;, try, self, ., output_dependencies, (, ), ;, try, self, ., output_typedef, (, ), ;, try, self, ., output_include_guard_end, (, ), ;, }, fn, output_include_guard_begin, (, self, :, *, Self, ), CodeGen_Error, !, void, {, try, self, ., writer, ., print, (, \, \, /, *, Code, generated, using, the, Orange, compiler, http, :, \, \, \, \, #, ifndef, {, 0f, }, _H, \, \, #, define, {, 0f, }, _H, \, \, \, \, ,, ., {, Canonical_Type_Fmt, {, ., type, =, self, ., dep, ., base, ,, ., case, =, ., upper, }, }, ), ;, }, fn, output_dependencies, (, self, :, *, Self, ), CodeGen_Error, !, void, {, for, (, self, ., dep, ., dependencies, ., items, ), |, depen, |, {, switch, (, depen, ., base, .*, ), {, ., struct_type, ,, ., context_type, ,, ., tuple_type, ,, ., array_of, ,, ., enum_type, ,, ., dyn_type, ,, =>, {, try, self, ., writer, ., print, (, "struct {f};\n", ,, ., {, Canonical_Type_Fmt, {, ., type, =, depen, ., base, }, }, ), ;, }, ,, ., untagged_sum_type, =>, try, self, ., writer, ., print, (, "union {f};\n", ,, ., {, Canonical_Type_Fmt, {, ., type, =, depen, ., base, }, }, ), ,, else, =>, {, }, ,, }, }, if, (, self, ., dep, ., dependencies, ., items, ., len, >, 0, ), {, try, self, ., writer, ., print, (, "\n", ,, ., {, }, ), ;, }, }, fn, output_include_guard_end, (, self, :, *, Self, ), CodeGen_Error, !, void, {, try, self, ., writer, ., print, (, \, \, #, endif, \, \, ,, ., {, }, ), ;, }, fn, output_typedef, (, self, :, *, Self, ), CodeGen_Error, !, void, {, if, (, self, ., dep, ., base, .*, ==, ., function, ), {, const, has_contexts, =, self, ., dep, ., base, ., function, ., contexts, ., items, ., len, >, 0, ;, const, has_params, =, self, ., dep, ., base, ., function, ., args, ., items, ., len, >, 0, ;, try, self, ., writer, ., print, (, "typedef ", ,, ., {, }, ), ;, try, self, ., emitter, ., output_type, (, self, ., dep, ., base, ., rhs, (, ), ), ;, try, self, ., writer, ., print, (, "(*{f})(", ,, ., {, Canonical_Type_Fmt, {, ., type, =, self, ., dep, ., base, }, }, ), ;, for, (, self, ., dep, ., base, ., function, ., args, ., items, ,, 0.., ), |, arg, ,, i, |, {, if, (, !, arg, ., is_c_void_type, (, ), ), {, try, self, ., emitter, ., output_type, (, arg, ), ;, if, (, i, +, 1, <, self, ., dep, ., base, ., function, ., args, ., items, ., len, and, !, self, ., dep, ., base, ., function, ., args, ., items, [, i, +, 1, ], ., is_c_void_type, (, ), ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, }, }, if, (, has_contexts, ), {, if, (, has_params, ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, for, (, self, ., dep, ., base, ., function, ., contexts, ., items, ,, 0.., ), |, ctx, ,, i, |, {, try, self, ., emitter, ., output_type, (, ctx, ), ;, if, (, i, +, 1, <, self, ., dep, ., base, ., function, ., contexts, ., items, ., len, ), {, try, self, ., writer, ., print, (, ", ", ,, ., {, }, ), ;, }, }, }, try, self, ., writer, ., print, (, ");\n\n", ,, ., {, }, ), ;, }, else, if, (, self, ., dep, ., base, .*, ==, ., struct_type, or, self, ., dep, ., base, .*, ==, ., tuple_type, or, self, ., dep, ., base, .*, ==, ., context_type, ), {, try, self, ., writer, ., print, (, "struct {f} {{\n", ,, ., {, Canonical_Type_Fmt, {, ., type, =, self, ., dep, ., base, }, }, ), ;, try, self, ., output_field_list, (, self, ., dep, ., base, ., children, (, ), ,, 4, ), ;, try, self, ., writer, ., print, (, "}};\n\n", ,, ., {, }, ), ;, }, else, if, (, self, ., dep, ., base, .*, ==, ., array_of, ), {, try, self, ., writer, ., print, (, "struct {f} {{\n    ", ,, ., {, Canonical_Type_Fmt, {, ., type, =, self, ., dep, ., base, }, }, ), ;, try, self, ., emitter, ., output_type, (, self, ., dep, ., base, ., child, (, ), ), ;, try, self, ., writer, ., print, (, " _0[{}];\n", ,, ., {, self, ., dep, ., base, ., array_of, ., len, ., int, ., data, }, ), ;, try, self, ., writer, ., print, (, "}};\n\n", ,, ., {, }, ), ;, }, else, if, (, self, ., dep, ., base, .*, ==, ., enum_type, ), {, try, self, ., writer, ., print, (, "struct {f} {{\n    uint64_t tag;\n", ,, ., {, Canonical_Type_Fmt, {, ., type, =, self, ., dep, ., base, }, }, ), ;, if, (, !, self, ., dep, ., base, ., enum_type, ., is_all_unit, (, ), ), {, try, self, ., writer, ., print, (, "    union {{\n", ,, ., {, }, ), ;, try, self, ., output_field_list, (, self, ., dep, ., base, ., children, (, ), ,, 8, ), ;, try, self, ., writer, ., print, (, "    }};\n", ,, ., {, }, ), ;, }, try, self, ., writer, ., print, (, "}};\n\n", ,, ., {, }, ), ;, }, else, if, (, self, ., dep, ., base, .*, ==, ., untagged_sum_type, ), {, try, self, ., writer, ., print, (, "union {f} {{\n", ,, ., {, Canonical_Type_Fmt, {, ., type, =, self, ., dep, ., base, }, }, ), ;, if, (, !, self, ., dep, ., base, ., child, (, ), ., expand_identifier, (, ), ., enum_type, ., is_all_unit, (, ), ), {, try, self, ., output_field_list, (, self, ., dep, ., base, ., children, (, ), ,, 4, ), ;, }, try, self, ., writer, ., print, (, "}};\n\n", ,, ., {, }, ), ;, }, else, if, (, self, ., dep, ., base, .*, ==, ., dyn_type, ), {, const, trait_symbol, =, self, ., dep, ., base, ., child, (, ), ., symbol, (, ), .?, ;, try, self, ., writer, ., print, (, "struct {f} {{\n    void* data_ptr;\n    const struct vtable_{s}__{s}__{}_{s}* vtable;\n}};\n\n", ,, ., {, Canonical_Type_Fmt, {, ., type, =, self, ., dep, ., base, }, ,, trait_symbol, ., scope, ., module, .?, ., package_name, ,, trait_symbol, ., scope, ., module, .?, ., name, (, ), ,, trait_symbol, ., scope, ., uid, ,, trait_symbol, ., name, ,, }, ), ;, }, else, {, std, ., debug, ., panic, (, "cannot output typedef for typekind {t}", ,, ., {, self, ., dep, ., base, .*, }, ), ;, }, }, fn, output_field_list, (, self, :, *, Self, ,, fields, :, *, const, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, spaces, :, usize, ), CodeGen_Error, !, void, {, for, (, fields, ., items, ,, 0.., ), |, term, ,, i, |, {, if, (, !, term, ., is_c_void_type, (, ), ), {, for, (, 0..spaces, ), |, _, |, {, try, self, ., writer, ., print, (, " ", ,, ., {, }, ), ;, }, try, self, ., emitter, ., output_type, (, term, ), ;, try, self, ., writer, ., print, (, " _{};\n", ,, ., {, i, }, ), ;, }, }, }, const, std, =, @, import, (, "std", ), ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, CFG_Store, =, @, import, (, "../ir/cfg_store.zig", ), ;, const, core_, =, @, import, (, "core.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Interned_String_Set, =, @, import, (, "../ir/interned_string_set.zig", ), ;, const, Module, =, @, import, (, "../hierarchy/module.zig", ), ., Module, ;, const, Module_Iterator, =, @, import, (, "../util/dfs.zig", ), ., Dfs_Iterator, (, *, Module, ), ;, const, Package, =, @, import, (, "../hierarchy/package.zig", ), ;, const, Package_Iterator, =, @, import, (, "../util/dfs.zig", ), ., Dfs_Iterator, (, Package_Iterator_Node, ), ;, const, Package_Iterator_Node, =, @, import, (, "../hierarchy/package.zig", ), ., Package_Iterator_Node, ;, const, poison_, =, @, import, (, "../ast/poison.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, repo_, =, @, import, (, "../util/repo.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Scope, =, @, import, (, "../symbol/scope.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Validate_Module, =, @, import, (, "../semantic/module_validate.zig", ), ;, const, Validate_Scope, =, @, import, (, "../semantic/scope_validate.zig", ), ;, const, Validate_Symbol, =, @, import, (, "../semantic/symbol_validate.zig", ), ;, const, Validate_Type, =, @, import, (, "../types/type_validate.zig", ), ;, const, Validate_Pattern, =, @, import, (, "../semantic/pattern_validate.zig", ), ;, const, Typecheck, =, @, import, (, "../semantic/typecheck.zig", ), ;, const, Self, =, @, This, (, ), ;, const, Error, :, type, =, error, {, LexerError, ,, ParseError, ,, CompileError, ,, FileNotFound, ,, OutOfMemory, ,, MakeDirError, ,, }, ;, arena, :, std, ., heap, ., ArenaAllocator, ,, errors, :, errs_, ., Errors, ,, stderr, :, ?, std, ., fs, ., File, ,, prelude, :, *, Scope, ,, core, :, ?, *, Scope, ,, modules, :, std, ., StringArrayHashMap, (, *, Symbol, ), ,, cfg_store, :, CFG_Store, ,, validate_module, :, Validate_Module, ,, validate_scope, :, Validate_Scope, ,, validate_symbol, :, Validate_Symbol, ,, validate_type, :, Validate_Type, ,, validate_pattern, :, Validate_Pattern, ,, typecheck, :, Typecheck, ,, module_interned_strings, :, std, ., AutoArrayHashMap, (, u32, ,, *, Interned_String_Set, ), ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, pub, fn, init, (, stderr, :, ?, std, ., fs, ., File, ,, alloc, :, std, ., mem, ., Allocator, ), Error, !, *, Self, {, var, retval, :, *, Self, =, try, alloc, ., create, (, Self, ), ;, retval, ., arena, =, std, ., heap, ., ArenaAllocator, ., init, (, alloc, ), ;, repo_, ., ensure_inc_dir_exists, (, retval, ., allocator, (, ), ), ;, poison_, ., init_structures, (, retval, ., allocator, (, ), ), ;, retval, ., errors, =, errs_, ., Errors, ., init, (, retval, ., allocator, (, ), ), ;, retval, ., module_interned_strings, =, std, ., AutoArrayHashMap, (, u32, ,, *, Interned_String_Set, ), ., init, (, retval, ., allocator, (, ), ), ;, retval, ., modules, =, std, ., StringArrayHashMap, (, *, Symbol, ), ., init, (, retval, ., allocator, (, ), ), ;, retval, ., packages, =, std, ., StringArrayHashMap, (, *, Package, ), ., init, (, retval, ., allocator, (, ), ), ;, retval, ., core, =, null, ;, retval, ., stderr, =, stderr, ;, retval, ., cfg_store, =, CFG_Store, ., init, (, retval, ), ;, retval, ., validate_module, =, Validate_Module, ., init, (, retval, ), ;, retval, ., validate_scope, =, Validate_Scope, ., init, (, retval, ), ;, retval, ., validate_symbol, =, Validate_Symbol, ., init, (, retval, ), ;, retval, ., validate_type, =, Validate_Type, ., init, (, retval, ), ;, retval, ., validate_pattern, =, Validate_Pattern, ., init, (, retval, ), ;, retval, ., typecheck, =, Typecheck, ., init, (, retval, ), ;, retval, ., prelude, =, try, prelude_, ., get_prelude_scope, (, retval, ), ;, retval, ., core, =, core_, ., get_core_scope, (, retval, ), catch, |, e, |, {, if, (, stderr, ==, null, ), return, e, ;, var, writer, =, stderr, .?, ., writer, (, &, ., {, }, ), ., interface, ;, retval, ., errors, ., print_errors, (, &, writer, ,, ., {, }, ), ;, return, e, ;, }, ;, try, retval, ., register_package, (, core_, ., core_package_name, ,, ., static_library, ), ;, const, core_module_symbol, =, retval, ., lookup_module, (, retval, ., core, .?, ., module, .?, ., absolute_path, ), .?, ;, retval, ., set_package_root, (, core_, ., core_package_name, ,, core_module_symbol, ), ;, return, retval, ;, }, pub, fn, deinit, (, self, :, *, Self, ), void, {, if, (, self, ., stderr, ), |, stderr, |, {, var, writer, =, stderr, ., writer, (, &, ., {, }, ), ;, const, writer_intfc, =, &, writer, ., interface, ;, self, ., errors, ., print_errors, (, writer_intfc, ,, ., {, }, ), ;, }, poison_, ., deinit, (, ), ;, self, ., arena, ., deinit, (, ), ;, self, ., arena, ., child_allocator, ., destroy, (, self, ), ;, }, pub, fn, allocator, (, self, :, *, Self, ), std, ., mem, ., Allocator, {, return, self, ., arena, ., allocator, (, ), ;, }, pub, fn, compile_build_file, (, self, :, *, Self, ,, absolute_path, :, [, ], const, u8, ), Error, !, *, CFG, {, const, build_module, =, try, self, ., compile_module, (, absolute_path, ,, "build", ,, false, ), ;, return, build_module, ., init_value, (, ), .?, ., scope, (, ), .?, ., lookup, (, "build", ,, ., {, }, ), ., found, ., cfg, .?, ;, }, pub, fn, compile_module, (, self, :, *, Self, ,, absolute_path, :, [, ], const, u8, ,, entry_name, :, ?, [, ], const, u8, ,, fuzz_tokens, :, bool, ,, ), Error, !, *, Symbol, {, if, (, self, ., modules, ., get, (, absolute_path, ), ), |, module, |, {, return, module, ;, }, const, module, =, Module, ., load_from_filename, (, absolute_path, ,, entry_name, ,, fuzz_tokens, ,, self, ), catch, |, err, |, {, switch, (, err, ), {, error, ., LexerError, ,, error, ., ParseError, ,, error, ., FileNotFound, ,, error, ., OutOfMemory, ,, =>, {, return, err, ;, }, ,, error, ., CompileError, ,, =>, if, (, !, fuzz_tokens, ), {, return, err, ;, }, else, {, return, err, ;, }, ,, }, }, ;, return, self, ., lookup_module, (, module, ., absolute_path, ), .?, ;, }, pub, fn, lookup_module, (, self, :, *, Self, ,, absolute_path, :, [, ], const, u8, ), ?, *, Symbol, {, return, self, ., modules, ., get, (, absolute_path, ), ;, }, pub, fn, register_module, (, self, :, *, Self, ,, absolute_path, :, [, ], const, u8, ,, module, :, *, Symbol, ), !, void, {, try, self, ., modules, ., put, (, absolute_path, ,, module, ), ;, }, pub, fn, module_scope, (, self, :, *, Self, ,, absolute_path, :, [, ], const, u8, ), ?, *, Scope, {, const, module_symbol, =, self, ., lookup_module, (, absolute_path, ), orelse, return, null, ;, return, module_symbol, ., init_value, (, ), .?, ., scope, (, ), ;, }, pub, fn, register_interned_string_set, (, self, :, *, Self, ,, module_uid, :, u32, ), !, void, {, const, interned_strings, =, try, self, ., allocator, (, ), ., create, (, Interned_String_Set, ), ;, interned_strings, .*, =, Interned_String_Set, ., init, (, module_uid, ,, self, ., allocator, (, ), ), ;, try, self, ., module_interned_strings, ., put, (, module_uid, ,, interned_strings, ), ;, }, pub, fn, get_core_symbol, (, self, :, *, Self, ,, name, :, [, ], const, u8, ), *, Symbol, {, const, prelude_abs_path, =, self, ., core, .?, ., module, .?, ., absolute_path, ;, return, self, ., module_scope, (, prelude_abs_path, ), .?, ., lookup, (, name, ,, ., {, }, ), ., found, ;, }, pub, fn, get_core_type, (, self, :, *, Self, ,, name, :, [, ], const, u8, ), *, Type_AST, {, return, self, ., get_core_symbol, (, name, ), ., init_typedef, (, ), .?, ;, }, pub, fn, lookup_interned_string_set, (, self, :, *, Self, ,, module_uid, :, u32, ), ?, *, Interned_String_Set, {, return, self, ., module_interned_strings, ., get, (, module_uid, ), ;, }, pub, fn, lookup_package, (, self, :, *, Self, ,, package_absolute_path, :, [, ], const, u8, ), ?, *, Package, {, std, ., debug, ., assert, (, std, ., fs, ., path, ., isAbsolute, (, package_absolute_path, ), ), ;, return, self, ., packages, ., get, (, package_absolute_path, ), ;, }, pub, fn, lookup_package_root_module, (, self, :, *, Self, ,, package_absolute_path, :, [, ], const, u8, ,, requirement_name, :, [, ], const, u8, ), ?, *, Symbol, {, const, package, =, self, ., lookup_package, (, package_absolute_path, ), ;, if, (, package, ==, null, ), {, return, null, ;, }, return, package, .?, ., requirements, ., get, (, requirement_name, ), ;, }, pub, fn, register_package, (, self, :, *, Self, ,, package_absolute_path, :, [, ], const, u8, ,, kind, :, Package, ., Package_Kind, ), !, void, {, if, (, self, ., lookup_package, (, package_absolute_path, ), ==, null, ), {, const, package, =, Package, ., new, (, self, ., allocator, (, ), ,, package_absolute_path, ,, kind, ), ;, try, self, ., packages, ., put, (, package_absolute_path, ,, package, ), ;, if, (, !, std, ., mem, ., eql, (, u8, ,, package_absolute_path, ,, core_, ., core_package_name, ), ), {, try, self, ., make_package_requirement_link, (, package_absolute_path, ,, "core", ,, core_, ., core_package_name, ), ;, }, }, }, pub, fn, make_package_requirement_link, (, self, :, *, Self, ,, package_absolute_path, :, [, ], const, u8, ,, requirement_name, :, [, ], const, u8, ,, requirement_absolute_path, :, [, ], const, u8, ), !, void, {, const, package, =, self, ., lookup_package, (, package_absolute_path, ), .?, ;, const, requirement, =, self, ., lookup_package, (, requirement_absolute_path, ), .?, ;, try, package, ., requirements, ., put, (, requirement_name, ,, requirement, ., root, ), ;, }, pub, fn, set_package_root, (, self, :, *, Self, ,, package_absolute_path, :, [, ], const, u8, ,, root, :, *, Symbol, ), void, {, const, package, =, self, ., lookup_package, (, package_absolute_path, ), .?, ;, package, ., root, =, root, ;, }, pub, fn, propagate_include_directories, (, self, :, *, Self, ,, root_package_absolute_path, :, [, ], const, u8, ), void, {, const, package, =, self, ., lookup_package, (, root_package_absolute_path, ), .?, ;, package, ., append_include_dir, (, self, ., packages, ,, &, package, ., include_directories, ), ;, }, pub, fn, set_package_kind, (, self, :, *, Self, ,, package_absolute_path, :, [, ], const, u8, ,, kind, :, Package, ., Package_Kind, ), !, void, {, const, package, =, self, ., lookup_package, (, package_absolute_path, ), .?, ;, package, ., kind, =, kind, ;, try, package, ., set_executable_name, (, self, ., allocator, (, ), ), ;, }, pub, fn, clean_package, (, self, :, *, Self, ,, package_absolute_path, :, [, ], const, u8, ), void, {, var, dfs_iter, :, Package_Iterator, =, Package_Iterator, ., init, (, Package_Iterator_Node, ., init, (, self, ,, package_absolute_path, ), ,, self, ., allocator, (, ), ), ;, defer, dfs_iter, ., deinit, (, ), ;, while, (, dfs_iter, ., next, (, ), ), |, package_node, |, {, const, build_path, =, package_node, ., package, ., get_build_path, (, self, ., allocator, (, ), ), ;, std, ., fs, ., deleteTreeAbsolute, (, build_path, ), catch, |, err, |, switch, (, err, ), {, error, ., FileNotFound, =>, {, }, ,, else, =>, std, ., debug, ., panic, (, "{}\n", ,, ., {, err, }, ), ,, }, ;, }, }, pub, fn, collect_package_local_modules, (, self, :, *, Self, ), !, void, {, for, (, self, ., packages, ., keys, (, ), ), |, package_name, |, {, const, package, =, self, ., lookup_package, (, package_name, ), .?, ;, const, module, =, package, ., root, ., init_value, (, ), .?, ., module, ., module, ;, var, dfs_iter, :, Module_Iterator, =, Module_Iterator, ., init, (, module, ,, self, ., allocator, (, ), ), ;, defer, dfs_iter, ., deinit, (, ), ;, while, (, dfs_iter, ., next, (, ), ), |, next_module, |, {, if, (, std, ., mem, ., eql, (, u8, ,, next_module, ., name, (, ), ,, "core", ), and, !, std, ., mem, ., eql, (, u8, ,, package, ., name, ,, "core", ), ), {, continue, ;, }, try, package, ., local_modules, ., append, (, next_module, ), ;, }, }, }, pub, fn, collect_types, (, self, :, *, Self, ), void, {, for, (, self, ., packages, ., keys, (, ), ), |, package_name, |, {, const, package, =, self, ., lookup_package, (, package_name, ), .?, ;, package, ., collect_package_types, (, ), ;, }, }, pub, fn, determine_if_modified, (, self, :, *, Self, ,, root_package_absolute_path, :, [, ], const, u8, ), !, void, {, const, package, =, self, ., lookup_package, (, root_package_absolute_path, ), .?, ;, try, package, ., determine_if_package_modified, (, self, ., packages, ,, self, ), ;, }, pub, fn, compile, (, self, :, *, Self, ,, root_package_absolute_path, :, [, ], const, u8, ), !, void, {, const, package, =, self, ., lookup_package, (, root_package_absolute_path, ), .?, ;, try, package, ., output, (, self, ., packages, ,, self, ., allocator, (, ), ), ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, module_, =, @, import, (, "../hierarchy/module.zig", ), ;, const, prelude_, =, @, import, (, "prelude.zig", ), ;, const, repo_, =, @, import, (, "../util/repo.zig", ), ;, const, Scope, =, @, import, (, "../symbol/scope.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, UID_Gen, =, @, import, (, "../util/uid_gen.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, pub, var, package_type, :, *, Type_AST, =, undefined, ;, pub, var, package_source_type, :, *, Type_AST, =, undefined, ;, pub, var, test_result_type, :, *, Type_AST, =, undefined, ;, pub, var, test_type, :, *, Type_AST, =, undefined, ;, pub, var, allocating_context, :, *, Type_AST, =, undefined, ;, pub, var, io_context, :, *, Type_AST, =, undefined, ;, pub, var, args_context, :, *, Type_AST, =, undefined, ;, pub, var, file_io_context, :, *, Type_AST, =, undefined, ;, var, core, :, ?, *, Scope, =, null, ;, pub, var, core_symbol, :, ?, *, Symbol, =, null, ;, pub, var, core_package_name, :, [, ], const, u8, =, undefined, ;, pub, fn, get_core_scope, (, compiler, :, *, Compiler_Context, ), !, *, Scope, {, if, (, core, ==, null, ), {, try, create_core, (, compiler, ), ;, }, return, core, .?, ;, }, pub, fn, deinit, (, ), void, {, core, =, null, ;, }, fn, create_core, (, compiler, :, *, Compiler_Context, ), !, void, {, var, uid_gen, =, UID_Gen, ., init, (, ), ;, repo_, ., ensure_packages_dir_exists, (, compiler, ., allocator, (, ), ), ;, core_package_name, =, repo_, ., get_repo_dir, (, "core", ,, compiler, ., allocator, (, ), ), ;, _, =, std, ., fs, ., openDirAbsolute, (, core_package_name, ,, ., {, }, ), catch, {, std, ., fs, ., makeDirAbsolute, (, core_package_name, ), catch, return, error, ., MakeDirError, ;, }, ;, var, core_module_abs_path, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, compiler, ., allocator, (, ), ), ;, try, core_module_abs_path, ., print, (, "{s}{c}core.orng", ,, ., {, core_package_name, ,, std, ., fs, ., path, ., sep, }, ), ;, const, module, =, try, module_, ., Module, ., init, (, try, core_module_abs_path, ., toOwnedSlice, (, ), ,, compiler, ., allocator, (, ), ), ;, core, =, Scope, ., init, (, compiler, ., prelude, ,, &, uid_gen, ,, compiler, ., allocator, (, ), ), ;, core_symbol, =, Symbol, ., init, (, compiler, ., prelude, ,, "core", ,, ast_, ., AST, ., create_module, (, Token, ., init_simple, (, "core", ), ,, core, .?, ,, module, ,, compiler, ., allocator, (, ), ,, ), ,, ., module, ,, ., local, ,, compiler, ., allocator, (, ), ,, ), ;, try, compiler, ., prelude, ., put_symbol, (, core_symbol, .?, ,, &, compiler, ., errors, ), ;, core, .?, ., module, =, module, ;, const, contents, :, [, ], const, u8, =, @, embedFile, (, "core.orng", ), ;, try, module_, ., Module, ., fill_contents, (, contents, ,, "core.orng", ,, null, ,, core, .?, ,, module, ,, core_symbol, .?, ,, false, ,, compiler, ,, ), ;, const, module_scope, =, compiler, ., module_scope, (, module, ., absolute_path, ), .?, ;, package_type, =, module_scope, ., lookup, (, "Package", ,, ., {, }, ), ., found, ., init_typedef, (, ), .?, ;, package_source_type, =, module_scope, ., lookup, (, "Package_Source", ,, ., {, }, ), ., found, ., init_typedef, (, ), .?, ;, test_result_type, =, module_scope, ., lookup, (, "Test_Result", ,, ., {, }, ), ., found, ., init_typedef, (, ), .?, ;, const, args, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, compiler, ., allocator, (, ), ), ;, test_type, =, Type_AST, ., create_function, (, test_result_type, ., token, (, ), ,, args, ,, test_result_type, ,, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, compiler, ., allocator, (, ), ), ,, compiler, ., allocator, (, ), ,, ), ;, allocating_context, =, module_scope, ., lookup, (, "Allocating", ,, ., {, }, ), ., found, ., init_typedef, (, ), .?, ;, io_context, =, module_scope, ., lookup, (, "IO", ,, ., {, }, ), ., found, ., init_typedef, (, ), .?, ;, args_context, =, module_scope, ., lookup, (, "Args", ,, ., {, }, ), ., found, ., init_typedef, (, ), .?, ;, file_io_context, =, module_scope, ., lookup, (, "File_IO", ,, ., {, }, ), ., found, ., init_typedef, (, ), .?, ;, _, =, module_scope, ., lookup, (, "Requirement", ,, ., {, }, ), ., found, ., init_typedef, (, ), .?, ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, Cfg_Iterator, =, @, import, (, "../util/dfs.zig", ), ., Dfs_Iterator, (, *, CFG, ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Instruction, =, @, import, (, "../ir/instruction.zig", ), ;, const, pipeline_, =, @, import, (, "../util/pipeline.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Scope, =, @, import, (, "../symbol/scope.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Module_Hash, =, @, import, (, "module_hash.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Type_Set, =, @, import, (, "../types/type_set.zig", ), ;, const, UID_Gen, =, @, import, (, "../util/uid_gen.zig", ), ;, const, Read_File, =, @, import, (, "../lexer/read_file.zig", ), ;, const, Hash, =, @, import, (, "../lexer/hash.zig", ), ;, const, Split_Lines, =, @, import, (, "../lexer/split_lines.zig", ), ;, const, Tokenize, =, @, import, (, "../lexer/tokenize.zig", ), ;, const, Apply_Layout, =, @, import, (, "../lexer/apply_layout.zig", ), ;, const, Parse, =, @, import, (, "../parser/parse.zig", ), ;, const, Apply_Ast_Walk, =, @, import, (, "../ast/walker.zig", ), ., Apply_Ast_Walk, ;, const, Apply_Flat_Ast_Walk, =, @, import, (, "../ast/walker.zig", ), ., Apply_Flat_Ast_Walk, ;, const, Expand, =, @, import, (, "../ast/expand.zig", ), ;, const, Import, =, @, import, (, "../ast/import.zig", ), ;, const, Cinclude, =, @, import, (, "../ast/cinclude.zig", ), ;, const, Symbol_Tree, =, @, import, (, "../ast/symbol-tree.zig", ), ;, const, Decorate, =, @, import, (, "../ast/decorate.zig", ), ;, const, Type_Decorate, =, @, import, (, "../ast/type_decorate.zig", ), ;, pub, const, Module_Errors, =, error, {, OutOfMemory, ,, LexerError, ,, ParseError, ,, CompileError, ,, FileNotFound, }, ;, pub, const, Module_UID, :, type, =, u32, ;, var, module_uids, :, Module_UID, =, 0, ;, pub, const, Module, =, struct, {, uid, :, Module_UID, ,, uid_gen, :, UID_Gen, ,, absolute_path, :, [, ], const, u8, ,, package_name, :, [, ], const, u8, ,, local_imported_modules, :, std, ., AutoArrayHashMap, (, *, Module, ,, void, ), ,, cincludes, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, instructions, :, std, ., array_list, ., Managed, (, *, Instruction, ), ,, cfgs, :, std, ., array_list, ., Managed, (, *, CFG, ), ,, entry, :, ?, *, CFG, ,, traits, :, std, ., array_hash_map, ., AutoArrayHashMap, (, *, ast_, ., AST, ,, void, ), ,, impls, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, tests, :, std, ., array_list, ., Managed, (, *, CFG, ), ,, type_set, :, Type_Set, ,, allocator, :, std, ., mem, ., Allocator, ,, hash, :, u64, ,, modified, :, ?, bool, ,, pub, fn, init, (, absolute_path, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), !, *, Module, {, var, retval, =, try, allocator, ., create, (, Module, ), ;, retval, ., uid, =, module_uids, ;, retval, ., uid_gen, =, UID_Gen, ., init, (, ), ;, module_uids, +=, 1, ;, std, ., debug, ., assert, (, std, ., fs, ., path, ., isAbsolute, (, absolute_path, ), ), ;, retval, ., absolute_path, =, absolute_path, ;, retval, ., package_name, =, std, ., fs, ., path, ., basename, (, std, ., fs, ., path, ., dirname, (, absolute_path, ), .?, ), ;, retval, ., allocator, =, allocator, ;, retval, ., local_imported_modules, =, std, ., AutoArrayHashMap, (, *, Module, ,, void, ), ., init, (, allocator, ), ;, retval, ., cincludes, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, allocator, ), ;, retval, ., instructions, =, std, ., array_list, ., Managed, (, *, Instruction, ), ., init, (, allocator, ), ;, retval, ., traits, =, std, ., array_hash_map, ., AutoArrayHashMap, (, *, ast_, ., AST, ,, void, ), ., init, (, allocator, ), ;, retval, ., impls, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, allocator, ), ;, retval, ., tests, =, std, ., array_list, ., Managed, (, *, CFG, ), ., init, (, allocator, ), ;, retval, ., cfgs, =, std, ., array_list, ., Managed, (, *, CFG, ), ., init, (, allocator, ), ;, retval, ., type_set, =, Type_Set, ., init, (, allocator, ), ;, retval, ., entry, =, null, ;, retval, ., modified, =, null, ;, return, retval, ;, }, pub, fn, load_from_filename, (, absolute_path, :, [, ], const, u8, ,, entry_name, :, ?, [, ], const, u8, ,, fuzz_tokens, :, bool, ,, compiler, :, *, Compiler_Context, ,, ), Module_Errors, !, *, Module, {, {, var, file, =, std, ., fs, ., openFileAbsolute, (, absolute_path, ,, ., {, }, ), catch, |, err, |, switch, (, err, ), {, error, ., FileNotFound, =>, return, error, ., FileNotFound, ,, else, =>, return, error, ., CompileError, ,, }, ;, defer, file, ., close, (, ), ;, }, const, module, =, try, Module, ., init, (, absolute_path, ,, compiler, ., allocator, (, ), ), ;, var, file_root, =, Scope, ., init, (, compiler, ., prelude, ,, &, module, ., uid_gen, ,, compiler, ., allocator, (, ), ), ;, const, symbol, =, Symbol, ., init, (, compiler, ., prelude, ,, module, ., name, (, ), ,, ast_, ., AST, ., create_module, (, Token, ., init_simple, (, module, ., name, (, ), ), ,, file_root, ,, module, ,, compiler, ., allocator, (, ), ,, ), ,, ., module, ,, ., local, ,, compiler, ., allocator, (, ), ,, ), ;, try, compiler, ., prelude, ., put_symbol, (, symbol, ,, &, compiler, ., errors, ), ;, file_root, ., module, =, module, ;, try, fill_contents_from_file, (, absolute_path, ,, entry_name, ,, file_root, ,, module, ,, symbol, ,, fuzz_tokens, ,, compiler, ), ;, return, module, ;, }, pub, fn, name, (, self, :, *, const, Module, ), [, ], const, u8, {, const, basename, =, std, ., fs, ., path, ., basename, (, self, ., absolute_path, ), ;, var, i, :, usize, =, 0, ;, while, (, i, <, basename, ., len, and, basename, [, i, ], !=, '.', ), :, (, i, +=, 1, ), {, }, return, basename, [, 0..i, ], ;, }, fn, fill_contents_from_file, (, in_name, :, [, ], const, u8, ,, entry_name, :, ?, [, ], const, u8, ,, file_root, :, *, Scope, ,, module, :, *, Module, ,, module_symbol, :, *, Symbol, ,, fuzz_tokens, :, bool, ,, compiler, :, *, Compiler_Context, ,, ), Module_Errors, !, void, {, const, read_file, =, Read_File, ., init, (, compiler, ., allocator, (, ), ), ;, const, contents, =, try, read_file, ., run, (, in_name, ), ;, return, fill_contents, (, contents, ,, in_name, ,, entry_name, ,, file_root, ,, module, ,, module_symbol, ,, fuzz_tokens, ,, compiler, ), ;, }, pub, fn, fill_contents, (, contents, :, [, ], const, u8, ,, in_name, :, [, ], const, u8, ,, entry_name, :, ?, [, ], const, u8, ,, file_root, :, *, Scope, ,, module, :, *, Module, ,, module_symbol, :, *, Symbol, ,, fuzz_tokens, :, bool, ,, compiler, :, *, Compiler_Context, ,, ), Module_Errors, !, void, {, try, compiler, ., register_interned_string_set, (, module, ., uid, ), ;, try, compiler, ., register_module, (, module, ., absolute_path, ,, module_symbol, ), ;, if, (, compiler, ., core, !=, null, ), {, try, module, ., local_imported_modules, ., put, (, compiler, ., core, .?, ., module, .?, ,, void, {, }, ), ;, const, core_import_symbol, =, Symbol, ., init, (, file_root, ,, "core", ,, ast_, ., AST, ., create_module, (, Token, ., init_simple, (, "core", ), ,, compiler, ., core, .?, ,, module, ,, compiler, ., allocator, (, ), ,, ), ,, ., {, ., import, =, ., {, ., real_name, =, "core", ,, ., real_symbol, =, compiler, ., modules, ., get, (, compiler, ., core, .?, ., module, .?, ., absolute_path, ), .?, }, }, ,, ., local, ,, compiler, ., allocator, (, ), ,, ), ;, try, file_root, ., put_symbol, (, core_import_symbol, ,, &, compiler, ., errors, ), ;, }, _, =, try, pipeline_, ., run, (, contents, ,, ., {, Hash, ., init, (, &, module, ., hash, ), ,, Split_Lines, ., init, (, &, compiler, ., errors, ,, compiler, ., allocator, (, ), ), ,, Tokenize, ., init, (, in_name, ,, 0, ,, 1, ,, &, compiler, ., errors, ,, fuzz_tokens, ,, compiler, ., allocator, (, ), ), ,, Apply_Layout, ., init, (, ), ,, Parse, ., init, (, ., top_level, ,, &, compiler, ., errors, ,, compiler, ., allocator, (, ), ), ,, Apply_Ast_Walk, (, Expand, ), ., init, (, Expand, ., new, (, &, compiler, ., errors, ,, compiler, ., allocator, (, ), ), ), ,, Apply_Flat_Ast_Walk, (, Import, ), ., init, (, Import, ., new, (, compiler, ,, module, ., get_package_abs_path, (, ), ,, &, module, ., local_imported_modules, ), ), ,, Apply_Flat_Ast_Walk, (, Cinclude, ), ., init, (, Cinclude, ., new, (, &, module, ., cincludes, ), ), ,, Apply_Ast_Walk, (, Symbol_Tree, ), ., init, (, Symbol_Tree, ., new, (, file_root, ,, &, compiler, ., errors, ,, compiler, ., allocator, (, ), ), ), ,, Apply_Ast_Walk, (, Decorate, ), ., init, (, Decorate, ., new, (, file_root, ,, compiler, ), ), ,, Apply_Ast_Walk, (, Type_Decorate, ), ., init, (, Type_Decorate, ., new, (, compiler, ), ), ,, }, ), ;, try, compiler, ., validate_module, ., validate_module, (, module, ), ;, compiler, ., module_scope, (, module, ., absolute_path, ), .?, ., collect_traits_and_impls, (, &, module, ., traits, ,, &, module, ., impls, ), ;, try, module, ., add_all_cfgs, (, entry_name, ,, compiler, ), ;, if, (, module, ., entry, ), |, entry, |, {, entry, ., assert_needed_at_runtime, (, ), ;, }, try, module, ., collect_impls_cfgs, (, compiler, ), ;, try, module, ., collect_tests, (, compiler, ), ;, module, ., collect_local_types, (, ), ;, }, fn, add_all_cfgs, (, self, :, *, Module, ,, entry_name, :, ?, [, ], const, u8, ,, compiler, :, *, Compiler_Context, ), Module_Errors, !, void, {, var, found_entry, =, false, ;, const, need_entry, =, entry_name, !=, null, ;, for, (, compiler, ., module_scope, (, self, ., absolute_path, ), .?, ., symbols, ., keys, (, ), ), |, key, |, {, const, symbol, :, *, Symbol, =, compiler, ., module_scope, (, self, ., absolute_path, ), .?, ., symbols, ., get, (, key, ), .?, ;, if, (, symbol, ., kind, !=, ., @, "fn", ), {, continue, ;, }, if, (, symbol, ., decl, .?, ., num_generic_params, (, ), >, 0, ), {, continue, ;, }, const, interned_strings, =, compiler, ., lookup_interned_string_set, (, self, ., uid, ), .?, ;, const, cfg, =, try, compiler, ., cfg_store, ., get_cfg, (, symbol, ,, interned_strings, ), ;, self, ., collect_cfgs, (, cfg, ), ;, if, (, need_entry, and, std, ., mem, ., eql, (, u8, ,, key, ,, entry_name, .?, ), ), {, self, ., entry, =, cfg, ;, found_entry, =, true, ;, const, args_, =, @, import, (, "../semantic/args.zig", ), ;, try, args_, ., validate_requested_contexts, (, cfg, ., symbol, ., type, (, ), ., function, ., contexts, ., items, ,, &, compiler, ., errors, ), ;, }, }, if, (, need_entry, and, !, found_entry, ), {, compiler, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, Span, ., phony, ,, ., msg, =, "no main function found", ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, fn, collect_cfgs, (, self, :, *, Module, ,, cfg, :, *, CFG, ), void, {, var, cfg_dfs_iter, =, Cfg_Iterator, ., init, (, cfg, ,, self, ., allocator, ), ;, while, (, cfg_dfs_iter, ., next, (, ), ), |, next_cfg, |, {, if, (, next_cfg, ., symbol, ., decl, .?, ., num_generic_params, (, ), >, 0, ), continue, ;, if, (, next_cfg, ., symbol, ., decl, .?, .*, ==, ., method_decl, and, next_cfg, ., symbol, ., decl, .?, ., method_decl, ., impl, .?, ., num_generic_params, (, ), >, 0, ), continue, ;, next_cfg, ., collect_generated_symbvers, (, ), ;, _, =, next_cfg, ., emplace_cfg, (, self, ., uid, ,, &, self, ., cfgs, ,, &, self, ., instructions, ), ;, }, }, fn, collect_local_types, (, self, :, *, Module, ), void, {, for, (, self, ., traits, ., keys, (, ), ), |, trait, |, {, for, (, trait, ., trait, ., method_decls, ., items, ), |, decl, |, {, const, @, "type", =, decl, ., method_decl, ., c_type, .?, ., expand_identifier, (, ), ;, if, (, @, "type", ., refers_to_self, (, ), ), continue, ;, _, =, self, ., type_set, ., add_type, (, decl, ., method_decl, ., c_type, .?, ., expand_identifier, (, ), ), ;, _, =, self, ., type_set, ., add_type, (, decl, ., method_decl, ., ret_type, ., expand_identifier, (, ), ), ;, }, }, for, (, self, ., cfgs, ., items, ), |, cfg, |, {, cfg, ., collect_cfg_types, (, &, self, ., type_set, ), ;, }, }, pub, fn, collect_module_types, (, self, :, *, Module, ,, type_set, :, *, Type_Set, ), void, {, type_set, ., union_from, (, &, self, ., type_set, ), ;, }, fn, collect_impls_cfgs, (, self, :, *, Module, ,, compiler, :, *, Compiler_Context, ), Module_Errors, !, void, {, for, (, self, ., impls, ., items, ), |, impl, |, {, if, (, impl, ., impl, ., instantiations, ., pairs, ., items, ., len, ==, 0, ), {, try, self, ., collect_impl_cfgs, (, impl, ,, compiler, ), ;, }, else, {, for, (, impl, ., impl, ., instantiations, ., pairs, ., items, ), |, pair, |, {, try, self, ., collect_impl_cfgs, (, pair, ., value, ,, compiler, ), ;, }, }, }, }, fn, collect_impl_cfgs, (, self, :, *, Module, ,, impl, :, *, ast_, ., AST, ,, compiler, :, *, Compiler_Context, ), Module_Errors, !, void, {, for, (, impl, ., impl, ., method_defs, ., items, ), |, def, |, {, const, symbol, =, def, ., symbol, (, ), .?, ;, const, interned_strings, =, compiler, ., lookup_interned_string_set, (, self, ., uid, ), .?, ;, const, cfg, =, try, compiler, ., cfg_store, ., get_cfg, (, symbol, ,, interned_strings, ), ;, cfg, ., assert_needed_at_runtime, (, ), ;, self, ., collect_cfgs, (, cfg, ), ;, }, }, fn, collect_tests, (, self, :, *, Module, ,, compiler, :, *, Compiler_Context, ), Module_Errors, !, void, {, var, test_asts, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, compiler, ., allocator, (, ), ), ;, compiler, ., module_scope, (, self, ., absolute_path, ), .?, ., collect_tests, (, &, test_asts, ), ;, for, (, test_asts, ., items, ), |, test_ast, |, {, const, symbol, =, test_ast, ., symbol, (, ), .?, ;, const, interned_strings, =, compiler, ., lookup_interned_string_set, (, self, ., uid, ), .?, ;, const, cfg, =, try, compiler, ., cfg_store, ., get_cfg, (, symbol, ,, interned_strings, ), ;, try, self, ., tests, ., append, (, cfg, ), ;, cfg, ., assert_needed_at_runtime, (, ), ;, self, ., collect_cfgs, (, cfg, ), ;, }, }, pub, fn, get_package_abs_path, (, self, :, *, Module, ), [, ], const, u8, {, return, std, ., fs, ., path, ., dirname, (, self, ., absolute_path, ), .?, ;, }, pub, fn, pop_cfg, (, self, :, *, Module, ,, idx, :, i64, ), void, {, _, =, self, ., cfgs, ., orderedRemove, (, @, as, (, usize, ,, @, intCast, (, idx, ), ), ), ;, }, pub, fn, get_adjacent, (, self, :, *, Module, ), [, ], *, Module, {, return, self, ., local_imported_modules, ., keys, (, ), ;, }, pub, fn, print_instructions, (, self, :, *, Module, ), void, {, for, (, self, ., instructions, ., items, ), |, instr, |, {, std, ., debug, ., print, (, "{}", ,, ., {, instr, }, ), ;, }, }, pub, fn, determine_if_module_modified, (, self, :, *, Module, ,, compiler, :, *, Compiler_Context, ), !, void, {, if, (, self, ., modified, !=, null, ), {, return, ;, }, const, package_abs_path, =, self, ., get_package_abs_path, (, ), ;, const, module_hashes, =, compiler, ., lookup_package, (, package_abs_path, ), .?, ., module_hash, ;, const, old_hash, =, module_hashes, ., get_module_stored_hash, (, self, ., name, (, ), ), ;, const, local_module_number_string, =, try, std, ., fmt, ., allocPrint, (, compiler, ., allocator, (, ), ,, "{X}", ,, ., {, self, ., hash, }, ), ;, defer, compiler, ., allocator, (, ), ., free, (, local_module_number_string, ), ;, self, ., modified, =, (, old_hash, ==, null, ), or, !, std, ., mem, ., eql, (, u8, ,, local_module_number_string, ,, old_hash, .?, ), ;, for, (, self, ., local_imported_modules, ., keys, (, ), ), |, imported_module, |, {, try, imported_module, ., determine_if_module_modified, (, compiler, ), ;, self, ., modified, =, imported_module, ., modified, .?, or, self, ., modified, .?, ;, }, }, pub, fn, update_module_hash, (, self, :, *, const, Module, ,, module_hash, :, *, Module_Hash, ,, allocator, :, std, ., mem, ., Allocator, ), !, void, {, const, local_module_number_string, =, try, std, ., fmt, ., allocPrint, (, allocator, ,, "{X}", ,, ., {, self, ., hash, }, ), ;, module_hash, ., set_module_hash, (, self, ., name, (, ), ,, local_module_number_string, ,, allocator, ), ;, }, }, ;, const, std, =, @, import, (, "std", ), ;, const, Self, =, @, This, (, ), ;, json_parsed, :, ?, std, ., json, ., Parsed, (, std, ., json, ., Value, ), ,, json_absolute_path, :, [, ], const, u8, ,, pub, fn, init, (, package_absolute_path, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), !, Self, {, const, json_absolute_paths, =, [, _, ], [, ], const, u8, {, package_absolute_path, ,, "build", ,, "hash.json", }, ;, const, json_absolute_path, =, try, std, ., fs, ., path, ., join, (, allocator, ,, &, json_absolute_paths, ), ;, const, contents, =, read_contents, (, json_absolute_path, ,, allocator, ), catch, |, err, |, switch, (, err, ), {, error, ., FileNotFound, =>, return, Self, {, ., json_parsed, =, null, ,, ., json_absolute_path, =, json_absolute_path, }, ,, else, =>, return, error, ., CompileError, ,, }, ;, const, parsed, =, std, ., json, ., parseFromSlice, (, std, ., json, ., Value, ,, allocator, ,, contents, ,, ., {, }, ), catch, return, Self, {, ., json_parsed, =, null, ,, ., json_absolute_path, =, json_absolute_path, }, ;, return, Self, {, ., json_parsed, =, parsed, ,, ., json_absolute_path, =, json_absolute_path, ,, }, ;, }, pub, fn, deinit, (, self, :, *, Self, ), void, {, if, (, self, ., json_parsed, ), |, parsed, |, {, parsed, ., deinit, (, ), ;, }, }, fn, read_contents, (, absolute_path, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), !, [, ], const, u8, {, var, file, =, std, ., fs, ., openFileAbsolute, (, absolute_path, ,, ., {, }, ), catch, |, err, |, switch, (, err, ), {, error, ., FileNotFound, =>, return, error, ., FileNotFound, ,, else, =>, return, error, ., CompileError, ,, }, ;, defer, file, ., close, (, ), ;, const, stat, =, file, ., stat, (, ), catch, return, error, ., CompileError, ;, const, contents, =, try, file, ., readToEndAlloc, (, allocator, ,, stat, ., size, ), ;, return, contents, ;, }, pub, fn, get_module_stored_hash, (, self, :, *, const, Self, ,, module_name, :, [, ], const, u8, ), ?, [, ], const, u8, {, if, (, self, ., json_parsed, ), |, old_json_parsed, |, {, const, module_lookup_res, =, old_json_parsed, ., value, ., object, ., get, (, module_name, ), orelse, return, null, ;, return, module_lookup_res, ., string, ;, }, else, {, return, null, ;, }, }, pub, fn, set_module_hash, (, self, :, *, Self, ,, module_name, :, [, ], const, u8, ,, hash_number_string, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), void, {, if, (, self, ., json_parsed, ==, null, ), {, self, ., json_parsed, =, std, ., json, ., parseFromSlice, (, std, ., json, ., Value, ,, allocator, ,, "{}", ,, ., {, }, ), catch, unreachable, ;, }, self, ., json_parsed, .?, ., value, ., object, ., put, (, module_name, ,, std, ., json, ., Value, {, ., string, =, hash_number_string, }, ), catch, unreachable, ;, }, pub, fn, output_new_json, (, self, :, *, Self, ,, allocator, :, std, ., mem, ., Allocator, ), void, {, if, (, self, ., json_parsed, ==, null, ), {, self, ., json_parsed, =, std, ., json, ., parseFromSlice, (, std, ., json, ., Value, ,, allocator, ,, "{}", ,, ., {, }, ), catch, unreachable, ;, }, var, json_file_handle, =, std, ., fs, ., createFileAbsolute, (, self, ., json_absolute_path, ,, ., {, }, ), catch, unreachable, ;, defer, json_file_handle, ., close, (, ), ;, var, out, :, std, ., io, ., Writer, ., Allocating, =, ., init, (, allocator, ), ;, std, ., json, ., Stringify, ., value, (, self, ., json_parsed, .?, ., value, ,, ., {, }, ,, &, out, ., writer, ), catch, unreachable, ;, json_file_handle, ., writeAll, (, out, ., written, (, ), ), catch, unreachable, ;, }, const, std, =, @, import, (, "std", ), ;, const, Module, =, @, import, (, "../hierarchy/module.zig", ), ., Module, ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, Compiler_Context, =, @, import, (, "compiler.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, repo_, =, @, import, (, "../util/repo.zig", ), ;, const, Module_Hash, =, @, import, (, "module_hash.zig", ), ;, const, Type_Set, =, @, import, (, "../types/type_set.zig", ), ;, const, Package, =, @, This, (, ), ;, name, :, [, ], const, u8, ,, absolute_path, :, [, ], const, u8, ,, output_absolute_path, :, [, ], const, u8, ,, root, :, *, Symbol, ,, local_modules, :, std, ., array_list, ., Managed, (, *, Module, ), ,, requirements, :, std, ., StringArrayHashMap, (, *, Symbol, ), ,, include_directories, :, std, ., StringArrayHashMap, (, void, ), ,, library_directories, :, std, ., StringArrayHashMap, (, void, ), ,, libraries, :, std, ., StringArrayHashMap, (, void, ), ,, kind, :, Package_Kind, ,, visited, :, bool, ,, module_hash, :, Module_Hash, ,, type_set, :, Type_Set, ,, modified, :, ?, bool, ,, pub, const, Package_Kind, =, enum, {, executable, ,, static_library, ,, shared_library, ,, test_executable, ,, }, ;, pub, const, Package_Iterator_Node, =, struct, {, compiler, :, *, Compiler_Context, ,, package, :, *, Package, ,, pub, fn, init, (, compiler, :, *, Compiler_Context, ,, package_abs_path, :, [, ], const, u8, ), Package_Iterator_Node, {, const, package, =, compiler, ., lookup_package, (, package_abs_path, ), .?, ;, return, Package_Iterator_Node, {, ., compiler, =, compiler, ,, ., package, =, package, }, ;, }, pub, fn, get_adjacent, (, self, :, *, Package_Iterator_Node, ), [, ], Package_Iterator_Node, {, var, list, =, std, ., array_list, ., Managed, (, Package_Iterator_Node, ), ., init, (, self, ., compiler, ., allocator, (, ), ), ;, for, (, self, ., package, ., requirements, ., keys, (, ), ), |, requirement_name, |, {, const, requirement_root_module_symbol, =, self, ., package, ., requirements, ., get, (, requirement_name, ), ;, const, requirement_root_module, =, requirement_root_module_symbol, .?, ., init_value, (, ), .?, ., module, ., module, ;, const, requirement_root_abs_path, =, requirement_root_module, ., get_package_abs_path, (, ), ;, list, ., append, (, Package_Iterator_Node, ., init, (, self, ., compiler, ,, requirement_root_abs_path, ), ), catch, unreachable, ;, }, return, list, ., toOwnedSlice, (, ), catch, unreachable, ;, }, pub, fn, free_adjacent, (, self, :, *, Package_Iterator_Node, ,, adj, :, [, ], Package_Iterator_Node, ), void, {, self, ., compiler, ., allocator, (, ), ., free, (, adj, ), ;, }, }, ;, pub, fn, new, (, allocator, :, std, ., mem, ., Allocator, ,, package_absolute_path, :, [, ], const, u8, ,, kind, :, Package_Kind, ), *, Package, {, const, package, =, allocator, ., create, (, Package, ), catch, unreachable, ;, package, ., root, =, undefined, ;, package, ., output_absolute_path, =, undefined, ;, package, ., requirements, =, std, ., StringArrayHashMap, (, *, Symbol, ), ., init, (, allocator, ), ;, package, ., include_directories, =, std, ., StringArrayHashMap, (, void, ), ., init, (, allocator, ), ;, package, ., library_directories, =, std, ., StringArrayHashMap, (, void, ), ., init, (, allocator, ), ;, package, ., libraries, =, std, ., StringArrayHashMap, (, void, ), ., init, (, allocator, ), ;, package, ., local_modules, =, std, ., array_list, ., Managed, (, *, Module, ), ., init, (, allocator, ), ;, package, ., visited, =, false, ;, package, ., name, =, std, ., fs, ., path, ., basename, (, package_absolute_path, ), ;, package, ., absolute_path, =, package_absolute_path, ;, package, ., kind, =, kind, ;, package, ., module_hash, =, Module_Hash, ., init, (, package_absolute_path, ,, allocator, ), catch, unreachable, ;, package, ., type_set, =, Type_Set, ., init, (, allocator, ), ;, package, ., modified, =, null, ;, package, ., set_executable_name, (, allocator, ), catch, unreachable, ;, return, package, ;, }, pub, fn, get_build_path, (, self, :, *, const, Package, ,, allocator, :, std, ., mem, ., Allocator, ), [, ], const, u8, {, const, package_root_module, =, self, ., root, ., init_value, (, ), .?, ., module, ., module, ;, const, package_path, =, package_root_module, ., get_package_abs_path, (, ), ;, const, build_paths, =, [, _, ], [, ], const, u8, {, package_path, ,, "build", }, ;, return, std, ., fs, ., path, ., join, (, allocator, ,, &, build_paths, ), catch, unreachable, ;, }, pub, fn, get_types_path, (, self, :, *, const, Package, ,, allocator, :, std, ., mem, ., Allocator, ), [, ], const, u8, {, const, package_root_module, =, self, ., root, ., init_value, (, ), .?, ., module, ., module, ;, const, package_path, =, package_root_module, ., get_package_abs_path, (, ), ;, const, types_paths, =, [, _, ], [, ], const, u8, {, package_path, ,, "build", ,, "types", }, ;, return, std, ., fs, ., path, ., join, (, allocator, ,, &, types_paths, ), catch, unreachable, ;, }, pub, fn, get_build_module_absolute_path, (, self, :, *, const, Package, ,, allocator, :, std, ., mem, ., Allocator, ), [, ], const, u8, {, const, package_root_module, =, self, ., root, ., init_value, (, ), .?, ., module, ., module, ;, const, package_path, =, package_root_module, ., get_package_abs_path, (, ), ;, const, build_paths, =, [, _, ], [, ], const, u8, {, package_path, ,, "build.orng", }, ;, return, std, ., fs, ., path, ., join, (, allocator, ,, &, build_paths, ), catch, unreachable, ;, }, pub, fn, entry, (, self, :, *, const, Package, ), ?, *, CFG, {, return, self, ., root, ., init_value, (, ), .?, ., module, ., module, ., entry, ;, }, pub, fn, get_build_module, (, self, :, *, const, Package, ,, compiler, :, *, Compiler_Context, ), ?, *, Module, {, const, build_module_absolute_path, :, [, ], const, u8, =, self, ., get_build_module_absolute_path, (, compiler, ., allocator, (, ), ), ;, const, build_module_symbol, :, *, Symbol, =, compiler, ., lookup_module, (, build_module_absolute_path, ), orelse, return, null, ;, return, build_module_symbol, ., init_value, (, ), .?, ., module, ., module, ;, }, fn, get_required_package, (, self, :, *, Package, ,, requirement_name, :, [, ], const, u8, ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ), *, Package, {, const, requirement_root_module_symbol, :, ?, *, Symbol, =, self, ., requirements, ., get, (, requirement_name, ), ;, const, requirement_root_module, :, *, Module, =, requirement_root_module_symbol, .?, ., init_value, (, ), .?, ., module, ., module, ;, const, requirement_root_abs_path, :, [, ], const, u8, =, requirement_root_module, ., get_package_abs_path, (, ), ;, const, required_package, :, *, Package, =, packages, ., get, (, requirement_root_abs_path, ), .?, ;, return, required_package, ;, }, pub, fn, determine_if_package_modified, (, self, :, *, Package, ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, compiler, :, *, Compiler_Context, ), !, void, {, if, (, self, ., modified, !=, null, ), {, return, ;, }, self, ., modified, =, false, ;, for, (, self, ., requirements, ., keys, (, ), ), |, requirement_name, |, {, const, required_package, =, self, ., get_required_package, (, requirement_name, ,, packages, ), ;, try, required_package, ., determine_if_package_modified, (, packages, ,, compiler, ), ;, self, ., modified, =, required_package, ., modified, .?, or, self, ., modified, .?, ;, }, if, (, self, ., get_build_module, (, compiler, ), ), |, build_module, |, {, try, build_module, ., determine_if_module_modified, (, compiler, ), ;, try, build_module, ., update_module_hash, (, &, self, ., module_hash, ,, compiler, ., allocator, (, ), ), ;, self, ., modified, =, build_module, ., modified, .?, or, self, ., modified, .?, ;, }, for, (, self, ., local_modules, ., items, ), |, local_module, |, {, try, local_module, ., determine_if_module_modified, (, compiler, ), ;, try, local_module, ., update_module_hash, (, &, self, ., module_hash, ,, compiler, ., allocator, (, ), ), ;, self, ., modified, =, local_module, ., modified, .?, or, self, ., modified, .?, ;, }, self, ., modified, =, !, file_exists, (, self, ., output_absolute_path, ), or, self, ., modified, .?, ;, }, pub, fn, collect_package_types, (, self, :, *, Package, ), void, {, for, (, self, ., local_modules, ., items, ), |, module, |, {, module, ., collect_module_types, (, &, self, ., type_set, ), ;, }, }, fn, file_exists, (, abs_path, :, [, ], const, u8, ), bool, {, var, file, =, std, ., fs, ., openFileAbsolute, (, abs_path, ,, ., {, }, ), catch, |, err, |, switch, (, err, ), {, error, ., FileNotFound, =>, return, false, ,, else, =>, return, false, ,, }, ;, defer, file, ., close, (, ), ;, return, true, ;, }, pub, fn, output, (, self, :, *, Package, ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, allocator, :, std, ., mem, ., Allocator, ), !, void, {, if, (, self, ., visited, ), {, return, ;, }, self, ., visited, =, true, ;, for, (, self, ., requirements, ., keys, (, ), ), |, requirement_name, |, {, const, required_package, =, self, ., get_required_package, (, requirement_name, ,, packages, ), ;, try, required_package, ., output, (, packages, ,, allocator, ), ;, }, const, obj_files, =, try, self, ., compile_obj_files, (, packages, ,, allocator, ), ;, self, ., module_hash, ., output_new_json, (, allocator, ), ;, if, (, self, ., modified, .?, ), {, if, (, self, ., kind, ==, ., static_library, ), {, try, self, ., ar, (, obj_files, ,, allocator, ), ;, }, else, {, try, self, ., link_executable, (, obj_files, ,, packages, ,, allocator, ), ;, }, }, }, fn, compile_obj_files, (, self, :, *, Package, ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, allocator, :, std, ., mem, ., Allocator, ), !, std, ., StringArrayHashMap, (, void, ), {, var, obj_files, =, std, ., StringArrayHashMap, (, void, ), ., init, (, allocator, ), ;, try, self, ., compile_local_modules, (, &, obj_files, ,, packages, ,, allocator, ), ;, try, self, ., compile_entry_point, (, &, obj_files, ,, packages, ,, allocator, ), ;, return, obj_files, ;, }, fn, compile_local_modules, (, self, :, *, Package, ,, obj_files, :, *, std, ., StringArrayHashMap, (, void, ), ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, allocator, :, std, ., mem, ., Allocator, ), !, void, {, for, (, self, ., local_modules, ., items, ), |, local_module, |, {, if, (, !, std, ., mem, ., eql, (, u8, ,, local_module, ., get_package_abs_path, (, ), ,, self, ., absolute_path, ), ), {, continue, ;, }, const, o_file, =, self, ., add_module_obj_files, (, obj_files, ,, local_module, ,, allocator, ), ;, if, (, !, local_module, ., modified, .?, ), {, continue, ;, }, try, self, ., compile_module_sources, (, o_file, ,, packages, ,, local_module, ,, allocator, ), ;, }, }, fn, add_module_obj_files, (, self, :, *, Package, ,, obj_files, :, *, std, ., StringArrayHashMap, (, void, ), ,, local_module, :, *, Module, ,, allocator, :, std, ., mem, ., Allocator, ), std, ., array_list, ., Managed, (, u8, ), {, var, o_file, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, o_file, ., print, (, "{s}{c}build{c}{s}.o", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, ,, std, ., fs, ., path, ., sep, ,, local_module, ., name, (, ), ,, }, ), catch, unreachable, ;, obj_files, ., put, (, o_file, ., items, ,, void, {, }, ), catch, unreachable, ;, local_module, ., modified, =, !, file_exists, (, o_file, ., items, ), or, local_module, ., modified, .?, ;, if, (, self, ., kind, ==, ., test_executable, ), {, var, test_o_file, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, test_o_file, ., print, (, "{s}{c}build{c}{s}-tests.o", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, ,, std, ., fs, ., path, ., sep, ,, local_module, ., name, (, ), ,, }, ), catch, unreachable, ;, obj_files, ., put, (, test_o_file, ., items, ,, void, {, }, ), catch, unreachable, ;, local_module, ., modified, =, !, file_exists, (, test_o_file, ., items, ), or, local_module, ., modified, .?, ;, }, return, o_file, ;, }, fn, compile_module_sources, (, self, :, *, Package, ,, o_file, :, std, ., array_list, ., Managed, (, u8, ), ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, local_module, :, *, Module, ,, allocator, :, std, ., mem, ., Allocator, ), !, void, {, var, c_file, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, c_file, ., deinit, (, ), ;, c_file, ., print, (, "{s}{c}build{c}{s}-{s}.c", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, ,, std, ., fs, ., path, ., sep, ,, self, ., name, ,, local_module, ., name, (, ), ,, }, ), catch, unreachable, ;, try, self, ., cc, (, c_file, ., items, ,, o_file, ., items, ,, packages, ,, allocator, ), ;, if, (, self, ., kind, ==, ., test_executable, ), {, var, test_c_file, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, test_c_file, ., print, (, "{s}{c}build{c}{s}-{s}-tests.c", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, ,, std, ., fs, ., path, ., sep, ,, self, ., name, ,, local_module, ., name, (, ), ,, }, ), catch, unreachable, ;, var, test_o_file, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, test_o_file, ., print, (, "{s}-tests.o", ,, ., {, local_module, ., name, (, ), }, ), catch, unreachable, ;, try, self, ., cc, (, test_c_file, ., items, ,, test_o_file, ., items, ,, packages, ,, allocator, ), ;, }, }, fn, compile_entry_point, (, self, :, *, Package, ,, obj_files, :, *, std, ., StringArrayHashMap, (, void, ), ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, allocator, :, std, ., mem, ., Allocator, ), !, void, {, if, (, !, self, ., modified, .?, ), {, return, ;, }, switch, (, self, ., kind, ), {, ., executable, =>, try, self, ., compile_executable_entry_point, (, obj_files, ,, packages, ,, allocator, ), ,, ., test_executable, =>, try, self, ., compile_test_runner_entry_point, (, obj_files, ,, packages, ,, allocator, ), ,, else, =>, {, }, ,, }, }, fn, compile_executable_entry_point, (, self, :, *, Package, ,, obj_files, :, *, std, ., StringArrayHashMap, (, void, ), ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, allocator, :, std, ., mem, ., Allocator, ), !, void, {, var, start_o_file, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, start_o_file, ., print, (, "{s}{c}build{c}start.o", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, ,, std, ., fs, ., path, ., sep, ,, }, ), catch, unreachable, ;, obj_files, ., put, (, start_o_file, ., items, ,, void, {, }, ), catch, unreachable, ;, var, c_file, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, c_file, ., print, (, "{s}{c}build{c}start.c", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, ,, std, ., fs, ., path, ., sep, ,, }, ), catch, unreachable, ;, try, self, ., cc, (, c_file, ., items, ,, start_o_file, ., items, ,, packages, ,, allocator, ), ;, }, fn, compile_test_runner_entry_point, (, self, :, *, Package, ,, obj_files, :, *, std, ., StringArrayHashMap, (, void, ), ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, allocator, :, std, ., mem, ., Allocator, ), !, void, {, var, test_runner_o_file, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, test_runner_o_file, ., print, (, "{s}{c}build{c}test-runner.o", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, ,, std, ., fs, ., path, ., sep, ,, }, ), catch, unreachable, ;, obj_files, ., put, (, test_runner_o_file, ., items, ,, void, {, }, ), catch, unreachable, ;, var, c_file, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, c_file, ., print, (, "{s}{c}build{c}test-runner.c", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, ,, std, ., fs, ., path, ., sep, ,, }, ), catch, unreachable, ;, try, self, ., cc, (, c_file, ., items, ,, test_runner_o_file, ., items, ,, packages, ,, allocator, ), ;, }, pub, fn, append_include_dir, (, self, :, *, Package, ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, include_dirs, :, *, std, ., StringArrayHashMap, (, void, ), ), void, {, for, (, self, ., requirements, ., keys, (, ), ), |, requirement_name, |, {, const, required_package, =, self, ., get_required_package, (, requirement_name, ,, packages, ), ;, required_package, ., append_include_dir, (, packages, ,, &, self, ., include_directories, ), ;, }, for, (, self, ., include_directories, ., keys, (, ), ), |, dir, |, {, include_dirs, ., put, (, dir, ,, void, {, }, ), catch, unreachable, ;, }, }, fn, cc, (, self, :, *, Package, ,, c_file, :, [, ], const, u8, ,, o_file, :, [, ], const, u8, ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), !, void, {, const, cc_cmd, =, try, self, ., construct_obj_cc_cmd, (, c_file, ,, o_file, ,, packages, ,, allocator, ), ;, print_cmd, (, &, cc_cmd, ), ;, var, cwd_string, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, cwd_string, ., print, (, "{s}{c}build", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, }, ), catch, unreachable, ;, const, run_res, =, std, ., process, ., Child, ., run, (, ., {, ., allocator, =, allocator, ,, ., argv, =, cc_cmd, ., items, ,, ., cwd, =, cwd_string, ., items, ,, }, ), catch, |, err, |, switch, (, err, ), {, else, =>, std, ., debug, ., panic, (, "compile error: on cc invoke: {}", ,, ., {, err, }, ), ,, }, ;, var, retcode, :, u8, =, 0, ;, switch, (, run_res, ., term, ), {, ., Exited, =>, |, c, |, {, retcode, =, c, ;, }, ,, ., Signal, =>, return, error, ., CompileError, ,, else, =>, {, std, ., debug, ., print, (, "{s}\n", ,, ., {, run_res, ., stderr, }, ), ;, return, error, ., CompileError, ;, }, ,, }, if, (, retcode, !=, 0, ), {, std, ., debug, ., print, (, "{s}", ,, ., {, run_res, ., stderr, }, ), ;, return, error, ., CompileError, ;, }, }, fn, construct_obj_cc_cmd, (, self, :, *, Package, ,, c_file, :, [, ], const, u8, ,, o_file, :, [, ], const, u8, ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), !, std, ., array_list, ., Managed, (, [, ], const, u8, ), {, var, env_map, =, std, ., process, ., getEnvMap, (, allocator, ), catch, unreachable, ;, defer, env_map, ., deinit, (, ), ;, var, cc_cmd, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, allocator, ), ;, cc_cmd, ., appendSlice, (, &, [, _, ], [, ], const, u8, {, "zig", ,, "cc", }, ), catch, unreachable, ;, cc_cmd, ., append, (, "-c", ), catch, unreachable, ;, cc_cmd, ., append, (, c_file, ), catch, unreachable, ;, cc_cmd, ., append, (, "-o", ), catch, unreachable, ;, cc_cmd, ., append, (, o_file, ), catch, unreachable, ;, const, inc_path, =, repo_, ., get_inc_dir, (, allocator, ), ;, var, std_include_path, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, std_include_path, ., print, (, "-I{s}", ,, ., {, inc_path, }, ), catch, unreachable, ;, cc_cmd, ., appendSlice, (, &, [, _, ], [, ], const, u8, {, "-std=c11", ,, "-O3", ,, "-g", ,, std_include_path, ., items, ,, }, ), catch, unreachable, ;, if, (, true, ), {, cc_cmd, ., appendSlice, (, &, [, _, ], [, ], const, u8, {, "-Wall", ,, "-Wextra", ,, "-Wpedantic", ,, "-pedantic-errors", ,, "-Wconversion", ,, "-Wsign-conversion", ,, "-Wfloat-conversion", ,, "-Wcast-qual", ,, "-Wshadow", ,, "-Wformat=2", ,, "-Wmisleading-indentation", ,, "-Wstrict-prototypes", ,, "-Wmissing-prototypes", ,, "-Winit-self", ,, "-Wdeclaration-after-statement", ,, "-Wbad-function-cast", ,, "-Wcast-align", ,, }, ), catch, unreachable, ;, }, self, ., append_requirements_includes, (, &, cc_cmd, ,, packages, ,, allocator, ), ;, self, ., append_self_includes, (, &, cc_cmd, ,, allocator, ), ;, return, cc_cmd, ;, }, fn, append_requirements_includes, (, self, :, *, Package, ,, cc_cmd, :, *, std, ., array_list, ., Managed, (, [, ], const, u8, ), ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), void, {, for, (, self, ., requirements, ., keys, (, ), ), |, requirement_name, |, {, const, required_package, =, self, ., get_required_package, (, requirement_name, ,, packages, ), ;, var, requirement_include_path, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, requirement_include_path, ., print, (, "-I{s}{c}build", ,, ., {, required_package, ., root, ., init_value, (, ), .?, ., module, ., module, ., get_package_abs_path, (, ), ,, std, ., fs, ., path, ., sep, }, ), catch, unreachable, ;, cc_cmd, ., append, (, requirement_include_path, ., items, ), catch, unreachable, ;, }, }, fn, append_self_includes, (, self, :, *, Package, ,, cc_cmd, :, *, std, ., array_list, ., Managed, (, [, ], const, u8, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), void, {, for, (, self, ., include_directories, ., keys, (, ), ), |, include_dir, |, {, var, requirement_include_path, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, requirement_include_path, ., print, (, "-I{s}", ,, ., {, include_dir, }, ), catch, unreachable, ;, cc_cmd, ., append, (, requirement_include_path, ., items, ), catch, unreachable, ;, }, }, fn, ar, (, self, :, *, Package, ,, obj_files, :, std, ., StringArrayHashMap, (, void, ), ,, allocator, :, std, ., mem, ., Allocator, ), !, void, {, var, cmd, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, allocator, ), ;, cmd, ., appendSlice, (, &, [, _, ], [, ], const, u8, {, "zig", ,, "ar", ,, "rcs", ,, }, ), catch, unreachable, ;, cmd, ., append, (, self, ., output_absolute_path, ), catch, unreachable, ;, cmd, ., appendSlice, (, obj_files, ., keys, (, ), ), catch, unreachable, ;, var, cwd_string, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, cwd_string, ., print, (, "{s}{c}build", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, }, ), catch, unreachable, ;, print_cmd, (, &, cmd, ), ;, const, run_res, =, std, ., process, ., Child, ., run, (, ., {, ., allocator, =, allocator, ,, ., argv, =, cmd, ., items, ,, ., cwd, =, cwd_string, ., items, ,, }, ), catch, unreachable, ;, var, retcode, :, u8, =, 0, ;, switch, (, run_res, ., term, ), {, ., Exited, =>, |, c, |, {, retcode, =, c, ;, }, ,, ., Signal, =>, return, error, ., CompileError, ,, else, =>, {, std, ., debug, ., print, (, "{s}\n", ,, ., {, run_res, ., stderr, }, ), ;, return, error, ., CompileError, ;, }, ,, }, if, (, retcode, !=, 0, ), {, std, ., debug, ., print, (, "ar error: {s}\n", ,, ., {, run_res, ., stderr, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, set_executable_name, (, self, :, *, Package, ,, allocator, :, std, ., mem, ., Allocator, ), !, void, {, var, output_absolute_path, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, output_absolute_path, ., print, (, "{s}{c}build{c}", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, ,, std, ., fs, ., path, ., sep, ,, }, ), catch, unreachable, ;, switch, (, self, ., kind, ), {, ., executable, =>, try, output_absolute_path, ., print, (, "{s}", ,, ., {, self, ., name, }, ), ,, ., test_executable, =>, try, output_absolute_path, ., print, (, "{s}-test", ,, ., {, self, ., name, }, ), ,, ., static_library, =>, try, output_absolute_path, ., print, (, "lib{s}.a", ,, ., {, self, ., name, }, ), ,, ., shared_library, =>, try, output_absolute_path, ., print, (, "{s}.so", ,, ., {, self, ., name, }, ), ,, }, self, ., output_absolute_path, =, output_absolute_path, ., items, ;, }, fn, link_executable, (, self, :, *, Package, ,, obj_files, :, std, ., StringArrayHashMap, (, void, ), ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, allocator, :, std, ., mem, ., Allocator, ), !, void, {, const, cmd, =, try, self, ., construct_exe_cc_cmd, (, obj_files, ,, packages, ,, allocator, ), ;, var, cwd_string, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, cwd_string, ., print, (, "{s}{c}build", ,, ., {, self, ., absolute_path, ,, std, ., fs, ., path, ., sep, }, ), catch, unreachable, ;, print_cmd, (, &, cmd, ), ;, const, run_res, =, std, ., process, ., Child, ., run, (, ., {, ., allocator, =, allocator, ,, ., argv, =, cmd, ., items, ,, ., cwd, =, cwd_string, ., items, ,, }, ), catch, unreachable, ;, var, retcode, :, u8, =, 0, ;, switch, (, run_res, ., term, ), {, ., Exited, =>, |, c, |, {, retcode, =, c, ;, }, ,, else, =>, {, std, ., debug, ., panic, (, "{s}\n", ,, ., {, run_res, ., stderr, }, ), ;, }, ,, }, if, (, retcode, !=, 0, ), {, std, ., debug, ., panic, (, "err:{s}\n", ,, ., {, run_res, ., stderr, }, ), ;, }, }, fn, construct_exe_cc_cmd, (, self, :, *, Package, ,, obj_files, :, std, ., StringArrayHashMap, (, void, ), ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, allocator, :, std, ., mem, ., Allocator, ,, ), !, std, ., array_list, ., Managed, (, [, ], const, u8, ), {, var, env_map, =, std, ., process, ., getEnvMap, (, allocator, ), catch, unreachable, ;, defer, env_map, ., deinit, (, ), ;, var, cmd, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, allocator, ), ;, cmd, ., appendSlice, (, &, [, _, ], [, ], const, u8, {, "zig", ,, "cc", }, ), catch, unreachable, ;, cmd, ., appendSlice, (, obj_files, ., keys, (, ), ), catch, unreachable, ;, for, (, self, ., requirements, ., keys, (, ), ), |, requirement_name, |, {, self, ., append_requirement_link, (, &, cmd, ,, packages, ,, requirement_name, ,, allocator, ), ;, }, cmd, ., append, (, "-o", ), catch, unreachable, ;, cmd, ., append, (, self, ., output_absolute_path, ), catch, unreachable, ;, return, cmd, ;, }, fn, append_requirement_link, (, self, :, *, Package, ,, cmd, :, *, std, ., array_list, ., Managed, (, [, ], const, u8, ), ,, packages, :, std, ., StringArrayHashMap, (, *, Package, ), ,, requirement_name, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ,, ), void, {, const, required_package, =, self, ., get_required_package, (, requirement_name, ,, packages, ), ;, try, self, ., append_library_dirs, (, cmd, ,, required_package, ,, allocator, ), ;, try, self, ., append_library_flags, (, cmd, ,, required_package, ,, allocator, ), ;, }, fn, append_library_dirs, (, self, :, *, Package, ,, cmd, :, *, std, ., array_list, ., Managed, (, [, ], const, u8, ), ,, required_package, :, *, Package, ,, allocator, :, std, ., mem, ., Allocator, ,, ), !, void, {, var, requirement_library_path, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, requirement_library_path, ., print, (, "{s}{c}build", ,, ., {, required_package, ., root, ., init_value, (, ), .?, ., module, ., module, ., get_package_abs_path, (, ), ,, std, ., fs, ., path, ., sep, }, ), catch, unreachable, ;, cmd, ., append, (, "-L", ), catch, unreachable, ;, cmd, ., append, (, requirement_library_path, ., items, ), catch, unreachable, ;, for, (, self, ., library_directories, ., keys, (, ), ), |, lib_dir, |, {, cmd, ., append, (, "-L", ), catch, unreachable, ;, cmd, ., append, (, lib_dir, ), catch, unreachable, ;, }, }, fn, append_library_flags, (, self, :, *, Package, ,, cmd, :, *, std, ., array_list, ., Managed, (, [, ], const, u8, ), ,, required_package, :, *, Package, ,, allocator, :, std, ., mem, ., Allocator, ,, ), !, void, {, var, requirement_library, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, requirement_library, ., print, (, "-l{s}", ,, ., {, required_package, ., name, }, ), catch, unreachable, ;, cmd, ., append, (, requirement_library, ., items, ), catch, unreachable, ;, for, (, self, ., libraries, ., keys, (, ), ), |, lib, |, {, cmd, ., append, (, "-l", ), catch, unreachable, ;, cmd, ., append, (, lib, ), catch, unreachable, ;, }, }, const, debug, :, bool, =, false, ;, fn, print_cmd, (, cmd, :, *, const, std, ., array_list, ., Managed, (, [, ], const, u8, ), ), void, {, if, (, debug, ), {, for, (, cmd, ., items, ), |, item, |, {, std, ., debug, ., print, (, "{s} ", ,, ., {, item, }, ), ;, }, std, ., debug, ., print, (, "\n", ,, ., {, }, ), ;, }, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, module_, =, @, import, (, "../hierarchy/module.zig", ), ;, const, Scope, =, @, import, (, "../symbol/scope.zig", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, UID_Gen, =, @, import, (, "../util/uid_gen.zig", ), ;, pub, var, anyptr_type, :, *, Type_AST, =, undefined, ;, pub, var, bool_type, :, *, Type_AST, =, undefined, ;, pub, var, byte_type, :, *, Type_AST, =, undefined, ;, pub, var, byte_slice_type, :, *, Type_AST, =, undefined, ;, pub, var, float_type, :, *, Type_AST, =, undefined, ;, pub, var, float32_type, :, *, Type_AST, =, undefined, ;, pub, var, float64_type, :, *, Type_AST, =, undefined, ;, pub, var, int_type, :, *, Type_AST, =, undefined, ;, pub, var, int8_type, :, *, Type_AST, =, undefined, ;, pub, var, int16_type, :, *, Type_AST, =, undefined, ;, pub, var, int32_type, :, *, Type_AST, =, undefined, ;, pub, var, int64_type, :, *, Type_AST, =, undefined, ;, pub, var, string_type, :, *, Type_AST, =, undefined, ;, pub, var, unit_type, :, *, Type_AST, =, undefined, ;, pub, var, unit_value, :, *, ast_, ., AST, =, undefined, ;, pub, var, void_type, :, *, Type_AST, =, undefined, ;, pub, var, word8_type, :, *, Type_AST, =, undefined, ;, pub, var, word16_type, :, *, Type_AST, =, undefined, ;, pub, var, word32_type, :, *, Type_AST, =, undefined, ;, pub, var, word64_type, :, *, Type_AST, =, undefined, ;, pub, var, blackhole, :, *, Symbol, =, undefined, ;, pub, const, Primitive_Info, =, struct, {, c_name, :, [, ], const, u8, ,, canon_name, :, [, ], const, u8, ,, bounds, :, ?, Bounds, ,, type_class, :, Type_Class, ,, type_kind, :, Type_Kind, ,, default_value, :, ?, *, ast_, ., AST, ,, size, :, i64, ,, _align, :, i64, ,, }, ;, pub, const, Bounds, =, struct, {, lower, :, i128, ,, upper, :, i128, ,, }, ;, pub, const, Type_Class, =, enum, {, none, ,, eq, ,, ord, ,, num, ,, int, ,, }, ;, pub, const, Type_Kind, =, enum, {, type, ,, none, ,, signed_integer, ,, unsigned_integer, ,, floating_point, ,, boolean, ,, string, ,, }, ;, var, primitives, :, std, ., StringArrayHashMap, (, Primitive_Info, ), =, undefined, ;, var, prelude, :, ?, *, Scope, =, null, ;, pub, fn, get_prelude_scope, (, compiler, :, *, Compiler_Context, ), !, *, Scope, {, if, (, prelude, ==, null, ), {, try, create_prelude, (, compiler, ), ;, }, return, prelude, .?, ;, }, pub, fn, deinit, (, ), void, {, prelude, =, null, ;, }, fn, create_prelude, (, compiler, :, *, Compiler_Context, ), !, void, {, anyptr_type, =, create_anyptr_type_primitive, (, compiler, ., allocator, (, ), ), ;, bool_type, =, create_primitive_identifier, (, "Bool", ,, compiler, ., allocator, (, ), ), ;, byte_type, =, create_primitive_identifier, (, "Byte", ,, compiler, ., allocator, (, ), ), ;, float_type, =, create_primitive_identifier, (, "Float", ,, compiler, ., allocator, (, ), ), ;, float32_type, =, create_primitive_identifier, (, "Float32", ,, compiler, ., allocator, (, ), ), ;, float64_type, =, create_primitive_identifier, (, "Float64", ,, compiler, ., allocator, (, ), ), ;, int_type, =, create_primitive_identifier, (, "Int", ,, compiler, ., allocator, (, ), ), ;, int8_type, =, create_primitive_identifier, (, "Int8", ,, compiler, ., allocator, (, ), ), ;, int16_type, =, create_primitive_identifier, (, "Int16", ,, compiler, ., allocator, (, ), ), ;, int32_type, =, create_primitive_identifier, (, "Int32", ,, compiler, ., allocator, (, ), ), ;, int64_type, =, create_primitive_identifier, (, "Int64", ,, compiler, ., allocator, (, ), ), ;, string_type, =, create_primitive_identifier, (, "String", ,, compiler, ., allocator, (, ), ), ;, unit_type, =, create_unit_type, (, compiler, ., allocator, (, ), ), ;, unit_value, =, create_unit_value, (, compiler, ., allocator, (, ), ), ;, void_type, =, create_primitive_identifier, (, "Void", ,, compiler, ., allocator, (, ), ), ;, word8_type, =, create_primitive_identifier, (, "Word8", ,, compiler, ., allocator, (, ), ), ;, word16_type, =, create_primitive_identifier, (, "Word16", ,, compiler, ., allocator, (, ), ), ;, word32_type, =, create_primitive_identifier, (, "Word32", ,, compiler, ., allocator, (, ), ), ;, word64_type, =, create_primitive_identifier, (, "Word64", ,, compiler, ., allocator, (, ), ), ;, byte_slice_type, =, Type_AST, ., create_slice_type, (, byte_type, ,, false, ,, compiler, ., allocator, (, ), ), ;, var, uid_gen, =, UID_Gen, ., init, (, ), ;, prelude, =, Scope, ., init, (, null, ,, &, uid_gen, ,, compiler, ., allocator, (, ), ), ;, blackhole, =, create_prelude_symbol, (, "_", ,, unit_type, ,, unit_value, ,, compiler, ., allocator, (, ), ), ;, const, default_float32, =, ast_, ., AST, ., create_float, (, Token, ., init_simple, (, "0.0", ), ,, 0.0, ,, compiler, ., allocator, (, ), ), ;, const, default_float64, =, ast_, ., AST, ., create_float, (, Token, ., init_simple, (, "0.0", ), ,, 0.0, ,, compiler, ., allocator, (, ), ), ;, const, default_bool, =, ast_, ., AST, ., create_false, (, Token, ., init_simple, (, "false", ), ,, compiler, ., allocator, (, ), ), ;, const, default_int, =, ast_, ., AST, ., create_int, (, Token, ., init_simple, (, "0", ), ,, 0, ,, compiler, ., allocator, (, ), ), ;, primitives, =, std, ., StringArrayHashMap, (, Primitive_Info, ), ., init, (, compiler, ., allocator, (, ), ), ;, create_info, (, "Bool", ,, null, ,, "uint8_t", ,, "u8", ,, bool_type, ,, ., eq, ,, ., boolean, ,, default_bool, ,, 1, ,, compiler, ., allocator, (, ), ,, ), ;, create_info, (, "Float32", ,, null, ,, "float", ,, "f32", ,, float32_type, ,, ., num, ,, ., floating_point, ,, default_float32, ,, 4, ,, compiler, ., allocator, (, ), ,, ), ;, create_info, (, "Float64", ,, null, ,, "double", ,, "f64", ,, float64_type, ,, ., num, ,, ., floating_point, ,, default_float64, ,, 8, ,, compiler, ., allocator, (, ), ,, ), ;, create_info, (, "Int8", ,, Bounds, {, ., lower, =, -, 0x80, ,, ., upper, =, 0x7F, }, ,, "int8_t", ,, "i8", ,, int8_type, ,, ., int, ,, ., signed_integer, ,, default_int, ,, 1, ,, compiler, ., allocator, (, ), ,, ), ;, create_info, (, "Int16", ,, Bounds, {, ., lower, =, -, 0x8000, ,, ., upper, =, 0x7FFF, }, ,, "int16_t", ,, "i16", ,, int16_type, ,, ., int, ,, ., signed_integer, ,, default_int, ,, 2, ,, compiler, ., allocator, (, ), ,, ), ;, create_info, (, "Int32", ,, Bounds, {, ., lower, =, -, 0x8000_000, ,, ., upper, =, 0x7FFF_FFFF, }, ,, "int32_t", ,, "i32", ,, int32_type, ,, ., int, ,, ., signed_integer, ,, default_int, ,, 4, ,, compiler, ., allocator, (, ), ,, ), ;, create_info, (, "Int64", ,, Bounds, {, ., lower, =, -, 0x8000_0000_0000_0000, ,, ., upper, =, 0x7FFF_FFFF_FFFF_FFFF, }, ,, "int64_t", ,, "i64", ,, int64_type, ,, ., int, ,, ., signed_integer, ,, default_int, ,, 8, ,, compiler, ., allocator, (, ), ,, ), ;, create_info, (, "Void", ,, null, ,, "NO C EQUIVALENT!", ,, "NO C EQUIVALENT!", ,, void_type, ,, ., none, ,, ., none, ,, null, ,, 0, ,, compiler, ., allocator, (, ), ,, ), ;, create_info, (, "Word8", ,, Bounds, {, ., lower, =, 0, ,, ., upper, =, 0xFFFF, }, ,, "uint8_t", ,, "u8", ,, word8_type, ,, ., int, ,, ., unsigned_integer, ,, default_int, ,, 2, ,, compiler, ., allocator, (, ), ,, ), ;, create_info, (, "Word16", ,, Bounds, {, ., lower, =, 0, ,, ., upper, =, 0xFFFF, }, ,, "uint16_t", ,, "u16", ,, word16_type, ,, ., int, ,, ., unsigned_integer, ,, default_int, ,, 2, ,, compiler, ., allocator, (, ), ,, ), ;, create_info, (, "Word32", ,, Bounds, {, ., lower, =, 0, ,, ., upper, =, 0xFFFF_FFFF, }, ,, "uint32_t", ,, "u32", ,, word32_type, ,, ., int, ,, ., unsigned_integer, ,, default_int, ,, 4, ,, compiler, ., allocator, (, ), ,, ), ;, create_info, (, "Word64", ,, Bounds, {, ., lower, =, 0, ,, ., upper, =, 0xFFFF_FFFF_FFFF_FFFF, }, ,, "uint64_t", ,, "u64", ,, word64_type, ,, ., int, ,, ., unsigned_integer, ,, default_int, ,, 8, ,, compiler, ., allocator, (, ), ,, ), ;, _, =, create_type_alias_symbol, (, "String", ,, byte_slice_type, ,, string_type, ,, compiler, ., allocator, (, ), ), ;, _, =, create_type_alias_symbol, (, "Int", ,, int64_type, ,, int_type, ,, compiler, ., allocator, (, ), ), ;, _, =, create_type_alias_symbol, (, "Float", ,, float64_type, ,, float_type, ,, compiler, ., allocator, (, ), ), ;, _, =, create_type_alias_symbol, (, "Byte", ,, word8_type, ,, byte_type, ,, compiler, ., allocator, (, ), ), ;, var, errors, =, errs_, ., Errors, ., init, (, compiler, ., allocator, (, ), ), ;, defer, errors, ., deinit, (, ), ;, var, prelude_abs_path, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, compiler, ., allocator, (, ), ), ;, prelude_abs_path, ., print, (, "/prelude{c}prelude.orng", ,, ., {, std, ., fs, ., path, ., sep, }, ), catch, unreachable, ;, const, module, =, try, module_, ., Module, ., init, (, prelude_abs_path, ., toOwnedSlice, (, ), catch, unreachable, ,, compiler, ., allocator, (, ), ), ;, const, symbol, =, Symbol, ., init, (, prelude, .?, ,, "prelude", ,, ast_, ., AST, ., create_module, (, Token, ., init_simple, (, "prelude", ), ,, prelude, .?, ,, module, ,, compiler, ., allocator, (, ), ,, ), ,, ., module, ,, ., local, ,, compiler, ., allocator, (, ), ,, ), ;, try, prelude, .?, ., put_symbol, (, symbol, ,, &, compiler, ., errors, ), ;, }, fn, create_primitive_identifier, (, name, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., create_type_identifier, (, Token, ., init_simple, (, name, ), ,, allocator, ), ;, }, fn, create_unit_type, (, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., create_unit_type, (, Token, ., init_simple, (, "(", ), ,, allocator, ), ;, }, fn, create_anyptr_type_primitive, (, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., create_anyptr_type, (, Token, ., init_simple, (, "anyptr_type", ), ,, allocator, ), ;, }, fn, create_unit_value, (, allocator, :, std, ., mem, ., Allocator, ), *, ast_, ., AST, {, return, ast_, ., AST, ., create_unit_value, (, Token, ., init_simple, (, "{", ), ,, allocator, ), ., assert_ast_valid, (, ), ;, }, fn, create_prelude_symbol, (, name, :, [, ], const, u8, ,, _type, :, *, Type_AST, ,, init, :, *, ast_, ., AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Symbol, {, const, token, =, Token, ., init_simple, (, name, ), ;, const, decl, =, ast_, ., AST, ., create_decl, (, token, ,, ast_, ., AST, ., create_pattern_symbol, (, token, ,, ., @, "const", ,, ., local, ,, name, ,, allocator, ), ,, _type, ,, init, ,, allocator, ,, ), ;, var, symbol, =, Symbol, ., init, (, prelude, .?, ,, name, ,, decl, ,, ., @, "const", ,, ., local, ,, allocator, ,, ), ., assert_symbol_valid, (, ), ;, symbol, ., is_temp, =, true, ;, _type, ., set_expanded_type, (, _type, ), ;, prelude, .?, ., symbols, ., put, (, name, ,, symbol, ), catch, unreachable, ;, return, symbol, ;, }, fn, create_type_alias_symbol, (, name, :, [, ], const, u8, ,, _type, :, *, Type_AST, ,, repr_ident, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Symbol, {, const, token, =, Token, ., init_simple, (, name, ), ;, const, decl, =, ast_, ., AST, ., create_type_alias, (, token, ,, ast_, ., AST, ., create_pattern_symbol, (, token, ,, ., type, ,, ., local, ,, name, ,, allocator, ), ,, _type, ,, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, allocator, ), ,, allocator, ,, ), ;, var, symbol, =, Symbol, ., init, (, prelude, .?, ,, name, ,, decl, ,, ., type, ,, ., local, ,, allocator, ,, ), ., assert_symbol_valid, (, ), ;, symbol, ., is_temp, =, true, ;, repr_ident, ., set_symbol, (, symbol, ), ;, _type, ., set_expanded_type, (, _type, ), ;, prelude, .?, ., symbols, ., put, (, name, ,, symbol, ), catch, unreachable, ;, return, symbol, ;, }, fn, create_c_extern_symbol, (, name, :, [, ], const, u8, ,, c_name, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), *, Symbol, {, const, token, =, Token, ., init_simple, (, name, ), ;, const, storage, :, Symbol, ., Storage, =, ., {, ., @, "extern", =, ., {, ., c_name, =, ast_, ., AST, ., create_string, (, Token, ., init_simple, (, c_name, ), ,, c_name, ,, allocator, ), }, }, ;, const, decl, =, ast_, ., AST, ., create_type_alias, (, token, ,, ast_, ., AST, ., create_pattern_symbol, (, token, ,, ., type, ,, storage, ,, name, ,, allocator, ), ,, null, ,, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, allocator, ), ,, allocator, ,, ), ;, var, symbol, =, Symbol, ., init, (, prelude, .?, ,, name, ,, decl, ,, ., type, ,, storage, ,, allocator, ,, ), ., assert_symbol_valid, (, ), ;, symbol, ., is_temp, =, true, ;, prelude, .?, ., symbols, ., put, (, name, ,, symbol, ), catch, unreachable, ;, return, symbol, ;, }, fn, create_info, (, name, :, [, ], const, u8, ,, bounds, :, ?, Bounds, ,, c_name, :, [, ], const, u8, ,, canon_name, :, [, ], const, u8, ,, _ast, :, *, Type_AST, ,, type_class, :, Type_Class, ,, type_kind, :, Type_Kind, ,, default_value, :, ?, *, ast_, ., AST, ,, size, :, i64, ,, allocator, :, std, ., mem, ., Allocator, ,, ), void, {, const, symbol, :, *, Symbol, =, create_c_extern_symbol, (, name, ,, c_name, ,, allocator, ), ;, _ast, ., set_symbol, (, symbol, ), ;, primitives, ., put, (, name, ,, Primitive_Info, {, ., bounds, =, bounds, ,, ., c_name, =, c_name, ,, ., canon_name, =, canon_name, ,, ., type_class, =, type_class, ,, ., type_kind, =, type_kind, ,, ., default_value, =, default_value, ,, ., size, =, size, ,, ., _align, =, if, (, size, <, 8, ), size, else, 8, ,, }, ), catch, unreachable, ;, }, pub, fn, info_from_name, (, name, :, [, ], const, u8, ), ?, Primitive_Info, {, return, primitives, ., get, (, name, ), ;, }, pub, fn, bounds_from_ast, (, _type, :, *, Type_AST, ), ?, Bounds, {, switch, (, _type, .*, ), {, ., identifier, =>, return, bounds_from_identifier, (, _type, ), ,, ., addr_of, ,, ., function, =>, return, Bounds, {, ., lower, =, 0, ,, ., upper, =, 0xFFFF_FFFF_FFFF_FFFF, }, ,, else, =>, return, null, ,, }, }, fn, bounds_from_identifier, (, ident_type, :, *, Type_AST, ), ?, Bounds, {, const, info, =, primitives, ., get, (, ident_type, ., token, (, ), ., data, ), orelse, return, null, ;, if, (, info, ., bounds, ==, null, ), {, return, null, ;, }, return, switch, (, info, ., type_kind, ), {, ., signed_integer, =>, info, ., bounds, .?, ,, ., unsigned_integer, =>, info, ., bounds, .?, ,, ., boolean, =>, Bounds, {, ., lower, =, 0, ,, ., upper, =, 2, }, ,, else, =>, return, null, ,, }, ;, }, pub, fn, info_from_ast, (, expanded_type, :, *, Type_AST, ), ?, Primitive_Info, {, if, (, expanded_type, .*, !=, ., identifier, ), {, return, null, ;, }, return, info_from_name, (, expanded_type, ., token, (, ), ., data, ), ;, }, const, std, =, @, import, (, "std", ), ;, const, AST, =, @, import, (, "../ast/ast.zig", ), ., AST, ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, core_, =, @, import, (, "../hierarchy/core.zig", ), ;, const, Interpreter_Context, =, @, import, (, "../interpretation/interpreter.zig", ), ;, const, lval_, =, @, import, (, "../ir/lval.zig", ), ;, const, repo_, =, @, import, (, "../util/repo.zig", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, Error, :, type, =, error, {, LexerError, ,, ParseError, ,, CompileError, ,, FileNotFound, ,, OutOfMemory, ,, MakeDirError, }, ;, const, Package_Find_Result, =, struct, {, package_adrs, :, i64, ,, package_dirname, :, [, ], const, u8, }, ;, pub, fn, package_find, (, compiler, :, *, Compiler_Context, ,, interpreter, :, *, Interpreter_Context, ,, current_module_path, :, [, ], const, u8, ,, package_src, :, *, AST, ), Error, !, Package_Find_Result, {, const, package_absolute_path, =, switch, (, package_src, ., pos, (, ), .?, ), {, 0, =>, try, package_find_relative, (, current_module_path, ,, package_src, ., enum_value, ., init, .?, ,, compiler, ., allocator, (, ), ), ,, 1, =>, try, package_find_git, (, compiler, ,, package_src, ., enum_value, ., init, .?, ), ,, else, =>, unreachable, ,, }, ;, const, package_build_paths, =, [, _, ], [, ], const, u8, {, package_absolute_path, ,, "build.orng", }, ;, const, package_build_path, =, std, ., fs, ., path, ., join, (, compiler, ., allocator, (, ), ,, &, package_build_paths, ), catch, unreachable, ;, const, path_buffer, =, compiler, ., allocator, (, ), ., alloc, (, u8, ,, std, ., fs, ., max_path_bytes, ), catch, unreachable, ;, const, package_build_absolute_path, =, std, ., fs, ., cwd, (, ), ., realpath, (, package_build_path, ,, path_buffer, ), catch, return, error, ., CompileError, ;, const, build_cfg, =, try, compiler, ., compile_build_file, (, package_build_absolute_path, ), ;, interpreter, ., load_module, (, build_cfg, ., symbol, ., scope, ., module, .?, ), ;, const, package_len, :, usize, =, @, intCast, (, core_, ., package_type, ., sizeof, (, ), ), ;, const, adrs, :, i64, =, @, intCast, (, try, interpreter, ., alloc, (, @, intCast, (, package_len, ), ,, 8, ), ), ;, const, retval_place, =, lval_, ., L_Value, ., create_raw_address_lval, (, adrs, ,, compiler, ., allocator, (, ), ), ;, try, interpreter, ., call, (, build_cfg, ., symbol, ,, retval_place, ,, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ., init, (, compiler, ., allocator, (, ), ), ), ;, try, interpreter, ., run, (, ), ;, return, ., {, ., package_adrs, =, adrs, ,, ., package_dirname, =, package_absolute_path, }, ;, }, fn, package_find_relative, (, current_module_path, :, [, ], const, u8, ,, package_src, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), Error, !, [, ], const, u8, {, const, package_path, =, package_src, ., string, ., data, ;, const, current_package, =, std, ., fs, ., path, ., dirname, (, current_module_path, ), .?, ;, const, required_package_paths, =, [, _, ], [, ], const, u8, {, current_package, ,, package_path, }, ;, const, required_package_path, =, std, ., fs, ., path, ., join, (, allocator, ,, &, required_package_paths, ), catch, unreachable, ;, const, package_buffer, =, allocator, ., alloc, (, u8, ,, std, ., fs, ., max_path_bytes, ), catch, unreachable, ;, return, std, ., fs, ., cwd, (, ), ., realpath, (, required_package_path, ,, package_buffer, ), catch, return, error, ., CompileError, ;, }, fn, package_find_git, (, compiler, :, *, Compiler_Context, ,, package_src, :, *, AST, ), Error, !, [, ], const, u8, {, const, git_source_type, =, compiler, ., get_core_type, (, "Git_Source", ), ;, const, url, =, package_src, ., get_field, (, git_source_type, ,, "url", ), ;, const, subdir, =, package_src, ., get_field, (, git_source_type, ,, "subdir", ), ;, try, repo_, ., git_clone, (, url, ., string, ., data, ,, compiler, ., allocator, (, ), ), ;, const, repo_dir, =, repo_, ., get_packages_dir, (, compiler, ., allocator, (, ), ), ;, var, dirs, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, compiler, ., allocator, (, ), ), ;, defer, dirs, ., deinit, (, ), ;, dirs, ., append, (, repo_dir, ), catch, unreachable, ;, dirs, ., append, (, std, ., fs, ., path, ., basename, (, url, ., string, ., data, ), ), catch, unreachable, ;, if, (, subdir, ., string, ., data, ., len, >, 0, ), {, var, subdir_string, =, String, ., init_with_contents, (, compiler, ., allocator, (, ), ,, subdir, ., string, ., data, ), catch, unreachable, ;, const, os_sep, :, [, 1, ], u8, =, [, 1, ], u8, {, std, ., fs, ., path, ., sep, }, ;, _, =, subdir_string, ., replace, (, "/", ,, &, os_sep, ), catch, unreachable, ;, dirs, ., append, (, (, subdir_string, ., toOwned, (, ), catch, unreachable, ), .?, ), catch, unreachable, ;, }, return, std, ., fs, ., path, ., join, (, compiler, ., allocator, (, ), ,, dirs, ., items, ), catch, unreachable, ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, builtin_, =, @, import, (, "builtin.zig", ), ;, const, core_, =, @, import, (, "../hierarchy/core.zig", ), ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Instruction, =, @, import, (, "../ir/instruction.zig", ), ;, const, Interned_String_Set, =, @, import, (, "../ir/interned_string_set.zig", ), ;, const, lval_, =, @, import, (, "../ir/lval.zig", ), ;, const, Memory, =, @, import, (, "memory.zig", ), ;, const, module_, =, @, import, (, "../hierarchy/module.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, alignment_, =, @, import, (, "../util/alignment.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Self, =, @, This, (, ), ;, const, Error, =, error, {, CompileError, }, ;, const, timeout_ms, =, 3_000, ;, const, stack_limit, =, 0x8000, ;, const, halt_trap_instruction, :, Instruction, ., Index, =, 0xFFFF_FFF0, ;, const, Debugger_Mode, =, enum, {, off, ,, noninteractive, ,, interactive, ,, }, ;, const, debugger, :, Debugger_Mode, =, ., off, ;, const, Instruction_Pointer, =, struct, {, module_uid, :, module_, ., Module_UID, ,, inst_idx, :, Instruction, ., Index, ,, }, ;, stack_pointer, :, i64, ,, base_pointer, :, i64, ,, bump_alloc_pointer, :, i64, ,, instruction_pointer, :, Instruction_Pointer, ,, memory, :, Memory, ,, modules, :, std, ., AutoArrayHashMap, (, module_, ., Module_UID, ,, *, module_, ., Module, ), ,, debug_call_stack, :, std, ., array_list, ., Managed, (, Span, ), ,, start_time, :, i64, ,, call_depth, :, i64, ,, ctx, :, *, Compiler_Context, ,, pub, fn, init, (, ctx, :, *, Compiler_Context, ), Self, {, return, Self, {, ., memory, =, Memory, ., init, (, ctx, ., allocator, (, ), ., alloc, (, u8, ,, stack_limit, ), catch, unreachable, ), ,, ., bump_alloc_pointer, =, stack_limit, ,, ., stack_pointer, =, 0, ,, ., base_pointer, =, 0, ,, ., modules, =, std, ., AutoArrayHashMap, (, module_, ., Module_UID, ,, *, module_, ., Module, ), ., init, (, ctx, ., allocator, (, ), ), ,, ., instruction_pointer, =, ., {, ., module_uid, =, 0, ,, ., inst_idx, =, 0, }, ,, ., debug_call_stack, =, std, ., array_list, ., Managed, (, Span, ), ., init, (, ctx, ., allocator, (, ), ), ,, ., start_time, =, std, ., time, ., milliTimestamp, (, ), ,, ., call_depth, =, 0, ,, ., ctx, =, ctx, ,, }, ;, }, pub, fn, set_entry_point, (, self, :, *, Self, ,, entry, :, *, CFG, ,, ret_type, :, *, Type_AST, ,, ), void, {, const, frame_address, =, alignment_, ., next_alignment, (, ret_type, ., sizeof, (, ), ,, 8, ), ;, const, module, =, entry, ., symbol, ., scope, ., module, .?, ;, self, ., stack_pointer, =, (, 5, *, @, sizeOf, (, i64, ), ), +, frame_address, +, entry, ., locals_size, .?, ;, self, ., base_pointer, =, (, 3, *, @, sizeOf, (, i64, ), ), +, frame_address, ;, self, ., instruction_pointer, =, ., {, ., module_uid, =, module, ., uid, ,, ., inst_idx, =, entry, ., offset_table, ., get, (, module, ., uid, ), .?, }, ;, self, ., memory, ., store_int, (, frame_address, +, 0, *, @, sizeOf, (, i64, ), ,, @, sizeOf, (, i64, ), ,, 0, ), ;, self, ., memory, ., store_int, (, frame_address, +, 1, *, @, sizeOf, (, i64, ), ,, @, sizeOf, (, i64, ), ,, 0, ), ;, self, ., memory, ., store_int, (, frame_address, +, 2, *, @, sizeOf, (, i64, ), ,, @, sizeOf, (, i64, ), ,, 0, ), ;, self, ., memory, ., store, (, Instruction_Pointer, ,, frame_address, +, 3, *, @, sizeOf, (, i64, ), ,, ., {, ., module_uid, =, 0, ,, ., inst_idx, =, halt_trap_instruction, }, ), ;, self, ., debug_call_stack, ., append, (, entry, ., symbol, ., span, (, ), ), catch, unreachable, ;, self, ., load_module, (, module, ), ;, }, pub, fn, deinit, (, self, :, *, Self, ), void, {, self, ., modules, ., deinit, (, ), ;, self, ., debug_call_stack, ., deinit, (, ), ;, self, ., ctx, ., allocator, (, ), ., free, (, self, ., memory, ., memory, ), ;, }, pub, fn, run, (, self, :, *, Self, ), error, {, CompileError, }, !, void, {, const, initial_call_depth, =, self, ., call_depth, ;, while, (, self, ., call_depth, >=, initial_call_depth, and, self, ., instruction_pointer, ., inst_idx, <, halt_trap_instruction, ), :, (, self, ., instruction_pointer, ., inst_idx, +=, 1, ), {, const, instr, :, *, Instruction, =, try, self, ., curr_instruction, (, ), ;, if, (, debugger, !=, ., off, ), {, std, ., debug, ., print, (, "\n", ,, ., {, }, ), ;, self, ., print_registers, (, ), ;, self, ., print_stack, (, ), ;, std, ., debug, ., print, (, "\n\n\n\n// {s}\n{}=> ", ,, ., {, instr, ., span, ., line_text, ,, instr, }, ), ;, }, const, time_now, =, std, ., time, ., milliTimestamp, (, ), ;, if, (, debugger, ==, ., off, and, time_now, -, self, ., start_time, >, timeout_ms, ), {, return, self, ., interpreter_panic, (, "interpreter error: compile-time interpreter timeout\n", ,, ., {, }, ), ;, }, if, (, debugger, ==, ., interactive, ), {, var, in_buffer, :, [, 256, ], u8, =, undefined, ;, _, =, std, ., io, ., getStdIn, (, ), ., read, (, &, in_buffer, ), catch, unreachable, ;, }, try, self, ., execute_instruction, (, instr, ), ;, }, }, inline, fn, execute_instruction, (, self, :, *, Self, ,, instr, :, *, Instruction, ), Error, !, void, {, switch, (, instr, ., kind, ), {, ., load_extern, ,, ., size_of, ,, =>, unreachable, ,, ., label, ,, ., load_unit, =>, {, }, ,, ., load_int, =>, {, try, self, ., assert_fits, (, instr, ., data, ., int, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ,, "integer value", ,, instr, ., span, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, instr, ., data, ., int, ), ;, }, ,, ., load_float, =>, self, ., memory, ., store_float, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, instr, ., data, ., float, ), ,, ., load_string, =>, {, self, ., memory, ., store, (, Interned_String_Set, ., String_Idx, ,, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., data, ., string_id, ), ;, const, interned_strings, =, self, ., ctx, ., lookup_interned_string_set, (, self, ., modules, ., get, (, instr, ., data, ., string_id, ., module_uid, ), .?, ., uid, ), .?, ;, const, string, =, interned_strings, ., items, (, ), [, instr, ., data, ., string_id, ., string_idx, ], ;, self, ., memory, ., store, (, u64, ,, try, self, ., effective_address, (, instr, ., dest, .?, ), +, 8, ,, string, ., len, ), ;, }, ,, ., load_symbol, =>, {, const, symbol_module, =, instr, ., data, ., symbol, ., scope, ., module, .?, ;, if, (, self, ., modules, ., get, (, symbol_module, ., uid, ), ==, null, ), {, self, ., load_module, (, symbol_module, ), ;, }, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, @, intFromPtr, (, instr, ., data, ., symbol, ), ), ;, }, ,, ., load_struct, =>, try, self, ., move_lval_list, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, &, instr, ., data, ., lval_list, ), ,, ., load_union, =>, {, if, (, instr, ., src1, !=, null, ), {, const, dest, =, try, self, ., effective_address, (, instr, ., dest, .?, ), ;, const, src, =, try, self, ., effective_address, (, instr, ., src1, .?, ), ;, self, ., memory, ., move, (, dest, ,, src, ,, instr, ., src1, .?, ., expanded_type_sizeof, (, ), ), ;, }, const, tag_address, =, try, self, ., effective_address, (, instr, ., dest, .?, ), +, instr, ., dest, .?, ., expanded_type_sizeof, (, ), -, 8, ;, self, ., memory, ., store, (, i64, ,, tag_address, ,, @, as, (, i64, ,, @, intCast, (, instr, ., data, ., int, ), ), ), ;, }, ,, ., copy, =>, {, std, ., debug, ., assert, (, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ==, instr, ., src1, .?, ., expanded_type_sizeof, (, ), ), ;, const, dest, =, try, self, ., effective_address, (, instr, ., dest, .?, ), ;, const, src, =, try, self, ., effective_address, (, instr, ., src1, .?, ), ;, self, ., memory, ., move, (, dest, ,, src, ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ), ;, }, ,, ., not, =>, {, const, data, =, self, ., memory, ., load_int, (, try, self, ., effective_address, (, instr, ., src1, .?, ), ,, instr, ., src1, .?, ., expanded_type_sizeof, (, ), ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, if, (, data, !=, 0, ), 0, else, 1, ), ;, }, ,, ., negate_int, =>, {, const, data, =, self, ., memory, ., load_int, (, try, self, ., effective_address, (, instr, ., src1, .?, ), ,, instr, ., src1, .?, ., expanded_type_sizeof, (, ), ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, -, data, ), ;, }, ,, ., negate_float, =>, {, const, data, =, self, ., memory, ., load_float, (, try, self, ., effective_address, (, instr, ., src1, .?, ), ,, instr, ., src1, .?, ., expanded_type_sizeof, (, ), ), ;, self, ., memory, ., store_float, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, -, data, ), ;, }, ,, ., mut_addr_of, ,, ., addr_of, =>, {, const, data, =, try, self, ., effective_address, (, instr, ., src1, .?, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, 8, ,, data, ), ;, }, ,, ., equal, =>, {, const, data, =, try, self, ., binop_load_int, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, if, (, data, ., src1, ==, data, ., src2, ), 1, else, 0, ), ;, }, ,, ., not_equal, =>, {, const, data, =, try, self, ., binop_load_int, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, if, (, data, ., src1, !=, data, ., src2, ), 1, else, 0, ), ;, }, ,, ., greater_int, =>, {, const, data, =, try, self, ., binop_load_int, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, if, (, data, ., src1, >, data, ., src2, ), 1, else, 0, ), ;, }, ,, ., greater_float, =>, {, const, data, =, try, self, ., binop_load_float, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_float, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, if, (, data, ., src1, >, data, ., src2, ), 1, else, 0, ), ;, }, ,, ., lesser_int, =>, {, const, data, =, try, self, ., binop_load_int, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, if, (, data, ., src1, <, data, ., src2, ), 1, else, 0, ), ;, }, ,, ., lesser_float, =>, {, const, data, =, try, self, ., binop_load_float, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_float, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, if, (, data, ., src1, <, data, ., src2, ), 1, else, 0, ), ;, }, ,, ., greater_equal_int, =>, {, const, data, =, try, self, ., binop_load_int, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, if, (, data, ., src1, >=, data, ., src2, ), 1, else, 0, ), ;, }, ,, ., greater_equal_float, =>, {, const, data, =, try, self, ., binop_load_float, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_float, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, if, (, data, ., src1, >=, data, ., src2, ), 1, else, 0, ), ;, }, ,, ., lesser_equal_int, =>, {, const, data, =, try, self, ., binop_load_int, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, if, (, data, ., src1, <=, data, ., src2, ), 1, else, 0, ), ;, }, ,, ., lesser_equal_float, =>, {, const, data, =, try, self, ., binop_load_float, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_float, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, if, (, data, ., src1, <=, data, ., src2, ), 1, else, 0, ), ;, }, ,, ., add_int, =>, {, const, data, =, try, self, ., binop_load_int, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, const, val, =, data, ., src1, +, data, ., src2, ;, try, self, ., assert_fits, (, val, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ,, "addition result", ,, instr, ., span, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, val, ), ;, }, ,, ., add_float, =>, {, const, data, =, try, self, ., binop_load_float, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_float, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, data, ., src1, +, data, ., src2, ), ;, }, ,, ., sub_int, =>, {, const, data, =, try, self, ., binop_load_int, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, const, val, =, data, ., src1, -, data, ., src2, ;, try, self, ., assert_fits, (, val, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ,, "subtraction result", ,, instr, ., span, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, val, ), ;, }, ,, ., sub_float, =>, {, const, data, =, try, self, ., binop_load_float, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_float, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, data, ., src1, -, data, ., src2, ), ;, }, ,, ., mult_int, =>, {, const, data, =, try, self, ., binop_load_int, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, const, val, =, data, ., src1, *, data, ., src2, ;, try, self, ., assert_fits, (, val, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ,, "multiplication result", ,, instr, ., span, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, val, ), ;, }, ,, ., mult_float, =>, {, const, data, =, try, self, ., binop_load_float, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_float, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, data, ., src1, *, data, ., src2, ), ;, }, ,, ., div_int, =>, {, const, data, =, try, self, ., binop_load_int, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, if, (, data, ., src2, ==, 0, ), {, self, ., debug_call_stack, ., append, (, instr, ., span, ), catch, unreachable, ;, return, self, ., interpreter_panic, (, "interpreter error: division by zero\n", ,, ., {, }, ), ;, }, const, val, =, @, divTrunc, (, data, ., src1, ,, data, ., src2, ), ;, try, self, ., assert_fits, (, val, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ,, "division result", ,, instr, ., span, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, val, ), ;, }, ,, ., div_float, =>, {, const, data, =, try, self, ., binop_load_float, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, self, ., memory, ., store_float, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, @, divTrunc, (, data, ., src1, ,, data, ., src2, ), ), ;, }, ,, ., mod, =>, {, const, data, =, try, self, ., binop_load_int, (, instr, ., src1, .?, ,, instr, ., src2, .?, ), ;, const, val, =, @, rem, (, data, ., src1, ,, data, ., src2, ), ;, try, self, ., assert_fits, (, val, ,, instr, ., dest, .?, ., get_expanded_type, (, ), ,, "modulus result", ,, instr, ., span, ), ;, self, ., memory, ., store_int, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ,, val, ), ;, }, ,, ., get_tag, =>, {, const, tag_offset, =, instr, ., src1, .?, ., expanded_type_sizeof, (, ), -, 8, ;, std, ., debug, ., assert, (, instr, ., dest, .?, ., expanded_type_sizeof, (, ), ==, 8, ), ;, self, ., memory, ., move, (, try, self, ., effective_address, (, instr, ., dest, .?, ), ,, try, self, ., effective_address, (, instr, ., src1, .?, ), +, tag_offset, ,, 8, ), ;, }, ,, ., jump, =>, {, const, module_uid, =, (, self, ., curr_module, (, ), catch, unreachable, ), ., uid, ;, if, (, instr, ., data, ., jump_bb, ., next, ), |, next, |, {, self, ., instruction_pointer, ., inst_idx, =, next, ., offset_table, ., get, (, module_uid, ), .?, ;, }, else, {, self, ., ret, (, ), ;, }, }, ,, ., branch_if_false, =>, {, const, module_uid, =, (, self, ., curr_module, (, ), catch, unreachable, ), ., uid, ;, if, (, self, ., memory, ., load_int, (, try, self, ., effective_address, (, instr, ., src1, .?, ), ,, instr, ., src1, .?, ., expanded_type_sizeof, (, ), ), !=, 0, ), {, if, (, instr, ., data, ., branch_bb, ., next, ), |, next, |, {, self, ., instruction_pointer, ., inst_idx, =, next, ., offset_table, ., get, (, module_uid, ), .?, ;, }, else, {, self, ., ret, (, ), ;, }, }, else, {, if, (, instr, ., data, ., branch_bb, ., branch, ), |, branch, |, {, self, ., instruction_pointer, ., inst_idx, =, branch, ., offset_table, ., get, (, module_uid, ), .?, ;, }, else, {, self, ., ret, (, ), ;, }, }, }, ,, ., call, =>, {, const, symbol_loc, =, try, self, ., effective_address, (, instr, ., src1, .?, ), ;, const, symbol_int, =, @, as, (, usize, ,, @, intCast, (, self, ., memory, ., load_int, (, symbol_loc, ,, 8, ), ), ), ;, const, symbol, :, *, Symbol, =, @, ptrFromInt, (, symbol_int, ), ;, if, (, symbol, ., represents_method, (, core_, ., package_type, ,, "find", ), ), {, return, self, ., package_find, (, instr, ), ;, }, try, self, ., call, (, symbol, ,, instr, ., dest, .?, ,, instr, ., data, ., call, ., arg_lval_list, ), ;, }, ,, ., invoke, =>, {, const, symbol_loc, =, try, self, ., effective_address, (, instr, ., data, ., invoke, ., method_decl_lval, .?, ), ;, const, symbol_int, =, @, as, (, usize, ,, @, intCast, (, self, ., memory, ., load_int, (, symbol_loc, ,, 8, ), ), ), ;, const, symbol, :, *, Symbol, =, @, ptrFromInt, (, symbol_int, ), ;, try, self, ., call, (, symbol, ,, instr, ., dest, .?, ,, instr, ., data, ., invoke, ., arg_lval_list, ), ;, }, ,, ., push_stack_trace, =>, {, self, ., debug_call_stack, ., append, (, instr, ., span, ), catch, unreachable, ;, }, ,, ., pop_stack_trace, =>, {, _, =, self, ., debug_call_stack, ., pop, (, ), ;, }, ,, ., panic, =>, {, return, self, ., interpreter_panic, (, "interpreter error: reached unreachable code\n", ,, ., {, }, ), ;, }, ,, else, =>, std, ., debug, ., panic, (, "interpreter error: interpreter.zig::interpret(): Unimplemented Instruction for {s}\n", ,, ., {, @, tagName, (, instr, ., kind, ), }, ), ,, }, }, fn, package_find, (, self, :, *, Self, ,, instr, :, *, Instruction, ), !, void, {, const, arg, :, *, lval_, ., L_Value, =, instr, ., data, ., call, ., arg_lval_list, ., items, [, @, as, (, usize, ,, @, intCast, (, 0, ), ), ], ;, const, interned_strings, =, self, ., ctx, ., lookup_interned_string_set, (, self, ., modules, ., get, (, 1, ), .?, ., uid, ), .?, ;, const, src_ast, =, try, self, ., extract_ast, (, try, self, ., effective_address, (, arg, ), ,, core_, ., package_source_type, ., expand_identifier, (, ), ,, instr, ., span, ), ;, const, current_module_path, =, (, self, ., curr_module, (, ), catch, unreachable, ), ., absolute_path, ;, if, (, builtin_, ., package_find, (, self, ., ctx, ,, self, ,, current_module_path, ,, src_ast, ), ), |, package_info, |, {, const, adrs, =, package_info, ., package_adrs, ;, const, dir_string, =, interned_strings, ., add_string, (, package_info, ., package_dirname, ,, self, ., modules, ., get, (, 1, ), .?, ., uid, ), ;, const, dir_offset, =, core_, ., package_type, ., struct_type, ., get_offset_field, (, "dir", ), ;, self, ., memory, ., store, (, Interned_String_Set, ., String_Idx, ,, adrs, +, dir_offset, ,, dir_string, ), ;, const, ret_addr, =, try, self, ., effective_address, (, instr, ., dest, .?, ), ;, self, ., memory, ., store_int, (, ret_addr, ,, 8, ,, adrs, ), ;, }, else, |, _, |, {, return, self, ., interpreter_panic, (, "interpreter error: cannot find package\n", ,, ., {, }, ), ;, }, return, ;, }, pub, fn, load_module, (, self, :, *, Self, ,, module, :, *, module_, ., Module, ), void, {, self, ., modules, ., put, (, module, ., uid, ,, module, ), catch, unreachable, ;, }, pub, fn, call, (, self, :, *, Self, ,, function_symbol, :, *, Symbol, ,, retval_place, :, *, lval_, ., L_Value, ,, args_list, :, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ), error, {, CompileError, }, !, void, {, self, ., call_depth, +=, 1, ;, const, old_sp, =, self, ., stack_pointer, ;, self, ., stack_pointer, =, alignment_, ., next_alignment, (, self, ., stack_pointer, ,, 8, ), ;, var, i, :, i64, =, @, as, (, i64, ,, @, intCast, (, args_list, ., items, ., len, ), ), -, 1, ;, while, (, i, >=, 0, ), :, (, i, -=, 1, ), {, const, arg, =, args_list, ., items, [, @, as, (, usize, ,, @, intCast, (, i, ), ), ], ;, const, size, =, arg, ., get_expanded_type, (, ), ., sizeof, (, ), ;, const, alignof, =, arg, ., expanded_type_alignof, (, ), ;, self, ., stack_pointer, =, alignment_, ., next_alignment, (, self, ., stack_pointer, ,, alignof, ), ;, try, self, ., push_move, (, try, self, ., effective_address, (, arg, ), ,, size, ), ;, }, self, ., stack_pointer, =, alignment_, ., next_alignment, (, self, ., stack_pointer, ,, 8, ), ;, try, self, ., push_int, (, 8, ,, try, self, ., effective_address, (, retval_place, ), ), ;, try, self, ., push_int, (, 8, ,, old_sp, ), ;, try, self, ., push_int, (, 8, ,, self, ., base_pointer, ), ;, try, self, ., push, (, Instruction_Pointer, ,, self, ., instruction_pointer, ), ;, self, ., base_pointer, =, self, ., stack_pointer, -, 8, ;, const, local_size_bytes, =, function_symbol, ., cfg, .?, ., locals_size, .?, ;, try, self, ., memory_check, (, local_size_bytes, ), ;, self, ., stack_pointer, +=, local_size_bytes, ;, self, ., instruction_pointer, =, Instruction_Pointer, {, ., module_uid, =, function_symbol, ., scope, ., module, .?, ., uid, ,, ., inst_idx, =, function_symbol, ., cfg, .?, ., offset_table, ., get, (, function_symbol, ., scope, ., module, .?, ., uid, ), .?, ,, }, ;, }, inline, fn, ret, (, self, :, *, Self, ), void, {, self, ., call_depth, -=, 1, ;, self, ., stack_pointer, =, self, ., base_pointer, +, 8, ;, self, ., instruction_pointer, =, self, ., pop, (, Instruction_Pointer, ), ;, self, ., base_pointer, =, @, as, (, i64, ,, @, intCast, (, self, ., pop_int, (, 8, ), ), ), ;, self, ., stack_pointer, =, @, as, (, i64, ,, @, intCast, (, self, ., pop_int, (, 8, ), ), ), ;, }, pub, fn, alloc, (, self, :, *, Self, ,, nbytes, :, i64, ,, align_to, :, i64, ), error, {, CompileError, }, !, usize, {, std, ., debug, ., assert, (, nbytes, >, 0, ), ;, std, ., debug, ., assert, (, align_to, ==, 1, or, align_to, ==, 2, or, align_to, ==, 4, or, align_to, ==, 8, ), ;, try, self, ., memory_check, (, nbytes, ), ;, self, ., bump_alloc_pointer, -=, nbytes, ;, const, alignment_subtract, =, @, rem, (, self, ., bump_alloc_pointer, ,, align_to, ), ;, try, self, ., memory_check, (, alignment_subtract, ), ;, self, ., bump_alloc_pointer, -=, alignment_subtract, ;, return, @, intCast, (, self, ., bump_alloc_pointer, ), ;, }, pub, fn, extract_ast, (, self, :, *, Self, ,, address, :, i64, ,, _type, :, *, Type_AST, ,, span, :, Span, ), Error, !, *, ast_, ., AST, {, std, ., debug, ., assert, (, address, >=, 0, ), ;, switch, (, _type, .*, ), {, ., identifier, =>, return, self, ., extract_identifier, (, address, ,, _type, ,, span, ), ,, ., addr_of, =>, return, ast_, ., AST, ., create_int, (, Token, ., init_simple, (, "unsigned int", ), ,, self, ., memory, ., load_int, (, address, ,, 8, ), ,, self, ., ctx, ., allocator, (, ), ,, ), ,, ., unit_type, =>, return, ast_, ., AST, ., create_unit_value, (, _type, ., token, (, ), ,, self, ., ctx, ., allocator, (, ), ), ,, ., enum_type, =>, return, self, ., extract_enum_type, (, address, ,, _type, ,, span, ), ,, ., struct_type, =>, return, self, ., extract_struct_type, (, address, ,, _type, ,, span, ), ,, ., tuple_type, =>, return, self, ., extract_tuple_type, (, address, ,, _type, ,, span, ), ,, ., array_of, =>, return, self, ., extract_array_type, (, address, ,, _type, ,, span, ), ,, ., function, =>, return, self, ., extract_function, (, address, ), ,, ., untagged_sum_type, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, span, ,, ., msg, =, "comptime untagged enum values cannot propagate to runtime", ,, }, }, ), ;, return, error, ., CompileError, ;, }, ,, ., annotation, =>, return, try, self, ., extract_ast, (, address, ,, _type, ., child, (, ), ,, span, ), ,, else, =>, std, ., debug, ., panic, (, "interpreter error: unimplemented extract_ast() for: AST.{s}\n", ,, ., {, @, tagName, (, _type, .*, ), }, ), ,, }, }, fn, extract_identifier, (, self, :, *, Self, ,, address, :, i64, ,, identifier_type, :, *, Type_AST, ,, span, :, Span, ), Error, !, *, ast_, ., AST, {, const, info, =, prelude_, ., info_from_name, (, identifier_type, ., token, (, ), ., data, ), ;, if, (, info, ==, null, ), {, return, try, self, ., extract_ast, (, address, ,, identifier_type, ., symbol, (, ), .?, ., init_typedef, (, ), .?, ,, span, ), ;, }, switch, (, info, .?, ., type_kind, ), {, ., type, =>, {, const, stack_value, =, self, ., memory, ., load_unsigned_int, (, address, ,, 8, ), ;, if, (, stack_value, ==, 0xAAAAAAAAAAAAAAAA, ), {, return, prelude_, ., unit_value, ;, }, else, {, return, @, ptrFromInt, (, stack_value, ), ;, }, }, ,, ., string, =>, {, const, idx, =, self, ., memory, ., load, (, Interned_String_Set, ., String_Idx, ,, address, ), ;, const, interned_strings, =, self, ., ctx, ., module_interned_strings, ., get, (, idx, ., module_uid, ), ;, std, ., debug, ., assert, (, idx, ., module_uid, ==, interned_strings, .?, ., uid, ), ;, const, string, =, interned_strings, .?, ., items, (, ), [, idx, ., string_idx, ], ;, return, ast_, ., AST, ., create_string, (, Token, ., init_simple, (, "\"", ), ,, string, ,, self, ., ctx, ., allocator, (, ), ), ;, }, ,, ., none, =>, unreachable, ,, ., boolean, =>, {, const, val, =, self, ., memory, ., load_int, (, address, ,, info, .?, ., size, ), ;, if, (, val, ==, 0, ), {, return, ast_, ., AST, ., create_false, (, Token, ., init_simple, (, "false", ), ,, self, ., ctx, ., allocator, (, ), ), ;, }, else, {, return, ast_, ., AST, ., create_true, (, Token, ., init_simple, (, "true", ), ,, self, ., ctx, ., allocator, (, ), ), ;, }, }, ,, ., signed_integer, =>, {, const, retval, =, ast_, ., AST, ., create_int, (, Token, ., init_simple, (, "signed int", ), ,, self, ., memory, ., load_int, (, address, ,, info, .?, ., size, ), ,, self, ., ctx, ., allocator, (, ), ,, ), ;, return, retval, ;, }, ,, ., unsigned_integer, =>, {, const, retval, =, ast_, ., AST, ., create_int, (, Token, ., init_simple, (, "unsigned int", ), ,, self, ., memory, ., load_int, (, address, ,, info, .?, ., size, ), ,, self, ., ctx, ., allocator, (, ), ,, ), ;, return, retval, ;, }, ,, ., floating_point, =>, {, const, retval, =, ast_, ., AST, ., create_float, (, Token, ., init_simple, (, "float", ), ,, self, ., memory, ., load_float, (, address, ,, info, .?, ., size, ), ,, self, ., ctx, ., allocator, (, ), ,, ), ;, return, retval, ;, }, ,, }, }, fn, extract_function, (, self, :, *, Self, ,, address, :, i64, ), Error, !, *, ast_, ., AST, {, const, stack_value, =, @, as, (, usize, ,, @, intCast, (, self, ., memory, ., load_int, (, address, ,, 8, ), ), ), ;, const, symbol, :, *, Symbol, =, @, ptrFromInt, (, stack_value, ), ;, const, ast, =, ast_, ., AST, ., create_pattern_symbol, (, Token, ., init_simple, (, "function", ), ,, ., @, "fn", ,, ., local, ,, symbol, ., name, ,, self, ., ctx, ., allocator, (, ), ,, ), ;, ast, ., set_symbol, (, symbol, ), ;, return, ast, ;, }, fn, extract_enum_type, (, self, :, *, Self, ,, address, :, i64, ,, enum_type, :, *, Type_AST, ,, span, :, Span, ), Error, !, *, ast_, ., AST, {, const, tag, =, self, ., memory, ., load_int, (, address, +, enum_type, ., sizeof, (, ), -, 8, ,, 8, ), ;, const, token, =, enum_type, ., children, (, ), ., items, [, @, intCast, (, tag, ), ], ., annotation, ., pattern, ., token, (, ), ;, var, retval, =, ast_, ., AST, ., create_enum_value, (, token, ,, self, ., ctx, ., allocator, (, ), ), ;, retval, ., set_pos, (, @, as, (, usize, ,, @, intCast, (, tag, ), ), ), ;, retval, ., enum_value, ., base, =, enum_type, ;, const, proper_term, :, *, Type_AST, =, enum_type, ., children, (, ), ., items, [, @, as, (, usize, ,, @, intCast, (, tag, ), ), ], ;, retval, ., enum_value, ., init, =, try, self, ., extract_ast, (, address, ,, proper_term, ,, span, ), ;, return, retval, ;, }, fn, extract_struct_type, (, self, :, *, Self, ,, address, :, i64, ,, struct_type, :, *, Type_AST, ,, span, :, Span, ), Error, !, *, ast_, ., AST, {, if, (, struct_type, ., types_match, (, prelude_, ., string_type, ), ), {, const, idx, =, self, ., memory, ., load, (, Interned_String_Set, ., String_Idx, ,, address, ), ;, const, interned_strings, =, self, ., ctx, ., module_interned_strings, ., get, (, idx, ., module_uid, ), ;, std, ., debug, ., assert, (, idx, ., module_uid, ==, interned_strings, .?, ., uid, ), ;, const, string, =, interned_strings, .?, ., items, (, ), [, idx, ., string_idx, ], ;, return, ast_, ., AST, ., create_string, (, Token, ., init_simple, (, "\"", ), ,, string, ,, self, ., ctx, ., allocator, (, ), ), ;, }, var, value_terms, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, errdefer, value_terms, ., deinit, (, ), ;, for, (, 0.., ,, struct_type, ., children, (, ), ., items, ), |, i, ,, term, |, {, const, offset, =, struct_type, ., struct_type, ., get_offset, (, i, ), ;, const, extracted_term, =, try, self, ., extract_ast, (, address, +, offset, ,, term, ,, span, ), ;, value_terms, ., append, (, extracted_term, ), catch, unreachable, ;, }, return, ast_, ., AST, ., create_struct_value, (, struct_type, ., token, (, ), ,, struct_type, ,, value_terms, ,, self, ., ctx, ., allocator, (, ), ), ;, }, fn, extract_tuple_type, (, self, :, *, Self, ,, address, :, i64, ,, tuple_type, :, *, Type_AST, ,, span, :, Span, ), Error, !, *, ast_, ., AST, {, var, value_terms, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, errdefer, value_terms, ., deinit, (, ), ;, for, (, 0.., ,, tuple_type, ., children, (, ), ., items, ), |, i, ,, term, |, {, const, offset, =, tuple_type, ., tuple_type, ., get_offset, (, i, ), ;, const, extracted_term, =, try, self, ., extract_ast, (, address, +, offset, ,, term, ,, span, ), ;, value_terms, ., append, (, extracted_term, ), catch, unreachable, ;, }, return, ast_, ., AST, ., create_tuple_value, (, tuple_type, ., token, (, ), ,, value_terms, ,, self, ., ctx, ., allocator, (, ), ), ;, }, fn, extract_array_type, (, self, :, *, Self, ,, address, :, i64, ,, array_type, :, *, Type_AST, ,, span, :, Span, ), Error, !, *, ast_, ., AST, {, var, value_terms, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, errdefer, value_terms, ., deinit, (, ), ;, const, length, :, usize, =, @, intCast, (, array_type, ., array_of, ., len, ., int, ., data, ), ;, const, elem_type, =, array_type, ., child, (, ), ;, for, (, 0..length, ), |, i, |, {, const, offset, =, array_type, ., array_of, ., get_offset, (, i, ), ;, const, extracted_term, =, try, self, ., extract_ast, (, address, +, offset, ,, elem_type, ,, span, ), ;, value_terms, ., append, (, extracted_term, ), catch, unreachable, ;, }, return, ast_, ., AST, ., create_array_value, (, array_type, ., token, (, ), ,, value_terms, ,, self, ., ctx, ., allocator, (, ), ), ;, }, fn, print_registers, (, self, :, *, Self, ), void, {, const, module, :, ?, *, module_, ., Module, =, self, ., curr_module, (, ), catch, null, ;, std, ., debug, ., print, (, "bp:0x{X} sp:0x{X} ip:[{s}#{}]@{X}\n", ,, ., {, self, ., base_pointer, ,, self, ., stack_pointer, ,, if, (, module, !=, null, ), module, .?, ., name, (, ), else, "?", ,, self, ., instruction_pointer, ., module_uid, ,, self, ., instruction_pointer, ., inst_idx, ,, }, ), ;, }, fn, print_stack, (, self, :, *, Self, ), void, {, self, ., memory, ., print_memory, (, 0, ,, @, as, (, usize, ,, @, intCast, (, self, ., stack_pointer, ), ), ), ;, }, fn, print_debug_stack, (, self, :, *, Self, ), void, {, for, (, 0..self.debug_call_stack.items.len, ), |, i, |, {, const, span, =, self, ., debug_call_stack, ., items, [, i, ], ;, std, ., debug, ., print, (, "{}: {s}\n", ,, ., {, i, ,, span, ., line_text, }, ), ;, }, std, ., debug, ., print, (, "\n", ,, ., {, }, ), ;, }, fn, curr_instruction, (, self, :, *, Self, ), error, {, CompileError, }, !, *, Instruction, {, const, module, =, try, self, ., curr_module, (, ), ;, return, module, ., instructions, ., items, [, @, as, (, usize, ,, @, intCast, (, self, ., instruction_pointer, ., inst_idx, ), ), ], ;, }, pub, fn, curr_module, (, self, :, *, Self, ), error, {, CompileError, }, !, *, module_, ., Module, {, return, self, ., modules, ., get, (, self, ., instruction_pointer, ., module_uid, ), orelse, self, ., interpreter_panic, (, "interpreter error: attempt to use module 0x{X}, which hasn't been loaded yet\n", ,, ., {, self, ., instruction_pointer, ., module_uid, }, ), ;, }, fn, binop_load_int, (, self, :, *, Self, ,, src1, :, *, lval_, ., L_Value, ,, src2, :, *, lval_, ., L_Value, ), !, struct, {, src1, :, i128, ,, src2, :, i128, }, {, return, ., {, ., src1, =, self, ., memory, ., load_int, (, try, self, ., effective_address, (, src1, ), ,, src1, ., expanded_type_sizeof, (, ), ), ,, ., src2, =, self, ., memory, ., load_int, (, try, self, ., effective_address, (, src2, ), ,, src2, ., expanded_type_sizeof, (, ), ), ,, }, ;, }, fn, binop_load_float, (, self, :, *, Self, ,, src1, :, *, lval_, ., L_Value, ,, src2, :, *, lval_, ., L_Value, ), !, struct, {, src1, :, f64, ,, src2, :, f64, }, {, return, ., {, ., src1, =, self, ., memory, ., load_float, (, try, self, ., effective_address, (, src1, ), ,, src1, ., expanded_type_sizeof, (, ), ), ,, ., src2, =, self, ., memory, ., load_float, (, try, self, ., effective_address, (, src2, ), ,, src2, ., expanded_type_sizeof, (, ), ), ,, }, ;, }, fn, move_lval_list, (, self, :, *, Self, ,, dest, :, i64, ,, list, :, *, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ,, ), !, void, {, std, ., debug, ., assert, (, dest, >=, 0, ), ;, var, cursor, =, dest, ;, for, (, list, ., items, ), |, lval, |, {, cursor, =, alignment_, ., next_alignment, (, cursor, ,, lval, ., expanded_type_alignof, (, ), ), ;, const, src, =, try, self, ., effective_address, (, lval, ), ;, const, len, =, lval, ., expanded_type_sizeof, (, ), ;, self, ., memory, ., move, (, cursor, ,, src, ,, len, ), ;, cursor, +=, len, ;, }, }, fn, effective_address, (, self, :, *, Self, ,, lval, :, *, lval_, ., L_Value, ), error, {, CompileError, }, !, i64, {, switch, (, lval, .*, ), {, ., symbver, =>, {, if, (, std, ., mem, ., eql, (, u8, ,, "_retval", ,, lval, ., symbver, ., symbol, ., name, ), ), {, return, self, ., memory, ., load, (, i64, ,, self, ., base_pointer, +, CFG, ., retval_offset, ), ;, }, else, if, (, lval, ., symbver, ., symbol, ., offset, ==, null, ), {, if, (, lval, ., symbver, ., def, !=, null, ), {, self, ., debug_call_stack, ., append, (, lval, ., symbver, ., def, .?, ., span, ), catch, unreachable, ;, return, self, ., interpreter_panic, (, "interpreter error: variable `{s}` isn't comptime known\n", ,, ., {, lval, ., symbver, ., symbol, ., name, }, ), ;, }, else, {, self, ., debug_call_stack, ., append, (, lval, ., symbver, ., symbol, ., span, (, ), ), catch, unreachable, ;, return, self, ., interpreter_panic, (, "interpreter error: variable `{s}` isn't comptime known\n", ,, ., {, lval, ., symbver, ., symbol, ., name, }, ), ;, }, }, else, {, return, self, ., base_pointer, +, lval, ., symbver, ., symbol, ., offset, .?, ;, }, }, ,, ., dereference, =>, return, self, ., memory, ., load, (, i64, ,, try, self, ., effective_address, (, lval, ., dereference, ., expr, ), ), ,, ., index, =>, {, const, base, =, try, self, ., effective_address, (, lval, ., index, ., lhs, ), ;, const, index, =, self, ., memory, ., load, (, i64, ,, try, self, ., effective_address, (, lval, ., index, ., rhs, ), ), ;, return, base, +, index, *, lval, ., expanded_type_sizeof, (, ), ;, }, ,, ., select, =>, {, const, base, =, try, self, ., effective_address, (, lval, ., select, ., lhs, ), ;, return, base, +, lval, ., select, ., offset, ;, }, ,, ., raw_address, =>, return, lval, ., raw_address, ., adrs, ,, }, }, fn, pop_int, (, self, :, *, Self, ,, int_size_bytes, :, i64, ), i128, {, self, ., stack_pointer, -=, int_size_bytes, ;, return, self, ., memory, ., load_int, (, self, ., stack_pointer, ,, int_size_bytes, ), ;, }, fn, pop, (, self, :, *, Self, ,, comptime, T, :, type, ), T, {, const, t_size, :, usize, =, @, sizeOf, (, T, ), ;, self, ., stack_pointer, -=, t_size, ;, return, self, ., memory, ., load, (, T, ,, self, ., stack_pointer, ), ;, }, fn, push_int, (, self, :, *, Self, ,, size, :, i64, ,, val, :, i128, ), error, {, CompileError, }, !, void, {, try, self, ., memory_check, (, size, ), ;, self, ., memory, ., store_int, (, self, ., stack_pointer, ,, size, ,, val, ), ;, self, ., stack_pointer, +=, size, ;, }, fn, push_move, (, self, :, *, Self, ,, block_addr, :, i64, ,, block_size, :, i64, ), error, {, CompileError, }, !, void, {, try, self, ., memory_check, (, block_size, ), ;, self, ., memory, ., move, (, self, ., stack_pointer, ,, block_addr, ,, block_size, ), ;, self, ., stack_pointer, +=, block_size, ;, }, fn, push, (, self, :, *, Self, ,, comptime, T, :, type, ,, val, :, T, ), error, {, CompileError, }, !, void, {, const, t_size, :, usize, =, @, sizeOf, (, T, ), ;, try, self, ., memory_check, (, t_size, ), ;, self, ., memory, ., store, (, T, ,, self, ., stack_pointer, ,, val, ), ;, self, ., stack_pointer, +=, t_size, ;, }, fn, assert_fits, (, self, :, *, Self, ,, val, :, i128, ,, _type, :, *, Type_AST, ,, operation_name, :, [, ], const, u8, ,, span, :, Span, ), error, {, CompileError, }, !, void, {, const, bounds, =, prelude_, ., bounds_from_ast, (, _type, ), orelse, return, ;, if, (, val, <, bounds, ., lower, or, val, >, bounds, ., upper, ), {, self, ., debug_call_stack, ., append, (, span, ), catch, unreachable, ;, return, self, ., interpreter_panic, (, "interpreter error: {s} is out of bounds; value={}\n", ,, ., {, operation_name, ,, val, }, ), ;, }, }, fn, memory_check, (, self, :, *, Self, ,, space_needed, :, i64, ), error, {, CompileError, }, !, void, {, if, (, self, ., bump_alloc_pointer, -|, self, ., stack_pointer, <, space_needed, ), {, return, self, ., interpreter_panic, (, "interpreter error: out of memory!\n", ,, ., {, }, ), ;, }, }, fn, interpreter_panic, (, self, :, *, Self, ,, comptime, msg, :, [, ], const, u8, ,, args, :, anytype, ), error, {, CompileError, }, {, var, stdout, =, std, ., fs, ., File, ., stdout, (, ), ;, var, buf, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, std, ., heap, ., page_allocator, ), ;, defer, buf, ., deinit, (, ), ;, buf, ., print, (, msg, ,, args, ), catch, return, error, ., CompileError, ;, var, i, =, self, ., debug_call_stack, ., items, ., len, -, 1, ;, while, (, true, ), {, const, stack_span, =, self, ., debug_call_stack, ., items, [, i, ], ;, stack_span, ., print_debug_line, (, &, buf, ,, Span, ., interpreter_format, ), catch, return, error, ., CompileError, ;, if, (, i, ==, 0, ), {, break, ;, }, else, {, i, -=, 1, ;, }, }, stdout, ., writeAll, (, buf, ., items, ), catch, unreachable, ;, return, error, ., CompileError, ;, }, const, std, =, @, import, (, "std", ), ;, const, Self, :, type, =, @, This, (, ), ;, const, memory_debugger, :, bool, =, false, ;, memory, :, [, ], u8, ,, pub, fn, init, (, memory, :, [, ], u8, ), Self, {, return, Self, {, ., memory, =, memory, }, ;, }, pub, fn, move, (, self, :, *, Self, ,, dest, :, i64, ,, src, :, i64, ,, len, :, i64, ), void, {, if, (, memory_debugger, ), {, std, ., debug, ., print, (, "dest:0x{X} src:0x{X} len:0x{X}\n", ,, ., {, dest, ,, src, ,, len, }, ), ;, }, std, ., debug, ., assert, (, dest, >=, 0, ), ;, std, ., debug, ., assert, (, src, >=, 0, ), ;, if, (, len, ==, 0, ), {, return, ;, }, std, ., debug, ., assert, (, dest, !=, src, ), ;, if, (, dest, >, src, ), {, std, ., debug, ., assert, (, dest, >=, src, +, len, ), ;, }, else, {, std, ., debug, ., assert, (, src, >=, dest, +, len, ), ;, }, @, memcpy, (, self, ., memory, [, @, as, (, usize, ,, @, intCast, (, dest, ), ), .., @, as, (, usize, ,, @, intCast, (, dest, +, len, ), ), ], ,, self, ., memory, [, @, as, (, usize, ,, @, intCast, (, src, ), ), .., @, as, (, usize, ,, @, intCast, (, src, +, len, ), ), ], ,, ), ;, }, pub, fn, store_int, (, self, :, *, Self, ,, address, :, i64, ,, size, :, i64, ,, val, :, i128, ), void, {, std, ., debug, ., assert, (, address, >=, 0, ), ;, switch, (, size, ), {, 1, =>, self, ., store, (, i8, ,, address, ,, @, as, (, i8, ,, @, intCast, (, val, ), ), ), ,, 2, =>, self, ., store, (, i16, ,, address, ,, @, as, (, i16, ,, @, intCast, (, val, ), ), ), ,, 4, =>, self, ., store, (, i32, ,, address, ,, @, as, (, i32, ,, @, intCast, (, val, ), ), ), ,, 8, =>, self, ., store, (, i64, ,, address, ,, @, as, (, i64, ,, @, intCast, (, val, ), ), ), ,, else, =>, std, ., debug, ., panic, (, "interpreter error: cannot store an int of size {}\n", ,, ., {, size, }, ), ,, }, }, pub, fn, store_float, (, self, :, *, Self, ,, address, :, i64, ,, size, :, i64, ,, val, :, f64, ), void, {, std, ., debug, ., assert, (, address, >=, 0, ), ;, switch, (, size, ), {, 4, =>, self, ., store, (, f32, ,, address, ,, @, as, (, f32, ,, @, floatCast, (, val, ), ), ), ,, 8, =>, self, ., store, (, f64, ,, address, ,, val, ), ,, else, =>, unreachable, ,, }, }, pub, fn, load_int, (, self, :, *, Self, ,, address, :, i64, ,, size, :, i64, ), i128, {, std, ., debug, ., assert, (, address, >=, 0, ), ;, return, switch, (, size, ), {, 1, =>, self, ., load, (, i8, ,, address, ), ,, 2, =>, self, ., load, (, i16, ,, address, ), ,, 4, =>, self, ., load, (, i32, ,, address, ), ,, 8, =>, self, ., load, (, i64, ,, address, ), ,, else, =>, unreachable, ,, }, ;, }, pub, fn, load_unsigned_int, (, self, :, *, Self, ,, address, :, i64, ,, size, :, i64, ), u64, {, std, ., debug, ., assert, (, address, >=, 0, ), ;, return, switch, (, size, ), {, 1, =>, self, ., load, (, u8, ,, address, ), ,, 2, =>, self, ., load, (, u16, ,, address, ), ,, 4, =>, self, ., load, (, u32, ,, address, ), ,, 8, =>, self, ., load, (, u64, ,, address, ), ,, else, =>, unreachable, ,, }, ;, }, pub, fn, load_float, (, self, :, *, Self, ,, address, :, i64, ,, size, :, i64, ), f64, {, std, ., debug, ., assert, (, address, >=, 0, ), ;, return, switch, (, size, ), {, 4, =>, self, ., load, (, f32, ,, address, ), ,, 8, =>, self, ., load, (, f64, ,, address, ), ,, else, =>, unreachable, ,, }, ;, }, pub, fn, store, (, self, :, *, Self, ,, comptime, T, :, type, ,, address, :, i64, ,, val, :, T, ), void, {, std, ., debug, ., assert, (, address, >=, 0, ), ;, @, as, (, *, T, ,, @, alignCast, (, @, ptrCast, (, &, self, ., memory, [, @, as, (, usize, ,, @, intCast, (, address, ), ), ], ), ), ), .*, =, val, ;, }, pub, fn, load, (, self, :, *, Self, ,, comptime, T, :, type, ,, address, :, i64, ), T, {, std, ., debug, ., assert, (, address, >=, 0, ), ;, const, val, =, @, as, (, *, T, ,, @, ptrCast, (, @, alignCast, (, &, self, ., memory, [, @, as, (, usize, ,, @, intCast, (, address, ), ), ], ), ), ), .*, ;, return, val, ;, }, pub, fn, print_memory, (, self, :, *, Self, ,, start, :, usize, ,, end, :, usize, ), void, {, for, (, start, .., end, ), |, i, |, {, if, (, @, rem, (, i, ,, 8, ), ==, 0, ), {, std, ., debug, ., print, (, "0x{0X:0>2.}: ", ,, ., {, i, }, ), ;, }, std, ., debug, ., print, (, "{X:0>2.}", ,, ., {, self, ., memory, [, i, ], }, ), ;, if, (, @, rem, (, i, ,, 8, ), ==, 7, ), {, std, ., debug, ., print, (, " ", ,, ., {, }, ), ;, }, if, (, @, rem, (, i, ,, 32, ), ==, 31, ), {, std, ., debug, ., print, (, "\n", ,, ., {, }, ), ;, }, }, }, const, std, =, @, import, (, "std", ), ;, const, Instruction, =, @, import, (, "../ir/instruction.zig", ), ;, const, lval_, =, @, import, (, "../ir/lval.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Type_Set, =, @, import, (, "../types/type_set.zig", ), ;, const, Self, =, @, This, (, ), ;, var, uid_counter, :, u64, =, 0, ;, pub, const, Terminator, =, union, (, enum, ), {, unconditional, :, ?, *, Self, ,, conditional, :, struct, {, true_target, :, ?, *, Self, ,, false_target, :, ?, *, Self, ,, condition, :, *, lval_, ., L_Value, ,, }, ,, panic, ,, }, ;, uid, :, u64, ,, instructions, :, std, ., array_list, ., Managed, (, *, Instruction, ), ,, terminator, :, Terminator, ,, marked_instrs, :, std, ., AutoArrayHashMap, (, *, Instruction, ,, void, ), ,, removed_instrs, :, std, ., array_list, ., Managed, (, *, Instruction, ), ,, visited, :, bool, ,, number_predecessors, :, usize, ,, allocator, :, std, ., mem, ., Allocator, ,, offset_table, :, std, ., array_hash_map, ., AutoArrayHashMap, (, u32, ,, Instruction, ., Index, ), ,, pub, fn, init, (, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, allocator, ., create, (, Self, ), catch, unreachable, ;, retval, ., instructions, =, std, ., array_list, ., Managed, (, *, Instruction, ), ., init, (, allocator, ), ;, retval, ., terminator, =, ., panic, ;, retval, ., offset_table, =, std, ., array_hash_map, ., AutoArrayHashMap, (, u32, ,, Instruction, ., Index, ), ., init, (, allocator, ), ;, retval, ., marked_instrs, =, std, ., AutoArrayHashMap, (, *, Instruction, ,, void, ), ., init, (, allocator, ), ;, retval, ., removed_instrs, =, std, ., array_list, ., Managed, (, *, Instruction, ), ., init, (, allocator, ), ;, retval, ., uid, =, uid_counter, ;, uid_counter, +=, 1, ;, retval, ., allocator, =, allocator, ;, return, retval, ;, }, pub, fn, deinit, (, self, :, *, Self, ), void, {, for, (, self, ., instructions, ., items, ), |, instr, |, {, instr, ., deinit, (, ), ;, }, self, ., instructions, ., deinit, (, ), ;, for, (, self, ., removed_instrs, ., items, ), |, instr, |, {, instr, ., deinit, (, ), ;, }, self, ., removed_instrs, ., deinit, (, ), ;, self, ., allocator, ., destroy, (, self, ), ;, }, pub, fn, pprint, (, self, :, *, Self, ), void, {, if, (, self, ., visited, ), {, return, ;, }, self, ., visited, =, true, ;, std, ., debug, ., print, (, "BB{}", ,, ., {, self, ., uid, }, ), ;, std, ., debug, ., print, (, ":\n", ,, ., {, }, ), ;, for, (, self, ., instructions, ., items, ), |, instr, |, {, std, ., debug, ., print, (, "{f}", ,, ., {, instr, }, ), ;, }, switch, (, self, ., terminator, ), {, ., unconditional, =>, {, if, (, self, ., terminator, ., unconditional, ), |, next, |, {, std, ., debug, ., print, (, "    jump BB{}", ,, ., {, next, ., uid, }, ), ;, }, else, {, std, ., debug, ., print, (, "    return", ,, ., {, }, ), ;, }, }, ,, ., conditional, =>, {, if, (, self, ., terminator, ., conditional, ., true_target, ), |, next, |, {, std, ., debug, ., print, (, "    if ({f}) jump BB{}", ,, ., {, self, ., terminator, ., conditional, ., condition, ,, next, ., uid, }, ), ;, }, else, {, std, ., debug, ., print, (, "    if ({f}) return", ,, ., {, self, ., terminator, ., conditional, ., condition, }, ), ;, }, std, ., debug, ., print, (, " ", ,, ., {, }, ), ;, if, (, self, ., terminator, ., conditional, ., false_target, ), |, branch, |, {, std, ., debug, ., print, (, "else jump BB{}", ,, ., {, branch, ., uid, }, ), ;, }, else, {, std, ., debug, ., print, (, "else return", ,, ., {, }, ), ;, }, }, ,, ., panic, =>, {, std, ., debug, ., print, (, "    panic", ,, ., {, }, ), ;, }, ,, }, std, ., debug, ., print, (, "\n\n", ,, ., {, }, ), ;, if, (, self, ., terminator, ==, ., unconditional, and, self, ., terminator, ., unconditional, !=, null, ), {, self, ., terminator, ., unconditional, .?, ., pprint, (, ), ;, }, if, (, self, ., terminator, ==, ., conditional, ), {, if, (, self, ., terminator, ., conditional, ., true_target, ), |, next, |, {, next, ., pprint, (, ), ;, }, if, (, self, ., terminator, ., conditional, ., false_target, ), |, branch, |, {, branch, ., pprint, (, ), ;, }, }, }, pub, fn, empty, (, self, :, *, Self, ), bool, {, return, self, ., instructions, ., items, ., len, ==, 0, ;, }, pub, fn, first_instruction, (, self, :, *, Self, ), *, Instruction, {, return, self, ., instructions, ., items, [, 0, ], ;, }, pub, fn, mark_for_removal, (, self, :, *, Self, ,, instr, :, *, Instruction, ), void, {, self, ., marked_instrs, ., put, (, instr, ,, void, {, }, ), catch, unreachable, ;, }, pub, fn, mark_all_instructions_as_removed, (, self, :, *, Self, ), void, {, for, (, self, ., instructions, ., items, ), |, instr, |, {, self, ., mark_for_removal, (, instr, ), ;, }, }, pub, fn, remove_marked_instrs, (, self, :, *, Self, ), void, {, var, i, :, usize, =, 0, ;, while, (, i, <, self, ., instructions, ., items, ., len, ), {, const, instr, =, self, ., instructions, ., items, [, i, ], ;, if, (, self, ., marked_instrs, ., contains, (, instr, ), ), {, const, removed, =, self, ., instructions, ., orderedRemove, (, i, ), ;, self, ., removed_instrs, ., append, (, removed, ), catch, unreachable, ;, }, else, {, i, +=, 1, ;, }, }, self, ., marked_instrs, ., clearRetainingCapacity, (, ), ;, }, pub, fn, merge_with, (, self, :, *, Self, ,, other, :, *, Self, ), void, {, for, (, other, ., instructions, ., items, ), |, instr, |, {, instr, ., in_block, =, self, ;, self, ., instructions, ., append, (, instr, ), catch, unreachable, ;, }, self, ., terminator, =, other, ., terminator, ;, }, pub, fn, any_def_after, (, self, :, *, Self, ,, start_at_instr, :, *, Instruction, ,, symbol, :, *, Symbol, ,, stop_at_instr, :, ?, *, Instruction, ), ?, *, Instruction, {, const, idx, =, std, ., mem, ., indexOfScalar, (, *, Instruction, ,, self, ., instructions, ., items, ,, start_at_instr, ), ;, if, (, idx, ==, null, ), {, return, null, ;, }, for, (, self, ., instructions, ., items, [, idx, .?, .., ], ), |, instr, |, {, if, (, instr, ==, stop_at_instr, ), {, break, ;, }, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, .*, ==, ., select, and, instr, ., dest, .?, ., extract_symbver, (, ), ., symbol, ==, symbol, ), {, return, instr, ;, }, else, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, .*, ==, ., index, and, instr, ., dest, .?, ., extract_symbver, (, ), ., symbol, ==, symbol, ), {, return, instr, ;, }, else, if, (, instr, ., kind, ==, ., mut_addr_of, and, instr, ., src1, .?, ., extract_symbver, (, ), ., symbol, ==, symbol, ), {, return, instr, ;, }, else, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, .*, ==, ., symbver, and, instr, ., dest, .?, ., symbver, ., symbol, ==, symbol, ), {, return, instr, ;, }, }, return, null, ;, }, pub, fn, get_latest_def, (, self, :, *, Self, ,, lval, :, *, lval_, ., L_Value, ,, stop_at_instr, :, ?, *, Instruction, ,, ), ?, *, Instruction, {, if, (, lval, .*, !=, ., symbver, ), {, return, null, ;, }, if, (, self, ., empty, (, ), ), {, return, null, ;, }, else, {, return, self, ., get_latest_def_after, (, self, ., first_instruction, (, ), ,, lval, ., symbver, ., symbol, ,, stop_at_instr, ), ;, }, }, pub, fn, get_latest_def_after, (, self, :, *, Self, ,, start_at_instr, :, *, Instruction, ,, symbol, :, *, Symbol, ,, stop_at_instr, :, ?, *, Instruction, ), ?, *, Instruction, {, var, retval, :, ?, *, Instruction, =, null, ;, const, idx, =, std, ., mem, ., indexOfScalar, (, *, Instruction, ,, self, ., instructions, ., items, ,, start_at_instr, ), ;, if, (, idx, ==, null, ), {, return, null, ;, }, for, (, self, ., instructions, ., items, [, idx, .?, .., ], ), |, instr, |, {, if, (, instr, ==, stop_at_instr, ), {, break, ;, }, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, .*, ==, ., select, and, instr, ., dest, .?, ., extract_symbver, (, ), ., symbol, ==, symbol, ), {, return, null, ;, }, else, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, .*, ==, ., index, and, instr, ., dest, .?, ., extract_symbver, (, ), ., symbol, ==, symbol, ), {, return, null, ;, }, else, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, .*, ==, ., symbver, and, instr, ., dest, .?, ., symbver, ., symbol, ==, symbol, ), {, retval, =, instr, ;, }, else, if, (, instr, ., kind, ==, ., mut_addr_of, and, instr, ., src1, .?, ., extract_symbver, (, ), ., symbol, ==, symbol, ), {, retval, =, null, ;, }, }, return, retval, ;, }, pub, fn, count_predecessors, (, self, :, *, Self, ), void, {, self, ., number_predecessors, +=, 1, ;, if, (, self, ., visited, ), {, return, ;, }, self, ., visited, =, true, ;, switch, (, self, ., terminator, ), {, ., unconditional, =>, |, uncond, |, {, if, (, uncond, ), |, next, |, {, next, ., count_predecessors, (, ), ;, }, }, ,, ., conditional, =>, |, cond, |, {, if, (, cond, ., true_target, ), |, true_target, |, {, true_target, ., count_predecessors, (, ), ;, }, if, (, cond, ., false_target, ), |, false_target, |, {, false_target, ., count_predecessors, (, ), ;, }, }, ,, ., panic, =>, {, }, ,, }, }, pub, fn, append_instructions, (, self, :, *, Self, ,, module_uid, :, u32, ,, instructions_list, :, *, std, ., array_list, ., Managed, (, *, Instruction, ), ,, work_queue, :, *, std, ., array_list, ., Managed, (, *, Self, ), ), void, {, self, ., offset_table, ., put, (, module_uid, ,, @, as, (, Instruction, ., Index, ,, @, intCast, (, instructions_list, ., items, ., len, ), ), -|, 1, ), catch, unreachable, ;, for, (, self, ., instructions, ., items, ), |, instr, |, {, instructions_list, ., append, (, instr, ), catch, unreachable, ;, }, switch, (, self, ., terminator, ), {, ., unconditional, =>, {, if, (, self, ., terminator, ., unconditional, ), |, next, |, {, work_queue, ., append, (, next, ), catch, unreachable, ;, }, instructions_list, ., append, (, Instruction, ., init_jump_addr, (, self, ., terminator, ., unconditional, ,, Span, ., phony, ,, self, ., allocator, ,, ), ), catch, unreachable, ;, }, ,, ., conditional, =>, {, if, (, self, ., terminator, ., conditional, ., true_target, ), |, next, |, {, work_queue, ., append, (, next, ), catch, unreachable, ;, }, if, (, self, ., terminator, ., conditional, ., false_target, ), |, branch, |, {, work_queue, ., append, (, branch, ), catch, unreachable, ;, }, instructions_list, ., append, (, Instruction, ., init_branch_addr, (, self, ., terminator, ., conditional, ., condition, ,, self, ., terminator, ., conditional, ., true_target, ,, self, ., terminator, ., conditional, ., false_target, ,, Span, ., phony, ,, self, ., allocator, ,, ), ), catch, unreachable, ;, }, ,, ., panic, =>, {, }, ,, }, }, pub, fn, collect_basic_block_types, (, self, :, *, Self, ,, type_set, :, *, Type_Set, ), void, {, for, (, self, ., instructions, ., items, ), |, instr, |, {, if, (, instr, ., dest, !=, null, ), {, _, =, type_set, ., add_type, (, instr, ., dest, .?, ., get_expanded_type, (, ), ), ;, _, =, type_set, ., add_type, (, instr, ., dest, .?, ., extract_symbver, (, ), ., symbol, ., expanded_type, (, ), ), ;, }, }, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, alignment_, =, @, import, (, "../util/alignment.zig", ), ;, const, Basic_Block, =, @, import, (, "../ir/basic-block.zig", ), ;, const, Instruction, =, @, import, (, "../ir/instruction.zig", ), ;, const, lval_, =, @, import, (, "../ir/lval.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Symbol_Version, =, @, import, (, "symbol_version.zig", ), ;, const, Type_Set, =, @, import, (, "../types/type_set.zig", ), ;, const, Self, =, @, This, (, ), ;, pub, const, retval_offset, :, i64, =, -, 3, *, @, sizeOf, (, i64, ), ;, pub, const, locals_starting_offset, =, 8, ;, block_graph_head, :, ?, *, Basic_Block, ,, basic_blocks, :, std, ., array_list, ., Managed, (, *, Basic_Block, ), ,, children, :, std, ., AutoArrayHashMap, (, *, Self, ,, void, ), ,, parameters, :, std, ., array_list, ., Managed, (, *, Symbol_Version, ), ,, symbvers, :, std, ., array_list, ., Managed, (, *, Symbol_Version, ), ,, symbol, :, *, Symbol, ,, return_symbol, :, *, Symbol, ,, needed_at_runtime, :, bool, ,, offset_table, :, std, ., array_hash_map, ., AutoArrayHashMap, (, u32, ,, Instruction, ., Index, ), ,, locals_size, :, ?, i64, ,, allocator, :, std, ., mem, ., Allocator, ,, pub, fn, init, (, symbol, :, *, Symbol, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, if, (, symbol, ., cfg, ), |, cfg, |, {, return, cfg, ;, }, var, retval, =, allocator, ., create, (, Self, ), catch, unreachable, ;, retval, ., block_graph_head, =, null, ;, retval, ., basic_blocks, =, std, ., array_list, ., Managed, (, *, Basic_Block, ), ., init, (, allocator, ), ;, retval, ., children, =, std, ., AutoArrayHashMap, (, *, Self, ,, void, ), ., init, (, allocator, ), ;, retval, ., symbvers, =, std, ., array_list, ., Managed, (, *, Symbol_Version, ), ., init, (, allocator, ), ;, retval, ., parameters, =, std, ., array_list, ., Managed, (, *, Symbol_Version, ), ., init, (, allocator, ), ;, retval, ., symbol, =, symbol, ;, retval, ., return_symbol, =, Symbol, ., init, (, symbol, ., scope, ,, "_retval", ,, ast_, ., AST, ., create_decl, (, symbol, ., decl, .?, ., token, (, ), ,, ast_, ., AST, ., create_pattern_symbol, (, symbol, ., decl, .?, ., token, (, ), ,, ., mut, ,, ., local, ,, "_retval", ,, allocator, ), ,, symbol, ., type, (, ), ., rhs, (, ), ,, null, ,, allocator, ,, ), ,, ., mut, ,, ., local, ,, allocator, ,, ), ;, _, =, retval, ., return_symbol, ., type, (, ), ., expand_identifier, (, ), ;, _, =, symbol, ., type, (, ), ., expand_identifier, (, ), ;, retval, ., needed_at_runtime, =, false, ;, retval, ., offset_table, =, std, ., array_hash_map, ., AutoArrayHashMap, (, u32, ,, Instruction, ., Index, ), ., init, (, allocator, ), ;, retval, ., locals_size, =, null, ;, retval, ., allocator, =, allocator, ;, symbol, ., cfg, =, retval, ;, return, retval, ;, }, pub, fn, deinit, (, self, :, *, Self, ), void, {, for, (, self, ., basic_blocks, ., items, ), |, bb, |, {, bb, ., deinit, (, ), ;, }, self, ., basic_blocks, ., deinit, (, ), ;, self, ., symbvers, ., deinit, (, ), ;, for, (, self, ., parameters, ., items, ), |, param, |, {, param, ., deinit, (, ), ;, }, self, ., parameters, ., deinit, (, ), ;, self, ., allocator, ., destroy, (, self, ), ;, }, pub, fn, assert_needed_at_runtime, (, self, :, *, Self, ), void, {, if, (, self, ., needed_at_runtime, ), {, return, ;, }, self, ., needed_at_runtime, =, true, ;, for, (, self, ., children, ., keys, (, ), ), |, child, |, {, child, ., assert_needed_at_runtime, (, ), ;, }, }, pub, fn, clear_visited_BBs, (, self, :, *, Self, ), void, {, for, (, self, ., basic_blocks, ., items, ), |, bb, |, {, bb, ., visited, =, false, ;, }, }, pub, fn, collect_generated_symbvers, (, self, :, *, Self, ), void, {, for, (, self, ., basic_blocks, ., items, ), |, bb, |, {, for, (, bb, ., instructions, ., items, ), |, instr, |, {, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, ., extract_symbver, (, ), ., find_symbol_version_set, (, &, self, ., parameters, ), ==, null, ), {, _, =, instr, ., dest, .?, ., extract_symbver, (, ), ., put_symbol_version_set, (, &, self, ., symbvers, ), ;, }, }, }, }, pub, fn, collect_cfg_types, (, self, :, *, Self, ,, type_set, :, *, Type_Set, ), void, {, if, (, self, ., symbol, ., decl, .?, .*, ==, ., fn_decl, and, self, ., symbol, ., decl, .?, ., num_generic_params, (, ), >, 0, ), {, return, ;, }, if, (, self, ., symbol, ., decl, .?, .*, ==, ., method_decl, and, self, ., symbol, ., decl, .?, ., method_decl, ., impl, .?, ., num_generic_params, (, ), >, 0, ), {, return, ;, }, const, decl, =, self, ., symbol, ., decl, .?, ;, const, param_symbols, =, decl, ., param_symbols, (, ), ;, if, (, param_symbols, !=, null, ), {, for, (, param_symbols, .?, ., items, ), |, param, |, {, _, =, type_set, ., add_type, (, param, ., expanded_type, (, ), ), ;, }, }, const, context_param_symbols, =, decl, ., context_param_symbols, (, ), ;, if, (, context_param_symbols, !=, null, ), {, for, (, context_param_symbols, .?, ., items, ), |, context_param, |, {, _, =, type_set, ., add_type, (, context_param, ., expanded_type, (, ), ), ;, }, }, _, =, type_set, ., add_type, (, self, ., return_symbol, ., expanded_type, (, ), ), ;, for, (, self, ., basic_blocks, ., items, ), |, bb, |, {, bb, ., collect_basic_block_types, (, type_set, ), ;, }, }, pub, fn, basic_block_from_instructions, (, self, :, *, Self, ,, instructions, :, std, ., array_list, ., Managed, (, *, Instruction, ), ,, start_index, :, ?, usize, ), ?, *, Basic_Block, {, if, (, instructions, ., items, ., len, ==, 0, or, start_index, ==, null, ), {, return, null, ;, }, else, if, (, instructions, ., items, [, start_index, .?, ], ., in_block, ), |, in_block, |, {, return, in_block, ;, }, var, block, =, Basic_Block, ., init, (, self, ., allocator, ), ;, self, ., basic_blocks, ., append, (, block, ), catch, unreachable, ;, var, end_index, :, usize, =, start_index, .?, ;, while, (, end_index, <, instructions, ., items, ., len, ), {, const, instr, =, instructions, ., items, [, end_index, ], ;, end_index, +=, 1, ;, instr, ., in_block, =, block, ;, if, (, instr, ., kind, ==, ., label, ), {, const, next_block, =, self, ., basic_block_from_instructions, (, instructions, ,, end_index, ), ;, block, ., terminator, =, ., {, ., unconditional, =, next_block, }, ;, break, ;, }, else, if, (, instr, ., kind, ==, ., jump, ), {, const, branch_next, =, instr, ., data, ., branch, ;, const, bb_index, =, if, (, branch_next, !=, null, ), std, ., mem, ., indexOfScalar, (, *, Instruction, ,, instructions, ., items, ,, branch_next, .?, ), .?, +, 1, else, null, ;, const, next_block, =, self, ., basic_block_from_instructions, (, instructions, ,, bb_index, ), ;, block, ., terminator, =, ., {, ., unconditional, =, next_block, }, ;, break, ;, }, else, if, (, instr, ., kind, ==, ., panic, ), {, end_index, +=, 1, ;, block, ., terminator, =, ., panic, ;, break, ;, }, else, if, (, instr, ., kind, ==, ., branch_if_false, ), {, const, branch_next, =, instr, ., data, ., branch, ;, const, false_target_index, =, if, (, branch_next, !=, null, ), std, ., mem, ., indexOfScalar, (, *, Instruction, ,, instructions, ., items, ,, branch_next, .?, ), .?, +, 1, else, null, ;, const, next_block, =, self, ., basic_block_from_instructions, (, instructions, ,, end_index, ), ;, const, branch_block, =, self, ., basic_block_from_instructions, (, instructions, ,, false_target_index, ), ;, block, ., terminator, =, ., {, ., conditional, =, ., {, ., condition, =, instr, ., src1, .?, ,, ., true_target, =, next_block, ,, ., false_target, =, branch_block, ,, }, }, ;, break, ;, }, }, block, ., instructions, ., appendSlice, (, instructions, ., items, [, start_index, .?, .., end_index, -, 1, ], ), catch, unreachable, ;, return, block, ;, }, pub, fn, calculate_usage, (, self, :, *, Self, ), void, {, if, (, self, ., symbol, ., decl, .?, .*, ==, ., fn_decl, or, self, ., symbol, ., decl, .?, .*, ==, ., method_decl, ), {, const, param_symbols, =, self, ., symbol, ., decl, .?, ., param_symbols, (, ), ;, if, (, param_symbols, !=, null, ), {, for, (, param_symbols, .?, ., items, ), |, param_symbol, |, {, param_symbol, ., uses, =, 0, ;, }, }, }, for, (, self, ., basic_blocks, ., items, ), |, bb, |, {, for, (, bb, ., instructions, ., items, ), |, instr, |, {, if, (, instr, ., dest, !=, null, ), {, instr, ., dest, .?, ., reset_usage, (, ), ;, }, }, }, for, (, self, ., basic_blocks, ., items, ), |, bb, |, {, for, (, bb, ., instructions, ., items, ), |, instr, |, {, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, .*, !=, ., symbver, ), {, instr, ., dest, .?, ., increment_usage, (, ), ;, }, if, (, instr, ., src1, !=, null, ), {, instr, ., src1, .?, ., increment_usage, (, ), ;, }, if, (, instr, ., src2, !=, null, ), {, instr, ., src2, .?, ., increment_usage, (, ), ;, }, if, (, instr, ., data, ==, ., lval_list, ), {, for, (, instr, ., data, ., lval_list, ., items, ), |, lval, |, {, lval, ., increment_usage, (, ), ;, }, }, if, (, instr, ., data, ==, ., call, ), {, for, (, instr, ., data, ., call, ., arg_lval_list, ., items, ), |, lval, |, {, lval, ., increment_usage, (, ), ;, }, for, (, instr, ., data, ., call, ., context_arg_lval_list, ., items, ), |, lval, |, {, lval, ., increment_usage, (, ), ;, }, }, if, (, instr, ., data, ==, ., invoke, ), {, if, (, instr, ., data, ., invoke, ., dyn_value, !=, null, ), {, instr, ., data, ., invoke, ., dyn_value, .?, ., increment_usage, (, ), ;, }, if, (, instr, ., data, ., invoke, ., method_decl_lval, !=, null, and, !, instr, ., data, ., invoke, ., method_decl, ., method_decl, ., is_virtual, ), {, instr, ., data, ., invoke, ., method_decl_lval, .?, ., increment_usage, (, ), ;, }, for, (, instr, ., data, ., invoke, ., arg_lval_list, ., items, ), |, lval, |, {, lval, ., increment_usage, (, ), ;, }, for, (, instr, ., data, ., invoke, ., context_arg_lval_list, ., items, ), |, lval, |, {, lval, ., increment_usage, (, ), ;, }, }, }, if, (, bb, ., terminator, ==, ., conditional, ), {, bb, ., terminator, ., conditional, ., condition, ., extract_symbver, (, ), ., uses, +=, 1, ;, bb, ., terminator, ., conditional, ., condition, ., extract_symbver, (, ), ., symbol, ., uses, +=, 1, ;, }, }, }, pub, fn, calculate_definitions, (, self, :, *, Self, ), void, {, for, (, self, ., basic_blocks, ., items, ), |, bb, |, {, for, (, bb, ., instructions, ., items, ), |, instr, |, {, reset_defs, (, instr, ., dest, ), ;, reset_defs, (, instr, ., src1, ), ;, reset_defs, (, instr, ., src2, ), ;, if, (, instr, ., data, ==, ., lval_list, ), {, for, (, instr, ., data, ., lval_list, ., items, ), |, lval, |, {, reset_defs, (, lval, ), ;, }, }, if, (, instr, ., data, ==, ., call, ), {, for, (, instr, ., data, ., call, ., arg_lval_list, ., items, ), |, lval, |, {, reset_defs, (, lval, ), ;, }, for, (, instr, ., data, ., call, ., context_arg_lval_list, ., items, ), |, lval, |, {, reset_defs, (, lval, ), ;, }, }, if, (, instr, ., data, ==, ., invoke, ), {, reset_defs, (, instr, ., data, ., invoke, ., dyn_value, ), ;, reset_defs, (, instr, ., data, ., invoke, ., method_decl_lval, ), ;, for, (, instr, ., data, ., invoke, ., arg_lval_list, ., items, ), |, lval, |, {, reset_defs, (, lval, ), ;, }, for, (, instr, ., data, ., invoke, ., context_arg_lval_list, ., items, ), |, lval, |, {, reset_defs, (, lval, ), ;, }, }, }, self, ., return_symbol, ., defs, =, 0, ;, }, for, (, self, ., basic_blocks, ., items, ), |, bb, |, {, for, (, bb, ., instructions, ., items, ), |, instr, |, {, if, (, instr, ., dest, !=, null, ), {, var, symbver, =, instr, ., dest, .?, ., extract_symbver, (, ), ;, symbver, ., set_def, (, instr, ), ;, }, if, (, instr, ., dest, !=, null, ), {, instr, ., dest, .?, ., extract_symbver, (, ), ., symbol, ., roots, +=, 1, ;, }, if, (, instr, ., kind, ==, ., mut_addr_of, ), {, instr, ., src1, .?, ., extract_symbver, (, ), ., symbol, ., aliases, +=, 1, ;, }, }, }, }, pub, fn, reset_defs, (, maybe_lval, :, ?, *, lval_, ., L_Value, ), void, {, if, (, maybe_lval, ==, null, ), {, return, ;, }, switch, (, maybe_lval, .?, .*, ), {, ., symbver, =>, {, maybe_lval, .?, ., symbver, ., symbol, ., defs, =, 0, ;, }, ,, ., dereference, =>, reset_defs, (, maybe_lval, .?, ., dereference, ., expr, ), ,, ., index, =>, {, reset_defs, (, maybe_lval, .?, ., index, ., length, ), ;, reset_defs, (, maybe_lval, .?, ., index, ., lhs, ), ;, reset_defs, (, maybe_lval, .?, ., index, ., rhs, ), ;, }, ,, ., select, =>, {, reset_defs, (, maybe_lval, .?, ., select, ., tag, ), ;, reset_defs, (, maybe_lval, .?, ., select, ., lhs, ), ;, }, ,, ., raw_address, =>, std, ., debug, ., panic, (, "compiler error: undefined reset_defs for raw_address", ,, ., {, }, ), ,, }, }, pub, fn, count_bb_predecessors, (, self, :, *, Self, ), void, {, for, (, self, ., basic_blocks, ., items, ), |, bb, |, {, bb, ., number_predecessors, =, 0, ;, }, self, ., clear_visited_BBs, (, ), ;, if, (, self, ., block_graph_head, ), |, head, |, {, head, ., count_predecessors, (, ), ;, }, }, pub, fn, remove_basic_block, (, self, :, *, Self, ,, bb, :, *, Basic_Block, ), void, {, _, =, self, ., basic_blocks, ., swapRemove, (, self, ., index_of_basic_block, (, bb, ), ), ;, }, fn, index_of_basic_block, (, self, :, *, Self, ,, bb, :, *, Basic_Block, ), usize, {, for, (, 0..self.basic_blocks.items.len, ), |, i, |, {, if, (, bb, ==, self, ., basic_blocks, ., items, [, i, ], ), {, return, i, ;, }, }, else, {, unreachable, ;, }, }, pub, fn, emplace_cfg, (, self, :, *, Self, ,, module_uid, :, u32, ,, cfgs, :, *, std, ., array_list, ., Managed, (, *, Self, ), ,, instructions_list, :, *, std, ., array_list, ., Managed, (, *, Instruction, ), ), i64, {, const, len, =, @, as, (, i64, ,, @, intCast, (, cfgs, ., items, ., len, ), ), ;, if, (, self, ., offset_table, ., contains, (, module_uid, ), ), {, return, len, ;, }, else, if, (, self, ., block_graph_head, ==, null, ), {, self, ., offset_table, ., put, (, module_uid, ,, self, ., append_phony_block, (, instructions_list, ), ), catch, unreachable, ;, cfgs, ., append, (, self, ), catch, unreachable, ;, }, else, {, self, ., offset_table, ., put, (, module_uid, ,, self, ., append_basic_block, (, self, ., block_graph_head, .?, ,, module_uid, ,, instructions_list, ), ), catch, unreachable, ;, cfgs, ., append, (, self, ), catch, unreachable, ;, for, (, self, ., children, ., keys, (, ), ), |, child, |, {, if, (, child, ., symbol, ., decl, .?, ., num_generic_params, (, ), >, 0, ), continue, ;, if, (, child, ., symbol, ., decl, .?, .*, ==, ., method_decl, and, child, ., symbol, ., decl, .?, ., method_decl, ., impl, .?, ., num_generic_params, (, ), >, 0, ), continue, ;, _, =, child, ., emplace_cfg, (, module_uid, ,, cfgs, ,, instructions_list, ), ;, }, }, self, ., locals_size, =, self, ., calculate_offsets, (, ), ;, return, len, ;, }, fn, append_basic_block, (, self, :, *, Self, ,, first_bb, :, *, Basic_Block, ,, module_uid, :, u32, ,, instructions_list, :, *, std, ., array_list, ., Managed, (, *, Instruction, ), ), Instruction, ., Index, {, var, work_queue, =, std, ., array_list, ., Managed, (, *, Basic_Block, ), ., init, (, self, ., allocator, ), ;, defer, work_queue, ., deinit, (, ), ;, work_queue, ., append, (, first_bb, ), catch, unreachable, ;, while, (, work_queue, ., items, ., len, >, 0, ), {, var, bb, =, work_queue, ., orderedRemove, (, 0, ), ;, if, (, bb, ., offset_table, ., contains, (, module_uid, ), ), {, continue, ;, }, var, label, =, Instruction, ., init_label, (, "bb", ,, Span, ., phony, ,, self, ., allocator, ), ;, label, ., uid, =, bb, ., uid, ;, instructions_list, ., append, (, label, ), catch, unreachable, ;, bb, ., append_instructions, (, module_uid, ,, instructions_list, ,, &, work_queue, ), ;, }, return, first_bb, ., offset_table, ., get, (, module_uid, ), .?, ;, }, fn, append_phony_block, (, self, :, *, Self, ,, instructions_list, :, *, std, ., array_list, ., Managed, (, *, Instruction, ), ), Instruction, ., Index, {, const, offset, =, @, as, (, Instruction, ., Index, ,, @, intCast, (, instructions_list, ., items, ., len, ), ), ;, instructions_list, ., append, (, Instruction, ., init_label, (, "phony", ,, Span, ., phony, ,, self, ., allocator, ,, ), ), catch, unreachable, ;, instructions_list, ., append, (, Instruction, ., init_jump_addr, (, null, ,, Span, ., phony, ,, self, ., allocator, ,, ), ), catch, unreachable, ;, return, offset, ;, }, pub, fn, get_adjacent, (, self, :, *, Self, ), [, ], *, Self, {, return, self, ., children, ., keys, (, ), ;, }, pub, fn, calculate_offsets, (, self, :, *, Self, ), i64, {, self, ., return_symbol, ., offset, =, null, ;, var, phony_sp, :, i64, =, 0, ;, if, (, self, ., symbol, ., decl, .?, .*, ==, ., fn_decl, or, self, ., symbol, ., decl, .?, .*, ==, ., method_decl, ), {, const, param_symbols, =, self, ., symbol, ., decl, .?, ., param_symbols, (, ), .?, ., items, ;, var, i, :, i64, =, @, as, (, i64, ,, @, intCast, (, param_symbols, ., len, ), ), -, 1, ;, while, (, i, >=, 0, ), :, (, i, -=, 1, ), {, var, param, :, *, Symbol, =, param_symbols, [, @, as, (, usize, ,, @, intCast, (, i, ), ), ], ;, const, size, =, param, ., expanded_type, (, ), ., sizeof, (, ), ;, const, alignof, =, param, ., expanded_type, (, ), ., alignof, (, ), ;, phony_sp, =, alignment_, ., next_alignment, (, phony_sp, ,, alignof, ), ;, param, ., offset, =, phony_sp, ;, phony_sp, +=, size, ;, }, const, header, =, alignment_, ., next_alignment, (, phony_sp, ,, 8, ), ;, for, (, param_symbols, ), |, param, |, {, param, ., offset, .?, -=, header, -, retval_offset, ;, }, }, var, local_offsets, :, i64, =, locals_starting_offset, ;, for, (, self, ., symbvers, ., items, ), |, symbver, |, {, if, (, symbver, ., symbol, ., offset, ==, null, and, !, std, ., mem, ., eql, (, u8, ,, symbver, ., symbol, ., name, ,, "_retval", ), ), {, local_offsets, =, alignment_, ., next_alignment, (, local_offsets, ,, symbver, ., symbol, ., expanded_type, (, ), ., alignof, (, ), ), ;, local_offsets, +=, symbver, ., symbol, ., set_offset, (, local_offsets, ), ;, }, }, local_offsets, =, alignment_, ., next_alignment, (, local_offsets, ,, 8, ), ;, return, local_offsets, -, locals_starting_offset, ;, }, pub, fn, print_instructions, (, self, :, *, Self, ), void, {, std, ., debug, ., print, (, "CFG {s}:\n", ,, ., {, self, ., symbol, ., name, }, ), ;, for, (, self, ., basic_blocks, ., items, ), |, bb, |, {, bb, ., pprint, (, ), ;, }, }, const, std, =, @, import, (, "std", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Interned_String_Set, =, @, import, (, "../ir/interned_string_set.zig", ), ;, const, Lower_Context, =, @, import, (, "../ir/lower.zig", ), ;, const, cfg_validate_, =, @, import, (, "../semantic/cfg_validate.zig", ), ;, const, optimizations_, =, @, import, (, "../ir/optimizations.zig", ), ;, const, Self, :, type, =, @, This, (, ), ;, ctx, :, *, Compiler_Context, ,, map, :, std, ., AutoArrayHashMap, (, *, Symbol, ,, *, CFG, ), ,, pub, fn, init, (, ctx, :, *, Compiler_Context, ), Self, {, return, Self, {, ., ctx, =, ctx, ,, ., map, =, std, ., AutoArrayHashMap, (, *, Symbol, ,, *, CFG, ), ., init, (, ctx, ., allocator, (, ), ), ,, }, ;, }, pub, fn, get_cfg, (, self, :, *, Self, ,, symbol, :, *, Symbol, ,, interned_strings, :, *, Interned_String_Set, ,, ), Lower_Context, ., Lower_Errors, !, *, CFG, {, std, ., debug, ., assert, (, symbol, ., kind, ==, ., @, "fn", or, symbol, ., kind, ==, ., @, "test", or, symbol, ., kind, ==, ., @, "comptime", ), ;, std, ., debug, ., assert, (, symbol, ., validation_state, ==, ., valid, ), ;, if, (, symbol, ., init_validation_state, ==, ., validating, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., recursive_definition, =, ., {, ., span, =, symbol, ., span, (, ), ,, ., symbol_name, =, symbol, ., name, ,, }, }, ), ;, return, error, ., CompileError, ;, }, if, (, symbol, ., cfg, ==, null, ), {, symbol, ., cfg, =, CFG, ., init, (, symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, var, lower_context, =, Lower_Context, ., init, (, self, ., ctx, ,, symbol, ., cfg, .?, ,, interned_strings, ), ;, try, lower_context, ., lower_AST_into_cfg, (, ), ;, try, cfg_validate_, ., validate_cfg, (, symbol, ., cfg, .?, ,, &, self, ., ctx, ., errors, ), ;, try, optimizations_, ., optimize, (, symbol, ., cfg, .?, ,, &, self, ., ctx, ., errors, ,, self, ., ctx, ., allocator, (, ), ), ;, symbol, ., cfg, .?, ., collect_generated_symbvers, (, ), ;, }, return, symbol, ., cfg, .?, ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Basic_Block, =, @, import, (, "../ir/basic-block.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, lval_, =, @, import, (, "../ir/lval.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, String_Idx, =, @, import, (, "../ir/interned_string_set.zig", ), ., String_Idx, ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, fmt_, =, @, import, (, "../util/fmt.zig", ), ;, const, Self, =, @, This, (, ), ;, pub, const, Index, :, type, =, u32, ;, var, instruction_uid, :, u64, =, 0, ;, uid, :, u64, ,, kind, :, Kind, ,, dest, :, ?, *, lval_, ., L_Value, ,, src1, :, ?, *, lval_, ., L_Value, ,, src2, :, ?, *, lval_, ., L_Value, ,, data, :, Data, ,, in_block, :, ?, *, Basic_Block, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ,, pub, fn, init, (, kind, :, Kind, ,, dest, :, ?, *, lval_, ., L_Value, ,, src1, :, ?, *, lval_, ., L_Value, ,, src2, :, ?, *, lval_, ., L_Value, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, Self, {, var, retval, =, allocator, ., create, (, Self, ), catch, unreachable, ;, retval, ., kind, =, kind, ;, retval, ., dest, =, dest, ;, retval, ., src1, =, src1, ;, retval, ., src2, =, src2, ;, retval, ., uid, =, instruction_uid, ;, retval, ., in_block, =, null, ;, retval, ., data, =, Data, ., none, ;, retval, ., span, =, span, ;, retval, ., allocator, =, allocator, ;, instruction_uid, +=, 1, ;, return, retval, ;, }, pub, fn, init_int, (, dest, :, *, lval_, ., L_Value, ,, int, :, i128, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., load_int, ,, dest, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., int, =, int, }, ;, return, retval, ;, }, pub, fn, init_float, (, dest, :, *, lval_, ., L_Value, ,, float, :, f64, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., load_float, ,, dest, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., float, =, float, }, ;, return, retval, ;, }, pub, fn, init_string, (, dest, :, *, lval_, ., L_Value, ,, id, :, String_Idx, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., load_string, ,, dest, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., string_id, =, id, }, ;, return, retval, ;, }, pub, fn, init_symbol, (, dest, :, *, lval_, ., L_Value, ,, symbol, :, *, Symbol, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., load_symbol, ,, dest, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., symbol, =, symbol, }, ;, return, retval, ;, }, pub, fn, init_simple_copy, (, dest, :, *, lval_, ., L_Value, ,, src, :, *, lval_, ., L_Value, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, const, instr, =, Self, ., init, (, ., copy, ,, dest, ,, src, ,, null, ,, span, ,, allocator, ), ;, return, instr, ;, }, pub, fn, init_label, (, name, :, [, ], const, u8, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., label, ,, null, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., label, =, ., {, ., name, =, name, }, }, ;, return, retval, ;, }, pub, fn, init_branch, (, condition, :, *, lval_, ., L_Value, ,, label, :, ?, *, Self, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., branch_if_false, ,, null, ,, condition, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., branch, =, label, }, ;, return, retval, ;, }, pub, fn, init_jump, (, label, :, ?, *, Self, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., jump, ,, null, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., branch, =, label, }, ;, return, retval, ;, }, pub, fn, init_jump_addr, (, next, :, ?, *, Basic_Block, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., jump, ,, null, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., jump_bb, =, ., {, ., next, =, next, }, }, ;, return, retval, ;, }, pub, fn, init_branch_addr, (, condition, :, *, lval_, ., L_Value, ,, next, :, ?, *, Basic_Block, ,, branch, :, ?, *, Basic_Block, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, Self, {, var, retval, =, Self, ., init, (, ., branch_if_false, ,, null, ,, condition, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., branch_bb, =, ., {, ., next, =, next, ,, ., branch, =, branch, }, }, ;, return, retval, ;, }, pub, fn, init_call, (, dest, :, *, lval_, ., L_Value, ,, src1, :, *, lval_, ., L_Value, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., call, ,, dest, ,, src1, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., call, =, ., {, ., arg_lval_list, =, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ., init, (, allocator, ), ,, ., context_arg_lval_list, =, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ., init, (, allocator, ), ,, }, }, ;, return, retval, ;, }, pub, fn, init_invoke, (, dest, :, *, lval_, ., L_Value, ,, method_decl, :, *, ast_, ., AST, ,, lval_list, :, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ,, dyn_value, :, ?, *, lval_, ., L_Value, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., invoke, ,, dest, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., invoke, =, ., {, ., method_decl, =, method_decl, ,, ., arg_lval_list, =, lval_list, ,, ., context_arg_lval_list, =, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ., init, (, allocator, ), ,, ., dyn_value, =, dyn_value, ,, ., method_decl_lval, =, null, ,, }, ,, }, ;, return, retval, ;, }, pub, fn, init_dyn, (, dest, :, *, lval_, ., L_Value, ,, src1, :, *, lval_, ., L_Value, ,, mut, :, bool, ,, impl, :, *, ast_, ., AST, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, if, (, mut, ), ., mut_dyn_value, else, ., dyn_value, ,, dest, ,, src1, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., dyn, =, ., {, ., impl, =, impl, }, }, ;, return, retval, ;, }, pub, fn, init_load_struct, (, dest, :, *, lval_, ., L_Value, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., load_struct, ,, dest, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., lval_list, =, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ., init, (, allocator, ), }, ;, return, retval, ;, }, pub, fn, init_get_tag, (, dest, :, *, lval_, ., L_Value, ,, src1, :, *, lval_, ., L_Value, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, const, retval, =, Self, ., init, (, ., get_tag, ,, dest, ,, src1, ,, null, ,, span, ,, allocator, ), ;, return, retval, ;, }, pub, fn, init_union, (, dest, :, *, lval_, ., L_Value, ,, _init, :, ?, *, lval_, ., L_Value, ,, tag, :, i128, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., load_union, ,, dest, ,, _init, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., int, =, tag, }, ;, return, retval, ;, }, pub, fn, init_stack_push, (, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., push_stack_trace, ,, null, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, ., none, ;, return, retval, ;, }, pub, fn, init_stack_pop, (, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., pop_stack_trace, ,, null, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, ., none, ;, return, retval, ;, }, pub, fn, init_panic, (, message, :, [, ], const, u8, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, Self, ., init, (, ., panic, ,, null, ,, null, ,, null, ,, span, ,, allocator, ), ;, retval, ., data, =, Data, {, ., string, =, message, }, ;, return, retval, ;, }, pub, fn, init_int_float_kind, (, int_kind, :, Kind, ,, float_kind, :, Kind, ,, dest, :, ?, *, lval_, ., L_Value, ,, src1, :, ?, *, lval_, ., L_Value, ,, src2, :, ?, *, lval_, ., L_Value, ,, span, :, Span, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, Self, {, if, (, src1, .?, ., get_expanded_type, (, ), ., can_represent_float, (, ), ), {, return, init, (, float_kind, ,, dest, ,, src1, ,, src2, ,, span, ,, allocator, ), ;, }, else, {, return, init, (, int_kind, ,, dest, ,, src1, ,, src2, ,, span, ,, allocator, ), ;, }, }, pub, fn, deinit, (, self, :, *, Self, ), void, {, if, (, self, ., dest, !=, null, ), {, self, ., dest, .?, ., deinit, (, ), ;, }, self, ., allocator, ., destroy, (, self, ), ;, }, pub, fn, pprint, (, self, :, Self, ,, allocator, :, std, ., mem, ., Allocator, ), !, [, ], const, u8, {, var, out, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, out, ., deinit, (, ), ;, switch, (, self, ., kind, ), {, ., label, =>, try, out, ., print, (, "{s}{}:\n", ,, ., {, self, ., data, ., label, ., name, ,, self, ., uid, }, ), ,, ., load_int, =>, {, try, out, ., print, (, "    {f} := {}\n", ,, ., {, self, ., dest, .?, ,, self, ., data, ., int, }, ), ;, }, ,, ., load_float, =>, {, try, out, ., print, (, "    {f} := {}\n", ,, ., {, self, ., dest, .?, ,, self, ., data, ., float, }, ), ;, }, ,, ., load_symbol, =>, {, try, out, ., print, (, "    {f} := {s}\n", ,, ., {, self, ., dest, .?, ,, self, ., data, ., symbol, ., name, }, ), ;, }, ,, ., load_struct, =>, {, try, out, ., print, (, "    {f} := {{", ,, ., {, self, ., dest, .?, }, ), ;, try, print_lval_list, (, self, ., data, ., lval_list, ,, &, out, ), ;, try, out, ., print, (, "}}\n", ,, ., {, }, ), ;, }, ,, ., load_union, =>, {, try, out, ., print, (, "    {f} := {{init={?f}, tag={}}}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, ,, self, ., data, ., int, }, ), ;, }, ,, ., load_string, =>, {, try, out, ., print, (, "    {f} := <interned string:{}>\n", ,, ., {, self, ., dest, .?, ,, self, ., data, ., string_id, }, ), ;, }, ,, ., load_unit, =>, {, try, out, ., print, (, "    {f} := {{}}\n", ,, ., {, self, ., dest, .?, }, ), ;, }, ,, ., copy, =>, {, try, out, ., print, (, "    {f} := {?f} // {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, ,, self, ., dest, .?, ., get_expanded_type, (, ), }, ), ;, }, ,, ., not, =>, {, try, out, ., print, (, "    {f} := !{f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, }, ), ;, }, ,, ., negate_int, =>, {, try, out, ., print, (, "    {f} := -{f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, }, ), ;, }, ,, ., negate_float, =>, {, try, out, ., print, (, "    {f} := -.{f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, }, ), ;, }, ,, ., size_of, =>, {, try, out, ., print, (, "    {f} := sizeof({f})\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, }, ), ;, }, ,, ., addr_of, =>, {, try, out, ., print, (, "    {f} := &{f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, }, ), ;, }, ,, ., mut_addr_of, =>, {, try, out, ., print, (, "    {f} := &mut {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, }, ), ;, }, ,, ., equal, =>, {, try, out, ., print, (, "    {f} := {f} == {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., not_equal, =>, {, try, out, ., print, (, "    {f} := {f} != {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., greater_int, =>, {, try, out, ., print, (, "    {f} := {f} > {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., greater_float, =>, {, try, out, ., print, (, "    {f} := {f} >. {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., lesser_int, =>, {, try, out, ., print, (, "    {f} := {f} < {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., lesser_float, =>, {, try, out, ., print, (, "    {f} := {f} <. {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., greater_equal_int, =>, {, try, out, ., print, (, "    {f} := {f} >= {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., greater_equal_float, =>, {, try, out, ., print, (, "    {f} := {f} >=. {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., lesser_equal_int, =>, {, try, out, ., print, (, "    {f} := {f} <= {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., lesser_equal_float, =>, {, try, out, ., print, (, "    {f} := {f} <=. {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., add_int, =>, {, try, out, ., print, (, "    {f} := {f} + {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., add_float, =>, {, try, out, ., print, (, "    {f} := {f} +. {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., sub_int, =>, {, try, out, ., print, (, "    {f} := {f} - {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., sub_float, =>, {, try, out, ., print, (, "    {f} := {f} -. {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., mult_int, =>, {, try, out, ., print, (, "    {f} := {f} * {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., mult_float, =>, {, try, out, ., print, (, "    {f} := {f} *. {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., div_int, =>, {, try, out, ., print, (, "    {f} := {f} / {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., div_float, =>, {, try, out, ., print, (, "    {f} := {f} /. {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., mod, =>, {, try, out, ., print, (, "    {f} := {f} % {f}\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, ,, self, ., src2, .?, }, ), ;, }, ,, ., get_tag, =>, {, try, out, ., print, (, "    {f} := {f}.tag\n", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, }, ), ;, }, ,, ., jump, =>, {, if, (, self, ., data, ==, ., jump_bb, and, self, ., data, ., jump_bb, ., next, !=, null, ), {, try, out, ., print, (, "    jump BB{}\n", ,, ., {, self, ., data, ., jump_bb, ., next, .?, ., uid, }, ), ;, }, else, if, (, self, ., data, ==, ., branch, and, self, ., data, ., branch, !=, null, ), {, try, out, ., print, (, "    jump {s}{}\n", ,, ., {, self, ., data, ., branch, .?, ., data, ., label, ., name, ,, self, ., data, ., branch, .?, ., uid, }, ), ;, }, else, {, try, out, ., print, (, "    ret\n", ,, ., {, }, ), ;, }, }, ,, ., branch_if_false, =>, {, if, (, self, ., data, ==, ., branch_bb, and, self, ., data, ., branch_bb, ., next, !=, null, ), {, try, out, ., print, (, "    if ({f}) jump BB{}", ,, ., {, self, ., src1, .?, ,, self, ., data, ., branch_bb, ., next, .?, ., uid, }, ), ;, }, else, if, (, self, ., data, ==, ., branch, and, self, ., data, ., branch, !=, null, ), {, try, out, ., print, (, "    if (!{f}) jump {s}{}\n", ,, ., {, self, ., src1, .?, ,, self, ., data, ., branch, .?, ., data, ., label, ., name, ,, self, ., data, ., branch, .?, ., uid, }, ), ;, }, else, {, try, out, ., print, (, "    if ({f}) ret", ,, ., {, self, ., src1, .?, }, ), ;, }, if, (, self, ., data, ==, ., branch_bb, and, self, ., data, ., branch_bb, ., branch, !=, null, ), {, try, out, ., print, (, " else jump BB{}\n", ,, ., {, self, ., data, ., branch_bb, ., branch, .?, ., uid, }, ), ;, }, else, if, (, self, ., data, !=, ., branch, ), {, try, out, ., print, (, " else ret\n", ,, ., {, }, ), ;, }, }, ,, ., call, =>, {, try, out, ., print, (, "    {f} := {f}(", ,, ., {, self, ., dest, .?, ,, self, ., src1, .?, }, ), ;, try, print_lval_list, (, self, ., data, ., call, ., arg_lval_list, ,, &, out, ), ;, try, out, ., print, (, ")\n", ,, ., {, }, ), ;, }, ,, ., invoke, =>, {, try, out, ., print, (, "    {f} := ::{s}(", ,, ., {, self, ., dest, .?, ,, self, ., data, ., invoke, ., method_decl, ., method_decl, ., name, ., token, (, ), ., data, }, ), ;, try, print_lval_list, (, self, ., data, ., invoke, ., arg_lval_list, ,, &, out, ), ;, try, out, ., print, (, ")\n", ,, ., {, }, ), ;, }, ,, ., push_stack_trace, =>, {, try, out, ., print, (, "    push-stack-trace\n", ,, ., {, }, ), ;, }, ,, ., pop_stack_trace, =>, {, try, out, ., print, (, "    pop-stack-trace\n", ,, ., {, }, ), ;, }, ,, ., panic, =>, {, try, out, ., print, (, "    panic\n", ,, ., {, }, ), ;, }, ,, else, =>, {, try, out, ., print, (, "<TODO: {s}>\n", ,, ., {, @, tagName, (, self, ., kind, ), }, ), ;, }, ,, }, return, try, out, ., toOwnedSlice, (, ), ;, }, pub, fn, format, (, self, :, Self, ,, writer, :, *, std, ., io, ., Writer, ), !, void, {, try, fmt_, ., indirect_format, (, self, ,, writer, ), ;, }, fn, print_lval_list, (, lval_list, :, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ,, writer, :, *, std, ., array_list, ., Managed, (, u8, ), ), !, void, {, for, (, lval_list, ., items, ,, 0.., ), |, lval, ,, i, |, {, try, writer, ., print, (, "{f}", ,, ., {, lval, }, ), ;, if, (, i, <, lval_list, ., items, ., len, -, 1, ), {, try, writer, ., print, (, ", ", ,, ., {, }, ), ;, }, }, }, pub, fn, copy_prop, (, self, :, *, Self, ,, src1_def, :, ?, *, Self, ,, kind, :, Kind, ,, errors, :, *, errs_, ., Errors, ), error, {, CompileError, }, !, bool, {, if, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, kind, ), {, if, (, kind, ==, ., load_int, ), {, try, assert_fits, (, src1_def, .?, ., data, ., int, ,, self, ., dest, .?, ., get_expanded_type, (, ), ,, self, ., span, ,, errors, ), ;, }, self, ., kind, =, kind, ;, self, ., data, =, src1_def, .?, ., data, ;, self, ., span, =, src1_def, .?, ., span, ;, self, ., src2, =, src1_def, .?, ., src2, ;, self, ., src1, =, src1_def, .?, ., src1, ;, return, true, ;, }, else, {, return, false, ;, }, }, pub, fn, convert_to_load, (, self, :, *, Self, ,, kind, :, Kind, ,, data, :, Data, ,, errors, :, *, errs_, ., Errors, ), error, {, CompileError, }, !, void, {, if, (, kind, ==, ., load_int, ), {, try, assert_fits, (, data, ., int, ,, self, ., dest, .?, ., get_expanded_type, (, ), ,, self, ., span, ,, errors, ), ;, }, self, ., kind, =, kind, ;, self, ., data, =, data, ;, self, ., src1, =, null, ;, self, ., src2, =, null, ;, }, pub, fn, convert_to_unop, (, self, :, *, Self, ,, src1, :, *, lval_, ., L_Value, ,, kind, :, Kind, ), void, {, self, ., kind, =, kind, ;, self, ., data, =, ., none, ;, self, ., src1, =, src1, ;, self, ., src2, =, null, ;, }, fn, assert_fits, (, val, :, i128, ,, _type, :, *, Type_AST, ,, span, :, Span, ,, errors, :, *, errs_, ., Errors, ), error, {, CompileError, }, !, void, {, const, bounds, =, prelude_, ., bounds_from_ast, (, _type, ), ;, if, (, bounds, !=, null, and, (, val, <, bounds, .?, ., lower, or, val, >, bounds, .?, ., upper, ), ), {, errors, ., add_error, (, errs_, ., Error, {, ., integer_out_of_bounds, =, ., {, ., span, =, span, ,, ., expected, =, _type, ,, ., value, =, val, ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, copy_of_prop, (, self, :, *, Self, ,, src, :, *, ?, *, lval_, ., L_Value, ,, src_def, :, ?, *, Self, ), bool, {, if, (, self, ., kind, !=, ., addr_of, and, self, ., kind, !=, ., mut_addr_of, and, src_def, !=, null, and, src_def, .?, ., kind, ==, ., copy, and, src_def, .?, ., src1, .?, .*, ==, ., symbver, and, (, src_def, .?, ., dest, .?, .*, !=, ., symbver, or, src_def, .?, ., src1, .?, ., extract_symbver, (, ), !=, src_def, .?, ., dest, .?, ., extract_symbver, (, ), ), ), {, const, src_def_redefinition, =, src_def, .?, ., in_block, .?, ., any_def_after, (, src_def, .?, ,, src_def, .?, ., src1, .?, ., symbver, ., symbol, ,, self, ), ;, if, (, src_def_redefinition, ==, null, ), {, src, .*, =, src_def, .?, ., src1, ;, return, true, ;, }, else, {, return, false, ;, }, }, else, {, return, false, ;, }, }, pub, fn, self_eq, (, self, :, *, Self, ), bool, {, return, self, ., src1, .?, .*, ==, ., symbver, and, self, ., src2, .?, .*, ==, ., symbver, and, self, ., src1, .?, ., symbver, ., symbol, ==, self, ., src2, .?, ., symbver, ., symbol, ;, }, pub, const, Precedence, =, enum, (, usize, ), {, literal, =, 0, ,, postfix, =, 1, ,, prefix, =, 2, ,, multiplicative, =, 3, ,, additive, =, 4, ,, bitwise, =, 5, ,, comparative, =, 6, ,, equality, =, 7, ,, copy, =, 14, ,, highest, =, 100, ,, }, ;, pub, const, Kind, =, enum, {, load_symbol, ,, load_extern, ,, load_int, ,, load_float, ,, load_struct, ,, load_union, ,, load_string, ,, load_unit, ,, copy, ,, not, ,, negate_int, ,, negate_float, ,, bit_not, ,, size_of, ,, addr_of, ,, mut_addr_of, ,, dyn_value, ,, mut_dyn_value, ,, equal, ,, not_equal, ,, greater_int, ,, greater_float, ,, lesser_int, ,, lesser_float, ,, greater_equal_int, ,, greater_equal_float, ,, lesser_equal_int, ,, lesser_equal_float, ,, bit_and, ,, bit_or, ,, bit_xor, ,, left_shift, ,, right_shift, ,, add_int, ,, add_float, ,, sub_int, ,, sub_float, ,, mult_int, ,, mult_float, ,, div_int, ,, div_float, ,, mod, ,, get_tag, ,, cast, ,, label, ,, jump, ,, branch_if_false, ,, call, ,, invoke, ,, push_stack_trace, ,, pop_stack_trace, ,, panic, ,, pub, fn, is_checked, (, self, :, Kind, ), bool, {, return, switch, (, self, ), {, ., negate_int, ,, ., add_int, ,, ., sub_int, ,, ., mult_int, ,, ., div_int, ,, ., mod, ,, =>, true, ,, else, =>, false, ,, }, ;, }, pub, fn, checked_name, (, self, :, Kind, ), [, ], const, u8, {, return, switch, (, self, ), {, ., negate_int, =>, "negate", ,, ., add_int, =>, "add", ,, ., sub_int, =>, "sub", ,, ., mult_int, =>, "mult", ,, ., div_int, =>, "div", ,, ., mod, =>, "mod", ,, else, =>, unreachable, ,, }, ;, }, pub, fn, c_token, (, self, :, Kind, ), [, ], const, u8, {, return, switch, (, self, ), {, ., not, =>, "!", ,, ., bit_not, =>, "~", ,, ., negate_int, ,, ., negate_float, =>, "-", ,, ., equal, =>, "==", ,, ., not_equal, =>, "!=", ,, ., greater_int, ,, ., greater_float, =>, ">", ,, ., lesser_int, ,, ., lesser_float, =>, "<", ,, ., greater_equal_int, ,, ., greater_equal_float, =>, ">=", ,, ., lesser_equal_int, ,, ., lesser_equal_float, =>, "<=", ,, ., add_int, ,, ., add_float, =>, "+", ,, ., sub_int, ,, ., sub_float, =>, "-", ,, ., mult_int, ,, ., mult_float, =>, "*", ,, ., div_int, ,, ., div_float, =>, "/", ,, ., mod, =>, "%", ,, ., bit_and, =>, "&", ,, ., bit_or, =>, "|", ,, ., bit_xor, =>, "^", ,, ., left_shift, =>, "<<", ,, ., right_shift, =>, ">>", ,, else, =>, unreachable, ,, }, ;, }, pub, fn, arity, (, self, :, Kind, ), enum, {, unop, ,, binop, }, {, return, switch, (, self, ), {, ., not, ,, ., negate_int, ,, ., negate_float, ,, ., bit_not, =>, ., unop, ,, ., equal, ,, ., not_equal, ,, ., greater_int, ,, ., greater_float, ,, ., lesser_int, ,, ., lesser_float, ,, ., greater_equal_int, ,, ., greater_equal_float, ,, ., lesser_equal_int, ,, ., lesser_equal_float, ,, ., add_int, ,, ., add_float, ,, ., sub_int, ,, ., sub_float, ,, ., mult_int, ,, ., mult_float, ,, ., div_int, ,, ., div_float, ,, ., mod, ,, ., bit_and, ,, ., bit_or, ,, ., bit_xor, ,, ., left_shift, ,, ., right_shift, ,, =>, ., binop, ,, else, =>, unreachable, ,, }, ;, }, pub, fn, precedence, (, self, :, Kind, ), Precedence, {, return, switch, (, self, ), {, ., load_symbol, ,, ., load_extern, ,, ., load_int, ,, ., load_float, ,, ., load_struct, ,, ., load_union, ,, ., load_string, ,, =>, Precedence, ., literal, ,, ., call, ,, ., get_tag, ,, =>, Precedence, ., postfix, ,, ., negate_int, ,, ., negate_float, ,, ., not, ,, ., bit_not, ,, ., size_of, ,, ., cast, ,, ., mut_addr_of, ,, ., addr_of, ,, ., mut_dyn_value, ,, ., dyn_value, ,, =>, Precedence, ., prefix, ,, ., mult_int, ,, ., mult_float, ,, ., div_int, ,, ., div_float, ,, ., mod, ,, =>, Precedence, ., multiplicative, ,, ., add_int, ,, ., add_float, ,, ., sub_int, ,, ., sub_float, ,, =>, Precedence, ., additive, ,, ., bit_and, ,, ., bit_or, ,, ., bit_xor, ,, ., left_shift, ,, ., right_shift, =>, Precedence, ., bitwise, ,, ., greater_int, ,, ., greater_float, ,, ., lesser_int, ,, ., lesser_float, ,, ., greater_equal_int, ,, ., greater_equal_float, ,, ., lesser_equal_int, ,, ., lesser_equal_float, ,, =>, Precedence, ., comparative, ,, ., equal, ,, ., not_equal, ,, =>, Precedence, ., equality, ,, ., copy, =>, Precedence, ., copy, ,, else, =>, std, ., debug, ., panic, (, "compiler error: unimplemented precedence for kind {s}", ,, ., {, @, tagName, (, self, ), }, ), ,, }, ;, }, }, ;, pub, const, Data, =, union, (, enum, ), {, branch, :, ?, *, Self, ,, jump_bb, :, struct, {, next, :, ?, *, Basic_Block, }, ,, branch_bb, :, struct, {, next, :, ?, *, Basic_Block, ,, branch, :, ?, *, Basic_Block, }, ,, int, :, i128, ,, float, :, f64, ,, string_id, :, String_Idx, ,, label, :, struct, {, name, :, [, ], const, u8, ,, }, ,, string, :, [, ], const, u8, ,, symbol, :, *, Symbol, ,, lval_list, :, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ,, call, :, struct, {, arg_lval_list, :, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ,, context_arg_lval_list, :, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ,, }, ,, invoke, :, struct, {, method_decl, :, *, ast_, ., AST, ,, method_decl_lval, :, ?, *, lval_, ., L_Value, ,, arg_lval_list, :, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ,, context_arg_lval_list, :, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ,, dyn_value, :, ?, *, lval_, ., L_Value, ,, }, ,, dyn, :, struct, {, impl, :, *, ast_, ., AST, }, ,, select, :, struct, {, offset, :, i128, ,, field, :, i128, }, ,, ast, :, *, ast_, ., AST, ,, none, ,, pub, fn, pprint, (, self, :, Data, ,, allocator, :, std, ., mem, ., Allocator, ), !, [, ], const, u8, {, var, out, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ,, "", ), catch, unreachable, ;, defer, out, ., deinit, (, ), ;, switch, (, self, ), {, ., int, =>, {, try, out, ., print, (, "{}", ,, ., {, self, ., int, }, ), ;, }, ,, ., float, =>, {, try, out, ., print, (, "{d:.6}", ,, ., {, self, ., float, }, ), ;, }, ,, ., none, =>, {, try, out, ., print, (, "none", ,, ., {, }, ), ;, }, ,, ., symbol, =>, {, try, out, ., print, (, "{s}", ,, ., {, self, ., symbol, ., name, }, ), ;, }, ,, ., string_id, =>, {, try, out, ., print, (, "<interned string:{}>", ,, ., {, self, ., string_id, }, ), ;, }, ,, else, =>, {, try, out, ., print, (, "??? ({s})", ,, ., {, @, tagName, (, self, ), }, ), ;, }, ,, }, return, (, try, out, ., toOwned, (, ), ), .?, ;, }, pub, fn, format, (, self, :, Data, ,, writer, :, *, std, ., io, ., Writer, ), !, void, {, try, fmt_, ., indirect_format, (, self, ,, writer, ), ;, }, pub, fn, equals, (, self, :, Data, ,, other, :, Data, ), bool, {, if, (, self, ==, ., branch, and, other, ==, ., branch, ), {, return, self, ., branch, ==, other, ., branch, ;, }, else, if, (, self, ==, ., int, and, other, ==, ., int, ), {, return, self, ., int, ==, other, ., int, ;, }, else, if, (, self, ==, ., float, and, other, ==, ., float, ), {, return, self, ., float, ==, other, ., float, ;, }, else, if, (, self, ==, ., int, and, other, ==, ., float, ), {, return, self, ., int, ==, @, as, (, i128, ,, @, intFromFloat, (, other, ., float, ), ), ;, }, else, if, (, self, ==, ., float, and, other, ==, ., int, ), {, return, @, as, (, i128, ,, @, intFromFloat, (, self, ., float, ), ), ==, other, ., int, ;, }, else, if, (, self, ==, ., string_id, and, other, ==, ., string_id, ), {, return, self, ., string_id, ==, other, ., string_id, ;, }, else, if, (, self, ==, ., string, and, other, ==, ., string, ), {, return, std, ., mem, ., eql, (, u8, ,, self, ., string, ,, other, ., string, ), ;, }, else, if, (, self, ==, ., symbol, and, other, ==, ., symbol, ), {, return, self, ., symbol, ==, other, ., symbol, ;, }, else, {, return, false, ;, }, }, pub, fn, add_int_overflow, (, self, :, Data, ,, other, :, Data, ), error, {, CompileError, }, !, Data, {, return, Data, {, ., int, =, std, ., math, ., add, (, i128, ,, self, ., int, ,, other, ., int, ), catch, unreachable, ,, }, ;, }, pub, fn, sub_int_overflow, (, self, :, Data, ,, other, :, Data, ), error, {, CompileError, }, !, Data, {, return, Data, {, ., int, =, std, ., math, ., sub, (, i128, ,, self, ., int, ,, other, ., int, ), catch, unreachable, ,, }, ;, }, pub, fn, mult_int_overflow, (, self, :, Data, ,, other, :, Data, ), error, {, CompileError, }, !, Data, {, return, Data, {, ., int, =, std, ., math, ., mul, (, i128, ,, self, ., int, ,, other, ., int, ), catch, unreachable, ,, }, ;, }, }, ;, const, std, =, @, import, (, "std", ), ;, const, Self, :, type, =, @, This, (, ), ;, pub, const, String_Idx, :, type, =, struct, {, module_uid, :, u32, ,, string_idx, :, u32, ,, }, ;, uid, :, u32, ,, interned_strings, :, std, ., array_list, ., Managed, (, [, ], const, u8, ), ,, pub, fn, init, (, uid, :, u32, ,, allocator, :, std, ., mem, ., Allocator, ), Self, {, return, Self, {, ., uid, =, uid, ,, ., interned_strings, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, allocator, ), ,, }, ;, }, pub, fn, add_string, (, self, :, *, Self, ,, str, :, [, ], const, u8, ,, uid, :, u32, ), String_Idx, {, std, ., debug, ., assert, (, uid, ==, self, ., uid, ), ;, for, (, 0..self.interned_strings.items.len, ), |, i, |, {, const, item, =, self, ., interned_strings, ., items, [, i, ], ;, if, (, std, ., mem, ., eql, (, u8, ,, item, ,, str, ), ), {, return, ., {, ., module_uid, =, self, ., uid, ,, ., string_idx, =, @, as, (, u32, ,, @, intCast, (, i, ), ), }, ;, }, }, const, idx, :, u32, =, @, intCast, (, self, ., interned_strings, ., items, ., len, ), ;, self, ., interned_strings, ., append, (, str, ), catch, unreachable, ;, return, ., {, ., module_uid, =, self, ., uid, ,, ., string_idx, =, idx, }, ;, }, pub, fn, merge, (, self, :, *, Self, ,, other, :, *, const, Self, ), void, {, for, (, 0..other.interned_strings.items, ), |, i, |, {, _, =, self, ., add_string, (, other, ., interned_strings, ., items, [, i, ], ), ;, }, }, pub, fn, items, (, self, :, *, const, Self, ), [, ], const, [, ], const, u8, {, return, self, ., interned_strings, ., items, ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Interned_String_Set, =, @, import, (, "../ir/interned_string_set.zig", ), ;, const, Instruction, =, @, import, (, "../ir/instruction.zig", ), ;, const, lval_, =, @, import, (, "lval.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Symbol_Version, =, @, import, (, "symbol_version.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Tree_Writer, =, @, import, (, "../ast/tree_writer.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, pub, const, Lower_Errors, =, error, {, CompileError, }, ;, const, Self, =, @, This, (, ), ;, ctx, :, *, Compiler_Context, ,, instructions, :, std, ., array_list, ., Managed, (, *, Instruction, ), ,, interned_strings, :, *, Interned_String_Set, ,, cfg, :, *, CFG, ,, number_temps, :, usize, =, 0, ,, const, Labels, =, struct, {, return_label, :, ?, *, Instruction, ,, break_label, :, ?, *, Instruction, ,, continue_label, :, ?, *, Instruction, ,, error_label, :, ?, *, Instruction, ,, const, null_labels, :, Labels, =, ., {, ., return_label, =, null, ,, ., break_label, =, null, ,, ., continue_label, =, null, ,, ., error_label, =, null, }, ;, }, ;, pub, fn, init, (, ctx, :, *, Compiler_Context, ,, cfg, :, *, CFG, ,, interned_strings, :, *, Interned_String_Set, ), Self, {, return, Self, {, ., instructions, =, std, ., array_list, ., Managed, (, *, Instruction, ), ., init, (, ctx, ., allocator, (, ), ), ,, ., interned_strings, =, interned_strings, ,, ., ctx, =, ctx, ,, ., cfg, =, cfg, ,, }, ;, }, pub, fn, lower_AST_into_cfg, (, self, :, *, Self, ), Lower_Errors, !, void, {, const, eval, :, ?, *, lval_, ., L_Value, =, try, self, ., lower_AST, (, self, ., cfg, ., symbol, ., init_value, (, ), .?, ,, Labels, ., null_labels, ), ;, if, (, self, ., cfg, ., symbol, ., decl, .?, .*, ==, ., fn_decl, or, self, ., cfg, ., symbol, ., decl, .?, .*, ==, ., method_decl, ), {, const, param_symbols, =, self, ., cfg, ., symbol, ., decl, .?, ., param_symbols, (, ), ;, if, (, param_symbols, !=, null, ), {, for, (, param_symbols, .?, ., items, ), |, param, |, {, self, ., cfg, ., parameters, ., append, (, Symbol_Version, ., create_unversioned, (, param, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, }, }, const, return_version, =, lval_, ., L_Value, ., create_unversioned_symbver, (, self, ., cfg, ., return_symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, if, (, eval, !=, null, ), {, self, ., instructions, ., append, (, Instruction, ., init_simple_copy, (, return_version, ,, eval, .?, ,, self, ., cfg, ., symbol, ., span, (, ), ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, self, ., instructions, ., append, (, Instruction, ., init_jump, (, null, ,, self, ., cfg, ., symbol, ., span, (, ), ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, if, (, false, ), {, std, ., debug, ., print, (, "CFG {s}: {f}\n", ,, ., {, self, ., cfg, ., symbol, ., name, ,, self, ., cfg, ., symbol, ., type, (, ), }, ), ;, for, (, self, ., instructions, ., items, ), |, instr, |, {, std, ., debug, ., print, (, "{f}", ,, ., {, instr, }, ), ;, }, std, ., debug, ., print, (, "\n", ,, ., {, }, ), ;, }, self, ., cfg, ., block_graph_head, =, self, ., cfg, ., basic_block_from_instructions, (, self, ., instructions, ,, 0, ), ;, if, (, false, ), {, std, ., debug, ., print, (, "CFG {s}:\n", ,, ., {, self, ., cfg, ., symbol, ., name, }, ), ;, for, (, self, ., cfg, ., basic_blocks, ., items, ), |, bb, |, {, bb, ., pprint, (, ), ;, }, }, }, fn, lower_AST, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, labels, :, Labels, ), Lower_Errors, !, ?, *, lval_, ., L_Value, {, const, retval, =, self, ., lower_AST_inner, (, ast, ,, labels, ), ;, if, (, false, ), {, std, ., debug, ., print, (, "{}\n", ,, ., {, ast, }, ), ;, std, ., debug, ., print, (, "CFG {s}:\n", ,, ., {, self, ., cfg, ., symbol, ., name, }, ), ;, for, (, self, ., instructions, ., items, ), |, instr, |, {, std, ., debug, ., print, (, "{}", ,, ., {, instr, }, ), ;, }, std, ., debug, ., print, (, "\n", ,, ., {, }, ), ;, }, return, retval, ;, }, fn, lower_AST_inner, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, labels, :, Labels, ,, ), Lower_Errors, !, ?, *, lval_, ., L_Value, {, switch, (, ast, .*, ), {, ., enum_decl, ,, ., struct_decl, ,, ., unit_value, ,, ., trait, ,, ., impl, ,, ., type_alias, =>, return, self, ., lval_from_unit_value, (, ast, ), ,, ., int, =>, return, self, ., lval_from_int, (, ast, ., int, ., data, ,, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ,, ast, ., token, (, ), ., span, ), ,, ., float, =>, {, const, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_float, (, temp, ,, ast, ., float, ., data, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, temp, ;, }, ,, ., string, =>, {, const, id, :, Interned_String_Set, ., String_Idx, =, self, ., interned_strings, ., add_string, (, ast, ., string, ., data, ,, self, ., cfg, ., symbol, ., scope, ., module, .?, ., uid, ), ;, const, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_string, (, temp, ,, id, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, temp, ;, }, ,, ., access, ,, ., identifier, ,, ., generic_apply, =>, {, const, symbol, =, ast, ., symbol, (, ), .?, ;, if, (, symbol, ., init_validation_state, ==, ., validating, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., recursive_definition, =, ., {, ., span, =, symbol, ., span, (, ), ,, ., symbol_name, =, symbol, ., name, ,, }, }, ), ;, return, error, ., CompileError, ;, }, if, (, symbol, ., kind, ==, ., @, "fn", ), {, return, try, self, ., lval_from_symbol_cfg, (, symbol, ,, ast, ., token, (, ), ., span, ), ;, }, else, if, (, symbol, ., kind, ==, ., @, "const", and, symbol, ., storage, !=, ., @, "extern", ), {, return, try, self, ., lower_AST, (, symbol, ., init_value, (, ), .?, ,, labels, ), ;, }, else, {, const, src, =, lval_, ., L_Value, ., create_unversioned_symbver, (, symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, return, src, ;, }, }, ,, ., pattern_symbol, =>, return, try, self, ., lval_from_symbol_cfg, (, ast, ., symbol, (, ), .?, ,, ast, ., token, (, ), ., span, ), ,, ., true, =>, return, self, ., lval_from_int, (, 1, ,, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ,, ast, ., token, (, ), ., span, ), ,, ., false, =>, return, self, ., lval_from_int, (, 0, ,, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ,, ast, ., token, (, ), ., span, ), ,, ., not, ,, ., negate, ,, ., addr_of, ,, ., bit_not, =>, return, try, self, ., unop, (, ast, ,, labels, ), ,, ., as, =>, {, const, expr, =, try, self, ., lower_AST, (, ast, ., expr, (, ), ,, labels, ), orelse, return, null, ;, const, expanded_type, =, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ., expand_identifier, (, ), ;, const, temp, =, self, ., create_temp_lvalue, (, expanded_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init, (, ., cast, ,, temp, ,, expr, ,, null, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, temp, ;, }, ,, ., dereference, =>, {, const, expr, =, try, self, ., lower_AST, (, ast, ., expr, (, ), ,, labels, ), orelse, return, null, ;, const, expanded_type, =, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ., expand_identifier, (, ), ;, const, temp, =, expr, ., create_dereference_lval, (, expanded_type, ,, self, ., ctx, ., allocator, (, ), ), ;, return, temp, ;, }, ,, ., @, "try", =>, {, var, expr, =, (, try, self, ., lower_AST, (, ast, ., expr, (, ), ,, labels, ), ), orelse, return, null, ;, const, end_label, =, Instruction, ., init_label, (, "try.end", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, ok_label, =, Instruction, ., init_label, (, "try.ok", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, var, expanded_expr_type, =, expr, ., get_expanded_type, (, ), ;, const, condition, =, self, ., create_temp_lvalue, (, prelude_, ., word64_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init_get_tag, (, condition, ,, expr, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_branch, (, condition, ,, ok_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, const, err_type, =, expanded_expr_type, ., get_err_type, (, ), ., expand_identifier, (, ), ;, const, err_lval, =, expr, ., create_select_lval, (, 1, ,, 0, ,, err_type, ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, const, full_err_lval, =, self, ., create_temp_lvalue, (, self, ., cfg, ., return_symbol, ., type, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_union, (, full_err_lval, ,, err_lval, ,, 1, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, const, retval_lval, =, lval_, ., L_Value, ., create_unversioned_symbver, (, self, ., cfg, ., return_symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_simple_copy, (, retval_lval, ,, full_err_lval, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_jump, (, labels, ., error_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, ok_label, ), catch, unreachable, ;, const, ok_type, =, expanded_expr_type, ., get_ok_type, (, ), ., expand_identifier, (, ), ;, const, ok_lval, =, expr, ., create_select_lval, (, 0, ,, 0, ,, ok_type, ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_jump, (, end_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, end_label, ), catch, unreachable, ;, return, ok_lval, ;, }, ,, ., assign, =>, {, const, rhs, =, try, self, ., lower_AST, (, ast, ., rhs, (, ), ,, labels, ), orelse, return, null, ;, try, self, ., generate_assign, (, ast, ., lhs, (, ), ,, rhs, ,, labels, ), ;, return, self, ., lval_from_unit_value, (, ast, ), ;, }, ,, ., @, "or", ,, ., @, "and", =>, return, try, self, ., or_and_op, (, ast, ,, labels, ), ,, ., @, "comptime", =>, return, try, self, ., lower_AST, (, ast, ., expr, (, ), ,, labels, ), ,, ., add, ,, ., sub, ,, ., mult, ,, ., div, ,, ., mod, ,, ., left_shift, ,, ., right_shift, ,, ., greater, ,, ., lesser, ,, ., greater_equal, ,, ., lesser_equal, ,, =>, return, try, self, ., binop, (, ast, ,, labels, ), ,, ., equal, ,, ., not_equal, =>, return, try, self, ., tuple_equality_check, (, ast, ,, labels, ), ,, ., @, "catch", ,, ., @, "orelse", =>, return, try, self, ., coalesce_op, (, ast, ,, labels, ), ,, ., bit_and, ,, ., bit_or, ,, ., bit_xor, =>, {, var, temp, :, *, lval_, ., L_Value, =, undefined, ;, var, src1, =, (, try, self, ., lower_AST, (, ast, ., children, (, ), ., items, [, 0, ], ,, labels, ), ), orelse, return, null, ;, for, (, 1..ast.children, (, ), ., items, ., len, ), |, i, |, {, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, const, src2, =, (, try, self, ., lower_AST, (, ast, ., children, (, ), ., items, [, i, ], ,, labels, ), ), orelse, continue, ;, self, ., instructions, ., append, (, Instruction, ., init, (, bit_ir_kind_from_ast_kind, (, ast, ), ,, temp, ,, src1, ,, src2, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, src1, =, temp, ;, }, return, temp, ;, }, ,, ., call, =>, {, const, lhs, =, (, try, self, ., lower_AST, (, ast, ., lhs, (, ), ,, labels, ), ), orelse, return, null, ;, var, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, temp, ., extract_symbver, (, ), ., symbol, ., set_span, (, ast, ., token, (, ), ., span, ), ;, var, instr, =, Instruction, ., init_call, (, temp, ,, lhs, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, for, (, ast, ., children, (, ), ., items, ), |, term, |, {, instr, ., data, ., call, ., arg_lval_list, ., append, (, (, try, self, ., lower_AST, (, term, ,, labels, ), ), orelse, continue, ), catch, unreachable, ;, }, for, (, ast, ., call, ., context_args, ., items, ), |, context_arg, |, {, instr, ., data, ., call, ., arg_lval_list, ., append, (, lval_, ., L_Value, ., create_unversioned_symbver, (, context_arg, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, self, ., instructions, ., append, (, Instruction, ., init_stack_push, (, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, instr, ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_stack_pop, (, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, temp, ;, }, ,, ., invoke, =>, {, var, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, temp, ., extract_symbver, (, ), ., symbol, ., set_span, (, ast, ., token, (, ), ., span, ), ;, var, dyn_value, :, ?, *, lval_, ., L_Value, =, null, ;, var, lval_list, =, std, ., array_list, ., Managed, (, *, lval_, ., L_Value, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, if, (, ast, ., children, (, ), ., items, ., len, ==, 0, ), {, if, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ., lhs, (, ), ), ., expand_identifier, (, ), .*, ==, ., dyn_type, ), {, dyn_value, =, (, try, self, ., lower_AST, (, ast, ., lhs, (, ), ,, labels, ), ), orelse, return, null, ;, }, }, else, {, for, (, ast, ., children, (, ), ., items, ,, 0.., ), |, term, ,, i, |, {, const, term_lval, =, (, try, self, ., lower_AST, (, term, ,, labels, ), ), orelse, continue, ;, lval_list, ., append, (, term_lval, ), catch, unreachable, ;, if, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ., lhs, (, ), ), ., expand_identifier, (, ), .*, ==, ., dyn_type, and, i, ==, 0, ), {, if, (, term, ==, ast, ., lhs, (, ), ), {, dyn_value, =, term_lval, ;, }, else, {, dyn_value, =, (, try, self, ., lower_AST, (, ast, ., lhs, (, ), ,, labels, ), ), orelse, continue, ;, }, }, }, }, const, instr, =, Instruction, ., init_invoke, (, temp, ,, ast, ., invoke, ., method_decl, .?, ,, lval_list, ,, dyn_value, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, for, (, ast, ., invoke, ., context_args, ., items, ), |, context_arg, |, {, instr, ., data, ., invoke, ., arg_lval_list, ., append, (, lval_, ., L_Value, ., create_unversioned_symbver, (, context_arg, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, if, (, ast, ., invoke, ., method_decl, .?, ., method_decl, ., init, !=, null, ), {, instr, ., data, ., invoke, ., method_decl_lval, =, try, self, ., lval_from_symbol_cfg, (, ast, ., invoke, ., method_decl, .?, ., symbol, (, ), .?, ,, ast, ., token, (, ), ., span, ), ;, }, self, ., instructions, ., append, (, Instruction, ., init_stack_push, (, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, instr, ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_stack_pop, (, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, temp, ;, }, ,, ., dyn_value, =>, {, const, expr, =, try, self, ., lower_AST, (, ast, ., expr, (, ), ,, labels, ), orelse, return, null, ;, const, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_dyn, (, temp, ,, expr, ,, ast, ., dyn_value, ., mut, ,, ast, ., dyn_value, ., impl, .?, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, temp, ;, }, ,, ., index, =>, {, const, lhs, =, (, try, self, ., lower_AST, (, ast, ., lhs, (, ), ,, labels, ), ), orelse, return, null, ;, const, rhs, =, (, try, self, ., lower_AST, (, ast, ., children, (, ), ., items, [, 0, ], ,, labels, ), ), orelse, return, null, ;, var, new_lhs, =, lhs, ;, const, ast_expanded_type, =, self, ., ctx, ., typecheck, ., typeof, (, ast, ., lhs, (, ), ), ., expand_identifier, (, ), ;, const, _type, =, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ;, if, (, ast_expanded_type, .*, ==, ., addr_of, ), {, std, ., debug, ., assert, (, ast_expanded_type, ., addr_of, ., multiptr, ), ;, }, else, if, (, ast_expanded_type, .*, ==, ., struct_type, and, ast_expanded_type, ., struct_type, ., was_slice, ), {, new_lhs, =, new_lhs, ., create_select_lval, (, 0, ,, 0, ,, _type, ., expand_identifier, (, ), ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, new_lhs, =, new_lhs, ., create_dereference_lval, (, _type, ., expand_identifier, (, ), ,, self, ., ctx, ., allocator, (, ), ), ;, }, const, length, :, ?, *, lval_, ., L_Value, =, self, ., generate_indexable_length, (, lhs, ,, ast_expanded_type, ,, ast, ., token, (, ), ., span, ), ;, return, new_lhs, ., create_index_lval, (, rhs, ,, length, ,, _type, ., expand_identifier, (, ), ,, self, ., ctx, ., allocator, (, ), ), ;, }, ,, ., select, =>, {, const, ast_lval, =, try, self, ., lower_AST, (, ast, ., lhs, (, ), ,, labels, ), ;, var, lhs_expanded_type, =, self, ., ctx, ., typecheck, ., typeof, (, ast, ., lhs, (, ), ), ., expand_identifier, (, ), ;, const, offset, =, if, (, lhs_expanded_type, .*, ==, ., struct_type, ), lhs_expanded_type, ., struct_type, ., get_offset, (, ast, ., pos, (, ), .?, ), else, if, (, lhs_expanded_type, .*, ==, ., tuple_type, ), lhs_expanded_type, ., tuple_type, ., get_offset, (, ast, ., pos, (, ), .?, ), else, 0, ;, var, tag, :, ?, *, lval_, ., L_Value, =, null, ;, if, (, lhs_expanded_type, .*, ==, ., enum_type, ), {, tag, =, self, ., create_temp_lvalue, (, prelude_, ., word64_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init_get_tag, (, tag, .?, ,, ast_lval, .?, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, const, field, =, ast, ., pos, (, ), .?, ;, const, expanded_type, =, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ., expand_identifier, (, ), ;, return, ast_lval, .?, ., create_select_lval, (, field, ,, offset, ,, expanded_type, ,, tag, ,, self, ., ctx, ., allocator, (, ), ), ;, }, ,, ., struct_value, ,, ., tuple_value, ,, ., array_value, ,, ., context_value, =>, {, _, =, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ., expand_identifier, (, ), ;, const, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, var, instr, =, Instruction, ., init_load_struct, (, temp, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, for, (, ast, ., children, (, ), ., items, ), |, term, |, {, instr, ., data, ., lval_list, ., append, (, (, try, self, ., lower_AST, (, term, ,, labels, ), ), orelse, return, null, ), catch, unreachable, ;, }, self, ., instructions, ., append, (, instr, ), catch, unreachable, ;, return, temp, ;, }, ,, ., sub_slice, =>, {, const, arr, =, (, try, self, ., lower_AST, (, ast, ., sub_slice, ., super, ,, labels, ), ), orelse, return, null, ;, const, lower, =, (, try, self, ., lower_AST, (, ast, ., sub_slice, ., lower, .?, ,, labels, ), ), orelse, return, null, ;, const, upper, =, (, try, self, ., lower_AST, (, ast, ., sub_slice, ., upper, .?, ,, labels, ), ), orelse, return, null, ;, self, ., generate_subslice_check, (, lower, ,, upper, ,, ast, ., token, (, ), ., span, ), ;, const, new_size, =, self, ., create_temp_lvalue, (, prelude_, ., int_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init, (, ., sub_int, ,, new_size, ,, upper, ,, lower, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, const, data_type, =, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ., children, (, ), ., items, [, 0, ], ;, const, data_ptr, =, arr, ., create_select_lval, (, 0, ,, 0, ,, data_type, ., expand_identifier, (, ), ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, const, new_data_ptr, =, self, ., create_temp_lvalue, (, data_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init, (, ., add_int, ,, new_data_ptr, ,, data_ptr, ,, lower, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, const, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, var, load_struct, =, Instruction, ., init_load_struct, (, temp, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, load_struct, ., data, ., lval_list, ., append, (, new_data_ptr, ), catch, unreachable, ;, load_struct, ., data, ., lval_list, ., append, (, new_size, ), catch, unreachable, ;, self, ., instructions, ., append, (, load_struct, ), catch, unreachable, ;, return, temp, ;, }, ,, ., enum_value, =>, {, var, _init, :, ?, *, lval_, ., L_Value, =, null, ;, const, pos, :, usize, =, ast, ., pos, (, ), .?, ;, const, ast_type, =, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ., expand_identifier, (, ), ;, const, proper_term, :, *, Type_AST, =, if, (, ast_type, .*, ==, ., enum_type, or, ast_type, .*, ==, ., untagged_sum_type, ), ast_type, ., children, (, ), ., items, [, pos, ], else, if, (, ast_type, .*, ==, ., annotation, ), ast_type, else, std, ., debug, ., panic, (, "expected either sum type or annot got {f}", ,, ., {, ast_type, }, ), ;, if, (, ast, ., enum_value, ., init, !=, null, ), {, const, sum_init, =, try, self, ., lower_AST, (, ast, ., enum_value, ., init, .?, ,, labels, ), ;, if, (, proper_term, ., child, (, ), .*, !=, ., unit_type, ), {, _init, =, sum_init, ;, }, }, const, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_union, (, temp, ,, _init, ,, ast, ., pos, (, ), .?, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, temp, ;, }, ,, ., @, "if", =>, {, const, symbol, =, self, ., create_temp_symbol, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, const, else_label, =, Instruction, ., init_label, (, "if.else", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, end_label, =, Instruction, ., init_label, (, "if.end", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, if, (, ast, ., @, "if", ., let, ), |, let, |, {, _, =, try, self, ., lower_AST, (, let, ,, labels, ), ;, }, try, self, ., flow, (, ast, ., @, "if", ., condition, ,, else_label, ,, false, ,, ast, ., token, (, ), ., span, ,, labels, ), ;, try, self, ., generate_control_flow_block, (, ast, ., body_block, (, ), ,, symbol, ,, ast, ., else_block, (, ), !=, null, ,, labels, ), ;, self, ., instructions, ., append, (, Instruction, ., init_jump, (, end_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, else_label, ), catch, unreachable, ;, try, self, ., generate_control_flow_else, (, ast, ., else_block, (, ), ,, symbol, ,, ast, ., token, (, ), ., span, ,, labels, ), ;, self, ., instructions, ., append, (, end_label, ), catch, unreachable, ;, return, lval_, ., L_Value, ., create_unversioned_symbver, (, symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, }, ,, ., match, =>, {, const, symbol, =, self, ., create_temp_symbol, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, const, end_label, =, Instruction, ., init_label, (, "match.end", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, fail_label, =, Instruction, ., init_label, (, "match.fail", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, if, (, ast, ., match, ., let, ), |, let, |, {, _, =, try, self, ., lower_AST, (, let, ,, labels, ), ;, }, const, expr, =, (, try, self, ., lower_AST, (, ast, ., expr, (, ), ,, labels, ), ), orelse, return, null, ;, const, rhs_label_list, =, try, self, ., generate_match_pattern_checks, (, expr, ,, ast, ., children, (, ), .*, ,, fail_label, ,, labels, ), ;, self, ., instructions, ., append, (, fail_label, ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_stack_push, (, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_panic, (, "could not match pattern", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, const, span, =, ast, ., token, (, ), ., span, ;, try, self, ., generate_match_bodies, (, expr, ,, ast, ., children, (, ), .*, ,, rhs_label_list, ,, symbol, ,, end_label, ,, span, ,, labels, ), ;, self, ., instructions, ., append, (, end_label, ), catch, unreachable, ;, return, lval_, ., L_Value, ., create_unversioned_symbver, (, symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, }, ,, ., @, "while", =>, {, const, symbol, =, self, ., create_temp_symbol, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, const, cond_label, =, Instruction, ., init_label, (, "while.cond", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, current_continue_label, =, Instruction, ., init_label, (, "while.continue", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, else_label, =, Instruction, ., init_label, (, "while.else", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, end_label, =, Instruction, ., init_label, (, "while.end", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, if, (, ast, ., @, "while", ., let, ), |, let, |, {, _, =, try, self, ., lower_AST, (, let, ,, labels, ), ;, }, const, loop_labels, =, Labels, {, ., return_label, =, labels, ., return_label, ,, ., break_label, =, end_label, ,, ., continue_label, =, current_continue_label, ,, ., error_label, =, labels, ., error_label, ,, }, ;, const, post_labels, =, Labels, {, ., return_label, =, labels, ., return_label, ,, ., break_label, =, end_label, ,, ., continue_label, =, labels, ., continue_label, ,, ., error_label, =, labels, ., error_label, ,, }, ;, self, ., instructions, ., append, (, cond_label, ), catch, unreachable, ;, try, self, ., flow, (, ast, ., @, "while", ., condition, ,, else_label, ,, false, ,, ast, ., token, (, ), ., span, ,, loop_labels, ), ;, try, self, ., generate_control_flow_block, (, ast, ., body_block, (, ), ,, symbol, ,, ast, ., else_block, (, ), !=, null, ,, loop_labels, ), ;, self, ., instructions, ., append, (, current_continue_label, ), catch, unreachable, ;, if, (, ast, ., @, "while", ., post, ), |, post, |, {, _, =, try, self, ., lower_AST, (, post, ,, post_labels, ), ;, }, self, ., instructions, ., append, (, Instruction, ., init_jump, (, cond_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, else_label, ), catch, unreachable, ;, try, self, ., generate_control_flow_else, (, ast, ., else_block, (, ), ,, symbol, ,, ast, ., token, (, ), ., span, ,, labels, ), ;, self, ., instructions, ., append, (, end_label, ), catch, unreachable, ;, return, lval_, ., L_Value, ., create_unversioned_symbver, (, symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, }, ,, ., with, =>, {, for, (, ast, ., with, ., contexts, ., items, ), |, ctx, |, {, _, =, try, self, ., lower_AST, (, ctx, ,, labels, ), ;, }, return, self, ., lower_AST, (, ast, ., with, ., _body_block, ,, labels, ), ;, }, ,, ., block, =>, {, if, (, ast, ., children, (, ), ., items, ., len, ==, 0, and, ast, ., block, ., final, ==, null, ), {, return, self, ., lval_from_unit_value, (, ast, ), ;, }, var, continue_labels, =, std, ., array_list, ., Managed, (, *, Instruction, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, continue_labels, ., deinit, (, ), ;, var, break_labels, =, std, ., array_list, ., Managed, (, *, Instruction, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, break_labels, ., deinit, (, ), ;, var, return_labels, =, std, ., array_list, ., Managed, (, *, Instruction, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, return_labels, ., deinit, (, ), ;, var, error_labels, =, std, ., array_list, ., Managed, (, *, Instruction, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, error_labels, ., deinit, (, ), ;, for, (, ast, ., block, ., defers, ., items, ), |, _, |, {, continue_labels, ., append, (, Instruction, ., init_label, (, "block.defer.continue", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, break_labels, ., append, (, Instruction, ., init_label, (, "block.defer.break", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return_labels, ., append, (, Instruction, ., init_label, (, "block.defer.return", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, error_labels, ., append, (, Instruction, ., init_label, (, "block.errdefer.error", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, const, end_label, =, Instruction, ., init_label, (, "block.end", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, var, current_labels, :, Labels, =, labels, ;, var, defer_label_index, :, usize, =, 0, ;, var, errdefer_label_index, :, usize, =, 0, ;, var, temp, :, ?, *, lval_, ., L_Value, =, null, ;, for, (, ast, ., children, (, ), ., items, ), |, child, |, {, temp, =, try, self, ., lower_AST, (, child, ,, current_labels, ), ;, if, (, child, .*, ==, ., @, "defer", ), {, current_labels, ., continue_label, =, continue_labels, ., items, [, defer_label_index, ], ;, current_labels, ., break_label, =, break_labels, ., items, [, defer_label_index, ], ;, current_labels, ., return_label, =, return_labels, ., items, [, defer_label_index, ], ;, current_labels, ., error_label, =, error_labels, ., items, [, defer_label_index, ], ;, defer_label_index, +=, 1, ;, }, else, if, (, child, .*, ==, ., @, "errdefer", ), {, current_labels, ., error_label, =, error_labels, ., items, [, errdefer_label_index, ], ;, errdefer_label_index, +=, 1, ;, }, }, if, (, ast, ., block, ., final, ), |, final, |, {, _, =, try, self, ., lower_AST, (, final, ,, current_labels, ), ;, }, else, if, (, temp, ), |, _temp, |, {, self, ., wrap_error_return, (, _temp, ,, ast, ., token, (, ), ., span, ,, current_labels, ), ;, }, try, self, ., generate_defers, (, &, ast, ., block, ., defers, ,, &, continue_labels, ,, false, ), ;, self, ., instructions, ., append, (, Instruction, ., init_jump, (, end_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, try, self, ., generate_defers, (, &, ast, ., block, ., defers, ,, &, break_labels, ,, false, ), ;, self, ., instructions, ., append, (, Instruction, ., init_jump, (, labels, ., break_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, try, self, ., generate_defers, (, &, ast, ., block, ., defers, ,, &, return_labels, ,, false, ), ;, self, ., instructions, ., append, (, Instruction, ., init_jump, (, labels, ., return_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, try, self, ., generate_defers, (, &, ast, ., block, ., defers, ,, &, error_labels, ,, true, ), ;, self, ., instructions, ., append, (, Instruction, ., init_jump, (, labels, ., error_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, end_label, ), catch, unreachable, ;, return, temp, ;, }, ,, ., binding, =>, {, if, (, ast, ., binding, ., init, ), |, _init, |, {, const, def, :, ?, *, lval_, ., L_Value, =, try, self, ., lower_AST, (, _init, ,, labels, ), ;, if, (, def, ==, null, ), {, return, null, ;, }, try, self, ., generate_pattern, (, ast, ., binding, ., pattern, ,, ast, ., binding, ., type, ., expand_identifier, (, ), ,, def, .?, ), ;, }, return, self, ., lval_from_unit_value, (, ast, ), ;, }, ,, ., context_value_decl, =>, {, if, (, ast, ., context_value_decl, ., init, ), |, _init, |, {, const, def, :, ?, *, lval_, ., L_Value, =, try, self, ., lower_AST, (, _init, ,, labels, ), ;, if, (, def, ==, null, ), {, return, null, ;, }, const, symbver, =, lval_, ., L_Value, ., create_unversioned_symbver, (, ast, ., symbol, (, ), .?, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_simple_copy, (, symbver, ,, def, .?, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, return, self, ., lval_from_unit_value, (, ast, ), ;, }, ,, ., decl, =>, return, self, ., lval_from_unit_value, (, ast, ), ,, ., fn_decl, =>, return, try, self, ., lval_from_symbol_cfg, (, ast, ., symbol, (, ), .?, ,, ast, ., token, (, ), ., span, ), ,, ., @, "errdefer", ,, ., @, "defer", =>, return, self, ., lval_from_unit_value, (, ast, ), ,, ., @, "continue", =>, {, self, ., instructions, ., append, (, Instruction, ., init_jump, (, labels, ., continue_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, null, ;, }, ,, ., @, "unreachable", =>, {, self, ., instructions, ., append, (, Instruction, ., init_stack_push, (, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_panic, (, "reached unreachable code", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, null, ;, }, ,, ., @, "break", =>, {, self, ., instructions, ., append, (, Instruction, ., init_jump, (, labels, ., break_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, null, ;, }, ,, ., @, "return", =>, {, if, (, ast, ., @, "return", ., _ret_expr, ), |, expr, |, {, const, retval, =, (, try, self, ., lower_AST, (, expr, ,, labels, ), ), orelse, return, null, ;, const, retval_lval, =, lval_, ., L_Value, ., create_unversioned_symbver, (, self, ., cfg, ., return_symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_simple_copy, (, retval_lval, ,, retval, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., wrap_error_return, (, retval, ,, ast, ., token, (, ), ., span, ,, labels, ), ;, }, self, ., instructions, ., append, (, Instruction, ., init_jump, (, labels, ., return_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, null, ;, }, ,, else, =>, std, ., debug, ., panic, (, "compiler error: unimplemented lower_AST() for: AST.{s}", ,, ., {, @, tagName, (, ast, .*, ), }, ), ,, }, }, fn, lval_from_unit_value, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, ), *, lval_, ., L_Value, {, const, lval, =, self, ., create_temp_lvalue, (, prelude_, ., unit_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init, (, ., load_unit, ,, lval, ,, null, ,, null, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, lval, ;, }, fn, lval_from_int, (, self, :, *, Self, ,, int, :, i128, ,, _type, :, *, Type_AST, ,, span, :, Span, ,, ), *, lval_, ., L_Value, {, const, temp, =, self, ., create_temp_lvalue, (, _type, ), ;, self, ., instructions, ., append, (, Instruction, ., init_int, (, temp, ,, int, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, temp, ;, }, fn, lval_from_symbol_cfg, (, self, :, *, Self, ,, symbol, :, *, Symbol, ,, span, :, Span, ,, ), Lower_Errors, !, *, lval_, ., L_Value, {, const, callee, =, try, self, ., ctx, ., cfg_store, ., get_cfg, (, symbol, ,, self, ., interned_strings, ), ;, self, ., cfg, ., children, ., put, (, callee, ,, {, }, ), catch, unreachable, ;, const, lval, =, self, ., create_temp_lvalue, (, symbol, ., type, (, ), ), ;, const, instr, =, Instruction, ., init_symbol, (, lval, ,, symbol, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, instr, ), catch, unreachable, ;, return, lval, ;, }, fn, unop, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, labels, :, Labels, ,, ), Lower_Errors, !, ?, *, lval_, ., L_Value, {, const, expr, =, try, self, ., lower_AST, (, ast, ., expr, (, ), ,, labels, ), orelse, return, null, ;, const, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_int_float_kind, (, int_kind, (, ast, ), ,, float_kind, (, ast, ), ,, temp, ,, expr, ,, null, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, temp, ;, }, fn, binop, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, labels, :, Labels, ,, ), Lower_Errors, !, ?, *, lval_, ., L_Value, {, const, lhs_lval, =, try, self, ., lower_AST, (, ast, ., lhs, (, ), ,, labels, ), ;, const, rhs_lval, =, try, self, ., lower_AST, (, ast, ., rhs, (, ), ,, labels, ), ;, if, (, lhs_lval, ==, null, or, rhs_lval, ==, null, ), {, return, null, ;, }, const, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_int_float_kind, (, int_kind, (, ast, ), ,, float_kind, (, ast, ), ,, temp, ,, lhs_lval, ,, rhs_lval, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, temp, ;, }, fn, int_kind, (, ast, :, *, ast_, ., AST, ), Instruction, ., Kind, {, return, switch, (, ast, .*, ), {, ., not, =>, ., not, ,, ., negate, =>, ., negate_int, ,, ., bit_not, =>, ., bit_not, ,, ., addr_of, =>, if, (, ast, ., addr_of, ., mut, ), ., mut_addr_of, else, ., addr_of, ,, ., add, =>, ., add_int, ,, ., sub, =>, ., sub_int, ,, ., mult, =>, ., mult_int, ,, ., div, =>, ., div_int, ,, ., mod, =>, ., mod, ,, ., left_shift, =>, ., left_shift, ,, ., right_shift, =>, ., right_shift, ,, ., greater, =>, ., greater_int, ,, ., lesser, =>, ., lesser_int, ,, ., greater_equal, =>, ., greater_equal_int, ,, ., lesser_equal, =>, ., lesser_equal_int, ,, else, =>, unreachable, ,, }, ;, }, fn, float_kind, (, ast, :, *, ast_, ., AST, ), Instruction, ., Kind, {, return, switch, (, ast, .*, ), {, ., not, =>, ., not, ,, ., negate, =>, ., negate_float, ,, ., bit_not, =>, ., bit_not, ,, ., addr_of, =>, if, (, ast, ., addr_of, ., mut, ), ., mut_addr_of, else, ., addr_of, ,, ., add, =>, ., add_float, ,, ., sub, =>, ., sub_float, ,, ., mult, =>, ., mult_float, ,, ., div, =>, ., div_float, ,, ., mod, =>, ., mod, ,, ., greater, =>, ., greater_float, ,, ., lesser, =>, ., lesser_float, ,, ., greater_equal, =>, ., greater_equal_float, ,, ., lesser_equal, =>, ., lesser_equal_float, ,, ., left_shift, =>, ., left_shift, ,, ., right_shift, =>, ., right_shift, ,, else, =>, unreachable, ,, }, ;, }, fn, or_and_op, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, labels, :, Labels, ,, ), Lower_Errors, !, ?, *, lval_, ., L_Value, {, const, or_and_symbol, =, self, ., create_temp_symbol, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, const, jump_label, =, Instruction, ., init_label, (, "or/and.jump", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, end_label, =, Instruction, ., init_label, (, "or/and.end", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, should_jump, =, ast, .*, ==, ., @, "or", ;, try, self, ., flow, (, ast, ., lhs, (, ), ,, jump_label, ,, should_jump, ,, ast, ., token, (, ), ., span, ,, labels, ), ;, try, self, ., flow, (, ast, ., rhs, (, ), ,, jump_label, ,, should_jump, ,, ast, ., token, (, ), ., span, ,, labels, ), ;, const, load_false_lval, =, lval_, ., L_Value, ., create_unversioned_symbver, (, or_and_symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_int, (, load_false_lval, ,, if, (, should_jump, ), 0, else, 1, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_jump, (, end_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, jump_label, ), catch, unreachable, ;, const, load_true_lval, =, lval_, ., L_Value, ., create_unversioned_symbver, (, or_and_symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_int, (, load_true_lval, ,, if, (, should_jump, ), 1, else, 0, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, end_label, ), catch, unreachable, ;, return, lval_, ., L_Value, ., create_unversioned_symbver, (, or_and_symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, }, fn, tuple_equality_check, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, labels, :, Labels, ,, ), Lower_Errors, !, ?, *, lval_, ., L_Value, {, std, ., debug, ., assert, (, ast, .*, ==, ., equal, or, ast, .*, ==, ., not_equal, ), ;, const, lhs, =, try, self, ., lower_AST, (, ast, ., lhs, (, ), ,, labels, ), ;, const, rhs, =, try, self, ., lower_AST, (, ast, ., rhs, (, ), ,, labels, ), ;, if, (, lhs, ==, null, or, rhs, ==, null, ), {, return, null, ;, }, const, temp, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, const, lhs_type, =, lhs, .?, ., get_expanded_type, (, ), ;, if, (, lhs_type, .*, !=, ., tuple_type, and, lhs_type, .*, !=, ., enum_type, ), {, self, ., instructions, ., append, (, Instruction, ., init, (, if, (, ast, .*, ==, ., equal, ), ., equal, else, ., not_equal, ,, temp, ,, lhs, ,, rhs, ,, lhs, .?, ., extract_symbver, (, ), ., symbol, ., span, (, ), ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, temp, ;, }, const, fail_label, =, Instruction, ., init_label, (, "tuple-eq.fail", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, end_label, =, Instruction, ., init_label, (, "tuple-eq.end", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., tuple_equality_flow, (, lhs, .?, ,, rhs, .?, ,, fail_label, ), ;, self, ., instructions, ., append, (, Instruction, ., init_int, (, temp, ,, if, (, ast, .*, ==, ., equal, ), 1, else, 0, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_jump, (, end_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, fail_label, ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_int, (, temp, ,, if, (, ast, .*, ==, ., equal, ), 0, else, 1, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, end_label, ), catch, unreachable, ;, return, temp, ;, }, fn, tuple_equality_flow, (, self, :, *, Self, ,, lhs, :, *, lval_, ., L_Value, ,, rhs, :, *, lval_, ., L_Value, ,, fail_label, :, *, Instruction, ,, ), void, {, const, new_lhs, =, lhs, ;, const, new_rhs, =, rhs, ;, const, temp, =, self, ., create_temp_lvalue, (, prelude_, ., bool_type, ), ;, var, lhs_type, =, lhs, ., get_expanded_type, (, ), ;, if, (, lhs_type, .*, ==, ., tuple_type, ), {, for, (, 0..lhs_type.children, (, ), ., items, ., len, ), |, field, |, {, const, expanded_type, =, lhs_type, ., children, (, ), ., items, [, field, ], ., expand_identifier, (, ), ;, const, offset, =, lhs_type, ., tuple_type, ., get_offset, (, field, ), ;, const, lhs_select, =, new_lhs, ., create_select_lval, (, field, ,, offset, ,, expanded_type, ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, const, rhs_select, =, new_rhs, ., create_select_lval, (, field, ,, offset, ,, expanded_type, ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., tuple_equality_flow, (, lhs_select, ,, rhs_select, ,, fail_label, ), ;, }, }, else, if, (, lhs_type, .*, ==, ., enum_type, ), {, const, lhs_tag, =, self, ., create_temp_lvalue, (, prelude_, ., word64_type, ), ;, const, rhs_tag, =, self, ., create_temp_lvalue, (, prelude_, ., word64_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init_get_tag, (, lhs_tag, ,, new_lhs, ,, lhs, ., extract_symbver, (, ), ., symbol, ., span, (, ), ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_get_tag, (, rhs_tag, ,, new_rhs, ,, lhs, ., extract_symbver, (, ), ., symbol, ., span, (, ), ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init, (, ., equal, ,, temp, ,, lhs_tag, ,, rhs_tag, ,, lhs, ., extract_symbver, (, ), ., symbol, ., span, (, ), ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_branch, (, temp, ,, fail_label, ,, lhs, ., extract_symbver, (, ), ., symbol, ., span, (, ), ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, else, {, self, ., instructions, ., append, (, Instruction, ., init, (, ., equal, ,, temp, ,, new_lhs, ,, rhs, ,, lhs, ., extract_symbver, (, ), ., symbol, ., span, (, ), ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_branch, (, temp, ,, fail_label, ,, lhs, ., extract_symbver, (, ), ., symbol, ., span, (, ), ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, }, fn, coalesce_op, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, labels, :, Labels, ,, ), Lower_Errors, !, ?, *, lval_, ., L_Value, {, const, coalesce_symbol, =, self, ., create_temp_symbol, (, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ), ;, const, zero_label, =, Instruction, ., init_label, (, "coalesce.zero", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, end_label, =, Instruction, ., init_label, (, "coalesce.end", ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, lhs, =, (, try, self, ., lower_AST, (, ast, ., lhs, (, ), ,, labels, ), ), orelse, return, null, ;, const, condition, =, self, ., create_temp_lvalue, (, prelude_, ., word64_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init_get_tag, (, condition, ,, lhs, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_branch, (, condition, ,, zero_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, const, maybe_rhs, =, (, try, self, ., lower_AST, (, ast, ., rhs, (, ), ,, labels, ), ), ;, if, (, maybe_rhs, ), |, rhs, |, {, const, rhs_lval, =, lval_, ., L_Value, ., create_unversioned_symbver, (, coalesce_symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_simple_copy, (, rhs_lval, ,, rhs, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_jump, (, end_label, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, self, ., instructions, ., append, (, zero_label, ), catch, unreachable, ;, const, expanded_type, =, self, ., ctx, ., typecheck, ., typeof, (, ast, ), ., expand_identifier, (, ), ;, const, val, =, lhs, ., create_select_lval, (, 0, ,, 0, ,, expanded_type, ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, const, ok_lval, =, lval_, ., L_Value, ., create_unversioned_symbver, (, coalesce_symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_simple_copy, (, ok_lval, ,, val, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, end_label, ), catch, unreachable, ;, return, lval_, ., L_Value, ., create_unversioned_symbver, (, coalesce_symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, }, fn, bit_ir_kind_from_ast_kind, (, ast, :, *, ast_, ., AST, ), Instruction, ., Kind, {, return, switch, (, ast, .*, ), {, ., bit_and, =>, Instruction, ., Kind, ., bit_and, ,, ., bit_or, =>, Instruction, ., Kind, ., bit_or, ,, ., bit_xor, =>, Instruction, ., Kind, ., bit_xor, ,, else, =>, std, ., debug, ., panic, (, "compiler error: not a bit ast: {s}\n", ,, ., {, @, tagName, (, ast, .*, ), }, ), ,, }, ;, }, fn, generate_assign, (, self, :, *, Self, ,, lhs, :, *, ast_, ., AST, ,, rhs, :, *, lval_, ., L_Value, ,, labels, :, Labels, ,, ), Lower_Errors, !, void, {, if, (, lhs, .*, ==, ., tuple_value, ), {, var, lhs_expanded_type, =, self, ., ctx, ., typecheck, ., typeof, (, lhs, ), ., expand_identifier, (, ), ;, for, (, lhs, ., children, (, ), ., items, ,, 0.., ), |, term, ,, field, |, {, const, product_lhs, =, try, self, ., lower_AST, (, term, ,, labels, ), ;, if, (, product_lhs, ==, null, ), {, continue, ;, }, const, expanded_type, =, rhs, ., get_expanded_type, (, ), ., children, (, ), ., items, [, field, ], ., expand_identifier, (, ), ;, const, offset, =, lhs_expanded_type, ., tuple_type, ., get_offset, (, field, ), ;, const, select, =, rhs, ., create_select_lval, (, field, ,, offset, ,, expanded_type, ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, try, self, ., generate_assign, (, term, ,, select, ,, labels, ), ;, }, }, else, if, (, lhs, .*, ==, ., array_value, ), {, const, lhs_expanded_type, =, self, ., ctx, ., typecheck, ., typeof, (, lhs, ), ., expand_identifier, (, ), ;, for, (, lhs, ., children, (, ), ., items, ,, 0.., ), |, term, ,, field, |, {, const, array_lhs, =, try, self, ., lower_AST, (, term, ,, labels, ), ;, if, (, array_lhs, ==, null, ), {, continue, ;, }, const, expanded_type, =, rhs, ., get_expanded_type, (, ), ., child, (, ), ., expand_identifier, (, ), ;, const, length, :, ?, *, lval_, ., L_Value, =, self, ., generate_indexable_length, (, rhs, ,, lhs_expanded_type, ,, lhs, ., token, (, ), ., span, ), ;, const, idx, =, self, ., lval_from_int, (, field, ,, prelude_, ., int_type, ,, lhs, ., token, (, ), ., span, ), ;, const, index, =, rhs, ., create_index_lval, (, idx, ,, length, ,, expanded_type, ,, self, ., ctx, ., allocator, (, ), ), ;, try, self, ., generate_assign, (, term, ,, index, ,, labels, ), ;, }, }, else, if, (, lhs, .*, ==, ., select, and, self, ., ctx, ., typecheck, ., typeof, (, lhs, ., lhs, (, ), ), ., expand_identifier, (, ), .*, ==, ., enum_type, ), {, const, enum_value, =, self, ., create_temp_lvalue, (, self, ., ctx, ., typecheck, ., typeof, (, lhs, ., lhs, (, ), ), ., expand_identifier, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_union, (, enum_value, ,, rhs, ,, lhs, ., pos, (, ), .?, ,, lhs, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, try, self, ., generate_assign, (, lhs, ., lhs, (, ), ,, enum_value, ,, labels, ), ;, }, else, {, const, lval, =, try, self, ., lower_AST, (, lhs, ,, labels, ), ;, const, instr, =, Instruction, ., init, (, ., copy, ,, lval, ,, rhs, ,, null, ,, lhs, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, instr, ), catch, unreachable, ;, }, }, fn, generate_indexable_length, (, self, :, *, Self, ,, lhs, :, *, lval_, ., L_Value, ,, _type, :, *, Type_AST, ,, span, :, Span, ,, ), ?, *, lval_, ., L_Value, {, if, (, _type, .*, ==, ., addr_of, ), {, std, ., debug, ., assert, (, _type, ., addr_of, ., multiptr, ), ;, return, null, ;, }, else, if, (, _type, .*, ==, ., struct_type, and, _type, ., struct_type, ., was_slice, ), {, const, offset, =, _type, ., struct_type, ., get_offset, (, 1, ), ;, return, lhs, ., create_select_lval, (, 1, ,, offset, ,, prelude_, ., int64_type, ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, }, else, if, (, _type, .*, ==, ., array_of, ), {, const, retval, =, self, ., create_temp_lvalue, (, prelude_, ., int_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init_int, (, retval, ,, _type, ., array_of, ., len, ., int, ., data, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, retval, ;, }, else, if, (, _type, .*, ==, ., tuple_type, ), {, const, retval, =, self, ., create_temp_lvalue, (, prelude_, ., int_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init_int, (, retval, ,, _type, ., children, (, ), ., items, ., len, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, return, retval, ;, }, else, {, std, ., debug, ., panic, (, "compiler error: cannot generate Instruction to get length of type AST.{s}", ,, ., {, @, tagName, (, _type, .*, ), }, ), ;, }, }, fn, generate_subslice_check, (, self, :, *, Self, ,, lower, :, *, lval_, ., L_Value, ,, upper, :, *, lval_, ., L_Value, ,, span, :, Span, ,, ), void, {, const, end_label, =, Instruction, ., init_label, (, "subslice-bounds-check.end", ,, span, ,, self, ., ctx, ., allocator, (, ), ), ;, const, compare, =, self, ., create_temp_lvalue, (, prelude_, ., bool_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init, (, ., greater_int, ,, compare, ,, lower, ,, upper, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_branch, (, compare, ,, end_label, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_stack_push, (, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_panic, (, "subslice lower bound is greater than upper bound", ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, end_label, ), catch, unreachable, ;, }, fn, flow, (, self, :, *, Self, ,, condition, :, *, ast_, ., AST, ,, label, :, *, Instruction, ,, sense, :, bool, ,, span, :, Span, ,, labels, :, Labels, ,, ), Lower_Errors, !, void, {, switch, (, condition, .*, ), {, ., true, =>, if, (, sense, ), {, self, ., instructions, ., append, (, Instruction, ., init_jump, (, label, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, ,, ., false, =>, if, (, !, sense, ), {, self, ., instructions, ., append, (, Instruction, ., init_jump, (, label, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, ,, ., not, =>, try, self, ., flow, (, condition, ., expr, (, ), ,, label, ,, !, sense, ,, span, ,, labels, ), ,, ., @, "or", =>, if, (, sense, ), {, try, self, ., flow, (, condition, ., lhs, (, ), ,, label, ,, true, ,, span, ,, labels, ), ;, try, self, ., flow, (, condition, ., rhs, (, ), ,, label, ,, true, ,, span, ,, labels, ), ;, }, else, {, const, skip_label, =, Instruction, ., init_label, (, "or-flow.skip", ,, span, ,, self, ., ctx, ., allocator, (, ), ), ;, try, self, ., flow, (, condition, ., lhs, (, ), ,, skip_label, ,, true, ,, span, ,, labels, ), ;, try, self, ., flow, (, condition, ., rhs, (, ), ,, label, ,, false, ,, span, ,, labels, ), ;, self, ., instructions, ., append, (, skip_label, ), catch, unreachable, ;, }, ,, ., @, "and", =>, if, (, sense, ), {, const, skip_label, =, Instruction, ., init_label, (, "and-flow.skip", ,, span, ,, self, ., ctx, ., allocator, (, ), ), ;, try, self, ., flow, (, condition, ., lhs, (, ), ,, skip_label, ,, false, ,, span, ,, labels, ), ;, try, self, ., flow, (, condition, ., rhs, (, ), ,, label, ,, true, ,, span, ,, labels, ), ;, self, ., instructions, ., append, (, skip_label, ), catch, unreachable, ;, }, else, {, try, self, ., flow, (, condition, ., lhs, (, ), ,, label, ,, false, ,, span, ,, labels, ), ;, try, self, ., flow, (, condition, ., rhs, (, ), ,, label, ,, false, ,, span, ,, labels, ), ;, }, ,, else, =>, if, (, sense, ), {, const, condition_lval, =, try, self, ., lower_AST, (, condition, ,, labels, ), orelse, return, ;, const, not_condition_lval, =, self, ., create_temp_lvalue, (, prelude_, ., bool_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init, (, ., not, ,, not_condition_lval, ,, condition_lval, ,, null, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_branch, (, not_condition_lval, ,, label, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, else, {, const, condition_lval, =, try, self, ., lower_AST, (, condition, ,, labels, ), orelse, return, ;, self, ., instructions, ., append, (, Instruction, ., init_branch, (, condition_lval, ,, label, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, ,, }, }, fn, generate_control_flow_block, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, symbol, :, *, Symbol, ,, has_else, :, bool, ,, labels, :, Labels, ,, ), Lower_Errors, !, void, {, if, (, try, self, ., lower_AST, (, ast, ,, labels, ), ), |, rhs_lval, |, {, const, rhs_copy_lval, =, lval_, ., L_Value, ., create_unversioned_symbver, (, symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, if, (, has_else, ), {, self, ., instructions, ., append, (, Instruction, ., init_simple_copy, (, rhs_copy_lval, ,, rhs_lval, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, else, {, self, ., instructions, ., append, (, Instruction, ., init_union, (, rhs_copy_lval, ,, rhs_lval, ,, 0, ,, ast, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, }, }, fn, generate_control_flow_else, (, self, :, *, Self, ,, ast, :, ?, *, ast_, ., AST, ,, symbol, :, *, Symbol, ,, span, :, Span, ,, labels, :, Labels, ,, ), Lower_Errors, !, void, {, if, (, ast, ), |, else_block, |, {, if, (, try, self, ., lower_AST, (, else_block, ,, labels, ), ), |, else_lval, |, {, const, else_copy_lval, =, lval_, ., L_Value, ., create_unversioned_symbver, (, symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_simple_copy, (, else_copy_lval, ,, else_lval, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, }, else, {, const, else_copy_lval, =, lval_, ., L_Value, ., create_unversioned_symbver, (, symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_union, (, else_copy_lval, ,, null, ,, 1, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, }, fn, generate_match_pattern_checks, (, self, :, *, Self, ,, expr, :, *, lval_, ., L_Value, ,, mappings, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, none_label, :, *, Instruction, ,, labels, :, Labels, ,, ), Lower_Errors, !, std, ., array_list, ., Managed, (, *, Instruction, ), {, var, lhs_label_list, =, std, ., array_list, ., Managed, (, *, Instruction, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, lhs_label_list, ., deinit, (, ), ;, var, rhs_label_list, =, std, ., array_list, ., Managed, (, *, Instruction, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, errdefer, rhs_label_list, ., deinit, (, ), ;, for, (, mappings, ., items, ), |, mapping, |, {, lhs_label_list, ., append, (, Instruction, ., init_label, (, "match.lhs", ,, mapping, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, rhs_label_list, ., append, (, Instruction, ., init_label, (, "match-rhs", ,, mapping, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, for, (, mappings, ., items, ,, 0.., ), |, mapping, ,, i, |, {, self, ., instructions, ., append, (, lhs_label_list, ., items, [, i, ], ), catch, unreachable, ;, const, next_label, =, if, (, i, <, lhs_label_list, ., items, ., len, -, 1, ), lhs_label_list, ., items, [, i, +, 1, ], else, none_label, ;, try, self, ., generate_match_pattern_check, (, mapping, ., lhs, (, ), ,, expr, ,, next_label, ,, labels, ), ;, self, ., instructions, ., append, (, Instruction, ., init_jump, (, rhs_label_list, ., items, [, i, ], ,, mapping, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, return, rhs_label_list, ;, }, fn, generate_match_pattern_check, (, self, :, *, Self, ,, pattern, :, ?, *, ast_, ., AST, ,, expr, :, *, lval_, ., L_Value, ,, next_pattern, :, *, Instruction, ,, labels, :, Labels, ,, ), Lower_Errors, !, void, {, switch, (, pattern, .?, .*, ), {, ., pattern_symbol, =>, {, }, ,, ., int, ,, ., float, ,, ., true, ,, ., false, ,, ., string, ,, ., block, ,, =>, {, const, value, =, (, try, self, ., lower_AST, (, pattern, .?, ,, labels, ), ), orelse, return, ;, const, condition, =, self, ., create_temp_lvalue, (, prelude_, ., bool_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init, (, ., equal, ,, condition, ,, expr, ,, value, ,, pattern, .?, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_branch, (, condition, ,, next_pattern, ,, pattern, .?, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, ,, ., tuple_value, =>, {, for, (, pattern, .?, ., children, (, ), ., items, ,, 0.., ), |, term, ,, field, |, {, const, expanded_type, =, expr, ., get_expanded_type, (, ), ., children, (, ), ., items, [, field, ], ., expand_identifier, (, ), ;, const, pattern_type, =, self, ., ctx, ., typecheck, ., typeof, (, pattern, .?, ), ., expand_identifier, (, ), ;, const, offset, =, pattern_type, ., tuple_type, ., get_offset, (, field, ), ;, const, lval, =, expr, ., create_select_lval, (, field, ,, offset, ,, expanded_type, ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, try, self, ., generate_match_pattern_check, (, term, ,, lval, ,, next_pattern, ,, labels, ), ;, }, }, ,, ., select, ,, ., enum_value, =>, {, const, sel, =, self, ., create_temp_lvalue, (, prelude_, ., word64_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init_int, (, sel, ,, pattern, .?, ., pos, (, ), .?, ,, pattern, .?, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, const, tag, =, self, ., create_temp_lvalue, (, prelude_, ., word64_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init_get_tag, (, tag, ,, expr, ,, pattern, .?, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, const, neql, =, self, ., create_temp_lvalue, (, prelude_, ., bool_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init, (, ., equal, ,, neql, ,, tag, ,, sel, ,, pattern, .?, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_branch, (, neql, ,, next_pattern, ,, pattern, .?, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, ,, else, =>, std, ., debug, ., panic, (, "compiler error: unimplemented generate_match_pattern_check() for {s}", ,, ., {, @, tagName, (, pattern, .?, .*, ), }, ), ,, }, }, fn, generate_match_bodies, (, self, :, *, Self, ,, expr, :, *, lval_, ., L_Value, ,, mappings, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, rhs_label_list, :, std, ., array_list, ., Managed, (, *, Instruction, ), ,, symbol, :, *, Symbol, ,, end_label, :, *, Instruction, ,, span, :, Span, ,, labels, :, Labels, ,, ), Lower_Errors, !, void, {, for, (, mappings, ., items, ,, 0.., ), |, mapping, ,, i, |, {, self, ., instructions, ., append, (, rhs_label_list, ., items, [, i, ], ), catch, unreachable, ;, try, self, ., generate_pattern, (, mapping, ., lhs, (, ), ,, expr, ., get_expanded_type, (, ), ,, expr, ), ;, if, (, try, self, ., lower_AST, (, mapping, ., rhs, (, ), ,, labels, ), ), |, rhs_lval, |, {, const, rhs_copy_lval, =, lval_, ., L_Value, ., create_unversioned_symbver, (, symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_simple_copy, (, rhs_copy_lval, ,, rhs_lval, ,, mapping, ., rhs, (, ), ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, self, ., instructions, ., append, (, Instruction, ., init_jump, (, end_label, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, }, fn, wrap_error_return, (, self, :, *, Self, ,, expr, :, *, lval_, ., L_Value, ,, span, :, Span, ,, labels, :, Labels, ,, ), void, {, const, expanded_temp_type, =, expr, ., get_expanded_type, (, ), ;, if, (, labels, ., error_label, !=, null, and, expanded_temp_type, .*, ==, ., enum_type, and, expanded_temp_type, ., enum_type, ., from, ==, ., @, "error", ), {, const, condition, =, self, ., create_temp_lvalue, (, prelude_, ., word64_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init_get_tag, (, condition, ,, expr, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, const, not_condition, =, self, ., create_temp_lvalue, (, prelude_, ., bool_type, ), ;, self, ., instructions, ., append, (, Instruction, ., init, (, ., not, ,, not_condition, ,, condition, ,, null, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, self, ., instructions, ., append, (, Instruction, ., init_branch, (, not_condition, ,, labels, ., error_label, ,, span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, }, fn, create_temp_lvalue, (, self, :, *, Self, ,, _type, :, *, Type_AST, ), *, lval_, ., L_Value, {, const, temp_symbol, =, self, ., create_temp_symbol, (, _type, ), ;, const, retval, =, lval_, ., L_Value, ., create_unversioned_symbver, (, temp_symbol, ,, self, ., ctx, ., allocator, (, ), ), ;, return, retval, ;, }, fn, create_temp_symbol, (, self, :, *, Self, ,, _type, :, *, Type_AST, ), *, Symbol, {, var, buf, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, buf, ., print, (, "t{}", ,, ., {, self, ., number_temps, }, ), catch, unreachable, ;, self, ., number_temps, +=, 1, ;, const, name, =, buf, ., toOwnedSlice, (, ), catch, unreachable, ;, const, token, =, Token, ., init_simple, (, name, ), ;, const, decl, =, ast_, ., AST, ., create_decl, (, token, ,, ast_, ., AST, ., create_pattern_symbol, (, token, ,, ., mut, ,, ., local, ,, name, ,, self, ., ctx, ., allocator, (, ), ), ,, _type, ,, null, ,, self, ., ctx, ., allocator, (, ), ,, ), ;, var, temp_symbol, =, Symbol, ., init, (, self, ., cfg, ., symbol, ., scope, ,, name, ,, decl, ,, ., mut, ,, ., local, ,, self, ., ctx, ., allocator, (, ), ,, ), ;, _, =, _type, ., expand_identifier, (, ), ;, temp_symbol, ., is_temp, =, true, ;, return, temp_symbol, ;, }, fn, generate_defers, (, self, :, *, Self, ,, defers, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, defer_labels, :, *, std, ., array_list, ., Managed, (, *, Instruction, ), ,, emit_errdefers, :, bool, ,, ), Lower_Errors, !, void, {, var, i, :, usize, =, defers, ., items, ., len, ;, while, (, i, >, 0, ), :, (, i, -=, 1, ), {, const, def, =, defers, ., items, [, i, -, 1, ], ;, if, (, def, .*, !=, ., @, "errdefer", or, emit_errdefers, ), {, self, ., instructions, ., append, (, defer_labels, ., items, [, i, -, 1, ], ), catch, unreachable, ;, _, =, try, self, ., lower_AST, (, def, ., statement, (, ), ,, Labels, ., null_labels, ), ;, }, }, }, fn, generate_pattern, (, self, :, *, Self, ,, pattern, :, *, ast_, ., AST, ,, _type, :, *, Type_AST, ,, def, :, *, lval_, ., L_Value, ,, ), Lower_Errors, !, void, {, if, (, pattern, .*, ==, ., pattern_symbol, ), {, if, (, !, std, ., mem, ., eql, (, u8, ,, pattern, ., pattern_symbol, ., name, ,, "_", ), ), {, const, symbver, =, lval_, ., L_Value, ., create_unversioned_symbver, (, pattern, ., symbol, (, ), .?, ,, self, ., ctx, ., allocator, (, ), ), ;, self, ., instructions, ., append, (, Instruction, ., init_simple_copy, (, symbver, ,, def, ,, pattern, ., token, (, ), ., span, ,, self, ., ctx, ., allocator, (, ), ), ), catch, unreachable, ;, }, }, else, if, (, pattern, .*, ==, ., tuple_value, ), {, for, (, pattern, ., children, (, ), ., items, ,, 0.., ), |, term, ,, field, |, {, const, expanded_type, =, _type, ., children, (, ), ., items, [, field, ], ., expand_identifier, (, ), ;, const, offset, =, _type, ., tuple_type, ., get_offset, (, field, ), ;, const, lval, =, def, ., create_select_lval, (, field, ,, offset, ,, expanded_type, ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, try, self, ., generate_pattern, (, term, ,, expanded_type, ,, lval, ), ;, }, }, else, if, (, pattern, .*, ==, ., array_value, ), {, const, lhs_expanded_type, =, self, ., ctx, ., typecheck, ., typeof, (, pattern, ), ., expand_identifier, (, ), ;, for, (, pattern, ., children, (, ), ., items, ,, 0.., ), |, term, ,, field, |, {, const, expanded_type, =, def, ., get_expanded_type, (, ), ., child, (, ), ., expand_identifier, (, ), ;, const, length, :, ?, *, lval_, ., L_Value, =, self, ., generate_indexable_length, (, def, ,, lhs_expanded_type, ,, pattern, ., token, (, ), ., span, ), ;, const, idx, =, self, ., lval_from_int, (, field, ,, prelude_, ., int_type, ,, pattern, ., token, (, ), ., span, ), ;, const, index, =, def, ., create_index_lval, (, idx, ,, length, ,, expanded_type, ,, self, ., ctx, ., allocator, (, ), ), ;, try, self, ., generate_pattern, (, term, ,, expanded_type, ,, index, ), ;, }, }, else, if, (, pattern, .*, ==, ., enum_value, ), {, const, expanded_type, =, pattern, ., enum_value, ., domain, .?, ., child, (, ), ., expand_identifier, (, ), ;, const, field, =, pattern, ., pos, (, ), .?, ;, const, lval, =, def, ., create_select_lval, (, field, ,, 0, ,, expanded_type, ,, null, ,, self, ., ctx, ., allocator, (, ), ), ;, try, self, ., generate_pattern, (, pattern, ., enum_value, ., init, .?, ,, expanded_type, ,, lval, ), ;, }, }, const, std, =, @, import, (, "std", ), ;, const, Instruction, =, @, import, (, "../ir/instruction.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, Symbol_Version, =, @, import, (, "symbol_version.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, fmt_, =, @, import, (, "../util/fmt.zig", ), ;, pub, const, L_Value, =, union, (, enum, ), {, symbver, :, *, Symbol_Version, ,, dereference, :, struct, {, expr, :, *, L_Value, ,, expanded_type, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ,, }, ,, index, :, struct, {, lhs, :, *, L_Value, ,, rhs, :, *, L_Value, ,, length, :, ?, *, L_Value, ,, expanded_type, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ,, }, ,, select, :, struct, {, lhs, :, *, L_Value, ,, field, :, i128, ,, offset, :, i64, ,, expanded_type, :, *, Type_AST, ,, tag, :, ?, *, L_Value, ,, allocator, :, std, ., mem, ., Allocator, ,, }, ,, raw_address, :, struct, {, adrs, :, i64, ,, allocator, :, std, ., mem, ., Allocator, ,, }, ,, fn, create_symbver, (, symbver, :, *, Symbol_Version, ,, allocator, :, std, ., mem, ., Allocator, ), *, L_Value, {, const, retval, =, allocator, ., create, (, L_Value, ), catch, unreachable, ;, retval, .*, =, L_Value, {, ., symbver, =, symbver, }, ;, return, retval, ;, }, pub, fn, create_unversioned_symbver, (, symbol, :, *, Symbol, ,, allocator, :, std, ., mem, ., Allocator, ), *, L_Value, {, const, retval, =, L_Value, ., create_symbver, (, Symbol_Version, ., create_unversioned, (, symbol, ,, allocator, ), ,, allocator, ), ;, return, retval, ;, }, pub, fn, create_dereference_lval, (, lhs, :, *, L_Value, ,, expanded_type, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, L_Value, {, const, retval, =, allocator, ., create, (, L_Value, ), catch, unreachable, ;, retval, .*, =, L_Value, {, ., dereference, =, ., {, ., expr, =, lhs, ,, ., expanded_type, =, expanded_type, ,, ., allocator, =, allocator, ,, }, ,, }, ;, return, retval, ;, }, pub, fn, create_index_lval, (, lhs, :, *, L_Value, ,, rhs, :, *, L_Value, ,, length, :, ?, *, L_Value, ,, expanded_type, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, L_Value, {, const, retval, =, allocator, ., create, (, L_Value, ), catch, unreachable, ;, retval, .*, =, L_Value, {, ., index, =, ., {, ., lhs, =, lhs, ,, ., rhs, =, rhs, ,, ., length, =, length, ,, ., expanded_type, =, expanded_type, ,, ., allocator, =, allocator, ,, }, }, ;, return, retval, ;, }, pub, fn, create_select_lval, (, lhs, :, *, L_Value, ,, field, :, i128, ,, offset, :, i64, ,, expanded_type, :, *, Type_AST, ,, tag, :, ?, *, L_Value, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, L_Value, {, const, retval, =, allocator, ., create, (, L_Value, ), catch, unreachable, ;, retval, .*, =, L_Value, {, ., select, =, ., {, ., lhs, =, lhs, ,, ., field, =, field, ,, ., offset, =, offset, ,, ., expanded_type, =, expanded_type, ,, ., tag, =, tag, ,, ., allocator, =, allocator, ,, }, ,, }, ;, return, retval, ;, }, pub, fn, create_raw_address_lval, (, adrs, :, i64, ,, allocator, :, std, ., mem, ., Allocator, ), *, L_Value, {, const, retval, =, allocator, ., create, (, L_Value, ), catch, unreachable, ;, retval, .*, =, L_Value, {, ., raw_address, =, ., {, ., adrs, =, adrs, ,, ., allocator, =, allocator, }, ,, }, ;, return, retval, ;, }, pub, fn, deinit, (, self, :, *, L_Value, ), void, {, switch, (, self, .*, ), {, ., symbver, =>, self, ., symbver, ., deinit, (, ), ,, ., dereference, =>, self, ., dereference, ., allocator, ., destroy, (, self, ), ,, ., index, =>, self, ., index, ., allocator, ., destroy, (, self, ), ,, ., select, =>, self, ., select, ., allocator, ., destroy, (, self, ), ,, ., raw_address, =>, self, ., raw_address, ., allocator, ., destroy, (, self, ), ,, }, }, pub, fn, pprint, (, self, :, L_Value, ,, allocator, :, std, ., mem, ., Allocator, ), !, [, ], const, u8, {, var, out, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, out, ., deinit, (, ), ;, switch, (, self, ), {, ., symbver, =>, {, try, out, ., print, (, "{f}", ,, ., {, self, ., symbver, }, ), ;, }, ,, ., dereference, =>, {, try, out, ., print, (, "{f}^", ,, ., {, self, ., dereference, ., expr, }, ), ;, }, ,, ., index, =>, {, try, out, ., print, (, "{f}[{f}]", ,, ., {, self, ., index, ., lhs, ,, self, ., index, ., rhs, }, ), ;, }, ,, ., select, =>, {, try, out, ., print, (, "{f}._{}", ,, ., {, self, ., select, ., lhs, ,, self, ., select, ., field, }, ), ;, }, ,, ., raw_address, =>, {, try, out, ., print, (, "0x{X}", ,, ., {, self, ., raw_address, ., adrs, }, ), ;, }, ,, }, return, try, out, ., toOwnedSlice, (, ), ;, }, pub, fn, format, (, self, :, L_Value, ,, writer, :, *, std, ., io, ., Writer, ), !, void, {, try, fmt_, ., indirect_format, (, self, ,, writer, ), ;, }, pub, fn, extract_symbver, (, self, :, *, L_Value, ), *, Symbol_Version, {, return, switch, (, self, .*, ), {, ., symbver, =>, self, ., symbver, ,, ., dereference, =>, self, ., dereference, ., expr, ., extract_symbver, (, ), ,, ., index, =>, self, ., index, ., lhs, ., extract_symbver, (, ), ,, ., select, =>, self, ., select, ., lhs, ., extract_symbver, (, ), ,, ., raw_address, =>, std, ., debug, ., panic, (, "compiler error: raw addresses do not have symbvers", ,, ., {, }, ), ,, }, ;, }, pub, fn, expanded_type_sizeof, (, self, :, *, L_Value, ), i64, {, return, self, ., get_expanded_type, (, ), ., sizeof, (, ), ;, }, pub, fn, expanded_type_alignof, (, self, :, *, L_Value, ), i64, {, return, self, ., get_expanded_type, (, ), ., alignof, (, ), ;, }, pub, fn, get_expanded_type, (, self, :, *, L_Value, ), *, Type_AST, {, switch, (, self, .*, ), {, ., symbver, =>, return, self, ., symbver, ., symbol, ., expanded_type, (, ), ,, ., dereference, =>, return, self, ., dereference, ., expanded_type, ,, ., index, =>, return, self, ., index, ., expanded_type, ,, ., select, =>, return, self, ., select, ., expanded_type, ,, ., raw_address, =>, std, ., debug, ., panic, (, "compiler error: raw addresses do not have types", ,, ., {, }, ), ,, }, }, pub, fn, lval_precedence, (, self, :, *, L_Value, ), Instruction, ., Precedence, {, return, switch, (, self, .*, ), {, ., symbver, =>, Instruction, ., Kind, ., precedence, (, Instruction, ., Kind, ., load_symbol, ), ,, ., dereference, =>, Instruction, ., Precedence, ., prefix, ,, ., index, =>, Instruction, ., Precedence, ., prefix, ,, ., select, =>, Instruction, ., Precedence, ., postfix, ,, ., raw_address, =>, std, ., debug, ., panic, (, "compiler error: raw addresses do not have precedence", ,, ., {, }, ), ,, }, ;, }, pub, fn, reset_usage, (, lval, :, *, L_Value, ), void, {, switch, (, lval, .*, ), {, ., symbver, =>, {, lval, ., symbver, ., uses, =, 0, ;, lval, ., symbver, ., symbol, ., uses, =, 0, ;, }, ,, ., dereference, =>, lval, ., dereference, ., expr, ., reset_usage, (, ), ,, ., index, =>, {, lval, ., index, ., lhs, ., reset_usage, (, ), ;, lval, ., index, ., rhs, ., reset_usage, (, ), ;, if, (, lval, ., index, ., length, !=, null, ), {, lval, ., index, ., length, .?, ., reset_usage, (, ), ;, }, }, ,, ., select, =>, {, lval, ., select, ., lhs, ., reset_usage, (, ), ;, if, (, lval, ., select, ., tag, !=, null, ), {, lval, ., select, ., tag, .?, ., reset_usage, (, ), ;, }, }, ,, ., raw_address, =>, std, ., debug, ., panic, (, "compiler error: raw addresses do not have usage", ,, ., {, }, ), ,, }, }, pub, fn, increment_usage, (, lval, :, *, L_Value, ), void, {, switch, (, lval, .*, ), {, ., symbver, =>, {, lval, ., symbver, ., uses, +=, 1, ;, lval, ., symbver, ., symbol, ., uses, +=, 1, ;, }, ,, ., dereference, =>, lval, ., dereference, ., expr, ., increment_usage, (, ), ,, ., index, =>, {, lval, ., index, ., lhs, ., increment_usage, (, ), ;, lval, ., index, ., rhs, ., increment_usage, (, ), ;, if, (, lval, ., index, ., length, !=, null, ), {, lval, ., index, ., length, .?, ., increment_usage, (, ), ;, }, }, ,, ., select, =>, {, lval, ., select, ., lhs, ., increment_usage, (, ), ;, if, (, lval, ., select, ., tag, !=, null, ), {, lval, ., select, ., tag, .?, ., increment_usage, (, ), ;, }, }, ,, ., raw_address, =>, std, ., debug, ., panic, (, "compiler error: raw addresses do not have usage", ,, ., {, }, ), ,, }, }, }, ;, const, std, =, @, import, (, "std", ), ;, const, Basic_Block, =, @, import, (, "basic-block.zig", ), ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Instruction, =, @, import, (, "../ir/instruction.zig", ), ;, const, Symbol_Version, =, @, import, (, "symbol_version.zig", ), ;, var, debug, =, false, ;, pub, fn, optimize, (, cfg, :, *, CFG, ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ), error, {, CompileError, }, !, void, {, if, (, debug, ), {, std, ., debug, ., print, (, "[  CFG  ]: {s}\n", ,, ., {, cfg, ., symbol, ., name, }, ), ;, cfg, ., block_graph_head, .?, ., pprint, (, ), ;, log, (, "\n\n", ), ;, }, while, (, try, propagate, (, cfg, ,, errors, ,, allocator, ), or, remove_unused_defs, (, cfg, ), or, bb_optimizations, (, cfg, ,, allocator, ), or, remove_unused_defs, (, cfg, ), ), {, }, cfg, ., clear_visited_BBs, (, ), ;, log_optimization_pass, (, "final", ,, cfg, ), ;, }, fn, propagate, (, cfg, :, *, CFG, ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ), error, {, CompileError, }, !, bool, {, var, retval, =, false, ;, cfg, ., calculate_definitions, (, ), ;, cfg, ., calculate_usage, (, ), ;, for, (, cfg, ., basic_blocks, ., items, ), |, bb, |, {, var, def_map, =, std, ., AutoArrayHashMap, (, *, Symbol_Version, ,, ?, *, Instruction, ), ., init, (, allocator, ), ;, defer, def_map, ., deinit, (, ), ;, for, (, bb, ., instructions, ., items, ), |, instr, |, {, const, src1_def, :, ?, *, Instruction, =, if, (, instr, ., src1, !=, null, and, instr, ., src1, .?, .*, ==, ., symbver, ), def_map, ., get, (, instr, ., src1, .?, ., symbver, ), orelse, null, else, null, ;, const, src2_def, :, ?, *, Instruction, =, if, (, instr, ., src2, !=, null, and, instr, ., src2, .?, .*, ==, ., symbver, ), def_map, ., get, (, instr, ., src2, .?, ., symbver, ), orelse, null, else, null, ;, retval, =, try, propagate_instruction, (, instr, ,, src1_def, ,, src2_def, ,, errors, ), or, retval, ;, log_optimization_pass, (, "^", ,, cfg, ), ;, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, .*, !=, ., symbver, ), {, def_map, ., put, (, instr, ., dest, .?, ., extract_symbver, (, ), ,, null, ), catch, unreachable, ;, }, else, if, (, instr, ., kind, ==, ., mut_addr_of, ), {, def_map, ., put, (, instr, ., src1, .?, ., extract_symbver, (, ), ,, null, ), catch, unreachable, ;, }, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, .*, ==, ., symbver, ), {, def_map, ., put, (, instr, ., dest, .?, ., symbver, ,, instr, ), catch, unreachable, ;, }, }, bb, ., remove_marked_instrs, (, ), ;, if, (, bb, ., terminator, ==, ., conditional, and, bb, ., terminator, ., conditional, ., condition, .*, ==, ., symbver, ), {, const, cond_def, :, ?, *, Instruction, =, def_map, ., get, (, bb, ., terminator, ., conditional, ., condition, ., symbver, ), orelse, null, ;, bb, ., terminator, ., conditional, ., condition, ., symbver, ., set_def, (, cond_def, ), ;, if, (, cond_def, !=, null, and, cond_def, .?, ., kind, ==, ., copy, and, cond_def, .?, ., src1, !=, null, ), {, bb, ., terminator, ., conditional, ., condition, =, cond_def, .?, ., src1, .?, ;, retval, =, true, ;, }, }, }, return, retval, ;, }, fn, propagate_instruction, (, instr, :, *, Instruction, ,, src1_def, :, ?, *, Instruction, ,, src2_def, :, ?, *, Instruction, ,, errors, :, *, errs_, ., Errors, ), error, {, CompileError, }, !, bool, {, var, retval, =, false, ;, switch, (, instr, ., kind, ), {, ., copy, =>, {, if, (, instr, ., src1, ==, null, or, (, instr, ., src1, .?, ., expanded_type_sizeof, (, ), ==, 0, ), ), {, logfln, (, "unit-copy elimination {?f} {f}", ,, ., {, instr, ., src1, ,, instr, ., src1, .?, ., get_expanded_type, (, ), }, ), ;, instr, ., in_block, .?, ., mark_for_removal, (, instr, ), ;, }, else, if, (, instr, ., dest, .?, .*, ==, ., symbver, and, instr, ., src1, .?, .*, ==, ., symbver, and, instr, ., dest, .?, ., symbver, ., symbol, ==, instr, ., src1, .?, ., symbver, ., symbol, and, src1_def, !=, null, ), {, log, (, "self-copy elimination", ), ;, instr, ., in_block, .?, ., mark_for_removal, (, instr, ), ;, retval, =, true, ;, }, else, {, logfln, (, "copy-propagation {f}", ,, ., {, instr, }, ), ;, retval, =, try, instr, ., copy_prop, (, src1_def, ,, ., load_int, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., load_float, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., load_string, ,, errors, ), or, (, instr, ., src1, .?, .*, ==, ., symbver, and, instr, ., src1, .?, ., symbver, ., uses, ==, 1, and, try, instr, ., copy_prop, (, src1_def, ,, ., load_struct, ,, errors, ), ), or, try, instr, ., copy_prop, (, src1_def, ,, ., load_union, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., load_symbol, ,, errors, ), or, (, try, instr, ., copy_prop, (, src1_def, ,, ., copy, ,, errors, ), and, instr, ., src1, !=, src1_def, .?, ., src1, .?, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., addr_of, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., mut_addr_of, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., add_int, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., add_float, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., sub_int, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., sub_float, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., mult_int, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., mult_float, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., div_int, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., div_float, ,, errors, ), or, try, instr, ., copy_prop, (, src1_def, ,, ., mod, ,, errors, ), ;, }, }, ,, ., not, =>, {, if, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, ), {, log, (, "not; known int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., int, ==, 0, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., negate_int, =>, {, if, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, ), {, log, (, "negate_int; known value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, -, src1_def, .?, ., data, ., int, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., negate_float, =>, {, if, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, ), {, log, (, "negate_float; known value", ), ;, try, instr, ., convert_to_load, (, ., load_float, ,, ., {, ., float, =, -, src1_def, .?, ., data, ., float, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., equal, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., kind, ==, ., load_int, ), {, log, (, "equal; known int,int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., int, ==, src2_def, .?, ., data, ., int, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., kind, ==, ., load_float, ), {, log, (, "equal; known float,float value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., float, ==, src2_def, .?, ., data, ., float, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, instr, ., self_eq, (, ), and, !, instr, ., src1, .?, ., symbver, ., symbol, ., expanded_type, (, ), ., can_expanded_represent_float, (, ), ), {, log, (, "equal; self inequality", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 1, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, instr, ., src1, .?, ., get_expanded_type, (, ), ., is_c_void_type, (, ), and, instr, ., src2, .?, ., get_expanded_type, (, ), ., is_c_void_type, (, ), ), {, log, (, "equal; known unit,unit value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 1, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., not_equal, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., kind, ==, ., load_int, ), {, log, (, "not_equal; known int,int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., int, !=, src2_def, .?, ., data, ., int, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., kind, ==, ., load_float, ), {, log, (, "not_equal; known float,float value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., float, !=, src2_def, .?, ., data, ., float, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, instr, ., self_eq, (, ), and, !, instr, ., src1, .?, ., symbver, ., symbol, ., expanded_type, (, ), ., can_expanded_represent_float, (, ), ), {, log, (, "not_equal; self inequality", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 0, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, instr, ., src1, .?, ., get_expanded_type, (, ), ., is_c_void_type, (, ), and, instr, ., src2, .?, ., get_expanded_type, (, ), ., is_c_void_type, (, ), ), {, log, (, "equal; known unit,unit value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 0, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., greater_int, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., kind, ==, ., load_int, ), {, log, (, "greater_int; known int,int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., int, >, src2_def, .?, ., data, ., int, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, instr, ., self_eq, (, ), ), {, log, (, "greater_int; self compare", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 0, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., greater_float, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., kind, ==, ., load_float, ), {, log, (, "greater_float; known float,float value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., float, >, src2_def, .?, ., data, ., float, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, instr, ., self_eq, (, ), ), {, log, (, "greater_float; self compare", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 0, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., lesser_int, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., kind, ==, ., load_int, ), {, log, (, "lesser_int; known int,int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., int, <, src2_def, .?, ., data, ., int, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, instr, ., self_eq, (, ), ), {, log, (, "lesser_int; self compare", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 0, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., lesser_float, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., kind, ==, ., load_float, ), {, log, (, "lesser_float; known int,int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., float, <, src2_def, .?, ., data, ., float, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, instr, ., self_eq, (, ), ), {, log, (, "lesser_float; self compare", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 0, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., greater_equal_int, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., kind, ==, ., load_int, ), {, log, (, "greater_equal_int; known int,int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., int, >=, src2_def, .?, ., data, ., int, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, instr, ., self_eq, (, ), ), {, log, (, "greater_equal_int; self compare", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 1, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., greater_equal_float, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., kind, ==, ., load_float, ), {, log, (, "greater_equal_float; known float,float value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., float, >=, src2_def, .?, ., data, ., float, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., lesser_equal_int, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., kind, ==, ., load_int, ), {, log, (, "lesser_equal_int; known int,int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., int, <=, src2_def, .?, ., data, ., int, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, instr, ., self_eq, (, ), ), {, log, (, "lesser_equal_int; self compare", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 1, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., lesser_equal_float, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., kind, ==, ., load_float, ), {, log, (, "lesser_equal_float; known float,float value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, if, (, src1_def, .?, ., data, ., float, <=, src2_def, .?, ., data, ., float, ), 1, else, 0, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., add_int, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., kind, ==, ., load_int, ), {, log, (, "add_int; known int,int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, try, src1_def, .?, ., data, ., add_int_overflow, (, src2_def, .?, ., data, ), ,, errors, ), ;, retval, =, true, ;, }, else, if, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src1_def, .?, ., data, ., int, ==, 0, ), {, log, (, "add_int; add 0 lhs", ), ;, instr, ., convert_to_unop, (, instr, ., src2, .?, ,, ., copy, ), ;, retval, =, true, ;, }, else, if, (, src2_def, !=, null, and, src2_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., data, ., int, ==, 0, ), {, log, (, "add_int; add 0 rhs", ), ;, instr, ., convert_to_unop, (, instr, ., src1, .?, ,, ., copy, ), ;, retval, =, true, ;, }, }, ,, ., add_float, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., kind, ==, ., load_float, ), {, log, (, "add_float; known float,float value", ), ;, try, instr, ., convert_to_load, (, ., load_float, ,, ., {, ., float, =, src1_def, .?, ., data, ., float, +, src2_def, .?, ., data, ., float, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src1_def, .?, ., data, ., float, ==, 0.0, ), {, log, (, "add_float; add 0.0 lhs", ), ;, instr, ., convert_to_unop, (, instr, ., src2, .?, ,, ., copy, ), ;, retval, =, true, ;, }, else, if, (, src2_def, !=, null, and, src2_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., data, ., float, ==, 0.0, ), {, log, (, "add_float; add 0.0 rhs", ), ;, instr, ., convert_to_unop, (, instr, ., src1, .?, ,, ., copy, ), ;, retval, =, true, ;, }, }, ,, ., sub_int, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., kind, ==, ., load_int, ), {, log, (, "sub; known int,int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, try, src1_def, .?, ., data, ., sub_int_overflow, (, src2_def, .?, ., data, ), ,, errors, ), ;, retval, =, true, ;, }, else, if, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src1_def, .?, ., data, ., int, ==, 0, ), {, log, (, "sub; sub 0 lhs", ), ;, instr, ., convert_to_unop, (, instr, ., src2, .?, ,, ., negate_int, ), ;, retval, =, true, ;, }, else, if, (, src2_def, !=, null, and, src2_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., data, ., int, ==, 0, ), {, log, (, "sub; sub 0 rhs", ), ;, instr, ., convert_to_unop, (, instr, ., src1, .?, ,, ., copy, ), ;, retval, =, true, ;, }, }, ,, ., sub_float, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., kind, ==, ., load_float, ), {, log, (, "sub; known float,float value", ), ;, try, instr, ., convert_to_load, (, ., load_float, ,, ., {, ., float, =, src1_def, .?, ., data, ., float, -, src2_def, .?, ., data, ., float, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src1_def, .?, ., data, ., float, ==, 0.0, ), {, log, (, "sub; sub 0.0 lhs", ), ;, instr, ., convert_to_unop, (, instr, ., src2, .?, ,, ., negate_float, ), ;, retval, =, true, ;, }, else, if, (, src2_def, !=, null, and, src2_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., data, ., float, ==, 0.0, ), {, log, (, "sub; sub 0.0 rhs", ), ;, instr, ., convert_to_unop, (, instr, ., src1, .?, ,, ., copy, ), ;, retval, =, true, ;, }, }, ,, ., mult_int, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., kind, ==, ., load_int, ), {, log, (, "mult_int; known int,int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, try, src1_def, .?, ., data, ., mult_int_overflow, (, src2_def, .?, ., data, ), ,, errors, ), ;, retval, =, true, ;, }, else, if, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src1_def, .?, ., data, ., int, ==, 1, ), {, log, (, "mult; mult 1 lhs", ), ;, instr, ., convert_to_unop, (, instr, ., src2, .?, ,, ., copy, ), ;, retval, =, true, ;, }, else, if, (, src2_def, !=, null, and, src2_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., data, ., int, ==, 1, ), {, log, (, "mult; mult 1 rhs", ), ;, instr, ., convert_to_unop, (, instr, ., src1, .?, ,, ., copy, ), ;, retval, =, true, ;, }, else, if, (, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src1_def, .?, ., data, ., int, ==, 0, ), or, (, src2_def, !=, null, and, src2_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., data, ., int, ==, 0, ), ), {, log, (, "mult; mult 0 lhs int", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 0, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., mult_float, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., kind, ==, ., load_float, ), {, log, (, "mult_float; known float,float value", ), ;, try, instr, ., convert_to_load, (, ., load_float, ,, ., {, ., float, =, src1_def, .?, ., data, ., float, *, src2_def, .?, ., data, ., float, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src1_def, .?, ., data, ., float, ==, 1.0, ), {, log, (, "mult; mult 1.0 lhs", ), ;, instr, ., convert_to_unop, (, instr, ., src2, .?, ,, ., copy, ), ;, retval, =, true, ;, }, else, if, (, src2_def, !=, null, and, src2_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., data, ., float, ==, 1.0, ), {, log, (, "mult; mult 1.0 rhs", ), ;, instr, ., convert_to_unop, (, instr, ., src1, .?, ,, ., copy, ), ;, retval, =, true, ;, }, else, if, (, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src1_def, .?, ., data, ., float, ==, 0.0, ), or, (, src2_def, !=, null, and, src2_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., data, ., float, ==, 0.0, ), ), {, log, (, "mult; mult 0.0 lhs float", ), ;, try, instr, ., convert_to_load, (, ., load_float, ,, ., {, ., float, =, 0.0, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., div_int, =>, {, try, divide_by_zero_check, (, src2_def, ,, errors, ), ;, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., kind, ==, ., load_int, ), {, log, (, "div_int; known int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, @, divTrunc, (, src1_def, .?, ., data, ., int, ,, src2_def, .?, ., data, ., int, ), }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, src2_def, !=, null, and, src2_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., data, ., int, ==, 1, ), {, log, (, "div; div 1 rhs", ), ;, instr, ., convert_to_unop, (, instr, ., src1, .?, ,, ., copy, ), ;, retval, =, true, ;, }, }, ,, ., div_float, =>, {, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., data, ., float, !=, 0.0, ), {, log, (, "div_float; known float value", ), ;, try, instr, ., convert_to_load, (, ., load_float, ,, ., {, ., float, =, src1_def, .?, ., data, ., float, /, src2_def, .?, ., data, ., float, }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, src2_def, !=, null, and, src2_def, .?, ., kind, ==, ., load_float, and, src2_def, .?, ., data, ., float, ==, 1.0, ), {, log, (, "div; div 1.0 rhs", ), ;, instr, ., convert_to_unop, (, instr, ., src1, .?, ,, ., copy, ), ;, retval, =, true, ;, }, }, ,, ., mod, =>, {, try, divide_by_zero_check, (, src2_def, ,, errors, ), ;, if, (, src1_def, !=, null, and, src2_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., kind, ==, ., load_int, ), {, log, (, "mod; known int value", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, @, rem, (, src1_def, .?, ., data, ., int, ,, src2_def, .?, ., data, ., int, ), }, ,, errors, ), ;, retval, =, true, ;, }, else, if, (, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_int, and, src1_def, .?, ., data, ., int, ==, 0, ), or, (, src2_def, !=, null, and, src2_def, .?, ., kind, ==, ., load_int, and, src2_def, .?, ., data, ., int, ==, 1, ), ), {, log, (, "mod; mod 0 lhs", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, 0, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, ., get_tag, =>, {, if, (, src1_def, !=, null, and, src1_def, .?, ., kind, ==, ., load_union, ), {, log, (, "get_tag; known tag", ), ;, try, instr, ., convert_to_load, (, ., load_int, ,, ., {, ., int, =, src1_def, .?, ., data, ., int, }, ,, errors, ), ;, retval, =, true, ;, }, }, ,, else, =>, {, }, ,, }, retval, =, instr, ., copy_of_prop, (, &, instr, ., src1, ,, src1_def, ), or, retval, ;, retval, =, instr, ., copy_of_prop, (, &, instr, ., src2, ,, src2_def, ), or, retval, ;, return, retval, ;, }, fn, divide_by_zero_check, (, instr, :, ?, *, Instruction, ,, errors, :, *, errs_, ., Errors, ), error, {, CompileError, }, !, void, {, if, (, instr, !=, null, ), {, if, (, instr, .?, ., kind, ==, ., load_int, and, instr, .?, ., data, ., int, ==, 0, ), {, errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, instr, .?, ., span, ,, ., msg, =, "divide by 0", ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, }, fn, remove_unused_defs, (, cfg, :, *, CFG, ), bool, {, var, retval, =, false, ;, cfg, ., calculate_usage, (, ), ;, cfg, ., calculate_definitions, (, ), ;, for, (, cfg, ., basic_blocks, ., items, ), |, bb, |, {, for, (, bb, ., instructions, ., items, ), |, instr, |, {, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, .*, ==, ., symbver, and, instr, ., dest, .?, ., symbver, ., uses, ==, 0, and, instr, ., dest, .?, ., symbver, ., symbol, ., uses, ==, 0, and, instr, ., dest, .?, ., symbver, ., symbol, !=, cfg, ., return_symbol, ), {, logfln, (, "removing: {f}", ,, ., {, instr, }, ), ;, if, (, instr, ., kind, !=, ., call, and, instr, ., kind, !=, ., invoke, ), {, instr, ., in_block, .?, ., mark_for_removal, (, instr, ), ;, retval, =, true, ;, }, }, }, bb, ., remove_marked_instrs, (, ), ;, }, return, retval, ;, }, fn, bb_optimizations, (, cfg, :, *, CFG, ,, allocator, :, std, ., mem, ., Allocator, ), bool, {, var, retval, :, bool, =, false, ;, cfg, ., count_bb_predecessors, (, ), ;, cfg, ., calculate_definitions, (, ), ;, for, (, cfg, ., basic_blocks, ., items, ), |, bb, |, {, if, (, bb, ., number_predecessors, ==, 0, ), {, defer, log_optimization_pass, (, "remove unused block", ,, cfg, ), ;, cfg, ., remove_basic_block, (, bb, ), ;, bb, ., mark_all_instructions_as_removed, (, ), ;, return, true, ;, }, }, for, (, cfg, ., basic_blocks, ., items, ), |, bb, |, {, if, (, bb, ., terminator, ==, ., unconditional, and, !, bb, ., empty, (, ), and, bb, ., terminator, ., unconditional, !=, null, and, bb, ., terminator, ., unconditional, .?, ., number_predecessors, ==, 1, ), {, var, log_msg, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, log_msg, ., deinit, (, ), ;, log_msg, ., print, (, "adopt BB{} into BB{}", ,, ., {, bb, ., terminator, ., unconditional, .?, ., uid, ,, bb, ., uid, }, ), catch, unreachable, ;, defer, log_optimization_pass, (, log_msg, ., items, ,, cfg, ), ;, cfg, ., remove_basic_block, (, bb, ., terminator, ., unconditional, .?, ), ;, bb, ., merge_with, (, bb, ., terminator, ., unconditional, .?, ), ;, retval, =, true, ;, break, ;, }, if, (, bb, ., terminator, ==, ., conditional, and, bb, ., terminator, ., conditional, ., condition, .*, ==, ., symbver, ), {, const, latest_condition, =, bb, ., terminator, ., conditional, ., condition, ., symbver, ., def, ;, if, (, latest_condition, !=, null, and, latest_condition, .?, ., kind, ==, ., load_int, ), {, defer, log_optimization_pass, (, "convert constant true/false to jumps", ,, cfg, ), ;, if, (, bb, ., terminator, ., conditional, ., condition, ., symbver, ., def, .?, ., data, ., int, ==, 0, ), {, const, new_terminator, :, Basic_Block, ., Terminator, =, ., {, ., unconditional, =, bb, ., terminator, ., conditional, ., false_target, }, ;, bb, ., terminator, =, new_terminator, ;, }, else, {, const, new_terminator, :, Basic_Block, ., Terminator, =, ., {, ., unconditional, =, bb, ., terminator, ., conditional, ., true_target, }, ;, bb, ., terminator, =, new_terminator, ;, }, retval, =, true, ;, }, else, if, (, latest_condition, !=, null, and, latest_condition, .?, ., kind, ==, ., not, and, latest_condition, .?, ., src1, .?, .*, ==, ., symbver, and, latest_condition, .?, ., src1, .?, ., symbver, ., def, !=, null, ), {, defer, log_optimization_pass, (, "flip not condition", ,, cfg, ), ;, const, old_branch, =, bb, ., terminator, ., conditional, ., false_target, ;, bb, ., terminator, ., conditional, ., false_target, =, bb, ., terminator, ., conditional, ., true_target, ;, bb, ., terminator, ., conditional, ., true_target, =, old_branch, ;, bb, ., terminator, ., conditional, ., condition, =, latest_condition, .?, ., src1, .?, ;, retval, =, true, ;, }, }, if, (, bb, ., terminator, ==, ., unconditional, and, bb, ., terminator, ., unconditional, !=, null, ), {, const, next_bb, =, bb, ., terminator, ., unconditional, .?, ;, if, (, next_bb, ., empty, (, ), and, next_bb, ., terminator, ==, ., unconditional, and, next_bb, !=, bb, and, next_bb, ., terminator, ., unconditional, !=, bb, and, (, next_bb, ., terminator, ., unconditional, ==, null, or, (, next_bb, ., terminator, ., unconditional, .?, ., terminator, ==, ., unconditional, and, next_bb, ., terminator, ., unconditional, .?, ., terminator, ., unconditional, !=, next_bb, ), ), ), {, var, s, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, s, ., print, (, "remove jump chain BB{}", ,, ., {, next_bb, ., uid, }, ), catch, unreachable, ;, defer, s, ., deinit, (, ), ;, defer, log_optimization_pass, (, s, ., items, ,, cfg, ), ;, bb, ., terminator, ., unconditional, =, next_bb, ., terminator, ., unconditional, ;, retval, =, true, ;, }, }, if, (, bb, ., terminator, ==, ., conditional, and, bb, ., terminator, ., conditional, ., false_target, !=, null, ), {, const, branch, =, bb, ., terminator, ., conditional, ., false_target, .?, ;, if, (, branch, ., empty, (, ), and, branch, ., terminator, ==, ., unconditional, ), {, bb, ., terminator, ., conditional, ., false_target, =, branch, ., terminator, ., unconditional, ;, retval, =, true, ;, }, }, if, (, bb, ., terminator, ==, ., conditional, and, bb, ., terminator, ., conditional, ., true_target, ==, bb, ., terminator, ., conditional, ., false_target, ), {, bb, ., terminator, =, ., {, ., unconditional, =, bb, ., terminator, ., conditional, ., true_target, }, ;, retval, =, true, ;, }, if, (, bb, ., terminator, ==, ., unconditional, and, bb, ., terminator, ., unconditional, !=, null, ), {, const, next, =, bb, ., terminator, ., unconditional, .?, ;, if, (, next, ., terminator, ==, ., conditional, and, next, ., empty, (, ), and, next, ., terminator, ., conditional, ., condition, .*, ==, ., symbver, ), {, defer, log_optimization_pass, (, "next depends on known argument", ,, cfg, ), ;, const, def, =, bb, ., get_latest_def, (, next, ., terminator, ., conditional, ., condition, ,, null, ), ;, if, (, def, !=, null, and, def, .?, ., kind, ==, ., load_int, ), {, if, (, def, .?, ., data, ., int, ==, 0, ), {, bb, ., terminator, ., unconditional, =, next, ., terminator, ., conditional, ., false_target, ;, }, else, {, bb, ., terminator, ., unconditional, =, next, ., terminator, ., conditional, ., true_target, ;, }, }, }, }, if, (, bb, ., terminator, ==, ., conditional, and, bb, ., terminator, ., conditional, ., false_target, !=, null, and, bb, ., terminator, ., conditional, ., false_target, .?, ., terminator, ==, ., conditional, and, bb, ., terminator, ., conditional, ., false_target, .?, ., empty, (, ), and, bb, ., terminator, ., conditional, ., false_target, .?, ., terminator, ., conditional, ., condition, .*, ==, ., symbver, ), {, defer, log_optimization_pass, (, "branch depends on known argument", ,, cfg, ), ;, const, def, =, bb, ., get_latest_def, (, bb, ., terminator, ., conditional, ., false_target, .?, ., terminator, ., conditional, ., condition, ,, null, ), ;, if, (, def, !=, null, and, def, .?, ., kind, ==, ., load_int, ), {, if, (, def, .?, ., data, ., int, ==, 0, ), {, bb, ., terminator, ., conditional, ., false_target, =, bb, ., terminator, ., conditional, ., false_target, .?, ., terminator, ., conditional, ., false_target, ;, }, else, {, bb, ., terminator, ., conditional, ., false_target, =, bb, ., terminator, ., conditional, ., false_target, .?, ., terminator, ., conditional, ., true_target, ;, }, }, }, }, if, (, cfg, ., block_graph_head, ), |, head, |, {, if, (, head, ., empty, (, ), and, head, ., terminator, ==, ., unconditional, and, head, ., terminator, ., unconditional, !=, head, and, head, ., number_predecessors, ==, 0, ), {, defer, log_optimization_pass, (, "rebase block", ,, cfg, ), ;, cfg, ., block_graph_head, =, head, ., terminator, ., unconditional, ;, retval, =, true, ;, }, }, return, retval, ;, }, fn, log_optimization_pass, (, msg, :, [, ], const, u8, ,, cfg, :, *, CFG, ), void, {, if, (, debug, ), {, std, ., debug, ., print, (, "[OPTIMIZATION] {s}\n", ,, ., {, msg, }, ), ;, if, (, cfg, ., block_graph_head, ), |, block_head, |, {, cfg, ., clear_visited_BBs, (, ), ;, block_head, ., pprint, (, ), ;, cfg, ., clear_visited_BBs, (, ), ;, log, (, "\n\n", ), ;, }, else, {, std, ., debug, ., print, (, "[WARNING] block head for CFG: {s} is null\n", ,, ., {, cfg, ., symbol, ., name, }, ), ;, }, var, in_buffer, :, [, 256, ], u8, =, undefined, ;, _, =, std, ., fs, ., File, ., stdin, (, ), ., read, (, &, in_buffer, ), catch, unreachable, ;, }, }, fn, log, (, msg, :, [, ], const, u8, ), void, {, if, (, debug, ), {, std, ., debug, ., print, (, "{s}\n", ,, ., {, msg, }, ), ;, }, }, fn, logfln, (, comptime, fmt, :, [, ], const, u8, ,, args, :, anytype, ), void, {, if, (, debug, ), {, std, ., debug, ., print, (, fmt, ,, args, ), ;, std, ., debug, ., print, (, "\n", ,, ., {, }, ), ;, }, }, const, std, =, @, import, (, "std", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Instruction, =, @, import, (, "../ir/instruction.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, fmt_, =, @, import, (, "../util/fmt.zig", ), ;, const, Self, =, @, This, (, ), ;, symbol, :, *, Symbol, ,, def, :, ?, *, Instruction, ,, uses, :, usize, =, 0, ,, allocator, :, std, ., mem, ., Allocator, ,, pub, fn, create_unversioned, (, symbol, :, *, Symbol, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, allocator, ., create, (, Self, ), catch, unreachable, ;, retval, ., symbol, =, symbol, ;, retval, ., uses, =, 0, ;, retval, ., def, =, null, ;, retval, ., allocator, =, allocator, ;, return, retval, ;, }, pub, fn, deinit, (, self, :, *, Self, ), void, {, _, =, self, ;, }, pub, fn, format, (, self, :, ?, *, Self, ,, out, :, *, std, ., io, ., Writer, ), !, void, {, if, (, self, ), |, symbver, |, {, try, out, ., print, (, "{s:<10}", ,, ., {, symbver, ., symbol, ., name, }, ), ;, }, else, {, try, out, ., print, (, "<null>    ", ,, ., {, }, ), ;, }, }, pub, fn, set_def, (, self, :, *, Self, ,, def, :, ?, *, Instruction, ), void, {, self, ., def, =, def, ;, if, (, def, ), |, _, |, {, self, ., symbol, ., defs, +=, 1, ;, }, }, pub, fn, find_symbol_version_set, (, self, :, *, Self, ,, set, :, *, std, ., array_list, ., Managed, (, *, Self, ), ,, ), ?, *, Self, {, for, (, set, ., items, ), |, symbver, |, {, if, (, symbver, ., symbol, ==, self, ., symbol, ), {, return, symbver, ;, }, }, return, null, ;, }, pub, fn, put_symbol_version_set, (, self, :, *, Self, ,, set, :, *, std, ., array_list, ., Managed, (, *, Self, ), ), bool, {, for, (, set, ., items, ), |, v, |, {, if, (, v, ., symbol, ==, self, ., symbol, ), {, return, false, ;, }, }, set, ., append, (, self, ), catch, unreachable, ;, return, true, ;, }, const, std, =, @, import, (, "std", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Self, :, type, =, @, This, (, ), ;, pub, fn, init, (, ), Self, {, return, Self, {, }, ;, }, pub, fn, run, (, self, :, Self, ,, tokens, :, *, std, ., array_list, ., Managed, (, Token, ), ), error, {, }, !, *, std, ., array_list, ., Managed, (, Token, ), {, _, =, self, ;, strip_comments, (, tokens, ), ;, combine_multilines, (, tokens, ), ;, trailing_comma_rules, (, tokens, ), ;, newline_rules, (, tokens, ), ;, return, tokens, ;, }, fn, strip_comments, (, tokens, :, *, std, ., array_list, ., Managed, (, Token, ), ), void, {, var, i, :, usize, =, 0, ;, while, (, i, <, tokens, ., items, ., len, -, 1, ), :, (, i, +=, 1, ), {, const, token, =, tokens, ., items, [, i, ], ;, if, (, token, ., kind, !=, ., comment, ), {, continue, ;, }, var, j, :, usize, =, i, ;, while, (, j, >=, 0, and, (, tokens, ., items, [, j, ], ., kind, ==, ., newline, or, tokens, ., items, [, j, ], ., kind, ==, ., comment, ), ), {, _, =, tokens, ., orderedRemove, (, j, ), ;, if, (, j, !=, 0, ), {, j, -=, 1, ;, }, else, {, break, ;, }, }, i, =, j, ;, }, }, fn, combine_multilines, (, tokens, :, *, std, ., array_list, ., Managed, (, Token, ), ), void, {, var, i, :, usize, =, 0, ;, while, (, i, <, tokens, ., items, ., len, ), :, (, i, +=, 1, ), {, var, out, :, ?, String, =, null, ;, var, span, :, ?, Span, =, null, ;, while, (, i, <, tokens, ., items, ., len, and, tokens, ., items, [, i, ], ., kind, ==, ., multi_line_string, ), :, (, i, +=, 1, ), {, if, (, out, ==, null, ), {, out, =, String, ., init_with_contents, (, std, ., heap, ., page_allocator, ,, "", ), catch, unreachable, ;, span, =, tokens, ., items, [, i, ], ., span, ;, }, else, {, out, .?, ., insert, (, "\n", ,, out, .?, ., len, (, ), ), catch, unreachable, ;, }, const, multiline, :, Token, =, tokens, ., orderedRemove, (, i, ), ;, _, =, tokens, ., orderedRemove, (, i, ), ;, i, -|=, 1, ;, out, .?, ., insert, (, multiline, ., data, ,, out, .?, ., len, (, ), ), catch, unreachable, ;, }, if, (, out, !=, null, ), {, const, token, =, Token, ., init, (, (, out, .?, ., toOwned, (, ), catch, unreachable, ), .?, ,, ., multi_line_string, ,, span, .?, ., filename, ,, span, .?, ., line_text, ,, span, .?, ., line_number, ,, span, .?, ., col, ,, ), ;, tokens, ., insert, (, i, ,, token, ), catch, unreachable, ;, }, }, }, fn, trailing_comma_rules, (, tokens, :, *, std, ., array_list, ., Managed, (, Token, ), ), void, {, if, (, tokens, ., items, ., len, <, 4, ), {, return, ;, }, var, i, :, usize, =, 0, ;, while, (, i, <, tokens, ., items, ., len, -, 4, ), :, (, i, +=, 1, ), {, if, (, tokens, ., items, [, i, +, 0, ], ., kind, ., is_end_token, (, ), and, (, tokens, ., items, [, i, +, 1, ], ., kind, ==, ., comma, ), and, tokens, ., items, [, i, +, 2, ], ., kind, ==, ., newline, and, tokens, ., items, [, i, +, 3, ], ., kind, ==, ., right_parenthesis, ), {, _, =, tokens, ., orderedRemove, (, i, +, 2, ), ;, i, +=, 2, ;, std, ., debug, ., assert, (, tokens, ., items, [, i, ], ., kind, ==, ., right_parenthesis, ), ;, }, }, }, fn, newline_rules, (, tokens, :, *, std, ., array_list, ., Managed, (, Token, ), ), void, {, var, stack, =, std, ., array_list, ., Managed, (, Token, ., Kind, ), ., init, (, tokens, ., allocator, ), ;, defer, stack, ., deinit, (, ), ;, var, i, :, usize, =, 0, ;, while, (, i, <, tokens, ., items, ., len, -, 1, ), :, (, i, +=, 1, ), {, const, token, =, tokens, ., items, [, i, ], ;, if, (, token, ., kind, ==, ., left_parenthesis, or, token, ., kind, ==, ., left_brace, ), {, stack, ., append, (, token, ., kind, ), catch, unreachable, ;, }, else, if, (, token, ., kind, ==, ., right_parenthesis, or, token, ., kind, ==, ., right_brace, and, stack, ., items, ., len, >, 0, ), {, _, =, stack, ., pop, (, ), ;, }, else, if, (, token, ., kind, ==, ., newline, ), {, if, (, stack, ., items, ., len, >, 0, and, stack, ., getLast, (, ), ==, ., left_parenthesis, ), {, _, =, tokens, ., orderedRemove, (, i, ), ;, i, -|=, 1, ;, }, else, if, (, i, ==, 0, or, !, tokens, ., items, [, i, -, 1, ], ., kind, ., is_end_token, (, ), or, tokens, ., items, [, i, +, 1, ], ., kind, ==, ., @, "else", ), {, _, =, tokens, ., orderedRemove, (, i, ), ;, i, -|=, 1, ;, }, }, }, }, const, std, =, @, import, (, "std", ), ;, const, Self, =, @, This, (, ), ;, module_contents_hash, :, *, u64, ,, pub, fn, init, (, module_contents_hash, :, *, u64, ), Self, {, return, Self, {, ., module_contents_hash, =, module_contents_hash, ,, }, ;, }, pub, fn, run, (, self, :, *, Self, ,, contents, :, [, ], const, u8, ), error, {, }, !, [, ], const, u8, {, self, ., module_contents_hash, .*, =, std, ., hash, ., XxHash3, ., hash, (, 0, ,, contents, ), ;, return, contents, ;, }, const, std, =, @, import, (, "std", ), ;, const, Self, =, @, This, (, ), ;, allocator, :, std, ., mem, ., Allocator, ,, pub, fn, init, (, allocator, :, std, ., mem, ., Allocator, ), Self, {, return, ., {, ., allocator, =, allocator, }, ;, }, pub, fn, run, (, self, :, Self, ,, absolute_path, :, [, ], const, u8, ), error, {, FileNotFound, }, !, [, ], const, u8, {, var, file, =, std, ., fs, ., openFileAbsolute, (, absolute_path, ,, ., {, }, ), catch, return, error, ., FileNotFound, ;, defer, file, ., close, (, ), ;, const, stat, =, file, ., stat, (, ), catch, unreachable, ;, const, contents, =, file, ., readToEndAlloc, (, self, ., allocator, ,, stat, ., size, ), catch, unreachable, ;, return, contents, ;, }, const, std, =, @, import, (, "std", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Self, :, type, =, @, This, (, ), ;, lines, :, std, ., array_list, ., Managed, (, [, ], const, u8, ), ,, errors, :, *, errs_, ., Errors, ,, pub, fn, init, (, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ), Self, {, return, Self, {, ., lines, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, allocator, ), ,, ., errors, =, errors, ,, }, ;, }, pub, fn, run, (, self, :, *, Self, ,, contents, :, [, ], const, u8, ), error, {, LexerError, }, !, std, ., array_list, ., Managed, (, [, ], const, u8, ), {, var, start, :, usize, =, 0, ;, if, (, contents, ., len, ==, 0, ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, Span, ., phony, ,, ., msg, =, "file is empty", ,, }, }, ), ;, return, error, ., LexerError, ;, }, for, (, 1..contents.len, ), |, end, |, {, if, (, contents, [, end, ], ==, '\n', ), {, self, ., lines, ., append, (, contents, [, start, .., end, ], ), catch, unreachable, ;, start, =, end, +, 1, ;, }, }, self, ., lines, ., append, (, contents, [, start, .., contents, ., len, ], ), catch, unreachable, ;, return, self, ., lines, ;, }, const, std, =, @, import, (, "std", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Self, =, @, This, (, ), ;, pub, const, Kind, =, enum, (, u32, ), {, identifier, ,, dec_int, ,, hex_int, ,, oct_int, ,, bin_int, ,, float, ,, char, ,, string, ,, true, ,, false, ,, multi_line_string, ,, as, ,, @, "and", ,, @, "break", ,, @, "catch", ,, cinclude, ,, @, "comptime", ,, @, "const", ,, context, ,, @, "continue", ,, @, "defer", ,, dyn, ,, @, "else", ,, @, "enum", ,, @, "errdefer", ,, @, "extern", ,, @, "fn", ,, @, "for", ,, @, "if", ,, impl, ,, import, ,, in, ,, let, ,, match, ,, mut, ,, not, ,, @, "or", ,, @, "orelse", ,, @, "return", ,, @, "test", ,, trait, ,, @, "try", ,, type, ,, @, "unreachable", ,, where, ,, with, ,, @, "while", ,, self, ,, @, "struct", ,, undefined, ,, variadic, ,, virtual, ,, double_equals, ,, single_equals, ,, minus_equals, ,, e_mark_equals, ,, percent_equals, ,, plus_equals, ,, slash_equals, ,, star_equals, ,, bar, ,, caret, ,, double_bar, ,, fat_arrow, ,, greater, ,, greater_equal, ,, lesser, ,, lesser_equal, ,, minus, ,, percent, ,, plus, ,, skinny_arrow, ,, slash, ,, star, ,, ampersand, ,, single_colon, ,, double_colon, ,, comma, ,, double_period, ,, exclamation_mark, ,, period, ,, question_mark, ,, semicolon, ,, at_symbol, ,, left_brace, ,, left_parenthesis, ,, left_square, ,, right_brace, ,, right_parenthesis, ,, right_square, ,, invoke, ,, comment, ,, newline, ,, EOF, ,, len, ,, pub, fn, is_end_token, (, self, :, Kind, ), bool, {, for, (, end_tokens, ), |, kind, |, {, if, (, self, ==, kind, ), {, return, true, ;, }, }, return, false, ;, }, pub, fn, repr, (, kind, :, Kind, ), ?, [, ], const, u8, {, return, switch, (, kind, ), {, ., bin_int, ,, ., char, ,, ., dec_int, ,, ., hex_int, ,, ., identifier, ,, ., oct_int, ,, ., float, ,, ., string, ,, ., len, ,, =>, null, ,, ., comment, =>, "<a comment>", ,, ., newline, =>, "<a newline>", ,, ., as, =>, "as", ,, ., @, "and", =>, "and", ,, ., @, "break", =>, "break", ,, ., @, "catch", =>, "catch", ,, ., cinclude, =>, "cinclude", ,, ., @, "comptime", =>, "comptime", ,, ., @, "const", =>, "const", ,, ., context, =>, "context", ,, ., @, "continue", =>, "continue", ,, ., @, "defer", =>, "defer", ,, ., dyn, =>, "dyn", ,, ., @, "else", =>, "else", ,, ., @, "enum", =>, "enum", ,, ., @, "errdefer", =>, "errdefer", ,, ., @, "extern", =>, "extern", ,, ., false, =>, "false", ,, ., @, "fn", =>, "fn", ,, ., @, "for", =>, "for", ,, ., @, "if", =>, "if", ,, ., impl, =>, "impl", ,, ., import, =>, "import", ,, ., in, =>, "in", ,, ., let, =>, "let", ,, ., match, =>, "match", ,, ., mut, =>, "mut", ,, ., not, =>, "not", ,, ., @, "or", =>, "or", ,, ., @, "orelse", =>, "orelse", ,, ., @, "return", =>, "return", ,, ., @, "test", =>, "test", ,, ., true, =>, "true", ,, ., @, "try", =>, "try", ,, ., @, "unreachable", =>, "unreachable", ,, ., where, =>, "where", ,, ., with, =>, "with", ,, ., @, "while", =>, "while", ,, ., trait, =>, "trait", ,, ., type, =>, "type", ,, ., self, =>, "self", ,, ., @, "struct", =>, "struct", ,, ., undefined, =>, "undefined", ,, ., variadic, =>, "variadic", ,, ., virtual, =>, "virtual", ,, ., double_equals, =>, "==", ,, ., single_equals, =>, "=", ,, ., minus_equals, =>, "-=", ,, ., e_mark_equals, =>, "!=", ,, ., percent_equals, =>, "%=", ,, ., plus_equals, =>, "+=", ,, ., slash_equals, =>, "/=", ,, ., star_equals, =>, "*=", ,, ., bar, =>, "|", ,, ., caret, =>, "^", ,, ., double_bar, =>, "||", ,, ., fat_arrow, =>, "=>", ,, ., greater, =>, ">", ,, ., greater_equal, =>, ">=", ,, ., lesser, =>, "<", ,, ., lesser_equal, =>, "<=", ,, ., minus, =>, "-", ,, ., percent, =>, "%", ,, ., plus, =>, "+", ,, ., skinny_arrow, =>, "->", ,, ., slash, =>, "/", ,, ., star, =>, "*", ,, ., ampersand, =>, "&", ,, ., single_colon, =>, ":", ,, ., double_colon, =>, "::", ,, ., comma, =>, ",", ,, ., double_period, =>, "..", ,, ., exclamation_mark, =>, "!", ,, ., period, =>, ".", ,, ., question_mark, =>, "?", ,, ., semicolon, =>, ";", ,, ., multi_line_string, =>, "<multi-line>", ,, ., at_symbol, =>, "@", ,, ., left_brace, =>, "{", ,, ., left_parenthesis, =>, "(", ,, ., left_square, =>, "[", ,, ., right_brace, =>, "}", ,, ., right_parenthesis, =>, ")", ,, ., right_square, =>, "]", ,, ., invoke, =>, ".>", ,, ., EOF, =>, "(EOF)", ,, }, ;, }, pub, fn, from_string, (, data, :, [, ], const, u8, ), Kind, {, var, ix, :, usize, =, 0, ;, const, num_ctors, =, @, intFromEnum, (, Kind, ., len, ), ;, while, (, ix, <, num_ctors, ), :, (, ix, +=, 1, ), {, const, kind, :, Kind, =, @, enumFromInt, (, ix, ), ;, const, repr_kind, :, ?, [, ], const, u8, =, kind, ., repr, (, ), ;, if, (, repr_kind, ), |, _repr, |, {, if, (, std, ., mem, ., eql, (, u8, ,, data, ,, _repr, ), ), {, return, kind, ;, }, }, }, return, Kind, ., identifier, ;, }, const, end_tokens, =, [, _, ], Kind, {, ., identifier, ,, ., self, ,, ., dec_int, ,, ., hex_int, ,, ., oct_int, ,, ., bin_int, ,, ., float, ,, ., char, ,, ., string, ,, ., @, "unreachable", ,, ., @, "break", ,, ., @, "continue", ,, ., @, "return", ,, ., @, "else", ,, ., right_parenthesis, ,, ., right_square, ,, ., right_brace, ,, ., true, ,, ., false, ,, ., caret, ,, ., undefined, ,, }, ;, }, ;, kind, :, Kind, ,, data, :, [, ], const, u8, ,, span, :, Span, ,, pub, fn, init, (, data, :, [, ], const, u8, ,, kind, :, ?, Kind, ,, filename, :, [, ], const, u8, ,, line_text, :, [, ], const, u8, ,, line_number, :, usize, ,, col, :, usize, ), Self, {, return, ., {, ., data, =, data, ,, ., kind, =, kind, orelse, Kind, ., from_string, (, data, ), ,, ., span, =, Span, {, ., filename, =, filename, ,, ., line_text, =, line_text, ,, ., line_number, =, line_number, ,, ., col, =, col, ,, }, }, ;, }, pub, fn, init_simple, (, data, :, [, ], const, u8, ), Self, {, return, Self, ., init, (, data, ,, ., identifier, ,, "", ,, "", ,, 0, ,, 0, ), ;, }, pub, fn, pprint, (, self, :, *, Self, ), void, {, std, ., debug, ., print, (, "Token {{line: {:03}, kind: {s}, data: {s}}}\n", ,, ., {, self, ., span, ., line_number, ,, self, ., repr, (, ), ,, self, ., data, }, ), ;, }, const, std, =, @, import, (, "std", ), ;, const, Token, =, @, import, (, "token.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Self, :, type, =, @, This, (, ), ;, const, Lexer_Errors, =, error, {, LexerError, }, ;, const, Lex_State, =, enum, {, none, ,, whitespace, ,, underscore, ,, capitalized, ,, all_caps, ,, uncapitalized, ,, string, ,, escapedString, ,, byte_string1, ,, byte_string2, ,, char, ,, escapedChar, ,, integer, ,, integer_digit, ,, float, ,, float_digit, ,, hex, ,, hex_digit, ,, octal, ,, octal_digit, ,, binary, ,, binary_digit, ,, symbol, ,, multiline, ,, comment, ,, fn, state_from_integer, (, c, :, u8, ), Lex_State, {, return, switch, (, c, ), {, 'x', =>, ., hex_digit, ,, 'o', =>, ., octal_digit, ,, 'b', =>, ., binary_digit, ,, else, =>, unreachable, ,, }, ;, }, }, ;, tokens, :, *, std, ., array_list, ., Managed, (, Token, ), ,, filename, :, [, ], const, u8, ,, errors, :, *, errs_, ., Errors, ,, fuzz_tokens, :, bool, ,, allocator, :, std, ., mem, ., Allocator, ,, line_number, :, usize, ,, col, :, usize, ,, slice_start, :, usize, ,, ix, :, usize, ,, state, :, Lex_State, ,, pub, fn, init, (, filename, :, [, ], const, u8, ,, line_number, :, usize, ,, col, :, usize, ,, errors, :, *, errs_, ., Errors, ,, fuzz_tokens, :, bool, ,, allocator, :, std, ., mem, ., Allocator, ,, ), Self, {, const, retval, =, Self, {, ., tokens, =, allocator, ., create, (, std, ., array_list, ., Managed, (, Token, ), ), catch, unreachable, ,, ., filename, =, filename, ,, ., errors, =, errors, ,, ., fuzz_tokens, =, fuzz_tokens, ,, ., allocator, =, allocator, ,, ., line_number, =, line_number, ,, ., col, =, col, ,, ., slice_start, =, 0, ,, ., ix, =, 0, ,, ., state, =, ., none, ,, }, ;, retval, ., tokens, .*, =, std, ., array_list, ., Managed, (, Token, ), ., init, (, allocator, ), ;, return, retval, ;, }, pub, fn, run, (, self, :, *, Self, ,, lines, :, std, ., array_list, ., Managed, (, [, ], const, u8, ), ), Lexer_Errors, !, *, std, ., array_list, ., Managed, (, Token, ), {, for, (, lines, ., items, ), |, line, |, {, self, ., slice_start, =, 0, ;, self, ., ix, =, 0, ;, self, ., state, =, ., none, ;, self, ., line_number, +=, 1, ;, self, ., col, =, 1, ;, while, (, self, ., ix, <, line, ., len, +, 1, ), {, const, next_char, =, if, (, self, ., ix, <, line, ., len, ), line, [, self, ., ix, ], else, '\n', ;, try, self, ., state_machine, (, next_char, ,, line, ), ;, }, self, ., tokens, ., append, (, Token, ., init, (, "\n", ,, ., newline, ,, self, ., filename, ,, line, ,, self, ., line_number, ,, self, ., col, ), ), catch, unreachable, ;, }, self, ., tokens, ., append, (, Token, ., init, (, "EOF", ,, ., EOF, ,, self, ., filename, ,, "", ,, self, ., line_number, ,, self, ., col, ), ), catch, unreachable, ;, return, self, ., tokens, ;, }, fn, advance_ix, (, self, :, *, Self, ,, state, :, Lex_State, ), void, {, self, ., ix, +=, 1, ;, self, ., col, +=, 1, ;, self, ., state, =, state, ;, }, fn, state_machine, (, self, :, *, Self, ,, next_char, :, u8, ,, line, :, [, ], const, u8, ), Lexer_Errors, !, void, {, switch, (, self, ., state, ), {, ., none, =>, if, (, std, ., ascii, ., isWhitespace, (, next_char, ), ), {, self, ., advance_ix, (, ., whitespace, ), ;, }, else, if, (, std, ., ascii, ., isLower, (, next_char, ), ), {, self, ., advance_ix, (, ., uncapitalized, ), ;, }, else, if, (, std, ., ascii, ., isUpper, (, next_char, ), ), {, self, ., advance_ix, (, ., all_caps, ), ;, }, else, if, (, std, ., ascii, ., isDigit, (, next_char, ), ), {, self, ., advance_ix, (, ., integer, ), ;, }, else, if, (, next_char, ==, '"', ), {, self, ., advance_ix, (, ., string, ), ;, }, else, if, (, next_char, ==, '\'', ), {, self, ., advance_ix, (, ., char, ), ;, }, else, {, self, ., advance_ix, (, ., symbol, ), ;, }, ,, ., whitespace, =>, if, (, self, ., ix, ==, line, ., len, or, !, std, ., ascii, ., isWhitespace, (, next_char, ), ), {, self, ., slice_start, =, self, ., ix, ;, self, ., state, =, ., none, ;, }, else, {, self, ., advance_ix, (, self, ., state, ), ;, }, ,, ., underscore, =>, if, (, next_char, ==, '_', ), {, self, ., advance_ix, (, self, ., state, ), ;, return, self, ., throw_basic_error, (, line, ,, "may not have more than one underscore in a row in an identifier", ), ;, }, else, if, (, std, ., ascii, ., isUpper, (, next_char, ), or, std, ., ascii, ., isDigit, (, next_char, ), ), {, self, ., advance_ix, (, ., all_caps, ), ;, }, else, if, (, std, ., ascii, ., isLower, (, next_char, ), ), {, self, ., advance_ix, (, ., uncapitalized, ), ;, }, else, {, return, self, ., throw_basic_error, (, line, ,, "identifiers may not end in an underscore", ), ;, }, ,, ., all_caps, =>, if, (, std, ., ascii, ., isLower, (, next_char, ), ), {, if, (, self, ., ix, -, self, ., slice_start, >, 1, and, line, [, self, ., ix, -, 2, ], !=, '_', ), {, return, self, ., throw_camel_case_unsupported, (, line, ), ;, }, else, {, self, ., advance_ix, (, ., capitalized, ), ;, }, }, else, {, self, ., identifier, (, line, ,, next_char, ), ;, }, ,, ., capitalized, =>, if, (, std, ., ascii, ., isUpper, (, next_char, ), ), {, return, self, ., throw_camel_case_unsupported, (, line, ), ;, }, else, {, self, ., identifier, (, line, ,, next_char, ), ;, }, ,, ., uncapitalized, =>, if, (, std, ., ascii, ., isUpper, (, next_char, ), ), {, return, self, ., throw_camel_case_unsupported, (, line, ), ;, }, else, {, self, ., identifier, (, line, ,, next_char, ), ;, }, ,, ., string, =>, if, (, self, ., ix, ==, line, ., len, ), {, return, self, ., throw_basic_error, (, line, ,, "expected `\"`, got end-of-file", ), ;, }, else, switch, (, next_char, ), {, '"', =>, {, self, ., advance_ix, (, ., none, ), ;, self, ., tokens, ., append, (, self, ., create_token, (, line, ,, ., string, ), ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, }, ,, '\\', =>, {, self, ., advance_ix, (, ., escapedString, ), ;, }, ,, else, =>, {, self, ., advance_ix, (, self, ., state, ), ;, }, ,, }, ,, ., escapedString, =>, if, (, self, ., ix, ==, line, ., len, ), {, return, self, ., throw_basic_error, (, line, ,, "expected a string, got end-of-file", ), ;, }, else, if, (, is_escape, (, next_char, ), ), {, self, ., advance_ix, (, ., string, ), ;, }, else, if, (, next_char, ==, 'x', ), {, self, ., advance_ix, (, ., byte_string1, ), ;, }, else, {, return, self, ., throw_invalid_escape, (, line, ,, next_char, ), ;, }, ,, ., byte_string1, =>, if, (, is_hex_digit, (, next_char, ), ), {, self, ., advance_ix, (, ., byte_string2, ), ;, }, else, {, return, self, ., throw_invalid_decimal, (, line, ,, next_char, ,, "hexadecimal", ), ;, }, ,, ., byte_string2, =>, if, (, is_hex_digit, (, next_char, ), ), {, self, ., advance_ix, (, ., string, ), ;, }, else, {, return, self, ., throw_invalid_decimal, (, line, ,, next_char, ,, "hexadecimal", ), ;, }, ,, ., char, =>, if, (, self, ., ix, ==, line, ., len, ), {, return, self, ., throw_basic_error, (, line, ,, "expected a `'`, got end-of-file", ), ;, }, else, switch, (, next_char, ), {, '\'', =>, {, self, ., advance_ix, (, ., none, ), ;, const, num_codepoints, =, std, ., unicode, ., utf8CountCodepoints, (, line, [, self, ., slice_start, +, 1, .., self, ., ix, -, 1, ], ), catch, unreachable, ;, const, escaped, =, line, [, self, ., slice_start, +, 1, ], ==, '\\', ;, if, (, (, !, escaped, and, num_codepoints, >, 1, ), or, (, escaped, and, num_codepoints, >, 2, ), ), {, return, self, ., throw_basic_error, (, line, ,, "more than one codepoint specified in character literal", ), ;, }, self, ., tokens, ., append, (, self, ., create_token, (, line, ,, ., char, ), ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, }, ,, '\\', =>, {, self, ., advance_ix, (, ., escapedChar, ), ;, }, ,, else, =>, {, self, ., advance_ix, (, self, ., state, ), ;, }, ,, }, ,, ., escapedChar, =>, if, (, self, ., ix, ==, line, ., len, ), {, return, self, ., throw_basic_error, (, line, ,, "expected a character, got end-of-file", ), ;, }, else, if, (, is_escape, (, next_char, ), ), {, self, ., advance_ix, (, ., char, ), ;, }, else, {, return, self, ., throw_invalid_escape, (, line, ,, next_char, ), ;, }, ,, ., integer, =>, if, (, next_char, ==, '.', ), {, if, (, self, ., ix, +, 1, <, line, ., len, and, std, ., ascii, ., isDigit, (, line, [, self, ., ix, +, 1, ], ), ), {, self, ., advance_ix, (, ., float, ), ;, }, else, {, self, ., tokens, ., append, (, self, ., create_token, (, line, ,, ., dec_int, ), ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, self, ., state, =, ., none, ;, }, }, else, if, (, self, ., ix, -, self, ., slice_start, >, 0, and, line, [, self, ., slice_start, ], ==, '0', and, is_base_identifier, (, next_char, ), ), {, self, ., advance_ix, (, Lex_State, ., state_from_integer, (, next_char, ), ), ;, }, else, if, (, next_char, ==, '_', ), {, self, ., advance_ix, (, ., integer_digit, ), ;, }, else, if, (, self, ., ix, ==, line, ., len, or, !, std, ., ascii, ., isDigit, (, next_char, ), ), {, self, ., tokens, ., append, (, self, ., create_token, (, line, ,, ., dec_int, ), ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, self, ., state, =, ., none, ;, }, else, {, self, ., advance_ix, (, self, ., state, ), ;, }, ,, ., integer_digit, =>, if, (, self, ., ix, ==, line, ., len, or, !, std, ., ascii, ., isDigit, (, next_char, ), ), {, return, self, ., throw_invalid_decimal, (, line, ,, next_char, ,, "decimal", ), ;, }, else, {, self, ., advance_ix, (, ., integer, ), ;, }, ,, ., float, =>, if, (, next_char, ==, '_', ), {, self, ., advance_ix, (, ., float_digit, ), ;, }, else, if, (, self, ., ix, ==, line, ., len, or, !, std, ., ascii, ., isDigit, (, next_char, ), ), {, self, ., tokens, ., append, (, self, ., create_token, (, line, ,, ., float, ), ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, self, ., state, =, ., none, ;, }, else, {, self, ., advance_ix, (, self, ., state, ), ;, }, ,, ., float_digit, =>, if, (, self, ., ix, ==, line, ., len, or, !, std, ., ascii, ., isDigit, (, next_char, ), ), {, return, self, ., throw_invalid_decimal, (, line, ,, next_char, ,, "decimal", ), ;, }, else, {, self, ., advance_ix, (, ., float, ), ;, }, ,, ., hex, =>, switch, (, next_char, ), {, '_', =>, {, self, ., advance_ix, (, ., hex_digit, ), ;, }, ,, '0', .., ., '9', ,, 'a', .., ., 'f', ,, 'A', .., ., 'F', =>, {, self, ., advance_ix, (, self, ., state, ), ;, }, ,, else, =>, {, self, ., tokens, ., append, (, self, ., create_token, (, line, ,, ., hex_int, ), ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, self, ., state, =, ., none, ;, }, ,, }, ,, ., hex_digit, =>, switch, (, next_char, ), {, '0', .., ., '9', ,, 'a', .., ., 'f', ,, 'A', .., ., 'F', =>, {, self, ., advance_ix, (, ., hex, ), ;, }, ,, else, =>, {, return, self, ., throw_invalid_decimal, (, line, ,, next_char, ,, "hexadecimal", ), ;, }, ,, }, ,, ., octal, =>, switch, (, next_char, ), {, '_', =>, {, self, ., advance_ix, (, ., octal_digit, ), ;, }, ,, '0', .., ., '7', =>, {, self, ., advance_ix, (, self, ., state, ), ;, }, ,, else, =>, {, self, ., tokens, ., append, (, self, ., create_token, (, line, ,, ., oct_int, ), ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, self, ., state, =, ., none, ;, }, ,, }, ,, ., octal_digit, =>, switch, (, next_char, ), {, '0', .., ., '7', =>, {, self, ., advance_ix, (, ., octal, ), ;, }, ,, else, =>, {, return, self, ., throw_invalid_decimal, (, line, ,, next_char, ,, "octal", ), ;, }, ,, }, ,, ., binary, =>, switch, (, next_char, ), {, '_', =>, {, self, ., advance_ix, (, ., binary_digit, ), ;, }, ,, '0', .., ., '1', =>, {, self, ., advance_ix, (, self, ., state, ), ;, }, ,, else, =>, {, self, ., tokens, ., append, (, self, ., create_token, (, line, ,, ., bin_int, ), ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, self, ., state, =, ., none, ;, }, ,, }, ,, ., binary_digit, =>, switch, (, next_char, ), {, '0', .., ., '1', =>, {, self, ., advance_ix, (, ., binary, ), ;, }, ,, else, =>, {, return, self, ., throw_invalid_decimal, (, line, ,, next_char, ,, "binary", ), ;, }, ,, }, ,, ., symbol, =>, if, (, self, ., ix, -, self, ., slice_start, >, 0, and, line, [, self, ., slice_start, ], ==, '\\', and, next_char, ==, '\\', ), {, self, ., advance_ix, (, ., multiline, ), ;, }, else, if, (, self, ., ix, -, self, ., slice_start, >, 0, and, line, [, self, ., slice_start, ], ==, '/', and, next_char, ==, '/', ), {, self, ., advance_ix, (, ., comment, ), ;, }, else, if, (, self, ., ix, ==, line, ., len, or, Token, ., Kind, ., from_string, (, line, [, self, ., slice_start, .., self, ., ix, +, 1, ], ), ==, ., identifier, ), {, const, token, =, self, ., create_token, (, line, ,, null, ), ;, self, ., tokens, ., append, (, token, ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, self, ., state, =, ., none, ;, }, else, {, self, ., advance_ix, (, self, ., state, ), ;, }, ,, ., multiline, =>, if, (, next_char, ==, '\n', ), {, self, ., tokens, ., append, (, Token, ., init, (, line, [, self, ., slice_start, +, 2, .., self, ., ix, ], ,, ., multi_line_string, ,, self, ., filename, ,, line, ,, self, ., line_number, ,, self, ., col, ), ,, ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, self, ., state, =, ., none, ;, }, else, {, self, ., advance_ix, (, self, ., state, ), ;, }, ,, ., comment, =>, if, (, next_char, ==, '\n', ), {, self, ., tokens, ., append, (, Token, ., init, (, "", ,, ., comment, ,, self, ., filename, ,, line, ,, self, ., line_number, ,, self, ., col, ), ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, self, ., state, =, ., none, ;, }, else, {, self, ., advance_ix, (, self, ., state, ), ;, }, ,, }, }, fn, get_span, (, self, :, *, Self, ,, line, :, [, ], const, u8, ,, offset, :, usize, ), Span, {, return, Span, {, ., filename, =, self, ., filename, ,, ., line_text, =, line, ,, ., col, =, self, ., col, +, offset, ,, ., line_number, =, self, ., line_number, }, ;, }, fn, throw_invalid_decimal, (, self, :, *, Self, ,, line, :, [, ], const, u8, ,, digit, :, u8, ,, base, :, [, ], const, u8, ), Lexer_Errors, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., invalid_digit, =, ., {, ., span, =, self, ., get_span, (, line, ,, 1, ), ,, ., digit, =, digit, ,, ., base, =, base, ,, }, }, ), ;, return, Lexer_Errors, ., LexerError, ;, }, fn, throw_camel_case_unsupported, (, self, :, *, Self, ,, line, :, [, ], const, u8, ), Lexer_Errors, {, return, self, ., throw_basic_error, (, line, ,, "camelCase is not supported", ), ;, }, fn, throw_invalid_escape, (, self, :, *, Self, ,, line, :, [, ], const, u8, ,, next_char, :, u8, ), Lexer_Errors, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., invalid_escape, =, ., {, ., span, =, self, ., get_span, (, line, ,, 1, ), ,, ., digit, =, next_char, ,, }, }, ), ;, return, Lexer_Errors, ., LexerError, ;, }, fn, throw_basic_error, (, self, :, *, Self, ,, line, :, [, ], const, u8, ,, msg, :, [, ], const, u8, ), Lexer_Errors, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, self, ., get_span, (, line, ,, 0, ), ,, ., msg, =, msg, ,, }, }, ), ;, return, Lexer_Errors, ., LexerError, ;, }, fn, identifier, (, self, :, *, Self, ,, line, :, [, ], const, u8, ,, next_char, :, u8, ), void, {, if, (, next_char, ==, '_', ), {, self, ., advance_ix, (, ., underscore, ), ;, }, else, if, (, self, ., ix, ==, line, ., len, or, !, std, ., ascii, ., isAlphanumeric, (, next_char, ), ), {, var, token, =, self, ., create_token, (, line, ,, null, ), ;, if, (, self, ., fuzz_tokens, ), {, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "newline", ), or, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "eof", ), ), {, token, ., kind, =, ., newline, ;, }, }, self, ., tokens, ., append, (, token, ), catch, unreachable, ;, self, ., slice_start, =, self, ., ix, ;, self, ., state, =, ., none, ;, }, else, {, self, ., advance_ix, (, self, ., state, ), ;, }, }, fn, create_token, (, self, :, *, Self, ,, line, :, [, ], const, u8, ,, kind, :, ?, Token, ., Kind, ), Token, {, return, Token, ., init, (, line, [, self, ., slice_start, .., self, ., ix, ], ,, kind, ,, self, ., filename, ,, line, ,, self, ., line_number, ,, self, ., col, ,, ), ;, }, fn, is_base_identifier, (, c, :, u8, ), bool, {, return, switch, (, c, ), {, 'x', ,, 'o', ,, 'b', =>, true, ,, else, =>, false, ,, }, ;, }, fn, is_escape, (, c, :, u8, ), bool, {, return, switch, (, c, ), {, 'n', ,, 'r', ,, 't', ,, '\\', ,, '\'', ,, '"', =>, true, ,, else, =>, false, ,, }, ;, }, fn, is_hex_digit, (, c, :, u8, ), bool, {, return, std, ., ascii, ., isDigit, (, c, ), or, (, 'a', <=, c, and, c, <=, 'f', ), or, (, 'A', <=, c, and, c, <=, 'F', ), ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "ast/ast.zig", ), ;, const, core_, =, @, import, (, "hierarchy/core.zig", ), ;, const, Compiler_Context, =, @, import, (, "hierarchy/compiler.zig", ), ;, const, Codegen_Context, =, @, import, (, "codegen/codegen.zig", ), ;, const, errs_, =, @, import, (, "util/errors.zig", ), ;, const, exec, =, @, import, (, "util/exec.zig", ), ., exec, ;, const, Interpreter_Context, =, @, import, (, "interpretation/interpreter.zig", ), ;, const, Package_Kind, =, @, import, (, "hierarchy/package.zig", ), ., Package_Kind, ;, const, Span, =, @, import, (, "util/span.zig", ), ;, const, Symbol, =, @, import, (, "symbol/symbol.zig", ), ;, const, version_year, :, usize, =, 25, ;, const, version_month, :, usize, =, 11, ;, const, version_minor, :, ?, usize, =, null, ;, pub, const, Command_Error, :, type, =, error, {, LexerError, ,, ParseError, ,, CompileError, ,, FileError, ,, FileNotFound, ,, OutOfMemory, ,, WriteFailed, }, ;, const, Command, :, type, =, *, const, fn, (, name, :, [, ], const, u8, ,, args, :, *, std, ., process, ., ArgIterator, ,, allocator, :, std, ., mem, ., Allocator, ), Command_Error, !, void, ;, const, Command_Entry, :, type, =, struct, {, name, :, [, ], const, u8, ,, help, :, [, ], const, u8, ,, func, :, Command, ,, }, ;, const, command_table, =, [, _, ], Command_Entry, {, Command_Entry, {, ., name, =, "build", ,, ., help, =, "Builds an Orange package", ,, ., func, =, build, }, ,, Command_Entry, {, ., name, =, "clean", ,, ., help, =, "Clears the build cache, and forces a complete rebuild of the Orange package", ,, ., func, =, clean, }, ,, Command_Entry, {, ., name, =, "_fuzz_tokens", ,, ., help, =, "Builds an Orange package with fuzz tokens", ,, ., func, =, build, }, ,, Command_Entry, {, ., name, =, "help", ,, ., help, =, "Prints this help menu", ,, ., func, =, help, }, ,, Command_Entry, {, ., name, =, "init", ,, ., help, =, "Creates two files, one containing a sample Hello World program and a file to allow for it to be built", ,, ., func, =, init_project, }, ,, Command_Entry, {, ., name, =, "run", ,, ., help, =, "Builds and runs an Orange package", ,, ., func, =, build, }, ,, Command_Entry, {, ., name, =, "test", ,, ., help, =, "Builds and runs any tests in the current Orange package", ,, ., func, =, @, "test", }, ,, Command_Entry, {, ., name, =, "version", ,, ., help, =, "Prints the version of Orange", ,, ., func, =, print_version, }, ,, }, ;, pub, fn, main, (, ), !, void, {, const, allocator, =, std, ., heap, ., page_allocator, ;, var, args, =, try, std, ., process, ., ArgIterator, ., initWithAllocator, (, allocator, ), ;, const, location, =, args, ., next, (, ), .?, ;, _, =, location, ;, const, command, =, args, ., next, (, ), orelse, {, try, help, (, "help", ,, &, args, ,, allocator, ), ;, return, ;, }, ;, for, (, command_table, ), |, command_entry, |, {, if, (, std, ., mem, ., eql, (, u8, ,, command, ,, command_entry, ., name, ), ), {, command_entry, ., func, (, command, ,, &, args, ,, allocator, ), catch, |, err, |, switch, (, err, ), {, error, ., LexerError, ,, error, ., ParseError, ,, error, ., CompileError, ,, =>, std, ., process, ., exit, (, 1, ), ,, else, =>, return, err, ,, }, ;, return, ;, }, }, try, help, (, "help", ,, &, args, ,, allocator, ), ;, }, fn, build, (, name, :, [, ], const, u8, ,, args, :, *, std, ., process, ., ArgIterator, ,, allocator, :, std, ., mem, ., Allocator, ), Command_Error, !, void, {, var, compiler, =, try, Compiler_Context, ., init, (, errs_, ., get_std_err, (, ), ,, allocator, ), ;, defer, compiler, ., deinit, (, ), ;, const, package_abs_path, =, try, construct_package_dag, (, compiler, ), ;, compiler, ., propagate_include_directories, (, package_abs_path, ), ;, compiler, ., collect_package_local_modules, (, ), ;, compiler, ., determine_if_modified, (, package_abs_path, ), ;, compiler, ., collect_types, (, ), ;, try, Codegen_Context, ., output_modules, (, compiler, ), ;, try, compiler, ., compile, (, package_abs_path, ), ;, if, (, std, ., mem, ., eql, (, u8, ,, name, ,, "run", ), ), {, try, run, (, compiler, ,, package_abs_path, ,, args, ,, allocator, ), ;, }, }, fn, run_build_orng, (, compiler, :, *, Compiler_Context, ,, interpreter, :, *, Interpreter_Context, ,, build_path, :, [, ], const, u8, ), !, *, ast_, ., AST, {, const, build_cfg, =, compiler, ., compile_build_file, (, build_path, ), catch, return, error, ., CompileError, ;, interpreter, ., set_entry_point, (, build_cfg, ,, core_, ., package_type, ., expand_identifier, (, ), ), ;, try, interpreter, ., run, (, ), ;, return, try, interpreter, ., extract_ast, (, 0, ,, core_, ., package_type, ,, Span, ., phony, ), ;, }, fn, run, (, compiler, :, *, Compiler_Context, ,, package_abs_path, :, [, ], const, u8, ,, args, :, *, std, ., process, ., ArgIterator, ,, allocator, :, std, ., mem, ., Allocator, ), !, void, {, const, curr_package, =, compiler, ., lookup_package, (, package_abs_path, ), .?, ;, if, (, curr_package, ., kind, ==, ., static_library, ), {, var, stderr_writer, =, errs_, ., get_std_err, (, ), ., writer, (, &, ., {, }, ), ., interface, ;, (, errs_, ., Error, {, ., basic, =, ., {, ., msg, =, "cannot run a non-executable package", ,, ., span, =, Span, ., phony, ,, }, }, ), ., fatal_error, (, &, stderr_writer, ,, ., {, }, ), ;, return, error, ., CompileError, ;, }, var, output_name, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, try, output_name, ., print, (, "{s}", ,, ., {, curr_package, ., output_absolute_path, }, ), ;, var, argv, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, allocator, ), ;, defer, argv, ., deinit, (, ), ;, try, argv, ., append, (, output_name, ., items, ), ;, if, (, args, ., next, (, ), ), |, arg, |, {, try, argv, ., append, (, arg, ), ;, }, const, res, =, exec, (, argv, ., items, ,, ., Inherit, ), catch, return, error, ., CompileError, ;, std, ., process, ., exit, (, @, intCast, (, res, ., retcode, ), ), ;, }, fn, @, "test", (, name, :, [, ], const, u8, ,, args, :, *, std, ., process, ., ArgIterator, ,, allocator, :, std, ., mem, ., Allocator, ), Command_Error, !, void, {, _, =, name, ;, var, compiler, =, try, Compiler_Context, ., init, (, errs_, ., get_std_err, (, ), ,, allocator, ), ;, defer, compiler, ., deinit, (, ), ;, const, package_abs_path, =, try, construct_package_dag, (, compiler, ), ;, compiler, ., set_package_kind, (, package_abs_path, ,, ., test_executable, ), ;, compiler, ., propagate_include_directories, (, package_abs_path, ), ;, compiler, ., collect_package_local_modules, (, ), ;, compiler, ., determine_if_modified, (, package_abs_path, ), ;, compiler, ., collect_types, (, ), ;, try, Codegen_Context, ., output_modules, (, compiler, ), ;, try, compiler, ., compile, (, package_abs_path, ), ;, try, run, (, compiler, ,, package_abs_path, ,, args, ,, allocator, ), ;, }, fn, make_package, (, package, :, *, ast_, ., AST, ,, compiler, :, *, Compiler_Context, ,, interpreter, :, *, Interpreter_Context, ,, package_absolute_path, :, [, ], const, u8, ,, ), Command_Error, !, *, Symbol, {, var, package_kind, :, Package_Kind, =, undefined, ;, switch, (, package, ., get_field, (, core_, ., package_type, ,, "kind", ), ., pos, (, ), .?, ), {, 0, =>, package_kind, =, ., executable, ,, 1, =>, package_kind, =, ., static_library, ,, else, =>, std, ., debug, ., panic, (, "unimplemented", ,, ., {, }, ), ,, }, compiler, ., register_package, (, package_absolute_path, ,, package_kind, ), ;, const, entry_name, :, ?, [, ], const, u8, =, if, (, package_kind, ==, ., executable, ), "main", else, null, ;, for, (, package, ., get_field, (, core_, ., package_type, ,, "requirements", ), ., children, (, ), ., items, ), |, maybe_requirement_addr, |, {, if, (, maybe_requirement_addr, ., enum_value, ., _pos, !=, 0, ), {, continue, ;, }, const, requirement, =, maybe_requirement_addr, ., enum_value, ., init, .?, ;, const, required_package_name, :, [, ], const, u8, =, requirement, ., children, (, ), ., items, [, 0, ], ., string, ., data, ;, const, required_package_addr, :, i64, =, @, intCast, (, requirement, ., children, (, ), ., items, [, 1, ], ., int, ., data, ), ;, const, required_package, =, try, interpreter, ., extract_ast, (, required_package_addr, ,, core_, ., package_type, ,, Span, ., phony, ), ;, const, required_package_dir, =, required_package, ., get_field, (, core_, ., package_type, ,, "dir", ), ., string, ., data, ;, const, new_working_directory_buffer, =, try, compiler, ., allocator, (, ), ., alloc, (, u8, ,, std, ., fs, ., max_path_bytes, ), ;, const, new_working_directory, =, std, ., fs, ., cwd, (, ), ., realpath, (, required_package_dir, ,, new_working_directory_buffer, ), catch, return, error, ., PathError, ;, _, =, try, make_package, (, required_package, ,, compiler, ,, interpreter, ,, new_working_directory, ), ;, compiler, ., make_package_requirement_link, (, package_absolute_path, ,, required_package_name, ,, required_package_dir, ), ;, }, try, set_package_include_dirs, (, package, ,, compiler, ,, package_absolute_path, ), ;, try, set_package_lib_dirs, (, package, ,, compiler, ,, package_absolute_path, ), ;, try, set_package_libs, (, package, ,, compiler, ,, package_absolute_path, ), ;, const, root_filename, =, package, ., get_field, (, core_, ., package_type, ,, "root", ), ., string, ., data, ;, const, root_file_paths, =, [, _, ], [, ], const, u8, {, package_absolute_path, ,, root_filename, }, ;, const, root_file_path, =, try, std, ., fs, ., path, ., join, (, compiler, ., allocator, (, ), ,, &, root_file_paths, ), ;, const, package_root, =, compiler, ., compile_module, (, root_file_path, ,, entry_name, ,, false, ,, ), catch, return, error, ., CompileError, ;, compiler, ., set_package_root, (, package_absolute_path, ,, package_root, ), ;, return, package_root, ;, }, fn, set_package_include_dirs, (, package, :, *, ast_, ., AST, ,, compiler, :, *, Compiler_Context, ,, package_absolute_path, :, [, ], const, u8, ,, ), !, void, {, for, (, package, ., get_field, (, core_, ., package_type, ,, "include_dirs", ), ., children, (, ), ., items, ), |, maybe_include_dir_addr, |, {, if, (, maybe_include_dir_addr, ., enum_value, ., _pos, !=, 0, ), {, continue, ;, }, const, include_dir, =, maybe_include_dir_addr, ., enum_value, ., init, .?, ;, try, compiler, ., lookup_package, (, package_absolute_path, ), .?, ., include_directories, ., put, (, include_dir, ., string, ., data, ,, void, {, }, ), ;, }, }, fn, set_package_lib_dirs, (, package, :, *, ast_, ., AST, ,, compiler, :, *, Compiler_Context, ,, package_absolute_path, :, [, ], const, u8, ,, ), !, void, {, for, (, package, ., get_field, (, core_, ., package_type, ,, "lib_dirs", ), ., children, (, ), ., items, ), |, maybe_lib_dir_addr, |, {, if, (, maybe_lib_dir_addr, ., enum_value, ., _pos, !=, 0, ), {, continue, ;, }, const, include_dir, =, maybe_lib_dir_addr, ., enum_value, ., init, .?, ;, try, compiler, ., lookup_package, (, package_absolute_path, ), .?, ., library_directories, ., put, (, include_dir, ., string, ., data, ,, void, {, }, ), ;, }, }, fn, set_package_libs, (, package, :, *, ast_, ., AST, ,, compiler, :, *, Compiler_Context, ,, package_absolute_path, :, [, ], const, u8, ,, ), !, void, {, for, (, package, ., get_field, (, core_, ., package_type, ,, "libs", ), ., children, (, ), ., items, ), |, maybe_lib_addr, |, {, if, (, maybe_lib_addr, ., enum_value, ., _pos, !=, 0, ), {, continue, ;, }, const, include_dir, =, maybe_lib_addr, ., enum_value, ., init, .?, ;, try, compiler, ., lookup_package, (, package_absolute_path, ), .?, ., libraries, ., put, (, include_dir, ., string, ., data, ,, void, {, }, ), ;, }, }, fn, print_version, (, name, :, [, ], const, u8, ,, args, :, *, std, ., process, ., ArgIterator, ,, allocator, :, std, ., mem, ., Allocator, ), Command_Error, !, void, {, _, =, name, ;, _, =, allocator, ;, _, =, args, ;, const, out, =, std, ., fs, ., File, ., stdout, (, ), ;, var, writer, =, out, ., writer, (, &, ., {, }, ), ., interface, ;, try, writer, ., print, (, "Orange {}.{:0>2}", ,, ., {, version_year, ,, version_month, }, ), ;, if, (, version_minor, !=, null, ), {, try, writer, ., print, (, ".{}", ,, ., {, version_minor, .?, }, ), ;, }, try, writer, ., print, (, "\n", ,, ., {, }, ), ;, }, fn, help, (, name, :, [, ], const, u8, ,, args, :, *, std, ., process, ., ArgIterator, ,, allocator, :, std, ., mem, ., Allocator, ), Command_Error, !, void, {, _, =, name, ;, _, =, allocator, ;, _, =, args, ;, var, out, =, std, ., fs, ., File, ., stdout, (, ), ;, var, writer, =, out, ., writer, (, &, ., {, }, ), ., interface, ;, try, writer, ., print, (, "Usage: orng [command] [options]\n\nCommands:\n", ,, ., {, }, ), ;, for, (, command_table, ), |, command_entry, |, {, if, (, command_entry, ., name, [, 0, ], ==, '_', ), {, continue, ;, }, try, writer, ., print, (, "  {s}", ,, ., {, command_entry, ., name, }, ), ;, const, num_spaces, =, 12, -, command_entry, ., name, ., len, ;, for, (, 0..num_spaces, ), |, _, |, {, try, writer, ., print, (, " ", ,, ., {, }, ), ;, }, try, writer, ., print, (, "{s}\n", ,, ., {, command_entry, ., help, }, ), ;, }, try, writer, ., print, (, "\n", ,, ., {, }, ), ;, }, pub, fn, init_project, (, name, :, [, ], const, u8, ,, args, :, *, std, ., process, ., ArgIterator, ,, allocator, :, std, ., mem, ., Allocator, ), Command_Error, !, void, {, _, =, args, ;, _, =, name, ;, _, =, allocator, ;, var, stderr_writer, =, errs_, ., get_std_err, (, ), ., writer, (, &, ., {, }, ), ., interface, ;, const, main_path, =, "main.orng", ;, if, (, std, ., fs, ., cwd, (, ), ., openFile, (, main_path, ,, ., {, }, ), ), |, _, |, {, (, errs_, ., Error, {, ., basic, =, ., {, ., msg, =, "an Orange package already exists here", ,, ., span, =, Span, ., phony, ,, }, }, ), ., fatal_error, (, &, stderr_writer, ,, ., {, }, ), ;, }, else, |, err, |, switch, (, err, ), {, error, ., FileNotFound, =>, {, }, ,, else, =>, return, error, ., FileError, ,, }, const, build_path, =, "build.orng", ;, if, (, std, ., fs, ., cwd, (, ), ., openFile, (, build_path, ,, ., {, }, ), ), |, _, |, {, (, errs_, ., Error, {, ., basic, =, ., {, ., msg, =, "an Orange package already exists here", ,, ., span, =, Span, ., phony, ,, }, }, ), ., fatal_error, (, &, stderr_writer, ,, ., {, }, ), ;, }, else, |, err, |, switch, (, err, ), {, error, ., FileNotFound, =>, {, }, ,, else, =>, return, error, ., FileError, ,, }, var, main_orng, =, std, ., fs, ., cwd, (, ), ., createFile, (, main_path, ,, ., {, }, ), catch, return, error, ., FileError, ;, defer, main_orng, ., close, (, ), ;, const, main_content, =, \, \, fn, main, (, ), ->, (, ), !, (, ), with, core, ::, IO, {, \, \, @, println, (, "Hello, World!", ), \, \, }, ;, main_orng, ., writeAll, (, main_content, ), catch, return, error, ., FileError, ;, var, build_orng, =, std, ., fs, ., cwd, (, ), ., createFile, (, build_path, ,, ., {, }, ), catch, return, error, ., FileError, ;, defer, build_orng, ., close, (, ), ;, const, build_content, =, \, \, fn, build, (, ), ->, core, ::, Package, {, \, \, let, mut, retval, =, core, ::, Package, ::, executable, (, ., root, =, "main.orng", ), \, \, retval, .>, requires, (, "std", ,, core, ::, Package, ::, find, (, \, \, ., git, (, core, ::, Git_Source, (, ., url, =, "https://github.com/Rakhyvel/Orange", ,, ., subdir, =, "std", ), ), ), \, \, ), \, \, retval, \, \, }, ;, var, build_orng_writer, =, build_orng, ., writer, (, &, ., {, }, ), ., interface, ;, build_orng_writer, ., writeAll, (, build_content, ), catch, return, error, ., FileError, ;, }, fn, clean, (, name, :, [, ], const, u8, ,, args, :, *, std, ., process, ., ArgIterator, ,, allocator, :, std, ., mem, ., Allocator, ), Command_Error, !, void, {, _, =, name, ;, _, =, args, ;, var, compiler, =, try, Compiler_Context, ., init, (, errs_, ., get_std_err, (, ), ,, allocator, ), ;, defer, compiler, ., deinit, (, ), ;, const, package_abs_path, =, try, construct_package_dag, (, compiler, ), ;, compiler, ., clean_package, (, package_abs_path, ), ;, }, fn, construct_package_dag, (, compiler, :, *, Compiler_Context, ), Command_Error, !, [, ], const, u8, {, const, build_path_buffer, =, try, std, ., heap, ., page_allocator, ., alloc, (, u8, ,, std, ., fs, ., max_path_bytes, ), ;, var, stderr_writer, =, errs_, ., get_std_err, (, ), ., writer, (, &, ., {, }, ), ., interface, ;, const, build_path, :, [, ], const, u8, =, std, ., fs, ., cwd, (, ), ., realpath, (, "build.orng", ,, build_path_buffer, ), catch, |, err, |, switch, (, err, ), {, error, ., FileNotFound, =>, {, (, errs_, ., Error, {, ., basic, =, ., {, ., msg, =, "no `build.orng` file found in current working directory", ,, ., span, =, Span, ., phony, ,, }, }, ), ., fatal_error, (, &, stderr_writer, ,, ., {, }, ), ;, }, ,, else, =>, return, error, ., CompileError, ,, }, ;, var, interpreter, =, Interpreter_Context, ., init, (, compiler, ), ;, defer, interpreter, ., deinit, (, ), ;, const, package_dag, =, try, run_build_orng, (, compiler, ,, &, interpreter, ,, build_path, ), ;, const, cwd_buffer, =, try, compiler, ., allocator, (, ), ., alloc, (, u8, ,, std, ., fs, ., max_path_bytes, ), ;, const, package_abs_path, =, std, ., fs, ., cwd, (, ), ., realpath, (, ".", ,, cwd_buffer, ), catch, return, error, ., PathError, ;, _, =, try, make_package, (, package_dag, ,, compiler, ,, &, interpreter, ,, package_abs_path, ), ;, return, package_abs_path, ;, }, const, std, =, @, import, (, "std", ), ;, const, AST, =, @, import, (, "../ast/ast.zig", ), ., AST, ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, pipeline_, =, @, import, (, "../util/pipeline.zig", ), ;, const, Split_Lines, =, @, import, (, "../lexer/split_lines.zig", ), ;, const, Tokenize, =, @, import, (, "../lexer/tokenize.zig", ), ;, const, Apply_Layout, =, @, import, (, "../lexer/apply_layout.zig", ), ;, const, Parse, =, @, import, (, "../parser/parse.zig", ), ;, const, Self, =, @, This, (, ), ;, fmt_str, :, *, AST, ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ,, i, :, usize, =, 0, ,, pub, fn, init, (, fmt_str, :, *, AST, ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ), Self, {, std, ., debug, ., assert, (, fmt_str, .*, ==, ., string, ), ;, return, Self, {, ., fmt_str, =, fmt_str, ,, ., errors, =, errors, ,, ., allocator, =, allocator, ,, }, ;, }, pub, fn, parse_fmt_string, (, self, :, *, Self, ), !, std, ., array_list, ., Managed, (, *, AST, ), {, var, retval, =, std, ., array_list, ., Managed, (, *, AST, ), ., init, (, self, ., allocator, ), ;, const, data, =, self, ., fmt_str, ., string, ., data, ;, var, prev, :, usize, =, 0, ;, while, (, self, ., i, <, data, ., len, ), :, (, self, ., i, +=, 1, ), {, if, (, data, [, self, ., i, ], ==, '{', ), {, try, self, ., ensure_not_end, (, ), ;, if, (, data, [, self, ., i, +, 1, ], ==, '{', ), {, try, retval, ., append, (, AST, ., create_string, (, self, ., fmt_str, ., token, (, ), ,, data, [, prev, .., self, ., i, ], ,, self, ., allocator, ), ), ;, self, ., i, +=, 1, ;, prev, =, self, ., i, ;, }, else, {, const, fmt_bracket_open, =, self, ., i, ;, while, (, self, ., i, <, data, ., len, and, data, [, self, ., i, ], !=, '}', ), :, (, self, ., i, +=, 1, ), {, }, try, self, ., ensure_not_end, (, ), ;, try, self, ., ensure_not_empty, (, fmt_bracket_open, ), ;, if, (, fmt_bracket_open, >, prev, ), {, try, retval, ., append, (, AST, ., create_string, (, self, ., fmt_str, ., token, (, ), ,, data, [, prev, .., fmt_bracket_open, ], ,, self, ., allocator, ), ), ;, prev, =, fmt_bracket_open, ;, }, const, asts, =, pipeline_, ., run, (, data, [, fmt_bracket_open, +, 1, .., self, ., i, ], ,, ., {, Split_Lines, ., init, (, self, ., errors, ,, self, ., allocator, ), ,, Tokenize, ., init, (, self, ., fmt_str, ., token, (, ), ., span, ., filename, ,, self, ., fmt_str, ., token, (, ), ., span, ., line_number, ,, self, ., fmt_str, ., token, (, ), ., span, ., col, ,, self, ., errors, ,, false, ,, self, ., allocator, ), ,, Parse, ., init, (, ., expr, ,, self, ., errors, ,, self, ., allocator, ), ,, }, ), catch, return, error, ., ParseError, ;, try, retval, ., append, (, asts, ., items, [, 0, ], ), ;, prev, =, self, ., i, +, 1, ;, }, }, else, if, (, data, [, self, ., i, ], ==, '}', ), {, self, ., i, +=, 1, ;, try, self, ., ensure_not_end, (, ), ;, try, self, ., expect_closing_brace, (, ), ;, try, retval, ., append, (, AST, ., create_string, (, self, ., fmt_str, ., token, (, ), ,, data, [, prev, .., self, ., i, -, 2, ], ,, self, ., allocator, ), ), ;, prev, =, self, ., i, ;, }, }, if, (, self, ., i, >, prev, ), {, try, retval, ., append, (, AST, ., create_string, (, self, ., fmt_str, ., token, (, ), ,, data, [, prev, .., self, ., i, ], ,, self, ., allocator, ), ), ;, }, return, retval, ;, }, fn, expect_closing_brace, (, self, :, *, Self, ), !, void, {, if, (, self, ., fmt_str, ., string, ., data, [, self, ., i, ], !=, '}', ), {, var, err_span, =, self, ., fmt_str, ., token, (, ), ., span, ;, err_span, ., col, -=, self, ., fmt_str, ., string, ., data, ., len, ;, err_span, ., col, +=, self, ., i, ;, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, err_span, ,, ., msg, =, "expected `}`", ,, }, }, ), ;, return, error, ., ParseError, ;, }, }, fn, ensure_not_end, (, self, :, *, Self, ), !, void, {, if, (, self, ., i, >=, self, ., fmt_str, ., string, ., data, ., len, ), {, var, err_span, =, self, ., fmt_str, ., token, (, ), ., span, ;, err_span, ., col, -=, self, ., fmt_str, ., string, ., data, ., len, ;, err_span, ., col, +=, self, ., i, ;, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, err_span, ,, ., msg, =, "unexpected end of format string", ,, }, }, ), ;, return, error, ., ParseError, ;, }, }, fn, ensure_not_empty, (, self, :, *, Self, ,, bracket_open_pos, :, usize, ), !, void, {, if, (, self, ., i, -, bracket_open_pos, <=, 1, ), {, var, err_span, =, self, ., fmt_str, ., token, (, ), ., span, ;, err_span, ., col, -=, self, ., fmt_str, ., string, ., data, ., len, ;, err_span, ., col, +=, bracket_open_pos, ;, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, err_span, ,, ., msg, =, "empty format argument", ,, }, }, ), ;, return, error, ., ParseError, ;, }, }, const, std, =, @, import, (, "std", ), ;, const, anon_name_, =, @, import, (, "../util/anon_name.zig", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Fmt_String, =, @, import, (, "fmt_string.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Self, :, type, =, @, This, (, ), ;, const, Parser_Error_Enum, =, error, {, ParseError, ,, OutOfMemory, }, ;, pub, const, Parse_Mode, =, enum, {, top_level, ,, expr, ,, }, ;, tokens, :, *, std, ., array_list, ., Managed, (, Token, ), ,, cursor, :, usize, ,, errors, :, *, errs_, ., Errors, ,, parse_mode, :, Parse_Mode, ,, allocator, :, std, ., mem, ., Allocator, ,, pub, fn, init, (, parse_mode, :, Parse_Mode, ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ), Self, {, return, ., {, ., tokens, =, undefined, ,, ., cursor, =, 0, ,, ., allocator, =, allocator, ,, ., parse_mode, =, parse_mode, ,, ., errors, =, errors, ,, }, ;, }, fn, peek, (, self, :, *, Self, ), Token, {, return, self, ., tokens, ., items, [, self, ., cursor, ], ;, }, fn, peek_kind, (, self, :, *, Self, ,, kind, :, Token, ., Kind, ), bool, {, return, self, ., peek, (, ), ., kind, ==, kind, ;, }, fn, next_is_expr, (, self, :, *, Self, ), bool, {, const, next_kind, =, self, ., peek, (, ), ., kind, ;, return, next_kind, ==, ., exclamation_mark, or, next_kind, ==, ., true, or, next_kind, ==, ., false, or, next_kind, ==, ., question_mark, or, next_kind, ==, ., period, or, next_kind, ==, ., ampersand, or, next_kind, ==, ., left_parenthesis, or, next_kind, ==, ., left_square, or, next_kind, ==, ., left_brace, or, next_kind, ==, ., bar, or, next_kind, ==, ., minus, or, next_kind, ==, ., match, or, next_kind, ==, ., @, "fn", or, next_kind, ==, ., @, "for", or, next_kind, ==, ., @, "if", or, next_kind, ==, ., @, "try", or, next_kind, ==, ., @, "comptime", or, next_kind, ==, ., @, "unreachable", or, next_kind, ==, ., @, "while", or, next_kind, ==, ., with, or, next_kind, ==, ., identifier, or, next_kind, ==, ., bin_int, or, next_kind, ==, ., char, or, next_kind, ==, ., hex_int, or, next_kind, ==, ., dec_int, or, next_kind, ==, ., oct_int, or, next_kind, ==, ., float, or, next_kind, ==, ., string, or, next_kind, ==, ., multi_line_string, or, next_kind, ==, ., not, or, next_kind, ==, ., at_symbol, or, next_kind, ==, ., self, ;, }, fn, next_is_control_flow, (, self, :, *, Self, ), bool, {, const, next_kind, =, self, ., peek, (, ), ., kind, ;, return, next_kind, ==, ., @, "if", or, next_kind, ==, ., @, "while", or, next_kind, ==, ., with, or, next_kind, ==, ., match, or, next_kind, ==, ., @, "for", or, next_kind, ==, ., @, "comptime", or, next_kind, ==, ., left_brace, ;, }, fn, next_is_statement, (, self, :, *, Self, ), bool, {, const, next_kind, =, self, ., peek, (, ), ., kind, ;, return, next_kind, ==, ., let, or, next_kind, ==, ., @, "const", or, next_kind, ==, ., @, "extern", or, next_kind, ==, ., import, or, next_kind, ==, ., cinclude, or, next_kind, ==, ., impl, or, next_kind, ==, ., trait, or, next_kind, ==, ., @, "defer", or, next_kind, ==, ., @, "errdefer", or, self, ., next_is_expr, (, ), ;, }, fn, next_is_compound_assign, (, self, :, *, Self, ), bool, {, const, next_kind, =, self, ., peek, (, ), ., kind, ;, return, next_kind, ==, ., plus_equals, or, next_kind, ==, ., minus_equals, or, next_kind, ==, ., star_equals, or, next_kind, ==, ., slash_equals, or, next_kind, ==, ., percent_equals, ;, }, fn, accept, (, self, :, *, Self, ,, kind, :, Token, ., Kind, ), ?, Token, {, const, token, =, self, ., peek, (, ), ;, if, (, token, ., kind, ==, kind, ), {, self, ., cursor, +=, 1, ;, return, token, ;, }, else, {, return, null, ;, }, }, fn, expect, (, self, :, *, Self, ,, kind, :, Token, ., Kind, ), Parser_Error_Enum, !, Token, {, if, (, self, ., accept, (, kind, ), ), |, token, |, {, return, token, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected2token, =, ., {, ., expected, =, kind, ,, ., got, =, self, ., peek, (, ), }, }, ), ;, return, Parser_Error_Enum, ., ParseError, ;, }, }, fn, pop, (, self, :, *, Self, ), Token, {, const, token, =, self, ., peek, (, ), ;, self, ., cursor, +=, 1, ;, return, token, ;, }, pub, fn, run, (, self, :, *, Self, ,, tokens, :, *, std, ., array_list, ., Managed, (, Token, ), ), Parser_Error_Enum, !, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, self, ., tokens, =, tokens, ;, var, decls, =, self, ., allocator, ., create, (, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ), catch, unreachable, ;, decls, .*, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, switch, (, self, ., parse_mode, ), {, ., top_level, =>, {, while, (, self, ., accept, (, ., newline, ), ), |, _, |, {, }, while, (, !, self, ., peek_kind, (, ., EOF, ), ), {, try, decls, ., append, (, try, self, ., top_level_declaration, (, ), ), ;, while, (, self, ., accept, (, ., newline, ), ), |, _, |, {, }, }, _, =, try, self, ., expect, (, ., EOF, ), ;, }, ,, ., expr, =>, try, decls, ., append, (, try, self, ., parse_expr, (, ), ), ,, }, return, decls, ;, }, fn, top_level_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, if, (, self, ., peek_kind, (, ., @, "fn", ), ), {, return, try, self, ., fn_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "const", ), ), {, const, decl, :, *, ast_, ., AST, =, try, self, ., const_declaration, (, ), ;, if, (, !, self, ., peek_kind, (, ., EOF, ), ), {, _, =, try, self, ., expect, (, ., newline, ), ;, }, return, decl, ;, }, else, if, (, self, ., peek_kind, (, ., @, "extern", ), ), {, const, decl, :, *, ast_, ., AST, =, try, self, ., extern_const_declaration, (, ), ;, if, (, !, self, ., peek_kind, (, ., EOF, ), ), {, _, =, try, self, ., expect, (, ., newline, ), ;, }, return, decl, ;, }, else, if, (, self, ., peek_kind, (, ., import, ), ), {, const, import, :, *, ast_, ., AST, =, try, self, ., import_declaration, (, ), ;, if, (, !, self, ., peek_kind, (, ., EOF, ), ), {, _, =, try, self, ., expect, (, ., newline, ), ;, }, return, import, ;, }, else, if, (, self, ., peek_kind, (, ., cinclude, ), ), {, const, cinclude, :, *, ast_, ., AST, =, try, self, ., cinclude_declaration, (, ), ;, if, (, !, self, ., peek_kind, (, ., EOF, ), ), {, _, =, try, self, ., expect, (, ., newline, ), ;, }, return, cinclude, ;, }, else, if, (, self, ., peek_kind, (, ., trait, ), ), {, return, try, self, ., trait_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., impl, ), ), {, return, try, self, ., impl_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "test", ), ), {, return, try, self, ., test_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "struct", ), ), {, return, self, ., struct_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., context, ), ), {, return, self, ., context_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "enum", ), ), {, return, self, ., enum_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., type, ), ), {, return, self, ., type_alias_declaration, (, ), ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "top-level declaration here", ,, ., got, =, self, ., peek, (, ), ,, }, }, ), ;, return, Parser_Error_Enum, ., ParseError, ;, }, }, fn, import_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., import, ), ;, const, identifier, =, try, self, ., expect, (, ., identifier, ), ;, var, pattern, =, ast_, ., AST, ., create_pattern_symbol, (, identifier, ,, ., {, ., import, =, ., {, ., real_name, =, identifier, ., data, }, }, ,, ., local, ,, identifier, ., data, ,, self, ., allocator, ,, ), ;, while, (, self, ., accept, (, ., double_colon, ), ), |, access_token, |, {, pattern, =, ast_, ., AST, ., create_access, (, access_token, ,, pattern, ,, ast_, ., AST, ., create_field, (, try, self, ., expect, (, ., identifier, ), ,, self, ., allocator, ), ,, self, ., allocator, ,, ), ;, }, return, ast_, ., AST, ., create_import, (, token, ,, pattern, ,, self, ., allocator, ,, ), ;, }, fn, cinclude_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., cinclude, ), ;, return, ast_, ., AST, ., create_cinclude, (, token, ,, try, self, ., bool_expr, (, ), ,, self, ., allocator, ,, ), ;, }, fn, extern_const_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, _, =, try, self, ., expect, (, ., @, "extern", ), ;, var, c_name, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., left_parenthesis, ), !=, null, ), {, c_name, =, try, self, ., bool_expr, (, ), ;, _, =, try, self, ., expect, (, ., right_parenthesis, ), ;, }, if, (, self, ., peek_kind, (, ., @, "const", ), ), {, var, retval, =, try, self, ., const_declaration, (, ), ;, retval, ., binding, ., pattern, =, ast_, ., AST, ., create_pattern_symbol, (, retval, ., binding, ., pattern, ., token, (, ), ,, ., @, "const", ,, ., {, ., @, "extern", =, ., {, ., c_name, =, c_name, }, }, ,, retval, ., binding, ., pattern, ., token, (, ), ., data, ,, self, ., allocator, ,, ), ;, retval, ., binding, ., init, =, null, ;, return, retval, ;, }, else, if, (, self, ., peek_kind, (, ., type, ), ), {, var, retval, =, try, self, ., type_alias_declaration, (, ), ;, retval, ., type_alias, ., name, =, ast_, ., AST, ., create_pattern_symbol, (, retval, ., type_alias, ., name, ., token, (, ), ,, ., type, ,, ., {, ., @, "extern", =, ., {, ., c_name, =, c_name, }, }, ,, retval, ., type_alias, ., name, ., token, (, ), ., data, ,, self, ., allocator, ,, ), ;, return, retval, ;, }, else, if, (, self, ., peek_kind, (, ., @, "struct", ), ), {, var, retval, =, try, self, ., struct_declaration, (, ), ;, retval, ., struct_decl, ., name, =, ast_, ., AST, ., create_pattern_symbol, (, retval, ., struct_decl, ., name, ., token, (, ), ,, ., type, ,, ., {, ., @, "extern", =, ., {, ., c_name, =, c_name, }, }, ,, retval, ., struct_decl, ., name, ., token, (, ), ., data, ,, self, ., allocator, ,, ), ;, return, retval, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "`const`, `type`, or `struct` here", ,, ., got, =, self, ., peek, (, ), }, }, ), ;, return, error, ., ParseError, ;, }, }, fn, product_type_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, Type_AST, {, const, exp, =, try, self, ., type_expr, (, ), ;, var, terms, :, ?, std, ., array_list, ., Managed, (, *, Type_AST, ), =, null, ;, var, firsttoken_, :, ?, Token, =, null, ;, while, (, self, ., accept, (, ., comma, ), ), |, token, |, {, if, (, terms, ==, null, ), {, terms, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ;, firsttoken_, =, token, ;, terms, .?, ., append, (, exp, ), catch, unreachable, ;, }, if, (, self, ., peek_kind, (, ., right_parenthesis, ), ), {, break, ;, }, terms, .?, ., append, (, try, self, ., type_expr, (, ), ), catch, unreachable, ;, }, if, (, terms, ), |, terms_list, |, {, return, Type_AST, ., create_tuple_type, (, firsttoken_, .?, ,, terms_list, ,, self, ., allocator, ), ;, }, else, {, return, exp, ;, }, }, fn, type_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, Type_AST, {, return, self, ., function_type_expr, (, ), ;, }, fn, function_type_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, Type_AST, {, var, exp, =, try, self, ., error_type_expr, (, ), ;, while, (, self, ., accept, (, ., skinny_arrow, ), orelse, self, ., accept, (, ., variadic, ), ), |, token, |, {, var, variadic, =, false, ;, if, (, token, ., kind, ==, ., variadic, ), {, _, =, try, self, ., expect, (, ., skinny_arrow, ), ;, variadic, =, true, ;, }, const, codomain, =, try, self, ., error_type_expr, (, ), ;, var, contexts, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ;, if, (, self, ., accept, (, ., with, ), !=, null, ), {, const, context, =, try, self, ., type_expr, (, ), ;, try, contexts, ., append, (, Type_AST, ., create_addr_of_type, (, context, ., token, (, ), ,, context, ,, false, ,, false, ,, self, ., allocator, ), ), ;, }, if, (, exp, .*, ==, ., tuple_type, ), {, exp, =, Type_AST, ., create_function, (, token, ,, exp, ., tuple_type, ., _terms, ,, codomain, ,, contexts, ,, self, ., allocator, ), ;, }, else, if, (, exp, .*, ==, ., unit_type, ), {, const, args, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ;, exp, =, Type_AST, ., create_function, (, token, ,, args, ,, codomain, ,, contexts, ,, self, ., allocator, ), ;, }, else, {, var, args, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ;, try, args, ., append, (, exp, ), ;, exp, =, Type_AST, ., create_function, (, token, ,, args, ,, codomain, ,, contexts, ,, self, ., allocator, ), ;, }, exp, ., function, ., variadic, =, variadic, ;, }, return, exp, ;, }, fn, error_type_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, Type_AST, {, var, exp, =, try, self, ., prefix_type_expr, (, ), ;, while, (, true, ), {, if, (, self, ., accept, (, ., exclamation_mark, ), ), |, _, |, {, exp, =, Type_AST, ., create_error_type, (, exp, ,, try, self, ., prefix_type_expr, (, ), ,, self, ., allocator, ), ;, }, else, {, return, exp, ;, }, }, }, fn, prefix_type_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, Type_AST, {, if, (, self, ., accept, (, ., ampersand, ), ), |, token, |, {, const, mut, =, self, ., accept, (, ., mut, ), ;, if, (, self, ., accept, (, ., dyn, ), ), |, token2, |, {, return, Type_AST, ., create_dyn_type, (, token2, ,, try, self, ., type_expr, (, ), ,, mut, !=, null, ,, self, ., allocator, ,, ), ;, }, else, {, return, Type_AST, ., create_addr_of_type, (, token, ,, try, self, ., prefix_type_expr, (, ), ,, mut, !=, null, ,, false, ,, self, ., allocator, ), ;, }, }, else, if, (, self, ., accept, (, ., at_symbol, ), ), |, _, |, {, const, token, =, try, self, ., expect, (, ., identifier, ), ;, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "typeof", ), ), {, const, args, =, try, self, ., call_args, (, ), ;, if, (, args, ., items, ., len, !=, 1, ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_arity, =, ., {, ., span, =, token, ., span, ,, ., takes, =, 1, ,, ., given, =, args, ., items, ., len, ,, ., thing_name, =, "built-in function", ,, ., takes_name, =, "parameter", ,, ., given_name, =, "argument", ,, }, }, ), ;, return, error, ., ParseError, ;, }, return, Type_AST, ., create_type_of, (, token, ,, args, ., items, [, 0, ], ,, self, ., allocator, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "Untagged", ), ), {, const, args, =, try, self, ., call_type_args_range, (, 1, ,, 1, ), ;, return, Type_AST, ., create_untagged_sum_type, (, token, ,, args, ., items, [, 0, ], ,, self, ., allocator, ), ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., msg, =, "unknown built-in function", ,, ., span, =, token, ., span, }, }, ), ;, return, error, ., ParseError, ;, }, }, else, if, (, self, ., accept, (, ., left_square, ), ), |, token, |, {, var, slice_kind, :, enum, {, multiptr, ,, array, ,, slice, }, =, undefined, ;, var, mut, =, false, ;, var, len, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., star, ), ), |, _, |, {, slice_kind, =, ., multiptr, ;, }, else, if, (, self, ., next_is_expr, (, ), ), {, slice_kind, =, ., array, ;, len, =, try, self, ., bool_expr, (, ), ;, if, (, !, len, .?, ., is_comptime_expr, (, ), ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., comptime_known, =, ., {, ., span, =, len, .?, ., token, (, ), ., span, ,, ., what, =, "array lengths", }, }, ), ;, return, error, ., ParseError, ;, }, }, else, {, slice_kind, =, ., slice, ;, }, if, (, self, ., accept, (, ., mut, ), ), |, _, |, {, mut, =, true, ;, }, if, (, self, ., peek_kind, (, ., right_square, ), ), {, _, =, self, ., expect, (, ., right_square, ), catch, {, }, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., missing_close, =, ., {, ., expected, =, ., right_square, ,, ., got, =, self, ., peek, (, ), ,, ., open, =, token, }, }, ), ;, return, error, ., ParseError, ;, }, switch, (, slice_kind, ), {, ., multiptr, =>, return, Type_AST, ., create_addr_of_type, (, token, ,, try, self, ., prefix_type_expr, (, ), ,, mut, ,, true, ,, self, ., allocator, ), ,, ., slice, =>, return, Type_AST, ., create_slice_type, (, try, self, ., prefix_type_expr, (, ), ,, mut, ,, self, ., allocator, ), ,, ., array, =>, return, Type_AST, ., create_array_of, (, token, ,, try, self, ., prefix_type_expr, (, ), ,, len, .?, ,, self, ., allocator, ), ,, }, }, else, if, (, self, ., accept, (, ., question_mark, ), ), |, _, |, {, return, Type_AST, ., create_optional_type, (, try, self, ., prefix_type_expr, (, ), ,, self, ., allocator, ), ;, }, else, {, return, try, self, ., postfix_type_expr, (, ), ;, }, }, fn, postfix_type_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, Type_AST, {, var, exp, =, try, self, ., terminal_type_expr, (, ), ;, var, val_access, :, ?, *, ast_, ., AST, =, null, ;, while, (, true, ), {, if, (, self, ., accept, (, ., double_colon, ), ), |, token, |, {, if, (, val_access, ==, null, ), {, if, (, exp, .*, !=, ., identifier, ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "identifier", ,, ., got, =, exp, ., token, (, ), }, }, ), ;, return, Parser_Error_Enum, ., ParseError, ;, }, val_access, =, ast_, ., AST, ., create_identifier, (, exp, ., token, (, ), ,, self, ., allocator, ), ;, }, val_access, =, ast_, ., AST, ., create_access, (, token, ,, val_access, .?, ,, ast_, ., AST, ., create_field, (, try, self, ., expect, (, ., identifier, ), ,, self, ., allocator, ), ,, self, ., allocator, ,, ), ;, }, else, if, (, self, ., peek_kind, (, ., left_square, ), ), {, const, args, =, try, self, ., generics_args, (, ), ;, exp, =, Type_AST, ., create_generic_apply_type, (, exp, ., token, (, ), ,, exp, ,, args, ,, self, ., allocator, ), ;, }, else, {, if, (, val_access, ), |, val, |, {, return, Type_AST, ., create_type_access, (, val, ., token, (, ), ,, val, ,, self, ., allocator, ), ;, }, return, exp, ;, }, }, }, fn, terminal_type_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, Type_AST, {, if, (, self, ., accept, (, ., identifier, ), ), |, token, |, {, return, Type_AST, ., create_type_identifier, (, token, ,, self, ., allocator, ), ;, }, else, if, (, self, ., peek_kind, (, ., left_parenthesis, ), ), {, return, try, self, ., paren_type_expr, (, ), ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "a type here", ,, ., got, =, self, ., peek, (, ), }, }, ), ;, return, Parser_Error_Enum, ., ParseError, ;, }, }, fn, paren_type_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, Type_AST, {, const, token, =, try, self, ., expect, (, ., left_parenthesis, ), ;, var, exp, :, ?, *, Type_AST, =, null, ;, if, (, self, ., next_is_expr, (, ), ), {, exp, =, try, self, ., product_type_expr, (, ), ;, }, if, (, self, ., peek_kind, (, ., right_parenthesis, ), ), {, _, =, self, ., expect, (, ., right_parenthesis, ), catch, {, }, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., missing_close, =, ., {, ., expected, =, ., right_parenthesis, ,, ., got, =, self, ., peek, (, ), ,, ., open, =, token, }, }, ), ;, return, error, ., ParseError, ;, }, return, exp, orelse, Type_AST, ., create_unit_type, (, token, ,, self, ., allocator, ), ;, }, fn, const_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., @, "const", ), ;, const, identifier, =, try, self, ., expect, (, ., identifier, ), ;, const, pattern, =, ast_, ., AST, ., create_pattern_symbol, (, identifier, ,, ., @, "const", ,, ., local, ,, identifier, ., data, ,, self, ., allocator, ), ;, var, _type, :, ?, *, Type_AST, =, null, ;, var, _init, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., single_colon, ), ), |, _, |, {, _type, =, try, self, ., type_expr, (, ), ;, if, (, self, ., peek_kind, (, ., single_equals, ), ), {, _, =, try, self, ., expect, (, ., single_equals, ), ;, const, inner_expr, =, try, self, ., bool_expr, (, ), ;, _init, =, ast_, ., AST, ., create_comptime, (, inner_expr, ., token, (, ), ,, inner_expr, ,, self, ., allocator, ), ;, }, }, else, if, (, self, ., accept, (, ., single_equals, ), ), |, _, |, {, const, inner_expr, =, try, self, ., bool_expr, (, ), ;, _init, =, ast_, ., AST, ., create_comptime, (, inner_expr, ., token, (, ), ,, inner_expr, ,, self, ., allocator, ), ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, self, ., peek, (, ), ., span, ,, ., msg, =, "variable declarations require at least a type or an intial value", ,, }, }, ), ;, return, error, ., ParseError, ;, }, return, ast_, ., AST, ., create_binding, (, token, ,, pattern, ,, _type, orelse, Type_AST, ., create_type_of, (, _init, .?, ., token, (, ), ,, _init, .?, ,, self, ., allocator, ), ,, _init, orelse, ast_, ., AST, ., create_default, (, _type, .?, ., token, (, ), ,, _type, .?, ,, self, ., allocator, ), ,, self, ., allocator, ,, ), ;, }, fn, let_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., let, ), ;, const, ident, =, try, self, ., let_pattern_atom, (, ), ;, var, _type, :, ?, *, Type_AST, =, null, ;, var, _init, :, ?, *, ast_, ., AST, =, null, ;, var, is_undefined, =, false, ;, if, (, self, ., accept, (, ., single_colon, ), ), |, _, |, {, _type, =, try, self, ., type_expr, (, ), ;, if, (, self, ., peek_kind, (, ., single_equals, ), ), {, _, =, try, self, ., expect, (, ., single_equals, ), ;, if, (, self, ., accept, (, ., undefined, ), ), |, _, |, {, is_undefined, =, true, ;, }, else, {, _init, =, try, self, ., bool_expr, (, ), ;, }, }, }, else, if, (, self, ., accept, (, ., single_equals, ), ), |, _, |, {, _init, =, try, self, ., bool_expr, (, ), ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, self, ., peek, (, ), ., span, ,, ., msg, =, "variable declarations require at least a type or an intial value", ,, }, }, ), ;, return, error, ., ParseError, ;, }, return, ast_, ., AST, ., create_binding, (, token, ,, ident, ,, _type, orelse, Type_AST, ., create_type_of, (, _init, .?, ., token, (, ), ,, _init, .?, ,, self, ., allocator, ), ,, _init, orelse, if, (, is_undefined, ), null, else, ast_, ., AST, ., create_default, (, _type, .?, ., token, (, ), ,, _type, .?, ,, self, ., allocator, ), ,, self, ., allocator, ,, ), ;, }, fn, let_pattern_atom, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, if, (, self, ., peek_kind, (, ., mut, ), or, self, ., peek_kind, (, ., @, "const", ), or, self, ., peek_kind, (, ., identifier, ), ), {, var, kind, :, Symbol, ., Kind, =, undefined, ;, if, (, self, ., accept, (, ., mut, ), !=, null, ), {, kind, =, ., mut, ;, }, else, if, (, self, ., accept, (, ., @, "const", ), !=, null, ), {, kind, =, ., @, "const", ;, }, else, {, kind, =, ., let, ;, }, const, identifier, =, try, self, ., expect, (, ., identifier, ), ;, return, ast_, ., AST, ., create_pattern_symbol, (, identifier, ,, kind, ,, ., local, ,, identifier, ., data, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., left_parenthesis, ), ), |, _, |, {, const, res, =, try, self, ., tuple_value, (, Self, ., let_pattern_atom, ), ;, _, =, try, self, ., expect, (, ., right_parenthesis, ), ;, return, res, ;, }, else, if, (, self, ., accept, (, ., left_square, ), ), |, _, |, {, const, res, =, try, self, ., let_pattern_array, (, ), ;, _, =, try, self, ., expect, (, ., right_square, ), ;, return, res, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "a pattern expression here", ,, ., got, =, self, ., peek, (, ), }, }, ), ;, return, Parser_Error_Enum, ., ParseError, ;, }, }, fn, let_pattern_array, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, exp, =, try, self, ., let_pattern_atom, (, ), ;, var, terms, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, terms, ., append, (, exp, ), catch, unreachable, ;, const, first_token, :, Token, =, self, ., peek, (, ), ;, while, (, self, ., accept, (, ., comma, ), ), |, _, |, {, terms, ., append, (, try, self, ., let_pattern_atom, (, ), ), catch, unreachable, ;, }, return, ast_, ., AST, ., create_array_value, (, first_token, ,, terms, ,, self, ., allocator, ), ;, }, fn, let_pre, (, self, :, *, Self, ), Parser_Error_Enum, !, ?, *, ast_, ., AST, {, var, retval, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., peek_kind, (, ., let, ), ), {, retval, =, try, self, ., let_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "const", ), ), {, retval, =, try, self, ., const_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "extern", ), ), {, retval, =, try, self, ., extern_const_declaration, (, ), ;, }, if, (, retval, !=, null, ), {, if, (, self, ., peek_kind, (, ., semicolon, ), ), {, _, =, self, ., expect, (, ., semicolon, ), catch, {, }, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "a semicolon here", ,, ., got, =, self, ., peek, (, ), ,, }, }, ), ;, return, error, ., ParseError, ;, }, }, return, retval, ;, }, fn, statement, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, if, (, self, ., peek_kind, (, ., let, ), ), {, return, self, ., let_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "const", ), ), {, return, self, ., const_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "extern", ), ), {, return, self, ., extern_const_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "struct", ), ), {, return, self, ., struct_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., context, ), ), {, return, self, ., context_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "enum", ), ), {, return, self, ., enum_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., type, ), ), {, return, self, ., type_alias_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., trait, ), ), {, return, self, ., trait_declaration, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., impl, ), ), {, return, self, ., impl_declaration, (, ), ;, }, else, if, (, self, ., accept, (, ., @, "defer", ), ), |, token, |, {, return, ast_, ., AST, ., create_defer, (, token, ,, try, self, ., assignment_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., @, "errdefer", ), ), |, token, |, {, return, ast_, ., AST, ., create_errdefer, (, token, ,, try, self, ., assignment_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., next_is_expr, (, ), ), {, return, self, ., assignment_expr, (, ), ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "a statement here", ,, ., got, =, self, ., peek, (, ), }, }, ), ;, return, Parser_Error_Enum, ., ParseError, ;, }, }, pub, fn, parse_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, return, self, ., tuple_value, (, Self, ., bool_expr, ), ;, }, fn, assignment_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, exp, =, try, self, ., bool_expr, (, ), ;, if, (, self, ., accept, (, ., single_equals, ), ), |, token, |, {, return, ast_, ., AST, ., create_assign, (, token, ,, exp, ,, try, self, ., bool_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., next_is_compound_assign, (, ), ), {, const, token, =, self, ., pop, (, ), ;, return, ast_, ., AST, ., create_assign, (, token, ,, exp, ,, ast_, ., AST, ., create_binop, (, token, ,, exp, ,, try, self, ., bool_expr, (, ), ,, self, ., allocator, ), ,, self, ., allocator, ), ;, }, else, {, return, exp, ;, }, }, fn, bool_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, var, exp, =, try, self, ., comparison_expr, (, ), ;, while, (, true, ), {, if, (, self, ., accept, (, ., @, "and", ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_and, (, token, ,, exp, ,, try, self, ., comparison_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., @, "or", ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_or, (, token, ,, exp, ,, try, self, ., comparison_expr, (, ), ,, self, ., allocator, ), ;, }, else, {, return, exp, ;, }, }, }, fn, comparison_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, var, exp, =, try, self, ., coalesce_expr, (, ), ;, if, (, self, ., accept, (, ., double_equals, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_equal, (, token, ,, exp, ,, try, self, ., coalesce_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., e_mark_equals, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_not_equal, (, token, ,, exp, ,, try, self, ., coalesce_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., greater, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_greater, (, token, ,, exp, ,, try, self, ., coalesce_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., lesser, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_lesser, (, token, ,, exp, ,, try, self, ., coalesce_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., greater_equal, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_greater_equal, (, token, ,, exp, ,, try, self, ., coalesce_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., lesser_equal, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_lesser_equal, (, token, ,, exp, ,, try, self, ., coalesce_expr, (, ), ,, self, ., allocator, ), ;, }, return, exp, ;, }, fn, coalesce_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, var, exp, =, try, self, ., int_expr, (, ), ;, while, (, true, ), {, if, (, self, ., accept, (, ., @, "catch", ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_catch, (, token, ,, exp, ,, try, self, ., int_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., @, "orelse", ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_orelse, (, token, ,, exp, ,, try, self, ., int_expr, (, ), ,, self, ., allocator, ), ;, }, else, {, return, exp, ;, }, }, }, fn, int_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, var, exp, =, try, self, ., term_expr, (, ), ;, while, (, true, ), {, if, (, self, ., accept, (, ., plus, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_add, (, token, ,, exp, ,, try, self, ., term_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., minus, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_sub, (, token, ,, exp, ,, try, self, ., term_expr, (, ), ,, self, ., allocator, ), ;, }, else, {, return, exp, ;, }, }, }, fn, term_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, var, exp, =, try, self, ., as_expr, (, ), ;, while, (, true, ), {, if, (, self, ., accept, (, ., star, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_mult, (, token, ,, exp, ,, try, self, ., as_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., slash, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_div, (, token, ,, exp, ,, try, self, ., as_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., percent, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_mod, (, token, ,, exp, ,, try, self, ., as_expr, (, ), ,, self, ., allocator, ), ;, }, else, {, return, exp, ;, }, }, }, fn, as_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, exp, =, try, self, ., prefix_expr, (, ), ;, if, (, self, ., accept, (, ., as, ), ), |, token, |, {, return, ast_, ., AST, ., create_as, (, token, ,, exp, ,, try, self, ., type_expr, (, ), ,, self, ., allocator, ), ;, }, else, {, return, exp, ;, }, }, fn, prefix_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, if, (, self, ., accept, (, ., not, ), ), |, token, |, {, return, ast_, ., AST, ., create_not, (, token, ,, try, self, ., prefix_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., at_symbol, ), ), |, _, |, {, const, token, =, try, self, ., expect, (, ., identifier, ), ;, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "default", ), ), {, const, args, =, try, self, ., call_type_args_range, (, 1, ,, 1, ), ;, return, ast_, ., AST, ., create_default, (, token, ,, args, ., items, [, 0, ], ,, self, ., allocator, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "sizeof", ), ), {, const, args, =, try, self, ., call_type_args_range, (, 1, ,, 1, ), ;, return, ast_, ., AST, ., create_size_of, (, token, ,, args, ., items, [, 0, ], ,, self, ., allocator, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "write", ), ), {, const, args, =, try, self, ., call_args_range, (, 2, ,, 2, ), ;, const, writer, =, args, ., items, [, 0, ], ;, const, fmt_str, =, args, ., items, [, 1, ], ;, var, fmt_string_parser, =, Fmt_String, ., init, (, fmt_str, ,, self, ., errors, ,, self, ., allocator, ), ;, const, children, =, try, fmt_string_parser, ., parse_fmt_string, (, ), ;, return, ast_, ., AST, ., create_write, (, token, ,, writer, ,, children, ,, self, ., allocator, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "print", ), ), {, const, args, =, try, self, ., call_args_range, (, 1, ,, 1, ), ;, const, fmt_str, =, args, ., items, [, 0, ], ;, var, fmt_string_parser, =, Fmt_String, ., init, (, fmt_str, ,, self, ., errors, ,, self, ., allocator, ), ;, const, children, =, try, fmt_string_parser, ., parse_fmt_string, (, ), ;, return, ast_, ., AST, ., create_print, (, token, ,, children, ,, self, ., allocator, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "println", ), ), {, const, args, =, try, self, ., call_args_range, (, 1, ,, 1, ), ;, const, fmt_str, =, args, ., items, [, 0, ], ;, var, fmt_string_parser, =, Fmt_String, ., init, (, fmt_str, ,, self, ., errors, ,, self, ., allocator, ), ;, var, children, =, try, fmt_string_parser, ., parse_fmt_string, (, ), ;, try, children, ., append, (, ast_, ., AST, ., create_string, (, token, ,, "\n", ,, self, ., allocator, ), ), ;, return, ast_, ., AST, ., create_print, (, token, ,, children, ,, self, ., allocator, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "bit_and", ), ), {, const, args, =, try, self, ., call_args_range, (, 2, ,, std, ., math, ., maxInt, (, usize, ), ), ;, return, ast_, ., AST, ., create_bit_and, (, token, ,, args, ,, self, ., allocator, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "bit_or", ), ), {, const, args, =, try, self, ., call_args_range, (, 2, ,, std, ., math, ., maxInt, (, usize, ), ), ;, return, ast_, ., AST, ., create_bit_or, (, token, ,, args, ,, self, ., allocator, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "bit_xor", ), ), {, const, args, =, try, self, ., call_args_range, (, 2, ,, std, ., math, ., maxInt, (, usize, ), ), ;, return, ast_, ., AST, ., create_bit_xor, (, token, ,, args, ,, self, ., allocator, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "bit_not", ), ), {, const, args, =, try, self, ., call_args_range, (, 1, ,, 1, ), ;, return, ast_, ., AST, ., create_bit_not, (, token, ,, args, ., items, [, 0, ], ,, self, ., allocator, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "left_shift", ), ), {, const, args, =, try, self, ., call_args_range, (, 2, ,, 2, ), ;, return, ast_, ., AST, ., create_left_shift, (, token, ,, args, ., items, [, 0, ], ,, args, ., items, [, 1, ], ,, self, ., allocator, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, token, ., data, ,, "right_shift", ), ), {, const, args, =, try, self, ., call_args_range, (, 2, ,, 2, ), ;, return, ast_, ., AST, ., create_right_shift, (, token, ,, args, ., items, [, 0, ], ,, args, ., items, [, 1, ], ,, self, ., allocator, ), ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., msg, =, "unknown built-in function", ,, ., span, =, token, ., span, }, }, ), ;, return, error, ., ParseError, ;, }, }, else, if, (, self, ., accept, (, ., minus, ), ), |, token, |, {, return, ast_, ., AST, ., create_negate, (, token, ,, try, self, ., prefix_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., ampersand, ), ), |, token, |, {, const, mut, =, self, ., accept, (, ., mut, ), ;, return, ast_, ., AST, ., create_addr_of, (, token, ,, try, self, ., prefix_expr, (, ), ,, mut, !=, null, ,, false, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., left_square, ), ), |, token, |, {, if, (, self, ., accept, (, ., mut, ), ), |, _, |, {, _, =, try, self, ., expect, (, ., right_square, ), ;, return, ast_, ., AST, ., create_slice_of, (, token, ,, try, self, ., prefix_expr, (, ), ,, true, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., right_square, ), ), |, _, |, {, return, ast_, ., AST, ., create_slice_of, (, token, ,, try, self, ., prefix_expr, (, ), ,, false, ,, self, ., allocator, ), ;, }, var, terms, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, if, (, self, ., accept, (, ., comma, ), ==, null, ), {, terms, ., append, (, try, self, ., bool_expr, (, ), ), catch, unreachable, ;, self, ., newlines, (, ), ;, while, (, self, ., accept, (, ., comma, ), ), |, _, |, {, self, ., newlines, (, ), ;, if, (, self, ., peek_kind, (, ., right_square, ), ), {, break, ;, }, terms, ., append, (, try, self, ., bool_expr, (, ), ), catch, unreachable, ;, self, ., newlines, (, ), ;, }, }, _, =, try, self, ., expect, (, ., right_square, ), ;, return, ast_, ., AST, ., create_array_value, (, token, ,, terms, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., @, "try", ), ), |, token, |, {, return, ast_, ., AST, ., create_try, (, token, ,, try, self, ., parse_expr, (, ), ,, self, ., allocator, ), ;, }, else, {, return, try, self, ., postfix_expr, (, ), ;, }, }, fn, postfix_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, var, exp, =, if, (, self, ., next_is_control_flow, (, ), ), try, self, ., control_flow, (, ), else, try, self, ., factor, (, ), ;, while, (, true, ), {, if, (, self, ., peek_kind, (, ., left_parenthesis, ), ), {, exp, =, ast_, ., AST, ., create_call, (, self, ., peek, (, ), ,, exp, ,, try, self, ., call_args, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., left_square, ), ), |, token, |, {, var, first, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., next_is_expr, (, ), ), {, first, =, try, self, ., assignment_expr, (, ), ;, }, if, (, self, ., accept, (, ., double_period, ), ), |, _, |, {, var, second, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., next_is_expr, (, ), ), {, second, =, try, self, ., assignment_expr, (, ), ;, }, exp, =, ast_, ., AST, ., create_sub_slice, (, token, ,, exp, ,, first, ,, second, ,, self, ., allocator, ), ;, }, else, {, var, children, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, children, ., append, (, first, orelse, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "an expression here", ,, ., got, =, self, ., peek, (, ), ,, }, }, ), ;, return, Parser_Error_Enum, ., ParseError, ;, }, ), catch, unreachable, ;, while, (, self, ., accept, (, ., comma, ), ), |, _, |, {, children, ., append, (, try, self, ., assignment_expr, (, ), ), catch, unreachable, ;, }, exp, =, ast_, ., AST, ., create_index, (, token, ,, exp, ,, children, ,, self, ., allocator, ), ;, }, if, (, self, ., peek_kind, (, ., right_square, ), ), {, _, =, self, ., expect, (, ., right_square, ), catch, {, }, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., missing_close, =, ., {, ., expected, =, ., right_square, ,, ., got, =, self, ., peek, (, ), ,, ., open, =, token, }, }, ), ;, return, error, ., ParseError, ;, }, }, else, if, (, self, ., accept, (, ., period, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_select, (, token, ,, exp, ,, ast_, ., AST, ., create_field, (, try, self, ., expect, (, ., identifier, ), ,, self, ., allocator, ), ,, self, ., allocator, ,, ), ;, }, else, if, (, self, ., accept, (, ., double_colon, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_access, (, token, ,, exp, ,, ast_, ., AST, ., create_field, (, try, self, ., expect, (, ., identifier, ), ,, self, ., allocator, ), ,, self, ., allocator, ,, ), ;, }, else, if, (, self, ., accept, (, ., invoke, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_invoke, (, token, ,, exp, ,, ast_, ., AST, ., create_field, (, try, self, ., expect, (, ., identifier, ), ,, self, ., allocator, ), ,, try, self, ., call_args, (, ), ,, self, ., allocator, ,, ), ;, }, else, if, (, self, ., accept, (, ., caret, ), ), |, token, |, {, exp, =, ast_, ., AST, ., create_dereference, (, token, ,, exp, ,, self, ., allocator, ), ;, }, else, {, return, exp, ;, }, }, }, fn, call_args, (, self, :, *, Self, ), Parser_Error_Enum, !, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, _, =, try, self, ., expect, (, ., left_parenthesis, ), ;, var, retval, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, if, (, !, self, ., peek_kind, (, ., right_parenthesis, ), ), {, retval, ., append, (, try, self, ., assignment_expr, (, ), ), catch, unreachable, ;, while, (, self, ., accept, (, ., comma, ), ), |, _, |, {, if, (, self, ., peek_kind, (, ., right_parenthesis, ), ), {, break, ;, }, retval, ., append, (, try, self, ., assignment_expr, (, ), ), catch, unreachable, ;, }, }, _, =, try, self, ., expect, (, ., right_parenthesis, ), ;, return, retval, ;, }, fn, call_args_range, (, self, :, *, Self, ,, lower, :, usize, ,, upper, :, usize, ), Parser_Error_Enum, !, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, const, prev_token, =, self, ., peek, (, ), ;, const, args, =, try, self, ., call_args, (, ), ;, if, (, upper, <, args, ., items, ., len, or, args, ., items, ., len, <, lower, ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_arity, =, ., {, ., span, =, if, (, args, ., items, ., len, ==, 0, ), prev_token, ., span, else, args, ., items, [, 0, ], ., token, (, ), ., span, ,, ., takes, =, upper, ,, ., given, =, args, ., items, ., len, ,, ., thing_name, =, "built-in function", ,, ., takes_name, =, "parameter", ,, ., given_name, =, "argument", ,, }, }, ), ;, return, error, ., ParseError, ;, }, else, {, return, args, ;, }, }, fn, generics_args, (, self, :, *, Self, ), Parser_Error_Enum, !, std, ., array_list, ., Managed, (, *, Type_AST, ), {, _, =, try, self, ., expect, (, ., left_square, ), ;, var, retval, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ;, retval, ., append, (, try, self, ., type_expr, (, ), ), catch, unreachable, ;, while, (, self, ., accept, (, ., comma, ), ), |, _, |, {, if, (, self, ., peek_kind, (, ., right_square, ), ), {, break, ;, }, retval, ., append, (, try, self, ., type_expr, (, ), ), catch, unreachable, ;, }, _, =, try, self, ., expect, (, ., right_square, ), ;, return, retval, ;, }, fn, call_type_args, (, self, :, *, Self, ), Parser_Error_Enum, !, std, ., array_list, ., Managed, (, *, Type_AST, ), {, _, =, try, self, ., expect, (, ., left_parenthesis, ), ;, var, retval, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ;, if, (, !, self, ., peek_kind, (, ., right_parenthesis, ), ), {, retval, ., append, (, try, self, ., type_expr, (, ), ), catch, unreachable, ;, while, (, self, ., accept, (, ., comma, ), ), |, _, |, {, retval, ., append, (, try, self, ., type_expr, (, ), ), catch, unreachable, ;, }, }, _, =, try, self, ., expect, (, ., right_parenthesis, ), ;, return, retval, ;, }, fn, call_type_args_range, (, self, :, *, Self, ,, lower, :, usize, ,, upper, :, usize, ), Parser_Error_Enum, !, std, ., array_list, ., Managed, (, *, Type_AST, ), {, const, prev_token, =, self, ., peek, (, ), ;, const, args, =, try, self, ., call_type_args, (, ), ;, if, (, upper, <, args, ., items, ., len, or, args, ., items, ., len, <, lower, ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_arity, =, ., {, ., span, =, if, (, args, ., items, ., len, ==, 0, ), prev_token, ., span, else, args, ., items, [, 0, ], ., token, (, ), ., span, ,, ., takes, =, upper, ,, ., given, =, args, ., items, ., len, ,, ., thing_name, =, "built-in function", ,, ., takes_name, =, "parameter", ,, ., given_name, =, "argument", ,, }, }, ), ;, return, error, ., ParseError, ;, }, else, {, return, args, ;, }, }, fn, control_flow, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, if, (, self, ., peek_kind, (, ., @, "if", ), ), {, return, try, self, ., if_expr, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "while", ), ), {, return, try, self, ., while_expr, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., match, ), ), {, return, try, self, ., match_expr, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "for", ), ), {, return, try, self, ., for_expr, (, ), ;, }, else, if, (, self, ., accept, (, ., @, "comptime", ), ), |, token, |, {, return, ast_, ., AST, ., create_comptime, (, token, ,, try, self, ., block_expr, (, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., peek_kind, (, ., with, ), ), {, return, try, self, ., with_expr, (, ), ;, }, else, {, return, try, self, ., factor, (, ), ;, }, }, fn, factor, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, if, (, self, ., accept, (, ., identifier, ), ), |, token, |, {, return, ast_, ., AST, ., create_identifier, (, token, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., self, ), ), |, token, |, {, return, ast_, ., AST, ., create_identifier, (, token, ,, self, ., allocator, ), ;, }, else, if, (, self, ., peek_kind, (, ., @, "fn", ), ), {, return, self, ., fn_declaration, (, ), ;, }, else, if, (, self, ., accept, (, ., period, ), ), |, _, |, {, const, sum_val, =, ast_, ., AST, ., create_enum_value, (, try, self, ., expect, (, ., identifier, ), ,, self, ., allocator, ), ;, if, (, self, ., accept, (, ., left_parenthesis, ), !=, null, ), {, if, (, !, self, ., peek_kind, (, ., right_parenthesis, ), ), {, sum_val, ., enum_value, ., init, =, try, self, ., assignment_expr, (, ), ;, }, _, =, try, self, ., expect, (, ., right_parenthesis, ), ;, }, return, sum_val, ;, }, else, if, (, self, ., accept, (, ., @, "unreachable", ), ), |, token, |, {, return, ast_, ., AST, ., create_unreachable, (, token, ,, self, ., allocator, ), ;, }, else, {, return, self, ., literal, (, ), ;, }, }, fn, literal, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, if, (, self, ., accept, (, ., true, ), ), |, token, |, {, return, ast_, ., AST, ., create_true, (, token, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., false, ), ), |, token, |, {, return, ast_, ., AST, ., create_false, (, token, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., dec_int, ), ), |, token, |, {, return, ast_, ., AST, ., create_int, (, token, ,, std, ., fmt, ., parseInt, (, i128, ,, token, ., data, ,, 10, ), catch, return, error, ., ParseError, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., hex_int, ), ), |, token, |, {, return, ast_, ., AST, ., create_int, (, token, ,, std, ., fmt, ., parseInt, (, i128, ,, token, ., data, [, 2.., ], ,, 16, ), catch, return, error, ., ParseError, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., oct_int, ), ), |, token, |, {, return, ast_, ., AST, ., create_int, (, token, ,, std, ., fmt, ., parseInt, (, i128, ,, token, ., data, [, 2.., ], ,, 8, ), catch, return, error, ., ParseError, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., bin_int, ), ), |, token, |, {, return, ast_, ., AST, ., create_int, (, token, ,, std, ., fmt, ., parseInt, (, i128, ,, token, ., data, [, 2.., ], ,, 2, ), catch, return, error, ., ParseError, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., float, ), ), |, token, |, {, return, ast_, ., AST, ., create_float, (, token, ,, std, ., fmt, ., parseFloat, (, f64, ,, token, ., data, ), catch, return, error, ., ParseError, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., char, ), ), |, token, |, {, var, codepoint, :, u21, =, undefined, ;, switch, (, token, ., data, [, 1, ], ), {, '\\', =>, switch, (, token, ., data, [, 2, ], ), {, 'n', =>, codepoint, =, 0x0A, ,, 'r', =>, codepoint, =, 0x0D, ,, 't', =>, codepoint, =, 0x09, ,, '\\', =>, codepoint, =, 0x5C, ,, '\'', =>, codepoint, =, 0x27, ,, '"', =>, codepoint, =, 0x22, ,, else, =>, return, error, ., ParseError, ,, }, ,, else, =>, {, const, num_bytes, =, std, ., unicode, ., utf8ByteSequenceLength, (, token, ., data, [, 1, ], ), catch, return, error, ., ParseError, ;, codepoint, =, std, ., unicode, ., utf8Decode, (, token, ., data, [, 1, .., num_bytes, +, 1, ], ), catch, return, error, ., ParseError, ;, }, ,, }, return, ast_, ., AST, ., create_int, (, token, ,, codepoint, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., string, ), ), |, token, |, {, return, ast_, ., AST, ., create_string, (, token, ,, resolve_escapes, (, token, ., data, [, 1, .., token, ., data, ., len, -, 1, ], ,, self, ., allocator, ), ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., multi_line_string, ), ), |, token, |, {, return, ast_, ., AST, ., create_string, (, token, ,, token, ., data, ,, self, ., allocator, ), ;, }, else, if, (, self, ., peek_kind, (, ., left_brace, ), ), {, return, try, self, ., block_expr, (, ), ;, }, else, if, (, self, ., peek_kind, (, ., left_parenthesis, ), ), {, return, try, self, ., parens, (, ), ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "an expression here", ,, ., got, =, self, ., peek, (, ), }, }, ), ;, return, Parser_Error_Enum, ., ParseError, ;, }, }, fn, newlines, (, self, :, *, Self, ), void, {, while, (, self, ., accept, (, ., newline, ), ), |, _, |, {, }, }, fn, block_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, bracetoken_, =, try, self, ., expect, (, ., left_brace, ), ;, var, statements, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, self, ., newlines, (, ), ;, if, (, self, ., peek_kind, (, ., right_brace, ), ), {, _, =, self, ., expect, (, ., right_brace, ), catch, {, }, ;, return, ast_, ., AST, ., create_unit_value, (, bracetoken_, ,, self, ., allocator, ), ;, }, while, (, !, self, ., peek_kind, (, ., right_brace, ), and, !, self, ., peek_kind, (, ., @, "break", ), and, !, self, ., peek_kind, (, ., @, "continue", ), and, !, self, ., peek_kind, (, ., @, "return", ), and, !, self, ., peek_kind, (, ., EOF, ), ), {, statements, ., append, (, try, self, ., statement, (, ), ), catch, unreachable, ;, if, (, !, self, ., peek_kind, (, ., semicolon, ), and, !, self, ., peek_kind, (, ., newline, ), and, !, self, ., peek_kind, (, ., right_brace, ), ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "a semicolon or a newline here", ,, ., got, =, self, ., peek, (, ), ,, }, }, ), ;, return, error, ., ParseError, ;, }, _, =, self, ., accept, (, ., semicolon, ), ;, self, ., newlines, (, ), ;, }, self, ., newlines, (, ), ;, var, final, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., @, "break", ), ), |, token, |, {, final, =, ast_, ., AST, ., create_break, (, token, ,, self, ., allocator, ), ;, self, ., newlines, (, ), ;, }, else, if, (, self, ., accept, (, ., @, "continue", ), ), |, token, |, {, final, =, ast_, ., AST, ., create_continue, (, token, ,, self, ., allocator, ), ;, self, ., newlines, (, ), ;, }, else, if, (, self, ., accept, (, ., @, "return", ), ), |, token, |, {, var, exp, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., next_is_expr, (, ), ), {, exp, =, try, self, ., assignment_expr, (, ), ;, }, final, =, ast_, ., AST, ., create_return, (, token, ,, exp, ,, self, ., allocator, ), ;, self, ., newlines, (, ), ;, }, if, (, self, ., peek_kind, (, ., right_brace, ), ), {, _, =, self, ., expect, (, ., right_brace, ), catch, {, }, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., missing_close, =, ., {, ., expected, =, ., right_brace, ,, ., got, =, self, ., peek, (, ), ,, ., open, =, bracetoken_, }, }, ), ;, return, error, ., ParseError, ;, }, return, ast_, ., AST, ., create_block, (, bracetoken_, ,, statements, ,, final, ,, self, ., allocator, ), ;, }, fn, if_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., @, "if", ), ;, const, let, :, ?, *, ast_, ., AST, =, try, self, ., let_pre, (, ), ;, const, cond, =, try, self, ., assignment_expr, (, ), ;, const, body_block, =, try, self, ., factor, (, ), ;, var, else_block, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., @, "else", ), ), |, _, |, {, else_block, =, try, self, ., control_flow, (, ), ;, }, return, ast_, ., AST, ., create_if, (, token, ,, let, ,, cond, ,, body_block, ,, else_block, ,, self, ., allocator, ), ;, }, fn, while_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., @, "while", ), ;, const, let, :, ?, *, ast_, ., AST, =, try, self, ., let_pre, (, ), ;, const, cond, =, try, self, ., assignment_expr, (, ), ;, var, post, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., semicolon, ), ), |, _, |, {, post, =, try, self, ., statement, (, ), ;, }, const, body_block, =, try, self, ., block_expr, (, ), ;, var, else_block, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., @, "else", ), ), |, _, |, {, else_block, =, try, self, ., control_flow, (, ), ;, }, return, ast_, ., AST, ., create_while, (, token, ,, let, ,, cond, ,, post, ,, body_block, ,, else_block, ,, self, ., allocator, ), ;, }, fn, with_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., with, ), ;, var, context_list, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, try, context_list, ., append, (, try, self, ., context_param, (, ), ), ;, while, (, self, ., accept, (, ., comma, ), !=, null, ), {, try, context_list, ., append, (, try, self, ., context_param, (, ), ), ;, }, const, body_block, =, try, self, ., block_expr, (, ), ;, return, ast_, ., AST, ., create_with, (, token, ,, context_list, ,, body_block, ,, self, ., allocator, ), ;, }, fn, context_value, (, self, :, *, Self, ,, context_name, :, *, Type_AST, ), Parser_Error_Enum, !, *, ast_, ., AST, {, var, arg_list, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, const, token, =, try, self, ., expect, (, ., left_parenthesis, ), ;, while, (, !, self, ., peek_kind, (, ., right_parenthesis, ), ), {, const, context_decl, =, try, self, ., assignment_expr, (, ), ;, arg_list, ., append, (, context_decl, ), catch, unreachable, ;, if, (, self, ., accept, (, ., comma, ), ==, null, ), {, break, ;, }, }, _, =, try, self, ., expect, (, ., right_parenthesis, ), ;, return, ast_, ., AST, ., create_context_value, (, token, ,, context_name, ,, arg_list, ,, self, ., allocator, ), ;, }, fn, for_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., @, "for", ), ;, const, let, :, ?, *, ast_, ., AST, =, try, self, ., let_pre, (, ), ;, _, =, self, ., accept, (, ., mut, ), ;, const, elem, =, ast_, ., AST, ., create_identifier, (, try, self, ., expect, (, ., identifier, ), ,, self, ., allocator, ), ;, _, =, try, self, ., expect, (, ., in, ), ;, const, iterable, =, try, self, ., assignment_expr, (, ), ;, const, body_block, =, try, self, ., block_expr, (, ), ;, var, else_block, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., @, "else", ), ), |, _, |, {, else_block, =, try, self, ., control_flow, (, ), ;, }, return, ast_, ., AST, ., create_for, (, token, ,, let, ,, elem, ,, iterable, ,, body_block, ,, else_block, ,, self, ., allocator, ), ;, }, fn, fn_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, introducer, =, try, self, ., expect, (, ., @, "fn", ), ;, var, maybe_ident, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., identifier, ), ), |, token, |, {, maybe_ident, =, ast_, ., AST, ., create_identifier, (, token, ,, self, ., allocator, ), ;, }, const, gen_params, =, try, self, ., generic_params_list, (, ), ;, const, params, =, try, self, ., paramlist, (, ), ;, var, ret_type, :, ?, *, Type_AST, =, null, ;, if, (, self, ., accept, (, ., skinny_arrow, ), !=, null, ), {, ret_type, =, try, self, ., type_expr, (, ), ;, }, const, refinement, :, ?, *, ast_, ., AST, =, null, ;, const, contexts_decls, =, try, self, ., context_paramlist, (, ), ;, const, _init, =, try, self, ., block_expr, (, ), ;, return, ast_, ., AST, ., create_fn_decl, (, introducer, ,, maybe_ident, ,, gen_params, ,, params, ,, ret_type, orelse, Type_AST, ., create_unit_type, (, introducer, ,, self, ., allocator, ), ,, contexts_decls, ,, refinement, ,, _init, ,, self, ., allocator, ,, ), ;, }, fn, paramlist, (, self, :, *, Self, ), Parser_Error_Enum, !, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, var, params, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, errdefer, params, ., deinit, (, ), ;, const, token, =, try, self, ., expect, (, ., left_parenthesis, ), ;, if, (, self, ., peek_kind, (, ., mut, ), or, self, ., peek_kind, (, ., left_parenthesis, ), or, self, ., peek_kind, (, ., identifier, ), ), {, params, ., append, (, try, self, ., param, (, ), ), catch, unreachable, ;, while, (, self, ., accept, (, ., comma, ), ), |, _, |, {, params, ., append, (, try, self, ., param, (, ), ), catch, unreachable, ;, }, }, if, (, self, ., peek_kind, (, ., right_parenthesis, ), ), {, _, =, self, ., expect, (, ., right_parenthesis, ), catch, unreachable, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., missing_close, =, ., {, ., expected, =, ., right_parenthesis, ,, ., got, =, self, ., peek, (, ), ,, ., open, =, token, }, }, ), ;, return, error, ., ParseError, ;, }, return, params, ;, }, fn, param, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, var, kind, :, Symbol, ., Kind, =, undefined, ;, if, (, self, ., accept, (, ., mut, ), !=, null, ), {, kind, =, ., mut, ;, }, else, {, kind, =, ., let, ;, }, const, identifier, =, try, self, ., expect, (, ., identifier, ), ;, const, ident, =, ast_, ., AST, ., create_pattern_symbol, (, identifier, ,, kind, ,, ., local, ,, identifier, ., data, ,, self, ., allocator, ), ;, var, _type, :, *, Type_AST, =, undefined, ;, var, _init, :, ?, *, ast_, ., AST, =, null, ;, _, =, try, self, ., expect, (, ., single_colon, ), ;, _type, =, try, self, ., type_expr, (, ), ;, if, (, self, ., peek_kind, (, ., single_equals, ), ), {, const, token, =, try, self, ., expect, (, ., single_equals, ), ;, _init, =, ast_, ., AST, ., create_comptime, (, token, ,, try, self, ., bool_expr, (, ), ,, self, ., allocator, ), ;, }, return, ast_, ., AST, ., create_binding, (, ident, ., token, (, ), ,, ident, ,, _type, ,, _init, ,, self, ., allocator, ,, ), ;, }, fn, context_paramlist, (, self, :, *, Self, ), Parser_Error_Enum, !, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, var, retval, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, if, (, self, ., accept, (, ., with, ), ), |, _, |, {, if, (, self, ., accept, (, ., left_parenthesis, ), !=, null, ), {, while, (, !, self, ., peek_kind, (, ., right_parenthesis, ), ), {, try, retval, ., append, (, try, self, ., context_param, (, ), ), ;, if, (, self, ., accept, (, ., comma, ), ==, null, ), {, break, ;, }, }, _, =, try, self, ., expect, (, ., right_parenthesis, ), ;, }, else, {, try, retval, ., append, (, try, self, ., context_param, (, ), ), ;, }, }, return, retval, ;, }, fn, context_param, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, parent, =, try, self, ., type_expr, (, ), ;, const, addr_context_type, =, Type_AST, ., create_addr_of_type, (, parent, ., token, (, ), ,, parent, ,, false, ,, false, ,, self, ., allocator, ,, ), ;, var, _init, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., peek_kind, (, ., left_parenthesis, ), ), {, _init, =, ast_, ., AST, ., create_addr_of, (, parent, ., token, (, ), ,, try, self, ., context_value, (, parent, ), ,, false, ,, false, ,, self, ., allocator, ), ;, }, return, ast_, ., AST, ., create_context_value_decl, (, parent, ., token, (, ), ,, addr_context_type, ,, _init, ,, self, ., allocator, ,, ), ;, }, fn, context_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, _, =, try, self, ., expect, (, ., context, ), ;, const, identifier, :, Token, =, try, self, ., expect, (, ., identifier, ), ;, const, name, =, ast_, ., AST, ., create_pattern_symbol, (, identifier, ,, ., type, ,, ., local, ,, identifier, ., data, ,, self, ., allocator, ), ;, const, fields, =, try, self, ., parse_fields, (, Self, ., parse_struct_field, ), ;, return, ast_, ., AST, ., create_context_decl, (, identifier, ,, name, ,, fields, ,, self, ., allocator, ), ;, }, fn, struct_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, _, =, try, self, ., expect, (, ., @, "struct", ), ;, const, identifier, =, try, self, ., expect, (, ., identifier, ), ;, const, name, =, ast_, ., AST, ., create_pattern_symbol, (, identifier, ,, ., type, ,, ., local, ,, identifier, ., data, ,, self, ., allocator, ), ;, const, gen_params, =, try, self, ., generic_params_list, (, ), ;, const, fields, =, try, self, ., parse_fields, (, Self, ., parse_struct_field, ), ;, return, ast_, ., AST, ., create_struct_decl, (, identifier, ,, name, ,, fields, ,, gen_params, ,, self, ., allocator, ), ;, }, fn, enum_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, _, =, try, self, ., expect, (, ., @, "enum", ), ;, const, identifier, =, try, self, ., expect, (, ., identifier, ), ;, const, name, =, ast_, ., AST, ., create_pattern_symbol, (, identifier, ,, ., type, ,, ., local, ,, identifier, ., data, ,, self, ., allocator, ), ;, const, gen_params, =, try, self, ., generic_params_list, (, ), ;, const, fields, =, try, self, ., parse_fields, (, Self, ., parse_enum_field, ), ;, return, ast_, ., AST, ., create_enum_decl, (, identifier, ,, name, ,, fields, ,, gen_params, ,, self, ., allocator, ), ;, }, fn, parse_fields, (, self, :, *, Self, ,, field_parser, :, *, const, fn, (, *, Self, ), Parser_Error_Enum, !, *, Type_AST, ), Parser_Error_Enum, !, std, ., array_list, ., Managed, (, *, Type_AST, ), {, _, =, try, self, ., expect, (, ., left_brace, ), ;, var, fields, :, std, ., array_list, ., Managed, (, *, Type_AST, ), =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ;, self, ., newlines, (, ), ;, while, (, !, self, ., peek_kind, (, ., right_brace, ), ), {, const, field, =, try, field_parser, (, self, ), ;, fields, ., append, (, field, ), catch, unreachable, ;, if, (, !, self, ., peek_kind, (, ., right_brace, ), ), {, _, =, self, ., accept, (, ., comma, ), orelse, self, ., accept, (, ., newline, ), orelse, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected2token, =, ., {, ., expected, =, ., newline, ,, ., got, =, self, ., peek, (, ), }, }, ), ;, return, error, ., ParseError, ;, }, ;, }, self, ., newlines, (, ), ;, }, self, ., newlines, (, ), ;, _, =, try, self, ., expect, (, ., right_brace, ), ;, return, fields, ;, }, fn, parse_struct_field, (, self, :, *, Self, ), Parser_Error_Enum, !, *, Type_AST, {, const, ident_token, =, try, self, ., expect, (, ., identifier, ), ;, _, =, try, self, ., expect, (, ., single_colon, ), ;, const, field_ident, =, ast_, ., AST, ., create_identifier, (, ident_token, ,, self, ., allocator, ), ;, const, _type, =, try, self, ., type_expr, (, ), ;, var, _init, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., single_equals, ), ), |, token, |, {, _init, =, ast_, ., AST, ., create_comptime, (, token, ,, try, self, ., bool_expr, (, ), ,, self, ., allocator, ), ;, }, return, Type_AST, ., create_annotation, (, ident_token, ,, field_ident, ,, _type, ,, _init, ,, self, ., allocator, ), ;, }, fn, parse_enum_field, (, self, :, *, Self, ), Parser_Error_Enum, !, *, Type_AST, {, const, ident_token, =, try, self, ., expect, (, ., identifier, ), ;, const, field_ident, =, ast_, ., AST, ., create_identifier, (, ident_token, ,, self, ., allocator, ), ;, var, _type, :, ?, *, Type_AST, =, null, ;, if, (, self, ., peek_kind, (, ., left_parenthesis, ), ), {, _type, =, try, self, ., paren_type_expr, (, ), ;, }, return, Type_AST, ., create_annotation, (, ident_token, ,, field_ident, ,, _type, orelse, Type_AST, ., create_unit_type, (, ident_token, ,, self, ., allocator, ), ,, null, ,, self, ., allocator, ), ;, }, fn, type_alias_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, _, =, try, self, ., expect, (, ., type, ), ;, const, identifier, =, try, self, ., expect, (, ., identifier, ), ;, const, name, =, ast_, ., AST, ., create_pattern_symbol, (, identifier, ,, ., type, ,, ., local, ,, identifier, ., data, ,, self, ., allocator, ), ;, const, gen_params, =, try, self, ., generic_params_list, (, ), ;, var, _init, :, ?, *, Type_AST, =, null, ;, if, (, self, ., accept, (, ., single_equals, ), ), |, _, |, {, _init, =, try, self, ., type_expr, (, ), ;, }, return, ast_, ., AST, ., create_type_alias, (, identifier, ,, name, ,, _init, ,, gen_params, ,, self, ., allocator, ), ;, }, fn, generic_params_list, (, self, :, *, Self, ), Parser_Error_Enum, !, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, var, params, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, if, (, self, ., accept, (, ., left_square, ), !=, null, ), {, while, (, !, self, ., peek_kind, (, ., right_square, ), ), {, const, param_token, =, try, self, ., expect, (, ., identifier, ), ;, var, constraints, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ;, if, (, self, ., accept, (, ., single_colon, ), ), |, _, |, {, try, constraints, ., append, (, try, self, ., type_expr, (, ), ), ;, while, (, self, ., accept, (, ., plus, ), ), |, _, |, {, try, constraints, ., append, (, try, self, ., type_expr, (, ), ), ;, }, }, const, param_ident, =, ast_, ., AST, ., create_type_param_decl, (, param_token, ,, constraints, ,, self, ., allocator, ), ;, params, ., append, (, param_ident, ), catch, unreachable, ;, if, (, self, ., accept, (, ., comma, ), ==, null, ), {, break, ;, }, }, _, =, try, self, ., expect, (, ., right_square, ), ;, }, return, params, ;, }, fn, trait_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, _, =, try, self, ., expect, (, ., trait, ), ;, const, trait_name, :, Token, =, try, self, ., expect, (, ., identifier, ), ;, var, super_traits, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., allocator, ), ;, self, ., newlines, (, ), ;, if, (, self, ., accept, (, ., single_colon, ), ), |, _, |, {, try, super_traits, ., append, (, try, self, ., type_expr, (, ), ), ;, while, (, self, ., accept, (, ., plus, ), ), |, _, |, {, try, super_traits, ., append, (, try, self, ., type_expr, (, ), ), ;, }, }, self, ., newlines, (, ), ;, _, =, try, self, ., expect, (, ., left_brace, ), ;, var, method_decls, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, errdefer, method_decls, ., deinit, (, ), ;, var, const_decls, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, errdefer, const_decls, ., deinit, (, ), ;, self, ., newlines, (, ), ;, while, (, self, ., peek_kind, (, ., @, "fn", ), or, self, ., peek_kind, (, ., virtual, ), or, self, ., peek_kind, (, ., @, "const", ), ), {, if, (, self, ., peek_kind, (, ., @, "const", ), ), {, const_decls, ., append, (, try, self, ., const_declaration, (, ), ), catch, unreachable, ;, }, else, {, method_decls, ., append, (, try, self, ., method_declaration, (, ), ), catch, unreachable, ;, }, self, ., newlines, (, ), ;, }, _, =, try, self, ., expect, (, ., right_brace, ), ;, return, ast_, ., AST, ., create_trait, (, trait_name, ,, super_traits, ,, method_decls, ,, const_decls, ,, self, ., allocator, ), ;, }, fn, impl_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., impl, ), ;, const, gen_params, =, try, self, ., generic_params_list, (, ), ;, const, trait_ident, :, ?, *, ast_, ., AST, =, if, (, !, self, ., peek_kind, (, ., @, "for", ), ), (, try, self, ., bool_expr, (, ), ), else, null, ;, _, =, try, self, ., expect, (, ., @, "for", ), ;, const, _type, =, try, self, ., type_expr, (, ), ;, self, ., newlines, (, ), ;, _, =, try, self, ., expect, (, ., left_brace, ), ;, var, method_defs, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, errdefer, method_defs, ., deinit, (, ), ;, var, const_defs, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, errdefer, const_defs, ., deinit, (, ), ;, const, retval, =, ast_, ., AST, ., create_impl, (, token, ,, trait_ident, ,, _type, ,, method_defs, ,, const_defs, ,, gen_params, ,, self, ., allocator, ), ;, self, ., newlines, (, ), ;, while, (, self, ., peek_kind, (, ., @, "fn", ), or, self, ., peek_kind, (, ., virtual, ), or, self, ., peek_kind, (, ., @, "const", ), ), {, if, (, self, ., peek_kind, (, ., @, "const", ), ), {, const_defs, ., append, (, try, self, ., const_declaration, (, ), ), catch, unreachable, ;, }, else, {, const, method, =, try, self, ., method_definition, (, ), ;, method, ., method_decl, ., impl, =, retval, ;, method_defs, ., append, (, method, ), catch, unreachable, ;, }, self, ., newlines, (, ), ;, }, _, =, try, self, ., expect, (, ., right_brace, ), ;, retval, ., impl, ., method_defs, =, method_defs, ;, retval, ., impl, ., const_defs, =, const_defs, ;, return, retval, ;, }, fn, test_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., @, "test", ), ;, const, name, =, try, self, ., bool_expr, (, ), ;, const, context_decls, =, try, self, ., context_paramlist, (, ), ;, const, body, =, try, self, ., block_expr, (, ), ;, return, ast_, ., AST, ., create_test, (, token, ,, name, ,, context_decls, ,, body, ,, self, ., allocator, ,, ), ;, }, fn, method_declaration, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, virtual, =, self, ., accept, (, ., virtual, ), ;, const, introducer, =, try, self, ., expect, (, ., @, "fn", ), ;, const, name, :, *, ast_, ., AST, =, ast_, ., AST, ., create_identifier, (, try, self, ., expect, (, ., identifier, ), ,, self, ., allocator, ), ;, const, params_and_receiver, =, try, self, ., method_paramlist, (, ), ;, const, params, =, params_and_receiver, ., params, ;, const, _receiver, =, params_and_receiver, ., receiver, ;, var, ret_type, :, ?, *, Type_AST, =, null, ;, if, (, self, ., accept, (, ., skinny_arrow, ), !=, null, ), {, ret_type, =, try, self, ., type_expr, (, ), ;, }, const, refinement, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., where, ), ), |, _, |, {, _, =, try, self, ., bool_expr, (, ), ;, }, const, contexts_decls, =, try, self, ., context_paramlist, (, ), ;, return, ast_, ., AST, ., create_method_decl, (, introducer, ,, name, ,, virtual, !=, null, ,, _receiver, ,, params, ,, ret_type, orelse, Type_AST, ., create_unit_type, (, introducer, ,, self, ., allocator, ), ,, contexts_decls, ,, refinement, ,, null, ,, self, ., allocator, ,, ), ;, }, fn, method_definition, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, virtual, =, self, ., accept, (, ., virtual, ), ;, const, introducer, =, try, self, ., expect, (, ., @, "fn", ), ;, const, name, :, *, ast_, ., AST, =, ast_, ., AST, ., create_identifier, (, try, self, ., expect, (, ., identifier, ), ,, self, ., allocator, ), ;, const, params_and_receiver, =, try, self, ., method_paramlist, (, ), ;, const, params, =, params_and_receiver, ., params, ;, const, _receiver, =, params_and_receiver, ., receiver, ;, var, ret_type, :, ?, *, Type_AST, =, null, ;, if, (, self, ., accept, (, ., skinny_arrow, ), !=, null, ), {, ret_type, =, try, self, ., type_expr, (, ), ;, }, const, refinement, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., accept, (, ., where, ), ), |, _, |, {, _, =, try, self, ., bool_expr, (, ), ;, }, const, contexts_decls, =, try, self, ., context_paramlist, (, ), ;, const, _init, =, try, self, ., block_expr, (, ), ;, return, ast_, ., AST, ., create_method_decl, (, introducer, ,, name, ,, virtual, !=, null, ,, _receiver, ,, params, ,, ret_type, orelse, Type_AST, ., create_unit_type, (, introducer, ,, self, ., allocator, ), ,, contexts_decls, ,, refinement, ,, _init, ,, self, ., allocator, ,, ), ;, }, fn, method_paramlist, (, self, :, *, Self, ), Parser_Error_Enum, !, struct, {, receiver, :, ?, *, ast_, ., AST, ,, params, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), }, {, var, params, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, errdefer, params, ., deinit, (, ), ;, var, _receiver, :, ?, *, ast_, ., AST, =, null, ;, const, token, =, try, self, ., expect, (, ., left_parenthesis, ), ;, if, (, !, self, ., peek_kind, (, ., right_parenthesis, ), ), {, if, (, self, ., peek_kind, (, ., self, ), or, self, ., peek_kind, (, ., ampersand, ), ), {, _receiver, =, try, self, ., receiver, (, ), ;, }, else, {, params, ., append, (, try, self, ., param, (, ), ), catch, unreachable, ;, }, while, (, self, ., accept, (, ., comma, ), ), |, _, |, {, params, ., append, (, try, self, ., param, (, ), ), catch, unreachable, ;, }, }, if, (, self, ., peek_kind, (, ., right_parenthesis, ), ), {, _, =, self, ., expect, (, ., right_parenthesis, ), catch, unreachable, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., missing_close, =, ., {, ., expected, =, ., right_parenthesis, ,, ., got, =, self, ., peek, (, ), ,, ., open, =, token, }, }, ), ;, return, error, ., ParseError, ;, }, return, ., {, ., receiver, =, _receiver, ,, ., params, =, params, }, ;, }, fn, receiver, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, var, kind, :, ast_, ., Receiver_Kind, =, ., value, ;, if, (, self, ., accept, (, ., ampersand, ), ), |, _, |, {, if, (, self, ., accept, (, ., mut, ), ), |, _, |, {, kind, =, ., mut_addr_of, ;, }, else, {, kind, =, ., addr_of, ;, }, }, const, token, =, try, self, ., expect, (, ., self, ), ;, return, ast_, ., AST, ., create_receiver, (, token, ,, kind, ,, self, ., allocator, ), ;, }, fn, match_expr, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., match, ), ;, var, mappings, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, const, let, :, ?, *, ast_, ., AST, =, try, self, ., let_pre, (, ), ;, const, exp, =, try, self, ., assignment_expr, (, ), ;, _, =, try, self, ., expect, (, ., left_brace, ), ;, while, (, self, ., accept, (, ., newline, ), ), |, _, |, {, }, while, (, !, self, ., peek_kind, (, ., right_brace, ), ), {, if, (, self, ., next_is_expr, (, ), or, self, ., peek, (, ), ., kind, ==, ., mut, ), {, mappings, ., append, (, try, self, ., match_mapping, (, ), ), catch, unreachable, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "match mapping here", ,, ., got, =, self, ., peek, (, ), }, }, ), ;, return, error, ., ParseError, ;, }, }, _, =, try, self, ., expect, (, ., right_brace, ), ;, if, (, mappings, ., items, ., len, ==, 0, ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, token, ., span, ,, ., msg, =, "match has no patterns", }, }, ), ;, return, error, ., ParseError, ;, }, return, ast_, ., AST, ., create_match, (, token, ,, let, ,, exp, ,, mappings, ,, self, ., allocator, ), ;, }, fn, match_mapping, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, var, lhs, =, try, self, ., match_pattern_enum_value, (, ), ;, _, =, try, self, ., expect, (, ., fat_arrow, ), ;, const, rhs, =, try, self, ., assignment_expr, (, ), ;, if, (, !, self, ., peek_kind, (, ., right_brace, ), ), {, _, =, try, self, ., expect, (, ., newline, ), ;, }, return, ast_, ., AST, ., create_mapping, (, lhs, ., token, (, ), ,, lhs, ,, rhs, ,, self, ., allocator, ), ;, }, fn, match_pattern_enum_value, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, exp, =, try, self, ., match_pattern_atom, (, ), ;, if, (, self, ., accept, (, ., left_parenthesis, ), ), |, _, |, {, const, retval, =, ast_, ., AST, ., create_enum_value, (, exp, ., token, (, ), ,, self, ., allocator, ), ;, if, (, exp, .*, ==, ., select, ), {, retval, ., enum_value, ., base, =, Type_AST, ., create_type_identifier, (, exp, ., lhs, (, ), ., token, (, ), ,, self, ., allocator, ), ;, retval, ., common, (, ), ., _token, =, exp, ., rhs, (, ), ., token, (, ), ;, }, retval, ., enum_value, ., init, =, try, self, ., match_pattern_atom, (, ), ;, _, =, try, self, ., expect, (, ., right_parenthesis, ), ;, return, retval, ;, }, else, {, return, exp, ;, }, }, fn, match_pattern_atom, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, if, (, self, ., accept, (, ., mut, ), ), |, _, |, {, const, identifier, =, try, self, ., expect, (, ., identifier, ), ;, return, ast_, ., AST, ., create_pattern_symbol, (, identifier, ,, ., mut, ,, ., local, ,, identifier, ., data, ,, self, ., allocator, ), ;, }, else, if, (, self, ., accept, (, ., identifier, ), ), |, token, |, {, if, (, self, ., peek_kind, (, ., period, ), ), {, var, exp, =, ast_, ., AST, ., create_identifier, (, token, ,, self, ., allocator, ), ;, while, (, self, ., accept, (, ., period, ), ), |, _, |, {, exp, =, ast_, ., AST, ., create_select, (, token, ,, exp, ,, ast_, ., AST, ., create_field, (, try, self, ., expect, (, ., identifier, ), ,, self, ., allocator, ), ,, self, ., allocator, ,, ), ;, }, return, exp, ;, }, else, {, return, ast_, ., AST, ., create_pattern_symbol, (, token, ,, ., let, ,, ., local, ,, token, ., data, ,, self, ., allocator, ), ;, }, }, else, if, (, self, ., accept, (, ., period, ), ), |, _, |, {, const, sum_val, =, ast_, ., AST, ., create_enum_value, (, try, self, ., expect, (, ., identifier, ), ,, self, ., allocator, ), ;, if, (, self, ., accept, (, ., left_parenthesis, ), !=, null, ), {, if, (, !, self, ., peek_kind, (, ., right_parenthesis, ), ), {, sum_val, ., enum_value, ., init, =, try, self, ., tuple_value, (, Self, ., match_pattern_enum_value, ), ;, }, _, =, try, self, ., expect, (, ., right_parenthesis, ), ;, }, return, sum_val, ;, }, else, if, (, self, ., accept, (, ., left_parenthesis, ), ), |, _, |, {, const, pattern, =, try, self, ., tuple_value, (, Self, ., match_pattern_enum_value, ), ;, _, =, try, self, ., expect, (, ., right_parenthesis, ), ;, return, pattern, ;, }, else, {, return, self, ., literal, (, ), ;, }, }, fn, tuple_value, (, self, :, *, Self, ,, elem, :, *, const, fn, (, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, exp, =, try, elem, (, self, ), ;, var, terms, :, ?, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), =, null, ;, var, firsttoken_, :, ?, Token, =, null, ;, while, (, self, ., accept, (, ., comma, ), ), |, token, |, {, if, (, terms, ==, null, ), {, terms, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, firsttoken_, =, token, ;, terms, .?, ., append, (, exp, ), catch, unreachable, ;, }, if, (, self, ., peek_kind, (, ., right_parenthesis, ), ), {, break, ;, }, terms, .?, ., append, (, try, elem, (, self, ), ), catch, unreachable, ;, }, if, (, terms, ), |, terms_list, |, {, return, ast_, ., AST, ., create_tuple_value, (, firsttoken_, .?, ,, terms_list, ,, self, ., allocator, ), ;, }, else, {, return, exp, ;, }, }, fn, parens, (, self, :, *, Self, ), Parser_Error_Enum, !, *, ast_, ., AST, {, const, token, =, try, self, ., expect, (, ., left_parenthesis, ), ;, var, exp, :, ?, *, ast_, ., AST, =, null, ;, if, (, self, ., next_is_expr, (, ), ), {, exp, =, try, self, ., parse_expr, (, ), ;, }, if, (, self, ., peek_kind, (, ., right_parenthesis, ), ), {, _, =, self, ., expect, (, ., right_parenthesis, ), catch, {, }, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., missing_close, =, ., {, ., expected, =, ., right_parenthesis, ,, ., got, =, self, ., peek, (, ), ,, ., open, =, token, }, }, ), ;, return, error, ., ParseError, ;, }, return, exp, orelse, ast_, ., AST, ., create_unit_value, (, token, ,, self, ., allocator, ), ;, }, fn, resolve_escapes, (, input, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), [, ], const, u8, {, var, retval, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, var, escape, =, false, ;, var, skip, :, i8, =, 0, ;, for, (, input, ,, 0.., ), |, byte, ,, j, |, {, if, (, skip, >, 0, ), {, skip, -=, 1, ;, continue, ;, }, else, if, (, escape, ), {, escape, =, false, ;, if, (, byte, ==, 'n', ), {, retval, ., append, (, 0x0A, ), catch, unreachable, ;, }, else, if, (, byte, ==, 'r', ), {, retval, ., append, (, 0x0D, ), catch, unreachable, ;, }, else, if, (, byte, ==, 't', ), {, retval, ., append, (, 0x09, ), catch, unreachable, ;, }, else, if, (, byte, ==, '\\', ), {, retval, ., append, (, 0x5C, ), catch, unreachable, ;, }, else, if, (, byte, ==, '\'', ), {, retval, ., append, (, 0x27, ), catch, unreachable, ;, }, else, if, (, byte, ==, '"', ), {, retval, ., append, (, 0x22, ), catch, unreachable, ;, }, else, if, (, byte, ==, 'x', ), {, retval, ., append, (, get_nibble, (, input, [, j, +, 1, ], ), *, 16, +, get_nibble, (, input, [, j, +, 2, ], ), ), catch, unreachable, ;, skip, =, 2, ;, }, else, {, std, ., debug, ., panic, (, "compiler error: unknown escape sequence '{c}'", ,, ., {, byte, }, ), ;, }, }, else, {, if, (, byte, ==, '\\', ), {, escape, =, true, ;, }, else, {, retval, ., append, (, byte, ), catch, unreachable, ;, }, }, }, return, retval, ., items, ;, }, fn, get_nibble, (, c, :, u8, ), u8, {, if, (, '0', <=, c, and, c, <=, '9', ), {, return, c, -, '0', ;, }, else, if, (, 'a', <=, c, and, c, <=, 'f', ), {, return, c, -, 'a', +, 10, ;, }, else, if, (, 'A', <=, c, and, c, <=, 'F', ), {, return, c, -, 'A', +, 10, ;, }, else, {, unreachable, ;, }, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Validate_Error_Enum, =, error, {, CompileError, }, ;, pub, const, Validate_Args_Thing, =, enum, {, function, ,, method, ,, context, ,, @, "struct", ,, tuple, ,, array, ,, fn, thing_name, (, self, :, @, This, (, ), ), [, ], const, u8, {, return, @, tagName, (, self, ), ;, }, fn, takes_name, (, self, :, @, This, (, ), ), [, ], const, u8, {, return, switch, (, self, ), {, ., context, ,, ., function, ,, ., method, =>, "parameter", ,, ., @, "struct", =>, "field", ,, ., tuple, ,, ., array, =>, "element", ,, }, ;, }, fn, given_name, (, self, :, @, This, (, ), ), [, ], const, u8, {, return, switch, (, self, ), {, ., context, ,, ., function, ,, ., method, =>, "argument", ,, ., @, "struct", =>, "value", ,, ., tuple, ,, ., array, =>, "element", ,, }, ;, }, }, ;, const, Self, =, @, This, (, ), ;, thing, :, Validate_Args_Thing, ,, args, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, span, :, Span, ,, expected, :, *, const, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, errors, :, *, errs_, ., Errors, ,, variadic, :, bool, =, false, ,, allocator, :, std, ., mem, ., Allocator, ,, pub, fn, init, (, thing, :, Validate_Args_Thing, ,, args, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, span, :, Span, ,, expected, :, *, const, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ), Self, {, return, Self, {, ., thing, =, thing, ,, ., args, =, args, ,, ., span, =, span, ,, ., expected, =, expected, ,, ., errors, =, errors, ,, ., allocator, =, allocator, ,, }, ;, }, pub, fn, set_variadic, (, self, :, *, Self, ,, variadic, :, bool, ), void, {, self, ., variadic, =, variadic, ;, }, pub, fn, default_args, (, self, :, *, Self, ), Validate_Error_Enum, !, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, if, (, try, self, ., args_are_named, (, ), and, self, ., expected, ., items, ., len, >, 0, ), {, return, self, ., named_args, (, ), catch, |, err, |, switch, (, err, ), {, error, ., NoDefault, =>, error, ., CompileError, ,, error, ., CompileError, =>, error, ., CompileError, ,, }, ;, }, else, {, return, self, ., positional_args, (, ), catch, |, err, |, switch, (, err, ), {, error, ., NoDefault, =>, error, ., CompileError, ,, }, ;, }, }, fn, args_are_named, (, self, :, *, Self, ), Validate_Error_Enum, !, bool, {, if, (, self, ., args, ., items, ., len, ==, 0, ), {, return, false, ;, }, var, has_named_arg, =, false, ;, var, has_pos_arg, =, false, ;, for, (, self, ., args, ., items, ), |, term, |, {, if, (, term, .*, ==, ., assign, ), {, has_named_arg, =, true, ;, }, else, {, has_pos_arg, =, true, ;, }, }, std, ., debug, ., assert, (, has_named_arg, or, has_pos_arg, ), ;, if, (, has_named_arg, and, has_pos_arg, ), {, const, arg_span, =, self, ., args, ., items, [, 0, ], ., token, (, ), ., span, ;, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, arg_span, ,, ., msg, =, "mixed positional and named arguments are not allowed", }, }, ), ;, return, error, ., CompileError, ;, }, else, {, return, has_named_arg, ;, }, }, fn, positional_args, (, self, :, *, Self, ), error, {, NoDefault, }, !, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, var, filled_args, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, errdefer, filled_args, ., deinit, (, ), ;, for, (, self, ., expected, ., items, ,, 0.., ), |, term, ,, i, |, {, if, (, self, ., args, ., items, ., len, >, 1, and, i, <, self, ., args, ., items, ., len, ), {, filled_args, ., append, (, self, ., args, ., items, [, i, ], ), catch, unreachable, ;, }, else, if, (, self, ., args, ., items, ., len, ==, 0, or, (, self, ., args, ., items, ., len, <=, 1, and, i, >, 0, ), or, (, self, ., args, ., items, ., len, >, 1, and, i, >=, self, ., args, ., items, ., len, ), ), {, if, (, term, .*, ==, ., annotation, and, term, ., annotation, ., init, !=, null, ), {, filled_args, ., append, (, term, ., annotation, ., init, .?, ), catch, unreachable, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_arity, =, ., {, ., span, =, self, ., span, ,, ., takes, =, self, ., expected, ., items, ., len, ,, ., given, =, self, ., args, ., items, ., len, ,, ., thing_name, =, self, ., thing, ., thing_name, (, ), ,, ., takes_name, =, self, ., thing, ., takes_name, (, ), ,, ., given_name, =, self, ., thing, ., given_name, (, ), ,, }, }, ), ;, return, error, ., NoDefault, ;, }, }, else, {, filled_args, ., append, (, self, ., args, ., items, [, 0, ], ), catch, unreachable, ;, }, }, if, (, filled_args, ., items, ., len, <, self, ., args, ., items, ., len, ), {, for, (, filled_args, ., items, ., len, .., self, ., args, ., items, ., len, ), |, i, |, {, filled_args, ., append, (, self, ., args, ., items, [, i, ], ), catch, unreachable, ;, }, }, return, filled_args, ;, }, fn, named_args, (, self, :, *, Self, ), (, Validate_Error_Enum, ||, error, {, NoDefault, }, ), !, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), {, std, ., debug, ., assert, (, self, ., args, ., items, ., len, >, 0, ), ;, var, arg_name_to_val_map, =, std, ., StringArrayHashMap, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, defer, arg_name_to_val_map, ., deinit, (, ), ;, for, (, self, ., args, ., items, ), |, term, |, {, self, ., put_assign, (, term, ,, &, arg_name_to_val_map, ), catch, |, err, |, switch, (, err, ), {, error, ., CompileError, =>, return, error, ., NoDefault, ,, else, =>, return, err, ,, }, ;, }, var, filled_args, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, self, ., allocator, ), ;, errdefer, filled_args, ., deinit, (, ), ;, var, args_used, :, usize, =, 0, ;, for, (, self, ., expected, ., items, ), |, term, |, {, if, (, term, .*, !=, ., annotation, ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, self, ., args, ., items, [, 0, ], ., token, (, ), ., span, ,, ., msg, =, "expected type does not accept named fields", ,, }, }, ), ;, return, error, ., NoDefault, ;, }, const, arg, =, arg_name_to_val_map, ., get, (, term, ., annotation, ., pattern, ., token, (, ), ., data, ), ;, if, (, arg, ==, null, ), {, if, (, term, ., annotation, ., init, !=, null, ), {, filled_args, ., append, (, term, ., annotation, ., init, .?, ), catch, unreachable, ;, }, else, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_arity, =, ., {, ., span, =, self, ., span, ,, ., takes, =, self, ., expected, ., items, ., len, ,, ., given, =, arg_name_to_val_map, ., keys, (, ), ., len, ,, ., thing_name, =, self, ., thing, ., thing_name, (, ), ,, ., takes_name, =, self, ., thing, ., takes_name, (, ), ,, ., given_name, =, self, ., thing, ., given_name, (, ), ,, }, }, ), ;, return, error, ., NoDefault, ;, }, }, else, {, filled_args, ., append, (, arg, .?, ), catch, unreachable, ;, }, args_used, +=, 1, ;, }, if, (, args_used, <, arg_name_to_val_map, ., keys, (, ), ., len, ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_arity, =, ., {, ., span, =, self, ., span, ,, ., takes, =, self, ., expected, ., items, ., len, ,, ., given, =, arg_name_to_val_map, ., keys, (, ), ., len, ,, ., thing_name, =, self, ., thing, ., thing_name, (, ), ,, ., takes_name, =, self, ., thing, ., takes_name, (, ), ,, ., given_name, =, self, ., thing, ., given_name, (, ), ,, }, }, ), ;, return, error, ., NoDefault, ;, }, return, filled_args, ;, }, fn, put_assign, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, arg_map, :, *, std, ., StringArrayHashMap, (, *, ast_, ., AST, ), ), Validate_Error_Enum, !, void, {, if, (, ast, ., lhs, (, ), .*, !=, ., enum_value, ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., expected_basic_token, =, ., {, ., expected, =, "an named argument", ,, ., got, =, ast, ., lhs, (, ), ., token, (, ), }, }, ), ;, return, error, ., CompileError, ;, }, try, self, ., put_ast_map, (, ast, ., rhs, (, ), ,, ast, ., lhs, (, ), ., enum_value, ., get_name, (, ), ,, ast, ., token, (, ), ., span, ,, arg_map, ), ;, }, fn, put_ast_map, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, name, :, [, ], const, u8, ,, arg_span, :, Span, ,, map, :, *, std, ., StringArrayHashMap, (, *, ast_, ., AST, ), ,, ), Validate_Error_Enum, !, void, {, if, (, map, ., get, (, name, ), ), |, _, |, {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., duplicate, =, ., {, ., span, =, arg_span, ,, ., thing, =, "item", ,, ., identifier, =, name, ,, ., first, =, null, ,, }, }, ), ;, }, else, {, map, ., put, (, name, ,, ast, ), catch, unreachable, ;, }, }, pub, fn, implicit_ref, (, self, :, *, Self, ), void, {, if, (, self, ., expected, ., items, ., len, ==, 0, ), return, ;, const, param_type, =, self, ., expected, ., items, [, 0, ], ;, if, (, param_type, .*, ==, ., annotation, and, param_type, ., annotation, ., pattern, .*, ==, ., receiver, and, param_type, ., child, (, ), .*, ==, ., addr_of, and, param_type, ., annotation, ., pattern, ., receiver, ., kind, ==, ., value, ), {, const, old_arg, =, self, ., args, ., items, [, 0, ], ;, self, ., args, ., items, [, 0, ], =, ast_, ., AST, ., create_addr_of, (, old_arg, ., token, (, ), ,, old_arg, ,, false, ,, false, ,, self, ., allocator, ), ;, }, }, pub, fn, validate_args_arity, (, self, :, *, Self, ), Validate_Error_Enum, !, void, {, const, expected_length, =, self, ., expected, ., items, ., len, ;, if, (, self, ., variadic, ), {, if, (, self, ., args, ., items, ., len, <, expected_length, ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_arity, =, ., {, ., span, =, self, ., span, ,, ., takes, =, expected_length, ,, ., given, =, self, ., args, ., items, ., len, ,, ., thing_name, =, self, ., thing, ., thing_name, (, ), ,, ., takes_name, =, self, ., thing, ., takes_name, (, ), ,, ., given_name, =, self, ., thing, ., given_name, (, ), ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, else, if, (, self, ., args, ., items, ., len, !=, expected_length, ), {, self, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_arity, =, ., {, ., span, =, self, ., span, ,, ., takes, =, expected_length, ,, ., given, =, self, ., args, ., items, ., len, ,, ., thing_name, =, self, ., thing, ., thing_name, (, ), ,, ., takes_name, =, self, ., thing, ., takes_name, (, ), ,, ., given_name, =, self, ., thing, ., given_name, (, ), ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, validate_requested_contexts, (, contexts, :, [, ], const, *, Type_AST, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, !, void, {, const, core_, =, @, import, (, "../hierarchy/core.zig", ), ;, for, (, contexts, ), |, ctx, |, {, if, (, !, ctx, ., child, (, ), ., types_match, (, core_, ., allocating_context, ), and, !, ctx, ., child, (, ), ., types_match, (, core_, ., io_context, ), and, !, ctx, ., child, (, ), ., types_match, (, core_, ., args_context, ), and, !, ctx, ., child, (, ), ., types_match, (, core_, ., file_io_context, ), ), {, errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, ctx, ., token, (, ), ., span, ,, ., msg, =, "can't request this context", ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, }, const, std, =, @, import, (, "std", ), ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Instruction, =, @, import, (, "../ir/instruction.zig", ), ;, const, lval_, =, @, import, (, "../ir/lval.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, pub, fn, validate_cfg, (, cfg, :, *, CFG, ,, errors, :, *, errs_, ., Errors, ), error, {, CompileError, }, !, void, {, cfg, ., calculate_usage, (, ), ;, cfg, ., calculate_definitions, (, ), ;, if, (, cfg, ., symbol, ., decl, .?, .*, ==, ., fn_decl, or, cfg, ., symbol, ., decl, .?, .*, ==, ., method_decl, ), {, const, param_symbols, =, cfg, ., symbol, ., decl, .?, ., param_symbols, (, ), ;, if, (, param_symbols, !=, null, ), {, for, (, param_symbols, .?, ., items, ), |, param_symbol, |, {, try, param_symbol, ., err_if_unused, (, errors, ), ;, try, param_symbol, ., err_if_var_not_mutated, (, errors, ), ;, }, }, }, for, (, cfg, ., basic_blocks, ., items, ), |, bb, |, {, for, (, bb, ., instructions, ., items, ), |, instr, |, {, if, (, instr, ., dest, !=, null, and, instr, ., dest, .?, .*, ==, ., symbver, and, !, instr, ., dest, .?, ., symbver, ., symbol, ., is_temp, and, instr, ., dest, .?, ., symbver, ., symbol, !=, cfg, ., return_symbol, ), {, try, instr, ., dest, .?, ., symbver, ., symbol, ., err_if_unused, (, errors, ), ;, try, instr, ., dest, .?, ., symbver, ., symbol, ., err_if_var_not_mutated, (, errors, ), ;, }, try, err_if_chain_undefd, (, instr, ., src1, ,, errors, ,, cfg, ., return_symbol, ,, instr, ., span, ), ;, try, err_if_chain_undefd, (, instr, ., src2, ,, errors, ,, cfg, ., return_symbol, ,, instr, ., span, ), ;, if, (, instr, ., data, ==, ., lval_list, ), {, for, (, instr, ., data, ., lval_list, ., items, ), |, lval, |, {, try, err_if_chain_undefd, (, lval, ,, errors, ,, cfg, ., return_symbol, ,, instr, ., span, ), ;, }, }, if, (, instr, ., data, ==, ., call, ), {, for, (, instr, ., data, ., call, ., arg_lval_list, ., items, ), |, lval, |, {, try, err_if_chain_undefd, (, lval, ,, errors, ,, cfg, ., return_symbol, ,, instr, ., span, ), ;, }, for, (, instr, ., data, ., call, ., context_arg_lval_list, ., items, ), |, lval, |, {, try, err_if_chain_undefd, (, lval, ,, errors, ,, cfg, ., return_symbol, ,, instr, ., span, ), ;, }, }, if, (, instr, ., data, ==, ., invoke, ), {, try, err_if_chain_undefd, (, instr, ., data, ., invoke, ., dyn_value, ,, errors, ,, cfg, ., return_symbol, ,, instr, ., span, ), ;, for, (, instr, ., data, ., invoke, ., arg_lval_list, ., items, ), |, lval, |, {, try, err_if_chain_undefd, (, lval, ,, errors, ,, cfg, ., return_symbol, ,, instr, ., span, ), ;, }, for, (, instr, ., data, ., invoke, ., context_arg_lval_list, ., items, ), |, lval, |, {, try, err_if_chain_undefd, (, lval, ,, errors, ,, cfg, ., return_symbol, ,, instr, ., span, ), ;, }, }, }, }, }, fn, err_if_chain_undefd, (, maybe_lval, :, ?, *, lval_, ., L_Value, ,, errors, :, *, errs_, ., Errors, ,, return_symbol, :, *, Symbol, ,, use, :, Span, ), error, {, CompileError, }, !, void, {, if, (, maybe_lval, ==, null, ), {, return, ;, }, switch, (, maybe_lval, .?, .*, ), {, ., symbver, =>, if, (, maybe_lval, .?, ., symbver, ., symbol, ., lvalue_is_symbol, (, return_symbol, ), ), {, try, maybe_lval, .?, ., symbver, ., symbol, ., err_if_undefd, (, errors, ,, use, ), ;, }, ,, ., dereference, =>, try, err_if_chain_undefd, (, maybe_lval, .?, ., dereference, ., expr, ,, errors, ,, return_symbol, ,, use, ), ,, ., index, =>, {, try, err_if_chain_undefd, (, maybe_lval, .?, ., index, ., length, ,, errors, ,, return_symbol, ,, use, ), ;, try, err_if_chain_undefd, (, maybe_lval, .?, ., index, ., lhs, ,, errors, ,, return_symbol, ,, use, ), ;, try, err_if_chain_undefd, (, maybe_lval, .?, ., index, ., rhs, ,, errors, ,, return_symbol, ,, use, ), ;, }, ,, ., select, =>, {, try, err_if_chain_undefd, (, maybe_lval, .?, ., select, ., tag, ,, errors, ,, return_symbol, ,, use, ), ;, try, err_if_chain_undefd, (, maybe_lval, .?, ., select, ., lhs, ,, errors, ,, return_symbol, ,, use, ), ;, }, ,, ., raw_address, =>, std, ., debug, ., panic, (, "compiler error: undefined err_if_chain_undefd for raw_address", ,, ., {, }, ), ,, }, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, Interpreter_Context, =, @, import, (, "../interpretation/interpreter.zig", ), ;, const, defaults_, =, @, import, (, "defaults.zig", ), ;, const, Scope, =, @, import, (, "../symbol/scope.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Symbol_Tree, =, @, import, (, "../ast/symbol-tree.zig", ), ;, const, walk_, =, @, import, (, "../ast/walker.zig", ), ;, const, Self, :, type, =, @, This, (, ), ;, ctx, :, *, Compiler_Context, ,, map, :, std, ., AutoArrayHashMap, (, *, ast_, ., AST, ,, void, ), ,, pub, fn, new, (, ctx, :, *, Compiler_Context, ), Self, {, return, Self, {, ., ctx, =, ctx, ,, ., map, =, std, ., AutoArrayHashMap, (, *, ast_, ., AST, ,, void, ), ., init, (, ctx, ., allocator, (, ), ), ,, }, ;, }, pub, fn, prefix, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, ?, Self, {, return, self, ., const_eval_prefix, (, ast, ), ;, }, fn, const_eval_prefix, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, ?, Self, {, if, (, self, ., map, ., get, (, ast, ), ), |, _, |, {, return, null, ;, }, try, self, ., eval_internal, (, ast, ), ;, self, ., map, ., put, (, ast, ,, void, {, }, ), catch, unreachable, ;, return, self, .*, ;, }, fn, eval_internal, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ), walk_, ., Error, !, void, {, switch, (, ast, .*, ), {, else, =>, {, }, ,, ., @, "comptime", =>, {, try, self, ., eval_internal, (, ast, ., expr, (, ), ), ;, const, expected_type, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, ast, ,, null, ), catch, return, error, ., CompileError, ;, ast, .*, =, (, try, self, ., interpret_comptime_expr, (, ast, ., expr, (, ), ,, expected_type, ,, ast, ., scope, (, ), .?, ), ), .*, ;, _, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, ast, ,, expected_type, ), catch, return, error, ., CompileError, ;, }, ,, ., default, =>, {, const, _type, =, ast, ., default, ., _type, ;, ast, .*, =, (, try, defaults_, ., generate_default, (, ast, ., default, ., _type, ,, ast, ., token, (, ), ., span, ,, &, self, ., ctx, ., errors, ,, self, ., ctx, ., allocator, (, ), ), ), .*, ;, _, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, ast, ,, _type, ), catch, return, error, ., CompileError, ;, }, ,, ., size_of, =>, {, const, _type, =, ast, ., size_of, ., _type, ;, ast, .*, =, ast_, ., AST, ., create_int, (, ast, ., token, (, ), ,, _type, ., sizeof, (, ), ,, self, ., ctx, ., allocator, (, ), ), .*, ;, _, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, ast, ,, null, ), catch, return, error, ., CompileError, ;, }, ,, }, }, fn, interpret_comptime_expr, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, ret_type, :, *, Type_AST, ,, scope, :, *, Scope, ,, ), !, *, ast_, ., AST, {, const, symbol, :, *, Symbol, =, (, try, Symbol_Tree, ., create_temp_comptime_symbol, (, ast, ,, ret_type, ,, scope, ,, self, ., ctx, ., allocator, (, ), ,, ), ), ., assert_symbol_valid, (, ), ., assert_init_valid, (, ), ;, const, module, =, symbol, ., scope, ., module, .?, ;, const, intered_strings, =, self, ., ctx, ., lookup_interned_string_set, (, module, ., uid, ), .?, ;, const, cfg, =, try, self, ., ctx, ., cfg_store, ., get_cfg, (, symbol, ,, intered_strings, ), ;, defer, cfg, ., deinit, (, ), ;, const, idx, =, cfg, ., emplace_cfg, (, module, ., uid, ,, &, module, ., cfgs, ,, &, module, ., instructions, ), ;, defer, module, ., pop_cfg, (, idx, ), ;, var, context, =, Interpreter_Context, ., init, (, self, ., ctx, ), ;, context, ., set_entry_point, (, cfg, ,, ret_type, ), ;, defer, context, ., deinit, (, ), ;, context, ., load_module, (, module, ), ;, try, context, ., run, (, ), ;, return, try, context, ., extract_ast, (, 0, ,, ret_type, ,, ast, ., token, (, ), ., span, ), ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Validate_Error_Enum, =, error, {, CompileError, }, ;, pub, fn, generate_default, (, _type, :, *, Type_AST, ,, span, :, Span, ,, errors, :, *, errs_, ., Errors, ,, allocator, :, std, ., mem, ., Allocator, ), Validate_Error_Enum, !, *, ast_, ., AST, {, switch, (, _type, .*, ), {, ., identifier, =>, {, const, expanded_type, =, _type, ., expand_identifier, (, ), ;, if, (, expanded_type, ==, _type, ), {, const, primitive_info, =, prelude_, ., info_from_name, (, _type, ., token, (, ), ., data, ), orelse, {, errors, ., add_error, (, errs_, ., Error, {, ., no_default, =, ., {, ., span, =, span, ,, ., _type, =, _type, }, }, ), ;, return, error, ., CompileError, ;, }, ;, if, (, primitive_info, ., default_value, !=, null, ), {, return, primitive_info, ., default_value, .?, ;, }, else, {, errors, ., add_error, (, errs_, ., Error, {, ., no_default, =, ., {, ., span, =, span, ,, ., _type, =, _type, }, }, ), ;, return, error, ., CompileError, ;, }, }, else, {, return, try, generate_default, (, expanded_type, ,, span, ,, errors, ,, allocator, ), ;, }, }, ,, ., function, =>, {, errors, ., add_error, (, errs_, ., Error, {, ., no_default, =, ., {, ., span, =, span, ,, ., _type, =, _type, }, }, ), ;, return, error, ., CompileError, ;, }, ,, ., dyn_type, ,, ., addr_of, =>, return, ast_, ., AST, ., create_int, (, _type, ., token, (, ), ,, 0, ,, allocator, ), ,, ., unit_type, =>, return, ast_, ., AST, ., create_unit_value, (, _type, ., token, (, ), ,, allocator, ), ,, ., enum_type, =>, {, var, retval, =, ast_, ., AST, ., create_enum_value, (, _type, ., token, (, ), ,, allocator, ), ;, if, (, _type, ., enum_type, ., from, ==, ., optional, ), {, retval, ., set_pos, (, 1, ), ;, }, else, {, retval, ., set_pos, (, 0, ), ;, }, retval, ., enum_value, ., base, =, _type, ;, retval, ., common, (, ), ., _token, =, _type, ., children, (, ), ., items, [, retval, ., pos, (, ), .?, ], ., annotation, ., pattern, ., token, (, ), ;, const, proper_term, :, *, Type_AST, =, _type, ., children, (, ), ., items, [, retval, ., pos, (, ), .?, ], ;, retval, ., enum_value, ., init, =, try, generate_default, (, proper_term, ,, span, ,, errors, ,, allocator, ), ;, return, retval, ;, }, ,, ., untagged_sum_type, =>, {, return, try, generate_default, (, _type, ., child, (, ), ,, span, ,, errors, ,, allocator, ), ;, }, ,, ., struct_type, =>, {, var, value_terms, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, allocator, ), ;, errdefer, value_terms, ., deinit, (, ), ;, for, (, _type, ., children, (, ), ., items, ), |, term, |, {, const, default_term, =, try, generate_default, (, term, ,, span, ,, errors, ,, allocator, ), ;, value_terms, ., append, (, default_term, ), catch, unreachable, ;, }, return, ast_, ., AST, ., create_struct_value, (, _type, ., token, (, ), ,, _type, ,, value_terms, ,, allocator, ), ;, }, ,, ., tuple_type, =>, {, var, value_terms, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, allocator, ), ;, errdefer, value_terms, ., deinit, (, ), ;, for, (, _type, ., children, (, ), ., items, ), |, term, |, {, const, default_term, =, try, generate_default, (, term, ,, span, ,, errors, ,, allocator, ), ;, value_terms, ., append, (, default_term, ), catch, unreachable, ;, }, return, ast_, ., AST, ., create_tuple_value, (, _type, ., token, (, ), ,, value_terms, ,, allocator, ), ;, }, ,, ., annotation, =>, if, (, _type, ., annotation, ., init, !=, null, ), {, return, _type, ., annotation, ., init, .?, ;, }, else, {, return, generate_default, (, _type, ., child, (, ), ,, span, ,, errors, ,, allocator, ), ;, }, ,, ., array_of, =>, {, var, value_terms, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, allocator, ), ;, const, child, =, try, generate_default, (, _type, ., child, (, ), ,, span, ,, errors, ,, allocator, ), ;, for, (, 0.., @, intCast, (, _type, ., array_of, ., len, ., int, ., data, ), ), |, _, |, {, value_terms, ., append, (, child, ), catch, unreachable, ;, }, return, ast_, ., AST, ., create_array_value, (, _type, ., token, (, ), ,, value_terms, ,, allocator, ), ;, }, ,, ., generic_apply, =>, return, generate_default, (, _type, ., generic_apply, ., _symbol, .?, ., init_typedef, (, ), .?, ,, span, ,, errors, ,, allocator, ), ,, ., poison, ,, ., anyptr_type, ,, ., access, ,, ., type_of, ,, ., domain_of, ,, ., index, ,, ., context_type, ,, =>, std, ., debug, ., panic, (, "compiler error: unimplemented generate_default() for: AST.{s}", ,, ., {, @, tagName, (, _type, .*, ), }, ), ,, }, }, const, std, =, @, import, (, "std", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, module_, =, @, import, (, "../hierarchy/module.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Validate_Error_Enum, =, error, {, LexerError, ,, ParseError, ,, CompileError, ,, OutOfMemory, }, ;, const, Self, :, type, =, @, This, (, ), ;, ctx, :, *, Compiler_Context, ,, pub, fn, init, (, ctx, :, *, Compiler_Context, ), Self, {, return, Self, {, ., ctx, =, ctx, }, ;, }, pub, fn, validate_module, (, self, :, *, Self, ,, module, :, *, module_, ., Module, ), Validate_Error_Enum, !, void, {, try, self, ., ctx, ., validate_scope, ., validate_scope, (, self, ., ctx, ., module_scope, (, module, ., absolute_path, ), .?, ), ;, for, (, 0..module.cincludes.items.len, ), |, i, |, {, _, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, module, ., cincludes, ., items, [, i, ], ,, prelude_, ., string_type, ), catch, return, error, ., CompileError, ;, }, if, (, self, ., ctx, ., errors, ., errors_list, ., items, ., len, >, 0, ), {, return, error, ., CompileError, ;, }, if, (, !, module_name_is_good, (, module, ., name, (, ), ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., symbol_error, =, ., {, ., problem, =, "has an improper module name", ,, ., span, =, Span, {, ., filename, =, module, ., absolute_path, ,, ., col, =, 0, ,, ., line_number, =, 0, ,, ., line_text, =, "", }, ,, ., name, =, module, ., name, (, ), ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, fn, module_name_is_good, (, module_name, :, [, ], const, u8, ), bool, {, if, (, module_name, ., len, ==, 0, ), {, return, false, ;, }, if, (, !, std, ., ascii, ., isLower, (, module_name, [, 0, ], ), ), {, return, false, ;, }, for, (, module_name, ), |, c, |, {, if, (, !, std, ., ascii, ., isAlphanumeric, (, c, ), and, c, !=, '_', ), {, return, false, ;, }, }, return, true, ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, defaults_, =, @, import, (, "defaults.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, typing_, =, @, import, (, "typing.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Validate_Error_Enum, =, error, {, CompileError, }, ;, const, Self, :, type, =, @, This, (, ), ;, ctx, :, *, Compiler_Context, ,, map, :, std, ., AutoArrayHashMap, (, *, ast_, ., AST, ,, *, Type_AST, ), ,, pub, fn, init, (, ctx, :, *, Compiler_Context, ), Self, {, return, Self, {, ., ctx, =, ctx, ,, ., map, =, std, ., AutoArrayHashMap, (, *, ast_, ., AST, ,, *, Type_AST, ), ., init, (, ctx, ., allocator, (, ), ), ,, }, ;, }, pub, fn, assert_pattern_matches, (, self, :, *, Self, ,, pattern, :, *, ast_, ., AST, ,, expr_type, :, *, Type_AST, ,, ), Validate_Error_Enum, !, void, {, switch, (, pattern, .*, ), {, ., unit_value, ,, ., int, ,, ., string, ,, ., float, ,, ., true, ,, ., false, ,, ., block, ,, ., select, ,, =>, _, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, pattern, ,, expr_type, ), catch, return, error, ., CompileError, ,, ., enum_value, =>, {, if, (, pattern, ., enum_value, ., base, ==, null, ), {, pattern, ., enum_value, ., base, =, expr_type, ;, }, const, expanded_base, :, *, Type_AST, =, pattern, ., enum_value, ., base, .?, ., expand_identifier, (, ), ;, if, (, expanded_base, .*, !=, ., enum_type, ), {, return, typing_, ., throw_wrong_from, (, "enum", ,, "enum value", ,, expanded_base, ,, pattern, ., token, (, ), ., span, ,, &, self, ., ctx, ., errors, ), ;, }, const, pos, =, expanded_base, ., get_pos, (, pattern, ., token, (, ), ., data, ), ;, if, (, pos, ==, null, and, expanded_base, .*, ==, ., enum_type, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., member_not_in_type, =, ., {, ., span, =, pattern, ., token, (, ), ., span, ,, ., identifier, =, pattern, ., token, (, ), ., data, ,, ., name, =, "enum", ,, ., type, =, expanded_base, }, }, ), ;, return, error, ., CompileError, ;, }, pattern, ., set_pos, (, expanded_base, ., get_pos, (, pattern, ., token, (, ), ., data, ), ), ;, pattern, ., enum_value, ., domain, =, expanded_base, ., children, (, ), ., items, [, pattern, ., pos, (, ), .?, ], ;, if, (, pattern, ., enum_value, ., init, ==, null, ), {, pattern, ., enum_value, ., init, =, pattern, ., enum_value, ., domain, .?, ., annotation, ., init, orelse, try, defaults_, ., generate_default, (, pattern, ., enum_value, ., domain, .?, ., child, (, ), ,, pattern, ., token, (, ), ., span, ,, &, self, ., ctx, ., errors, ,, self, ., ctx, ., allocator, (, ), ), ;, }, _, =, self, ., assert_pattern_matches, (, pattern, ., enum_value, ., init, .?, ,, pattern, ., enum_value, ., domain, .?, ., child, (, ), ), catch, return, error, ., CompileError, ;, }, ,, ., tuple_value, =>, {, const, expanded_expr_type, =, expr_type, ., expand_identifier, (, ), ;, if, (, expanded_expr_type, .*, !=, ., tuple_type, or, expanded_expr_type, ., children, (, ), ., items, ., len, !=, pattern, ., children, (, ), ., items, ., len, ), {, const, got, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, pattern, ,, null, ), catch, return, error, ., CompileError, ;, return, typing_, ., throw_unexpected_type, (, pattern, ., token, (, ), ., span, ,, expr_type, ,, got, ,, &, self, ., ctx, ., errors, ), ;, }, for, (, pattern, ., children, (, ), ., items, ,, expanded_expr_type, ., children, (, ), ., items, ), |, term, ,, expanded_term, |, {, try, self, ., assert_pattern_matches, (, term, ,, expanded_term, ), ;, }, }, ,, ., array_value, =>, {, const, expanded_expr_type, =, expr_type, ., expand_identifier, (, ), ;, if, (, expanded_expr_type, .*, !=, ., array_of, or, expanded_expr_type, ., array_of, ., len, ., int, ., data, !=, pattern, ., children, (, ), ., items, ., len, ), {, const, got, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, pattern, ,, null, ), catch, return, error, ., CompileError, ;, return, typing_, ., throw_unexpected_type, (, pattern, ., token, (, ), ., span, ,, expr_type, ,, got, ,, &, self, ., ctx, ., errors, ), ;, }, const, elem_type, =, expanded_expr_type, ., child, (, ), ;, for, (, pattern, ., children, (, ), ., items, ), |, term, |, {, try, self, ., assert_pattern_matches, (, term, ,, elem_type, ), ;, }, }, ,, ., pattern_symbol, =>, {, }, ,, else, =>, std, ., debug, ., panic, (, "compiler error: unimplemented assert_pattern_matches() for {s}", ,, ., {, @, tagName, (, pattern, .*, ), }, ), ,, }, self, ., ctx, ., typecheck, ., assert_typeof, (, pattern, ,, expr_type, ), ;, _, =, pattern, ., assert_ast_valid, (, ), ;, }, pub, fn, exhaustive_check, (, self, :, *, Self, ,, _type, :, *, Type_AST, ,, mappings, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, match_span, :, Span, ,, ), Validate_Error_Enum, !, void, {, if, (, _type, .*, ==, ., enum_type, ), {, var, total_sum_ids, =, std, ., array_list, ., Managed, (, usize, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, total_sum_ids, ., deinit, (, ), ;, for, (, _type, ., children, (, ), ., items, ,, 0.., ), |, _, ,, i, |, {, total_sum_ids, ., append, (, i, ), catch, unreachable, ;, }, for, (, mappings, ., items, ), |, m, |, {, exhaustive_check_sub, (, m, ., lhs, (, ), ,, &, total_sum_ids, ), ;, }, if, (, total_sum_ids, ., items, ., len, >, 0, ), {, var, forgotten_sum_variants, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, for, (, total_sum_ids, ., items, ), |, id, |, {, forgotten_sum_variants, ., append, (, _type, ., children, (, ), ., items, [, id, ], ), catch, unreachable, ;, }, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., non_exhaustive_sum, =, ., {, ., span, =, match_span, ,, ., forgotten, =, forgotten_sum_variants, }, }, ), ;, return, error, ., CompileError, ;, }, }, }, fn, exhaustive_check_sub, (, ast, :, *, ast_, ., AST, ,, ids, :, *, std, ., array_list, ., Managed, (, usize, ), ), void, {, switch, (, ast, .*, ), {, ., select, ,, ., enum_value, =>, {, for, (, ids, ., items, ,, 0.., ), |, item, ,, i, |, {, if, (, item, ==, ast, ., pos, (, ), .?, ), {, _, =, ids, ., swapRemove, (, i, ), ;, break, ;, }, }, }, ,, ., pattern_symbol, =>, ids, ., clearRetainingCapacity, (, ), ,, else, =>, {, }, ,, }, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Scope, =, @, import, (, "../symbol/scope.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Validate_Error_Enum, =, error, {, OutOfMemory, ,, CompileError, }, ;, const, Self, :, type, =, @, This, (, ), ;, ctx, :, *, Compiler_Context, ,, pub, fn, init, (, ctx, :, *, Compiler_Context, ), Self, {, return, Self, {, ., ctx, =, ctx, }, ;, }, pub, fn, validate_scope, (, self, :, *, Self, ,, scope, :, *, Scope, ), Validate_Error_Enum, !, void, {, for, (, scope, ., symbols, ., keys, (, ), ), |, key, |, {, const, symbol, =, scope, ., symbols, ., get, (, key, ), .?, ;, try, self, ., ctx, ., validate_symbol, ., validate_symbol, (, symbol, ), ;, }, var, i, :, usize, =, 0, ;, while, (, i, <, scope, ., children, ., items, ., len, ), :, (, i, +=, 1, ), {, const, child, =, scope, ., children, ., items, [, i, ], ;, try, self, ., validate_scope, (, child, ), ;, }, for, (, scope, ., impls, ., items, ), |, impl, |, {, try, self, ., validate_impl, (, impl, ), ;, }, }, fn, validate_impl, (, self, :, *, Self, ,, impl, :, *, ast_, ., AST, ), Validate_Error_Enum, !, void, {, if, (, impl, ., impl, ., _type, .*, ==, ., addr_of, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, impl, ., impl, ., _type, ., token, (, ), ., span, ,, ., msg, =, "cannot implement method for address types", ,, }, }, ), ;, return, error, ., CompileError, ;, }, _, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, impl, ., impl, ., trait, .?, ,, null, ), catch, |, e, |, switch, (, e, ), {, error, ., UnexpectedTypeType, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, impl, ., impl, ., trait, .?, ., token, (, ), ., span, ,, ., msg, =, "cannot implement for this, not a trait", ,, }, }, ), ;, return, error, ., CompileError, ;, }, ,, else, =>, return, error, ., CompileError, ,, }, ;, try, self, ., ctx, ., validate_type, ., validate_type, (, impl, ., impl, ., _type, ), ;, const, trait_symbol, :, *, Symbol, =, impl, ., impl, ., trait, .?, ., symbol, (, ), .?, ;, if, (, trait_symbol, ., kind, !=, ., trait, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, trait_symbol, ., span, (, ), ,, ., msg, =, "cannot implement for this, not a trait", ,, }, }, ), ;, return, error, ., CompileError, ;, }, const, trait_ast, =, trait_symbol, ., decl, .?, ;, const, lookup_res, =, impl, ., scope, (, ), .?, ., impl_trait_lookup, (, impl, ., impl, ., _type, ,, trait_symbol, ), ;, if, (, lookup_res, ., count, >, 1, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., reimpl, =, ., {, ., first_defined_span, =, lookup_res, ., ast, .?, ., token, (, ), ., span, ,, ., redefined_span, =, impl, ., token, (, ), ., span, ,, ., name, =, if, (, !, impl, ., impl, ., impls_anon_trait, ), trait_symbol, ., name, else, null, ,, ., _type, =, impl, ., impl, ., _type, ,, }, }, ), ;, return, error, ., CompileError, ;, }, for, (, trait_ast, ., trait, ., super_traits, ., items, ), |, super_trait, |, {, const, super_trait_symbol, =, super_trait, ., symbol, (, ), .?, ;, const, super_lookup_res, =, impl, ., scope, (, ), .?, ., impl_trait_lookup, (, impl, ., impl, ., _type, ,, super_trait_symbol, ), ;, if, (, super_lookup_res, ., count, ==, 0, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., type_not_impl_trait, =, ., {, ., _type, =, impl, ., impl, ., _type, ,, ., span, =, impl, ., token, (, ), ., span, ,, ., trait_name, =, super_trait, ., symbol, (, ), .?, ., name, ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, var, trait_decls, =, std, ., StringArrayHashMap, (, *, ast_, ., AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, trait_decls, ., deinit, (, ), ;, for, (, trait_ast, ., trait, ., method_decls, ., items, ), |, decl, |, {, trait_decls, ., put, (, decl, ., method_decl, ., name, ., token, (, ), ., data, ,, decl, ), catch, unreachable, ;, }, for, (, impl, ., impl, ., method_defs, ., items, ), |, def, |, {, const, def_key, =, def, ., method_decl, ., name, ., token, (, ), ., data, ;, const, trait_decl, =, trait_decls, ., get, (, def_key, ), ;, if, (, trait_decl, ==, null, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., method_not_in_trait, =, ., {, ., method_span, =, def, ., token, (, ), ., span, ,, ., method_name, =, def, ., method_decl, ., name, ., token, (, ), ., data, ,, ., trait_name, =, trait_ast, ., token, (, ), ., data, ,, }, }, ), ;, return, error, ., CompileError, ;, }, if, (, !, receivers_match, (, def, ., method_decl, ., receiver, ,, trait_decl, .?, ., method_decl, ., receiver, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., impl_receiver_mismatch, =, ., {, ., receiver_span, =, if, (, def, ., method_decl, ., receiver, !=, null, ), def, ., method_decl, ., receiver, .?, ., token, (, ), ., span, else, def, ., token, (, ), ., span, ,, ., method_name, =, def, ., method_decl, ., name, ., token, (, ), ., data, ,, ., trait_name, =, trait_ast, ., token, (, ), ., data, ,, ., trait_receiver, =, if, (, trait_decl, .?, ., method_decl, ., receiver, !=, null, ), trait_decl, .?, ., method_decl, ., receiver, .?, ., receiver, ., kind, else, null, ,, ., impl_receiver, =, if, (, def, ., method_decl, ., receiver, !=, null, ), def, ., method_decl, ., receiver, .?, ., receiver, ., kind, else, null, ,, }, }, ), ;, return, error, ., CompileError, ;, }, if, (, def, ., children, (, ), ., items, ., len, !=, trait_decl, .?, ., children, (, ), ., items, ., len, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_method_param_arity, =, ., {, ., span, =, def, ., token, (, ), ., span, ,, ., method_name, =, def, ., method_decl, ., name, ., token, (, ), ., data, ,, ., trait_name, =, trait_ast, ., token, (, ), ., data, ,, ., trait_arity, =, trait_decl, .?, ., children, (, ), ., items, ., len, +, @, intFromBool, (, trait_decl, .?, ., method_decl, ., receiver, !=, null, ), ,, ., impl_arity, =, def, ., children, (, ), ., items, ., len, +, @, intFromBool, (, def, ., method_decl, ., receiver, !=, null, ), ,, }, }, ), ;, return, error, ., CompileError, ;, }, var, subst, =, std, ., StringArrayHashMap, (, *, Type_AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, subst, ., deinit, (, ), ;, subst, ., put, (, "Self", ,, impl, ., impl, ., _type, ), catch, unreachable, ;, for, (, def, ., children, (, ), ., items, ,, trait_decl, .?, ., children, (, ), ., items, ), |, impl_param, ,, trait_param, |, {, const, impl_type, =, impl_param, ., binding, ., type, ;, const, trait_type, =, Type_AST, ., clone, (, trait_param, ., binding, ., type, ,, &, subst, ,, self, ., ctx, ., allocator, (, ), ), ;, if, (, !, impl_type, ., types_match, (, trait_type, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_method_type, =, ., {, ., span, =, impl_param, ., binding, ., type, ., token, (, ), ., span, ,, ., method_name, =, def, ., method_decl, ., name, ., token, (, ), ., data, ,, ., trait_name, =, trait_ast, ., token, (, ), ., data, ,, ., trait_type, =, trait_type, ,, ., impl_type, =, impl_type, ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, const, trait_method_ret_type, =, Type_AST, ., clone, (, trait_decl, .?, ., method_decl, ., ret_type, ,, &, subst, ,, self, ., ctx, ., allocator, (, ), ), ;, const, def_method_ret_type, =, Type_AST, ., clone, (, def, ., method_decl, ., ret_type, ,, &, subst, ,, self, ., ctx, ., allocator, (, ), ), ;, if, (, !, def_method_ret_type, ., types_match, (, trait_method_ret_type, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_method_type, =, ., {, ., span, =, def, ., method_decl, ., ret_type, ., token, (, ), ., span, ,, ., method_name, =, def, ., method_decl, ., name, ., token, (, ), ., data, ,, ., trait_name, =, trait_ast, ., token, (, ), ., data, ,, ., trait_type, =, trait_method_ret_type, ,, ., impl_type, =, def, ., method_decl, ., ret_type, ,, }, }, ), ;, return, error, ., CompileError, ;, }, def, ., method_decl, ., c_type, =, trait_decl, .?, ., method_decl, ., c_type, ;, if, (, def, ., method_decl, ., is_virtual, !=, trait_decl, .?, ., method_decl, ., is_virtual, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_method_virtuality, =, ., {, ., span, =, def, ., token, (, ), ., span, ,, ., method_name, =, def, ., method_decl, ., name, ., token, (, ), ., data, ,, ., trait_name, =, trait_ast, ., token, (, ), ., data, ,, ., trait_method_is_virtual, =, trait_decl, .?, ., method_decl, ., is_virtual, ,, ., impl_method_is_virtual, =, def, ., method_decl, ., is_virtual, ,, }, }, ), ;, return, error, ., CompileError, ;, }, if, (, def, ., method_decl, ., is_virtual, ), {, impl, ., impl, ., num_virtual_methods, +=, 1, ;, }, _, =, trait_decls, ., swapRemove, (, def_key, ), ;, }, var, errant, =, false, ;, for, (, trait_decls, ., keys, (, ), ), |, trait_key, |, {, const, trait_decl, =, trait_decls, ., get, (, trait_key, ), .?, ;, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., method_not_in_impl, =, ., {, ., impl_span, =, impl, ., token, (, ), ., span, ,, ., method_span, =, trait_decl, ., token, (, ), ., span, ,, ., method_name, =, trait_decl, ., method_decl, ., name, ., token, (, ), ., data, ,, ., trait_name, =, trait_ast, ., token, (, ), ., data, ,, }, }, ), ;, errant, =, true, ;, }, if, (, errant, ), {, return, error, ., CompileError, ;, }, for, (, impl, ., impl, ., method_defs, ., items, ), |, def, |, {, _, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, def, ,, null, ), catch, return, error, ., CompileError, ;, }, }, fn, receivers_match, (, a, :, ?, *, ast_, ., AST, ,, b, :, ?, *, ast_, ., AST, ), bool, {, if, (, a, ==, null, and, b, !=, null, ), {, return, false, ;, }, else, if, (, a, !=, null, and, b, ==, null, ), {, return, false, ;, }, else, if, (, a, ==, null, and, b, ==, null, ), {, return, true, ;, }, else, {, return, a, .?, ., receiver, ., kind, ==, b, .?, ., receiver, ., kind, ;, }, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, Const_Eval, =, @, import, (, "const_eval.zig", ), ;, const, typecheck_AST, =, @, import, (, "typecheck.zig", ), ., typecheck_AST, ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Tree_Writer, =, @, import, (, "../ast/tree_writer.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, walk_, =, @, import, (, "../ast/walker.zig", ), ;, const, Validate_Error_Enum, =, error, {, OutOfMemory, ,, CompileError, }, ;, const, Self, :, type, =, @, This, (, ), ;, ctx, :, *, Compiler_Context, ,, pub, fn, init, (, ctx, :, *, Compiler_Context, ), Self, {, return, Self, {, ., ctx, =, ctx, }, ;, }, pub, fn, validate_symbol, (, self, :, *, Self, ,, symbol, :, *, Symbol, ), Validate_Error_Enum, !, void, {, if, (, symbol, ., validation_state, ==, ., valid, or, symbol, ., validation_state, ==, ., validating, ), {, return, ;, }, symbol, ., validation_state, =, ., validating, ;, symbol, ., init_validation_state, =, ., validating, ;, _, =, symbol, ., assert_symbol_valid, (, ), ;, const, expected, :, ?, *, Type_AST, =, switch, (, symbol, ., kind, ), {, ., @, "fn", ,, ., @, "test", =>, symbol, ., type, (, ), ., rhs, (, ), ,, ., type, ,, ., context, =>, null, ,, ., import_inner, =>, if, (, symbol, ., decl, .?, .*, ==, ., type_alias, ), null, else, symbol, ., type, (, ), ,, else, =>, symbol, ., type, (, ), ,, }, ;, if, (, expected, ), |, expected_type, |, {, try, self, ., ctx, ., validate_type, ., validate_type, (, expected_type, ), ;, if, (, self, ., ctx, ., validate_type, ., detect_cycle, (, expected_type, ,, null, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., symbol_error, =, ., {, ., problem, =, "cyclic type detected", ,, ., span, =, symbol, ., span, (, ), ,, ., name, =, symbol, ., name, ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, if, (, symbol, ., init_value, (, ), ), |, _init, |, {, _, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, _init, ,, expected, ), catch, |, e, |, switch, (, e, ), {, error, ., CompileError, =>, return, error, ., CompileError, ,, error, ., OutOfMemory, =>, return, error, ., OutOfMemory, ,, error, ., UnexpectedTypeType, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., unexpected_type_type, =, ., {, ., expected, =, expected, ,, ., span, =, _init, ., token, (, ), ., span, }, }, ), ;, return, error, ., CompileError, ;, }, ,, }, ;, if, (, _init, .*, !=, ., module, ), {, try, walk_, ., walk_ast, (, _init, ,, Const_Eval, ., new, (, self, ., ctx, ), ), ;, }, }, else, if, (, symbol, ., kind, ==, ., type, and, symbol, ., init_typedef, (, ), !=, null, ), {, try, self, ., ctx, ., validate_type, ., validate_type, (, symbol, ., init_typedef, (, ), .?, ), ;, if, (, self, ., ctx, ., validate_type, ., detect_cycle, (, symbol, ., init_typedef, (, ), .?, ,, symbol, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., msg, =, "cyclic type detected", ,, ., span, =, symbol, ., span, (, ), ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, if, (, symbol, ., kind, ==, ., trait, ), {, try, self, ., validate_trait, (, symbol, ), ;, }, else, if, (, symbol, ., init_value, (, ), !=, null, and, symbol, ., init_value, (, ), .?, .*, ==, ., poison, ), {, symbol, ., validation_state, =, ., invalid, ;, symbol, ., init_validation_state, =, ., invalid, ;, return, error, ., CompileError, ;, }, if, (, symbol, ., kind, ==, ., @, "test", ), {, const, args_, =, @, import, (, "args.zig", ), ;, try, args_, ., validate_requested_contexts, (, symbol, ., type, (, ), ., function, ., contexts, ., items, ,, &, self, ., ctx, ., errors, ), ;, }, if, (, symbol, ., decl, .?, .*, ==, ., type_param_decl, ), {, var, traits_used, =, std, ., array_hash_map, ., AutoArrayHashMap, (, *, Symbol, ,, void, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, traits_used, ., deinit, (, ), ;, for, (, symbol, ., decl, .?, ., type_param_decl, ., constraints, ., items, ), |, constraint, |, {, if, (, !, constraint, ., refers_to_trait, (, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., not_constraint, =, ., {, ., got, =, constraint, ,, ., span, =, constraint, ., token, (, ), ., span, }, }, ), ;, return, error, ., CompileError, ;, }, if, (, traits_used, ., contains, (, constraint, ., symbol, (, ), .?, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., duplicate, =, ., {, ., identifier, =, constraint, ., symbol, (, ), .?, ., name, ,, ., thing, =, "constraint", ,, ., first, =, null, ,, ., span, =, constraint, ., token, (, ), ., span, }, }, ), ;, return, error, ., CompileError, ;, }, try, traits_used, ., put, (, constraint, ., symbol, (, ), .?, ,, void, {, }, ), ;, }, }, if, (, symbol, ., is_type, (, ), or, symbol, ., kind, ==, ., trait, or, symbol, ., kind, ==, ., context, ), {, if, (, !, is_capitalized, (, symbol, ., name, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., symbol_error, =, ., {, ., problem, =, "must start with an uppercase letter", ,, ., span, =, symbol, ., span, (, ), ,, ., name, =, symbol, ., name, ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, else, {, if, (, is_capitalized, (, symbol, ., name, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., symbol_error, =, ., {, ., problem, =, "must start with an lowercase letter", ,, ., span, =, symbol, ., span, (, ), ,, ., name, =, symbol, ., name, ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, if, (, symbol, ., storage, ==, ., @, "extern", ), {, if, (, symbol, ., storage, ., @, "extern", ., c_name, !=, null, ), {, _, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, symbol, ., storage, ., @, "extern", ., c_name, .?, ,, prelude_, ., string_type, ), catch, return, error, ., CompileError, ;, }, else, {, symbol, ., storage, ., @, "extern", ., c_name, =, ast_, ., AST, ., create_string, (, Token, ., init_simple, (, symbol, ., name, ), ,, symbol, ., name, ,, self, ., ctx, ., allocator, (, ), ), ;, }, }, _, =, symbol, ., assert_init_valid, (, ), ;, }, fn, type_is_type_type, (, ast, :, *, ast_, ., AST, ), bool, {, if, (, ast, .*, ==, ., function, ), {, return, type_is_type_type_atom, (, ast, ., rhs, (, ), ), ;, }, else, {, return, type_is_type_type_atom, (, ast, ), ;, }, }, fn, type_is_type_type_atom, (, ast, :, *, ast_, ., AST, ), bool, {, return, ast, .*, ==, ., identifier, and, std, ., mem, ., eql, (, u8, ,, ast, ., token, (, ), ., data, ,, "Type", ), ;, }, fn, validate_trait, (, self, :, *, Self, ,, trait, :, *, Symbol, ), Validate_Error_Enum, !, void, {, var, names, =, std, ., StringArrayHashMap, (, *, ast_, ., AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, names, ., deinit, (, ), ;, for, (, trait, ., decl, .?, ., trait, ., method_decls, ., items, ), |, decl, |, {, const, method_name, =, decl, ., method_decl, ., name, ., token, (, ), ., data, ;, if, (, names, ., get, (, method_name, ), ), |, other, |, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., duplicate, =, ., {, ., span, =, decl, ., token, (, ), ., span, ,, ., thing, =, "method", ,, ., identifier, =, method_name, ,, ., first, =, other, ., token, (, ), ., span, ,, }, }, ), ;, return, error, ., CompileError, ;, }, else, {, names, ., put, (, method_name, ,, decl, ), catch, unreachable, ;, }, var, visited, =, std, ., array_hash_map, ., AutoArrayHashMap, (, *, Symbol, ,, void, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, visited, ., deinit, (, ), ;, try, self, ., validate_super_name_collision, (, trait, ,, decl, ., method_decl, ., name, ., token, (, ), ,, &, visited, ), ;, for, (, decl, ., method_decl, ., _params, ., items, ), |, param, |, {, try, self, ., ctx, ., validate_type, ., validate_type, (, param, ., binding, ., type, ), ;, }, try, self, ., ctx, ., validate_type, ., validate_type, (, decl, ., method_decl, ., ret_type, ), ;, try, self, ., ctx, ., validate_type, ., validate_type, (, decl, ., method_decl, ., c_type, .?, ), ;, if, (, decl, ., method_decl, ., is_virtual, ), {, if, (, decl, ., method_decl, ., c_type, .?, ., refers_to_self, (, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., trait_virtual_refers_to_self, =, ., {, ., span, =, decl, ., token, (, ), ., span, ,, ., method_name, =, method_name, ,, ., trait_name, =, trait, ., name, ,, }, }, ), ;, return, error, ., CompileError, ;, }, trait, ., decl, .?, ., trait, ., num_virtual_methods, +=, 1, ;, }, }, }, fn, validate_super_name_collision, (, self, :, *, Self, ,, trait_symbol, :, *, Symbol, ,, method_token, :, Token, ,, visited, :, *, std, ., array_hash_map, ., AutoArrayHashMap, (, *, Symbol, ,, void, ), ), Validate_Error_Enum, !, void, {, if, (, visited, ., get, (, trait_symbol, ), ), |, _, |, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., symbol_error, =, ., {, ., problem, =, "cyclic trait inheritance detected", ,, ., span, =, trait_symbol, ., span, (, ), ,, ., name, =, trait_symbol, ., name, ,, }, }, ), ;, return, error, ., CompileError, ;, }, try, visited, ., put, (, trait_symbol, ,, void, {, }, ), ;, defer, _, =, visited, ., swapRemove, (, trait_symbol, ), ;, for, (, trait_symbol, ., decl, .?, ., trait, ., super_traits, ., items, ), |, super_trait, |, {, const, super_trait_symbol, =, super_trait, ., symbol, (, ), .?, ;, try, self, ., validate_super_name_collision, (, super_trait_symbol, ,, method_token, ,, visited, ), ;, for, (, super_trait_symbol, ., decl, .?, ., trait, ., method_decls, ., items, ), |, super_decl, |, {, const, super_method_name, =, super_decl, ., method_decl, ., name, ., token, (, ), ., data, ;, if, (, std, ., mem, ., eql, (, u8, ,, super_method_name, ,, method_token, ., data, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., duplicate, =, ., {, ., span, =, method_token, ., span, ,, ., thing, =, "method", ,, ., identifier, =, method_token, ., data, ,, ., first, =, super_decl, ., token, (, ), ., span, ,, }, }, ), ;, }, }, }, }, fn, is_capitalized, (, name, :, [, ], const, u8, ), bool, {, var, should_be_upper, =, true, ;, for, (, name, ), |, c, |, {, if, (, should_be_upper, and, std, ., ascii, ., isLower, (, c, ), ), {, return, false, ;, }, should_be_upper, =, c, ==, '_', ;, }, return, true, ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, args_, =, @, import, (, "args.zig", ), ;, const, Const_Eval, =, @, import, (, "../semantic/const_eval.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, defaults_, =, @, import, (, "defaults.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, poison_, =, @, import, (, "../ast/poison.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, Tree_Writer, =, @, import, (, "../ast/tree_writer.zig", ), ;, const, typing_, =, @, import, (, "typing.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, walk_, =, @, import, (, "../ast/walker.zig", ), ;, const, Validate_Error_Enum, =, error, {, CompileError, ,, UnexpectedTypeType, ,, OutOfMemory, ,, }, ;, const, Self, :, type, =, @, This, (, ), ;, ctx, :, *, Compiler_Context, ,, map, :, std, ., AutoArrayHashMap, (, *, ast_, ., AST, ,, *, Type_AST, ), ,, pub, fn, init, (, ctx, :, *, Compiler_Context, ), Self, {, return, Self, {, ., ctx, =, ctx, ,, ., map, =, std, ., AutoArrayHashMap, (, *, ast_, ., AST, ,, *, Type_AST, ), ., init, (, ctx, ., allocator, (, ), ), ,, }, ;, }, pub, fn, typeof, (, self, :, *, const, Self, ,, ast, :, *, ast_, ., AST, ), *, Type_AST, {, if, (, (, ast, ., common, (, ), ., validation_state, !=, ., valid, and, ast, ., common, (, ), ., validation_state, !=, ., invalid, ), ), {, std, ., debug, ., panic, (, "type for ast {f} has not been constructed", ,, ., {, ast, }, ), ;, }, return, self, ., map, ., get, (, ast, ), orelse, poison_, ., poisoned_type, ;, }, pub, fn, assert_typeof, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, _type, :, *, Type_AST, ), void, {, ast, ., common, (, ), ., validation_state, =, ., valid, ;, self, ., map, ., put, (, ast, ,, _type, ), catch, unreachable, ;, }, pub, fn, typecheck_AST, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, expected, :, ?, *, Type_AST, ), Validate_Error_Enum, !, *, Type_AST, {, if, (, ast, ., common, (, ), ., validation_state, ==, ., validating, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., recursive_definition, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., symbol_name, =, null, ,, }, }, ), ;, return, error, ., CompileError, ;, }, else, if, (, ast, ., common, (, ), ., validation_state, !=, ., unvalidated, ), {, return, self, ., typeof, (, ast, ), ;, }, var, expected_type, =, expected, ;, ast, ., common, (, ), ., validation_state, =, ., validating, ;, if, (, expected_type, !=, null, and, expected_type, .?, .*, ==, ., poison, ), {, expected_type, =, null, ;, }, if, (, expected_type, ), |, _, |, {, const, expanded, =, expected_type, .?, ., expand_identifier, (, ), ;, if, (, expected_type, .?, .*, ==, ., type_of, ), {, expected_type, .?, .*, =, expanded, .*, ;, }, if, (, expected_type, .?, .*, ==, ., annotation, ), {, expected_type, =, expected_type, .?, ., child, (, ), ;, }, if, (, expected_type, .?, .*, ==, ., access, ), {, expected_type, =, expected_type, .?, ., symbol, (, ), .?, ., init_typedef, (, ), ;, }, }, const, actual_type, =, self, ., typecheck_AST_internal, (, ast, ,, expected_type, ), catch, |, e, |, {, ast, ., common, (, ), ., validation_state, =, ., invalid, ;, return, e, ;, }, ;, if, (, expected_type, ), |, _, |, {, if, (, !, prelude_, ., unit_type, ., types_match, (, expected_type, .?, ), or, (, actual_type, .*, ==, ., enum_type, and, actual_type, ., enum_type, ., from, ==, ., @, "error", ), ), typing_, ., type_check, (, ast, ., token, (, ), ., span, ,, actual_type, ,, expected_type, .?, ,, &, self, ., ctx, ., errors, ), catch, |, e, |, {, ast, ., common, (, ), ., validation_state, =, ., invalid, ;, return, e, ;, }, ;, }, self, ., map, ., put, (, ast, ,, actual_type, ), catch, unreachable, ;, if, (, actual_type, .*, !=, ., poison, ), {, ast, ., common, (, ), ., validation_state, =, ., invalid, ;, }, else, {, ast, ., common, (, ), ., validation_state, =, ., valid, ;, }, return, actual_type, ;, }, var, depth, :, usize, =, 0, ;, fn, typecheck_AST_internal, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, expected, :, ?, *, Type_AST, ), Validate_Error_Enum, !, *, Type_AST, {, depth, +=, 1, ;, switch, (, ast, .*, ), {, ., poison, =>, return, poison_, ., poisoned_type, ,, ., module, ,, ., trait, ,, ., impl, ,, ., enum_decl, ,, ., struct_decl, ,, ., type_alias, ,, ., unit_value, ,, =>, return, prelude_, ., unit_type, ,, ., pattern_symbol, =>, return, ast, ., symbol, (, ), .?, ., type, (, ), ,, ., int, =>, return, try, typing_, ., type_check_int, (, ast, ,, expected, ,, &, self, ., ctx, ., errors, ), ,, ., float, =>, return, try, typing_, ., type_check_float, (, ast, ,, expected, ,, &, self, ., ctx, ., errors, ), ,, ., string, =>, return, prelude_, ., string_type, ,, ., identifier, =>, {, const, symbol, =, ast, ., symbol, (, ), .?, ;, if, (, symbol, ., validation_state, ==, ., invalid, ), {, return, error, ., CompileError, ;, }, try, self, ., ctx, ., validate_symbol, ., validate_symbol, (, symbol, ), ;, if, (, symbol, ., is_type, (, ), or, symbol, ., kind, ==, ., context, ), {, if, (, expected, !=, null, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., unexpected_type_type, =, ., {, ., expected, =, expected, ,, ., span, =, ast, ., token, (, ), ., span, }, }, ), ;, return, error, ., CompileError, ;, }, return, error, ., UnexpectedTypeType, ;, }, if, (, symbol, ., decl, .?, ., num_generic_params, (, ), >, 0, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., unapplied_generic, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., symbol_name, =, symbol, ., name, ,, ., num_generics, =, symbol, ., decl, .?, ., num_generic_params, (, ), ,, }, }, ), ;, return, error, ., CompileError, ;, }, return, symbol, ., type, (, ), ;, }, ,, ., access, =>, {, _, =, self, ., typecheck_AST, (, ast, ., lhs, (, ), ,, null, ), catch, |, e, |, switch, (, e, ), {, error, ., UnexpectedTypeType, =>, {, }, ,, else, =>, return, e, ,, }, ;, const, symbol, =, ast, ., symbol, (, ), .?, ;, if, (, symbol, ., validation_state, ==, ., invalid, ), {, return, error, ., CompileError, ;, }, try, self, ., ctx, ., validate_symbol, ., validate_symbol, (, symbol, ), ;, if, (, symbol, ., decl, .?, ., num_generic_params, (, ), >, 0, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., unapplied_generic, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., symbol_name, =, symbol, ., name, ,, ., num_generics, =, symbol, ., decl, .?, ., num_generic_params, (, ), ,, }, }, ), ;, return, error, ., CompileError, ;, }, if, (, symbol, ., is_type, (, ), ), {, if, (, expected, !=, null, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., unexpected_type_type, =, ., {, ., expected, =, expected, ,, ., span, =, ast, ., token, (, ), ., span, }, }, ), ;, return, error, ., CompileError, ;, }, else, {, return, prelude_, ., unit_type, ;, }, }, else, {, return, symbol, ., type, (, ), ;, }, }, ,, ., true, ,, ., false, =>, return, prelude_, ., bool_type, ,, ., not, =>, {, _, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, prelude_, ., bool_type, ), catch, return, error, ., CompileError, ;, return, prelude_, ., bool_type, ;, }, ,, ., negate, =>, {, const, expr_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, expected, ), catch, return, error, ., CompileError, ;, try, typing_, ., type_check_arithmetic, (, ast, ., token, (, ), ., span, ,, expr_type, ,, &, self, ., ctx, ., errors, ), ;, return, expr_type, ;, }, ,, ., dereference, =>, {, const, expr_span, =, ast, ., expr, (, ), ., token, (, ), ., span, ;, const, expr_expected_type, :, ?, *, Type_AST, =, if, (, expected, !=, null, ), Type_AST, ., create_addr_of_type, (, ast, ., token, (, ), ,, expected, .?, ,, false, ,, false, ,, self, ., ctx, ., allocator, (, ), ), else, null, ;, const, expr_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, expr_expected_type, ), catch, return, error, ., CompileError, ;, const, expanded_expr_type, =, expr_type, ., expand_identifier, (, ), ;, if, (, expanded_expr_type, .*, !=, ., addr_of, ), {, return, typing_, ., throw_wrong_from, (, "address", ,, "dereference", ,, expanded_expr_type, ,, expr_span, ,, &, self, ., ctx, ., errors, ), ;, }, else, {, return, expanded_expr_type, ., child, (, ), ;, }, }, ,, ., @, "try", =>, {, const, expr_span, =, ast, ., expr, (, ), ., token, (, ), ., span, ;, const, expr_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, null, ), catch, return, error, ., CompileError, ;, var, expanded_expr_type, =, expr_type, ., expand_identifier, (, ), ;, if, (, expanded_expr_type, .*, !=, ., enum_type, or, expanded_expr_type, ., enum_type, ., from, !=, ., @, "error", ), {, return, typing_, ., throw_wrong_from, (, "error", ,, "try", ,, expanded_expr_type, ,, expr_span, ,, &, self, ., ctx, ., errors, ), ;, }, const, expanded_function_codomain, =, ast, ., symbol, (, ), .?, ., type, (, ), ., rhs, (, ), ., expand_identifier, (, ), ;, if, (, expanded_function_codomain, .*, !=, ., enum_type, or, expanded_function_codomain, ., enum_type, ., from, !=, ., @, "error", ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., msg, =, "enclosing function around try expression does not return an error", ,, }, }, ), ;, return, error, ., CompileError, ;, }, else, {, const, expr_error_type, =, expanded_expr_type, ., get_err_type, (, ), ., child, (, ), ;, const, function_error_type, =, expanded_function_codomain, ., get_err_type, (, ), ., child, (, ), ;, if, (, !, expr_error_type, ., types_match, (, function_error_type, ), ), {, return, typing_, ., throw_unexpected_type, (, expr_span, ,, expanded_expr_type, ,, expanded_function_codomain, ,, &, self, ., ctx, ., errors, ), ;, }, }, return, expanded_expr_type, ., get_ok_type, (, ), ., child, (, ), ;, }, ,, ., default, =>, {, try, self, ., ctx, ., validate_type, ., validate_type, (, ast, ., default, ., _type, ), ;, return, ast, ., default, ., _type, ;, }, ,, ., size_of, =>, {, try, self, ., ctx, ., validate_type, ., validate_type, (, ast, ., size_of, ., _type, ), ;, return, prelude_, ., int_type, ;, }, ,, ., @, "comptime", =>, {, const, expr_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, expected, ), catch, return, error, ., CompileError, ;, const, expr_expanded_type, =, expr_type, ., expand_identifier, (, ), ;, if, (, expr_expanded_type, ., types_match, (, prelude_, ., void_type, ), ), {, return, typing_, ., throw_unexpected_void_type, (, ast, ., expr, (, ), ., token, (, ), ., span, ,, &, self, ., ctx, ., errors, ), ;, }, return, expr_type, ;, }, ,, ., assign, =>, {, try, self, ., validate_L_Value, (, ast, ., lhs, (, ), ), ;, const, lhs_type, =, self, ., typecheck_AST, (, ast, ., lhs, (, ), ,, null, ), catch, return, error, ., CompileError, ;, const, rhs_expected, :, ?, *, Type_AST, =, if, (, ast, ., lhs, (, ), .*, ==, ., identifier, and, std, ., mem, ., eql, (, u8, ,, ast, ., lhs, (, ), ., token, (, ), ., data, ,, "_", ), ), null, else, lhs_type, ;, _, =, self, ., typecheck_AST, (, ast, ., rhs, (, ), ,, rhs_expected, ), catch, return, error, ., CompileError, ;, try, self, ., assert_mutable, (, ast, ., lhs, (, ), ), ;, return, prelude_, ., unit_type, ;, }, ,, ., @, "or", ,, ., @, "and", =>, {, _, =, self, ., typecheck_AST, (, ast, ., lhs, (, ), ,, prelude_, ., bool_type, ), catch, return, error, ., CompileError, ;, _, =, self, ., typecheck_AST, (, ast, ., rhs, (, ), ,, prelude_, ., bool_type, ), catch, return, error, ., CompileError, ;, return, prelude_, ., bool_type, ;, }, ,, ., add, ,, ., sub, ,, ., mult, ,, ., div, =>, {, const, lhs_type, =, try, self, ., binary_operator_open, (, ast, ,, expected, ), ;, const, expanded_lhs_type, =, lhs_type, ., expand_identifier, (, ), ;, try, typing_, ., type_check_arithmetic, (, ast, ., token, (, ), ., span, ,, expanded_lhs_type, ,, &, self, ., ctx, ., errors, ), ;, return, expanded_lhs_type, ;, }, ,, ., mod, =>, {, const, lhs_type, =, try, self, ., binary_operator_open, (, ast, ,, null, ), ;, try, typing_, ., type_check_integral, (, ast, ., token, (, ), ., span, ,, lhs_type, ,, &, self, ., ctx, ., errors, ), ;, return, lhs_type, ;, }, ,, ., equal, ,, ., not_equal, =>, {, const, lhs_type, =, try, self, ., binary_operator_open, (, ast, ,, null, ), ;, try, typing_, ., type_check_eq, (, ast, ., token, (, ), ., span, ,, lhs_type, ,, &, self, ., ctx, ., errors, ), ;, return, prelude_, ., bool_type, ;, }, ,, ., greater, ,, ., lesser, ,, ., greater_equal, ,, ., lesser_equal, =>, {, const, lhs_type, =, try, self, ., binary_operator_open, (, ast, ,, null, ), ;, try, typing_, ., type_check_ord, (, ast, ., token, (, ), ., span, ,, lhs_type, ,, &, self, ., ctx, ., errors, ), ;, return, prelude_, ., bool_type, ;, }, ,, ., @, "catch", ,, ., @, "orelse", =>, {, const, lhs_span, =, ast, ., lhs, (, ), ., token, (, ), ., span, ;, const, lhs_type, =, self, ., typecheck_AST, (, ast, ., lhs, (, ), ,, null, ), catch, return, error, ., CompileError, ;, _, =, self, ., typecheck_AST, (, ast, ., rhs, (, ), ,, expected, ), catch, return, error, ., CompileError, ;, var, expanded_lhs_type, =, lhs_type, ., expand_identifier, (, ), ;, try, typing_, ., coalesce_operator, (, expanded_lhs_type, ,, ast, ,, lhs_span, ,, &, self, ., ctx, ., errors, ), ;, return, expanded_lhs_type, ., get_nominal_type, (, ), ., child, (, ), ;, }, ,, ., bit_and, ,, ., bit_or, ,, ., bit_xor, =>, {, var, retval, :, ?, *, Type_AST, =, null, ;, for, (, 0..ast.children, (, ), ., items, ., len, ), |, i, |, {, const, arg_type, =, self, ., typecheck_AST, (, ast, ., children, (, ), ., items, [, i, ], ,, expected, orelse, prelude_, ., word64_type, ), catch, return, error, ., CompileError, ;, if, (, retval, ==, null, ), {, retval, =, arg_type, ;, }, try, typing_, ., type_check_bits, (, ast, ., children, (, ), ., items, [, i, ], ., token, (, ), ., span, ,, arg_type, ,, &, self, ., ctx, ., errors, ), ;, }, return, retval, .?, ;, }, ,, ., bit_not, =>, {, const, expr_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, expected, orelse, prelude_, ., word64_type, ), catch, return, error, ., CompileError, ;, try, typing_, ., type_check_bits, (, ast, ., token, (, ), ., span, ,, expr_type, ,, &, self, ., ctx, ., errors, ), ;, return, expr_type, ;, }, ,, ., left_shift, ,, ., right_shift, =>, {, const, lhs_type, =, self, ., typecheck_AST, (, ast, ., lhs, (, ), ,, expected, orelse, prelude_, ., word64_type, ), catch, return, error, ., CompileError, ;, _, =, self, ., typecheck_AST, (, ast, ., rhs, (, ), ,, lhs_type, ), catch, return, error, ., CompileError, ;, try, typing_, ., type_check_bits, (, ast, ., token, (, ), ., span, ,, lhs_type, ,, &, self, ., ctx, ., errors, ), ;, return, lhs_type, ;, }, ,, ., call, =>, {, const, lhs_span, =, ast, ., lhs, (, ), ., token, (, ), ., span, ;, var, lhs_type, =, self, ., typecheck_AST, (, ast, ., lhs, (, ), ,, null, ), catch, return, error, ., CompileError, ;, const, expanded_lhs_type, =, lhs_type, ., expand_identifier, (, ), ;, if, (, expanded_lhs_type, .*, !=, ., function, ), {, return, typing_, ., throw_wrong_from, (, "function", ,, "call", ,, expanded_lhs_type, ,, lhs_span, ,, &, self, ., ctx, ., errors, ,, ), ;, }, try, self, ., validate_context, (, expanded_lhs_type, ,, ast, ), ;, const, domain, =, expanded_lhs_type, ., function, ., args, ;, const, codomain, =, expanded_lhs_type, ., rhs, (, ), ;, const, variadic, =, expanded_lhs_type, ., function, ., variadic, ;, var, args_validator, =, args_, ., init, (, ., function, ,, ast, ., children, (, ), ,, ast, ., token, (, ), ., span, ,, &, domain, ,, &, self, ., ctx, ., errors, ,, self, ., ctx, ., allocator, (, ), ), ;, args_validator, ., set_variadic, (, variadic, ), ;, ast, ., set_children, (, try, args_validator, ., default_args, (, ), ), ;, args_validator, ., implicit_ref, (, ), ;, try, args_validator, ., validate_args_arity, (, ), ;, _, =, try, self, ., validate_args_type, (, ast, ., children, (, ), ,, &, domain, ,, variadic, ), ;, return, codomain, ;, }, ,, ., index, =>, {, const, lhs_span, =, ast, ., lhs, (, ), ., token, (, ), ., span, ;, const, lhs_type, =, self, ., typecheck_AST, (, ast, ., lhs, (, ), ,, null, ), catch, return, error, ., CompileError, ;, if, (, ast, ., children, (, ), ., items, ., len, >, 1, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., msg, =, "too many indices", }, }, ), ;, return, error, ., CompileError, ;, }, _, =, self, ., typecheck_AST, (, ast, ., children, (, ), ., items, [, 0, ], ,, prelude_, ., int_type, ), catch, return, error, ., CompileError, ;, const, expanded_lhs_type, =, try, self, ., implicit_dereference, (, ast, ,, lhs_type, ., expand_identifier, (, ), ), ;, if, (, expanded_lhs_type, .*, ==, ., struct_type, ), {, if, (, expanded_lhs_type, ., struct_type, ., was_slice, ), {, return, expanded_lhs_type, ., children, (, ), ., items, [, 0, ], ., child, (, ), ., child, (, ), ;, }, else, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., not_indexable, =, ., {, ., span, =, lhs_span, ,, ., _type, =, expanded_lhs_type, }, }, ), ;, return, error, ., CompileError, ;, }, }, else, if, (, expanded_lhs_type, .*, ==, ., tuple_type, ), {, try, walk_, ., walk_ast, (, ast, ., children, (, ), ., items, [, 0, ], ,, Const_Eval, ., new, (, self, ., ctx, ), ), ;, if, (, ast, ., children, (, ), ., items, [, 0, ], .*, !=, ., int, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., msg, =, "not a constant integer", }, }, ), ;, return, error, ., CompileError, ;, }, const, pos, =, ast, ., children, (, ), ., items, [, 0, ], ., int, ., data, ;, ast, .*, =, ast_, ., AST, ., create_select, (, ast, ., token, (, ), ,, ast, ., lhs, (, ), ,, ast, ., children, (, ), ., items, [, 0, ], ,, self, ., ctx, ., allocator, (, ), ), .*, ;, ast, ., set_pos, (, @, as, (, usize, ,, @, intCast, (, pos, ), ), ), ;, return, self, ., typecheck_AST, (, ast, ,, expected, ), ;, }, else, if, (, expanded_lhs_type, .*, ==, ., array_of, ), {, return, expanded_lhs_type, ., child, (, ), ;, }, else, if, (, expanded_lhs_type, .*, ==, ., addr_of, and, expanded_lhs_type, ., addr_of, ., multiptr, ), {, return, expanded_lhs_type, ., child, (, ), ;, }, else, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., not_indexable, =, ., {, ., span, =, lhs_span, ,, ., _type, =, expanded_lhs_type, }, }, ), ;, return, error, ., CompileError, ;, }, }, ,, ., generic_apply, =>, {, const, symbol, =, ast, ., symbol, (, ), .?, ;, if, (, symbol, ., validation_state, ==, ., invalid, ), {, return, error, ., CompileError, ;, }, try, self, ., ctx, ., validate_symbol, ., validate_symbol, (, symbol, ), ;, if, (, symbol, ., is_type, (, ), or, symbol, ., kind, ==, ., context, ), {, if, (, expected, !=, null, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., unexpected_type_type, =, ., {, ., expected, =, expected, ,, ., span, =, ast, ., token, (, ), ., span, }, }, ), ;, return, error, ., CompileError, ;, }, return, error, ., UnexpectedTypeType, ;, }, return, symbol, ., type, (, ), ;, }, ,, ., select, =>, {, const, lhs_type, =, self, ., typecheck_AST, (, ast, ., lhs, (, ), ,, null, ), catch, return, error, ., CompileError, ;, const, expanded_lhs_type, =, try, self, ., implicit_dereference, (, ast, ,, lhs_type, ., expand_identifier, (, ), ), ;, if, (, ast, ., pos, (, ), ==, null, ), {, ast, ., set_pos, (, try, typing_, ., find_select_pos, (, expanded_lhs_type, ,, ast, ., rhs, (, ), ., token, (, ), ., data, ,, ast, ., token, (, ), ., span, ,, &, self, ., ctx, ., errors, ), ), ;, }, var, select_lhs_type, =, expanded_lhs_type, ;, if, (, ast, ., pos, (, ), .?, <, 0, or, ast, ., pos, (, ), .?, >=, select_lhs_type, ., children, (, ), ., items, ., len, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., bad_index, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., _type, =, lhs_type, ,, ., index, =, ast, ., pos, (, ), .?, ,, ., length, =, select_lhs_type, ., children, (, ), ., items, ., len, ,, }, }, ), ;, return, error, ., CompileError, ;, }, var, retval, =, select_lhs_type, ., children, (, ), ., items, [, ast, ., pos, (, ), .?, ], ;, while, (, retval, .*, ==, ., annotation, ), {, retval, =, retval, ., child, (, ), ;, }, return, retval, ;, }, ,, ., invoke, =>, {, const, true_lhs_type, =, self, ., typecheck_AST, (, ast, ., lhs, (, ), ,, null, ), catch, return, error, ., CompileError, ;, var, method_decl, :, ?, *, ast_, ., AST, =, undefined, ;, if, (, true_lhs_type, ., expand_identifier, (, ), .*, ==, ., dyn_type, ), {, const, trait_symbol, =, true_lhs_type, ., expand_identifier, (, ), ., child, (, ), ., symbol, (, ), .?, ;, const, trait, =, trait_symbol, ., decl, .?, ;, method_decl, =, trait, ., trait, ., find_method, (, ast, ., rhs, (, ), ., token, (, ), ., data, ), ;, if, (, method_decl, !=, null, and, !, method_decl, .?, ., method_decl, ., is_virtual, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., invoke_not_virtual, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., method_name, =, ast, ., rhs, (, ), ., token, (, ), ., data, ,, ., trait_name, =, trait_symbol, ., name, ,, }, ,, }, ), ;, return, error, ., CompileError, ;, }, }, else, {, const, lhs_type, =, if, (, true_lhs_type, .*, ==, ., addr_of, ), true_lhs_type, ., child, (, ), else, true_lhs_type, ;, try, self, ., ctx, ., validate_type, ., validate_type, (, lhs_type, ), ;, method_decl, =, try, ast, ., scope, (, ), .?, ., lookup_impl_member, (, lhs_type, ,, ast, ., rhs, (, ), ., token, (, ), ., data, ,, self, ., ctx, ), ;, }, if, (, method_decl, ==, null, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., type_not_impl_method, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., method_name, =, ast, ., rhs, (, ), ., token, (, ), ., data, ,, ., _type, =, true_lhs_type, ,, }, ,, }, ), ;, return, error, ., CompileError, ;, }, const, method_decl_type, =, self, ., typecheck_AST, (, method_decl, .?, ,, null, ), catch, return, error, ., CompileError, ;, ast, ., invoke, ., method_decl, =, method_decl, .?, ;, const, domain, :, std, ., array_list, ., Managed, (, *, Type_AST, ), =, method_decl, .?, ., decl_type, (, ), ., function, ., args, ;, const, expanded_true_lhs_type, =, true_lhs_type, ., expand_identifier, (, ), ;, if, (, method_decl, .?, ., method_decl, ., receiver, !=, null, and, !, ast, ., invoke, ., prepended, ), {, const, receiver_kind, :, ?, ast_, ., Receiver_Kind, =, method_decl, .?, ., method_decl, ., receiver, .?, ., receiver, ., kind, ;, if, (, expanded_true_lhs_type, .*, ==, ., dyn_type, or, expanded_true_lhs_type, .*, ==, ., addr_of, ), {, if, (, !, expanded_true_lhs_type, ., mut, (, ), and, receiver_kind, ==, ., mut_addr_of, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., invoke_receiver_mismatch, =, ., {, ., lhs_type, =, true_lhs_type, ,, ., method_name, =, method_decl, .?, ., method_decl, ., name, ., token, (, ), ., data, ,, ., method_receiver, =, receiver_kind, .?, ,, ., receiver_span, =, ast, ., lhs, (, ), ., token, (, ), ., span, ,, }, }, ), ;, return, error, ., CompileError, ;, }, ast, ., children, (, ), ., insert, (, 0, ,, ast, ., lhs, (, ), ), catch, unreachable, ;, ast, ., invoke, ., prepended, =, true, ;, }, else, {, const, addr_of, =, ast_, ., AST, ., create_addr_of, (, ast, ., lhs, (, ), ., token, (, ), ,, ast, ., lhs, (, ), ,, receiver_kind, .?, ==, ., mut_addr_of, ,, false, ,, self, ., ctx, ., allocator, (, ), ), ;, ast, ., children, (, ), ., insert, (, 0, ,, addr_of, ), catch, unreachable, ;, ast, ., invoke, ., prepended, =, true, ;, }, }, else, if, (, ast, ., invoke, ., prepended, ), {, ast, ., set_lhs, (, ast, ., children, (, ), ., items, [, 0, ], ), ;, }, try, self, ., validate_context, (, method_decl_type, ,, ast, ), ;, var, args_validator, =, args_, ., init, (, ., method, ,, ast, ., children, (, ), ,, ast, ., token, (, ), ., span, ,, &, domain, ,, &, self, ., ctx, ., errors, ,, self, ., ctx, ., allocator, (, ), ), ;, ast, ., set_children, (, try, args_validator, ., default_args, (, ), ), ;, try, args_validator, ., validate_args_arity, (, ), ;, _, =, try, self, ., validate_args_type, (, ast, ., children, (, ), ,, &, domain, ,, false, ), ;, return, ast, ., invoke, ., method_decl, .?, ., method_decl, ., ret_type, ;, }, ,, ., dyn_value, =>, {, var, expr_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, null, ), catch, return, error, ., CompileError, ;, while, (, expr_type, .*, ==, ., addr_of, ), {, ast, ., set_expr, (, ast_, ., AST, ., create_dereference, (, ast, ., token, (, ), ,, ast, ., expr, (, ), ,, self, ., ctx, ., allocator, (, ), ), ), ;, expr_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, null, ), catch, return, error, ., CompileError, ;, }, try, self, ., ctx, ., validate_type, ., validate_type, (, ast, ., dyn_value, ., dyn_type, ), ;, if, (, expr_type, .*, ==, ., identifier, and, expr_type, ., symbol, (, ), !=, null, and, expr_type, ., symbol, (, ), .?, ., decl, .?, .*, ==, ., type_param_decl, ), {, const, type_param_decl, =, expr_type, ., symbol, (, ), .?, ., decl, .?, ;, var, found_constraint, =, false, ;, for, (, type_param_decl, ., type_param_decl, ., constraints, ., items, ), |, constraint, |, {, const, constraint_trait, =, constraint, ., symbol, (, ), .?, ;, const, dyn_trait, =, ast, ., dyn_value, ., dyn_type, ., child, (, ), ., symbol, (, ), .?, ;, if, (, constraint_trait, ==, dyn_trait, ), {, found_constraint, =, true, ;, break, ;, }, }, if, (, !, found_constraint, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., type_not_impl_trait, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., trait_name, =, ast, ., dyn_value, ., dyn_type, ., child, (, ), ., symbol, (, ), .?, ., name, ,, ., _type, =, expr_type, ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, else, {, const, impl, =, ast, ., scope, (, ), .?, ., impl_trait_lookup, (, expr_type, ,, ast, ., dyn_value, ., dyn_type, ., child, (, ), ., symbol, (, ), .?, ), ;, if, (, impl, ., ast, ==, null, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., type_not_impl_trait, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., trait_name, =, ast, ., dyn_value, ., dyn_type, ., child, (, ), ., symbol, (, ), .?, ., name, ,, ., _type, =, expr_type, ,, }, }, ), ;, return, error, ., CompileError, ;, }, ast, ., dyn_value, ., impl, =, impl, ., ast, ;, }, return, ast, ., dyn_value, ., dyn_type, ;, }, ,, ., context_value, =>, {, try, self, ., ctx, ., validate_type, ., validate_type, (, ast, ., context_value, ., parent, ), ;, const, expanded_expected, :, *, Type_AST, =, if, (, expected, ==, null, ), ast, ., context_value, ., parent, ., expand_identifier, (, ), else, expected, .?, ., expand_identifier, (, ), ;, if, (, expanded_expected, .*, ==, ., context_type, ), {, var, args_validator, =, args_, ., init, (, ., context, ,, ast, ., children, (, ), ,, ast, ., token, (, ), ., span, ,, expanded_expected, ., children, (, ), ,, &, self, ., ctx, ., errors, ,, self, ., ctx, ., allocator, (, ), ), ;, ast, ., set_children, (, try, args_validator, ., default_args, (, ), ), ;, try, args_validator, ., validate_args_arity, (, ), ;, _, =, try, self, ., validate_args_type, (, ast, ., children, (, ), ,, expanded_expected, ., children, (, ), ,, false, ), ;, return, ast, ., context_value, ., parent, ;, }, else, if, (, ast, ., context_value, ., parent, ., expand_identifier, (, ), .*, !=, ., context_type, ), {, return, typing_, ., throw_wrong_from, (, "context", ,, "context value", ,, ast, ., context_value, ., parent, ,, ast, ., token, (, ), ., span, ,, &, self, ., ctx, ., errors, ), ;, }, else, if, (, !, prelude_, ., unit_type, ., types_match, (, expanded_expected, ), ), {, return, typing_, ., throw_unexpected_type, (, ast, ., token, (, ), ., span, ,, expanded_expected, ,, ast, ., context_value, ., parent, ,, &, self, ., ctx, ., errors, ), ;, }, else, {, return, prelude_, ., unit_type, ;, }, }, ,, ., struct_value, =>, {, try, self, ., ctx, ., validate_type, ., validate_type, (, ast, ., struct_value, ., parent, ), ;, const, expanded_expected, :, *, Type_AST, =, if, (, expected, ==, null, ), ast, ., struct_value, ., parent, ., expand_identifier, (, ), else, expected, .?, ., expand_identifier, (, ), ;, if, (, expanded_expected, .*, ==, ., struct_type, ), {, var, args_validator, =, args_, ., init, (, ., @, "struct", ,, ast, ., children, (, ), ,, ast, ., token, (, ), ., span, ,, expanded_expected, ., children, (, ), ,, &, self, ., ctx, ., errors, ,, self, ., ctx, ., allocator, (, ), ), ;, ast, ., set_children, (, try, args_validator, ., default_args, (, ), ), ;, try, args_validator, ., validate_args_arity, (, ), ;, _, =, try, self, ., validate_args_type, (, ast, ., children, (, ), ,, expanded_expected, ., children, (, ), ,, false, ), ;, return, ast, ., struct_value, ., parent, ;, }, else, if, (, ast, ., struct_value, ., parent, ., expand_identifier, (, ), .*, !=, ., struct_type, ), {, return, typing_, ., throw_wrong_from, (, "struct", ,, "struct value", ,, ast, ., struct_value, ., parent, ,, ast, ., token, (, ), ., span, ,, &, self, ., ctx, ., errors, ), ;, }, else, if, (, !, prelude_, ., unit_type, ., types_match, (, expanded_expected, ), ), {, return, typing_, ., throw_unexpected_type, (, ast, ., token, (, ), ., span, ,, expanded_expected, ,, ast, ., struct_value, ., parent, ,, &, self, ., ctx, ., errors, ), ;, }, else, {, return, prelude_, ., unit_type, ;, }, }, ,, ., tuple_value, =>, {, const, expanded_expected, :, ?, *, Type_AST, =, if, (, expected, ==, null, ), null, else, expected, .?, ., expand_identifier, (, ), ;, var, terms, :, std, ., array_list, ., Managed, (, *, Type_AST, ), =, undefined, ;, if, (, expanded_expected, ==, null, ), {, terms, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, for, (, 0..ast.children, (, ), ., items, ., len, ), |, i, |, {, const, term_type, =, self, ., typecheck_AST, (, ast, ., children, (, ), ., items, [, i, ], ,, null, ), catch, return, error, ., CompileError, ;, terms, ., append, (, term_type, ), catch, unreachable, ;, }, }, else, if, (, expanded_expected, !=, null, and, expanded_expected, .?, .*, ==, ., tuple_type, ), {, var, args_validator, =, args_, ., init, (, ., tuple, ,, ast, ., children, (, ), ,, ast, ., token, (, ), ., span, ,, expanded_expected, .?, ., children, (, ), ,, &, self, ., ctx, ., errors, ,, self, ., ctx, ., allocator, (, ), ), ;, try, args_validator, ., validate_args_arity, (, ), ;, _, =, try, self, ., validate_args_type, (, ast, ., children, (, ), ,, expanded_expected, .?, ., children, (, ), ,, false, ), ;, return, expected, .?, ;, }, else, {, return, typing_, ., throw_unexpected_type, (, ast, ., token, (, ), ., span, ,, expected, .?, ,, poison_, ., poisoned_type, ,, &, self, ., ctx, ., errors, ), ;, }, return, Type_AST, ., create_tuple_type, (, ast, ., token, (, ), ,, terms, ,, self, ., ctx, ., allocator, (, ), ), ;, }, ,, ., array_value, =>, {, const, expanded_expanded, =, get_expanded_expected, (, expected, ), ;, if, (, expanded_expanded, !=, null, and, expanded_expanded, .?, .*, !=, ., array_of, ), {, return, typing_, ., throw_wrong_from, (, "array", ,, "array value", ,, expanded_expanded, .?, ,, ast, ., token, (, ), ., span, ,, &, self, ., ctx, ., errors, ), ;, }, const, elem_type, =, if, (, expanded_expanded, ==, null, ), null, else, expanded_expanded, .?, ., array_of, ., _child, ;, if, (, ast, ., children, (, ), ., items, ., len, !=, 0, ), {, const, first_type, =, self, ., typecheck_AST, (, ast, ., children, (, ), ., items, [, 0, ], ,, elem_type, ), catch, return, error, ., CompileError, ;, for, (, ast, ., children, (, ), ., items, [, 1.., ], ), |, child, |, {, _, =, self, ., typecheck_AST, (, child, ,, first_type, ), catch, return, error, ., CompileError, ;, }, return, Type_AST, ., create_array_of, (, ast, ., token, (, ), ,, first_type, ,, ast_, ., AST, ., create_int, (, ast, ., token, (, ), ,, ast, ., children, (, ), ., items, ., len, ,, self, ., ctx, ., allocator, (, ), ), ,, self, ., ctx, ., allocator, (, ), ), ;, }, else, if, (, expanded_expanded, !=, null, ), {, return, expanded_expanded, .?, ;, }, else, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., msg, =, "cannot infer type for empty array", }, }, ), ;, return, error, ., CompileError, ;, }, }, ,, ., as, =>, {, const, child_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, null, ), catch, return, error, ., CompileError, ;, if, (, !, child_type, ., convertible_to, (, ast, ., type, (, ), ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., non_convertible, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., from, =, child_type, ,, ., to, =, ast, ., type, (, ), }, }, ), ;, return, error, ., CompileError, ;, }, return, ast, ., type, (, ), ;, }, ,, ., addr_of, =>, {, if, (, expected, ==, null, ), {, const, child_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, null, ), catch, return, error, ., CompileError, ;, try, self, ., validate_L_Value, (, ast, ., expr, (, ), ), ;, return, Type_AST, ., create_addr_of_type, (, ast, ., token, (, ), ,, child_type, ,, ast, ., addr_of, ., mut, ,, ast, ., addr_of, ., multiptr, ,, self, ., ctx, ., allocator, (, ), ), ;, }, else, {, const, expanded_expected, =, expected, .?, ., expand_identifier, (, ), ;, if, (, expanded_expected, .*, ==, ., dyn_type, ), {, ast, .*, =, ast_, ., AST, ., create_dyn_value, (, ast, ., token, (, ), ,, expanded_expected, ,, ast, ., expr, (, ), ,, ast, ., scope, (, ), .?, ,, ast, ., addr_of, ., mut, ,, self, ., ctx, ., allocator, (, ), ,, ), .*, ;, return, self, ., typecheck_AST, (, ast, ,, expected, ), ;, }, else, if, (, expanded_expected, .*, ==, ., anyptr_type, ), {, ast, ., addr_of, ., anytptr, =, true, ;, return, expanded_expected, ;, }, else, if, (, expanded_expected, .*, !=, ., addr_of, ), {, return, typing_, ., throw_unexpected_type, (, ast, ., token, (, ), ., span, ,, expected, .?, ,, poison_, ., poisoned_type, ,, &, self, ., ctx, ., errors, ), ;, }, _, =, expanded_expected, ., child, (, ), ., expand_identifier, (, ), ;, const, child_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, expanded_expected, ., child, (, ), ), catch, return, error, ., CompileError, ;, if, (, ast, ., addr_of, ., mut, ), {, try, self, ., assert_mutable, (, ast, ., expr, (, ), ), ;, }, return, Type_AST, ., create_addr_of_type, (, ast, ., token, (, ), ,, child_type, ,, ast, ., addr_of, ., mut, ,, ast, ., addr_of, ., multiptr, ,, self, ., ctx, ., allocator, (, ), ), ;, }, }, ,, ., slice_of, =>, {, const, expr_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, null, ), catch, return, error, ., CompileError, ;, if, (, expr_type, .*, !=, ., array_of, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., msg, =, "attempt to take slice-of something that is not an array", ,, }, }, ), ;, return, error, ., CompileError, ;, }, if, (, ast, ., slice_of, ., mut, ), {, try, self, ., assert_mutable, (, ast, ., expr, (, ), ), ;, }, const, retval, =, Type_AST, ., create_slice_type, (, expr_type, ., child, (, ), ,, ast, ., slice_of, ., mut, ,, self, ., ctx, ., allocator, (, ), ), ;, ast, .*, =, ast_, ., AST, ., create_slice_value, (, ast, ., expr, (, ), ,, ast, ., slice_of, ., mut, ,, expr_type, ,, self, ., ctx, ., allocator, (, ), ), .*, ;, _, =, self, ., typecheck_AST, (, ast, ,, null, ), catch, return, error, ., CompileError, ;, return, retval, ;, }, ,, ., sub_slice, =>, {, const, super_type, =, self, ., typecheck_AST, (, ast, ., sub_slice, ., super, ,, null, ), catch, return, error, ., CompileError, ;, const, expanded_super_type, =, super_type, ., expand_identifier, (, ), ;, _, =, self, ., typecheck_AST, (, ast, ., sub_slice, ., lower, .?, ,, null, ), catch, return, error, ., CompileError, ;, _, =, self, ., typecheck_AST, (, ast, ., sub_slice, ., upper, .?, ,, null, ), catch, return, error, ., CompileError, ;, if, (, expanded_super_type, .*, !=, ., struct_type, or, !, expanded_super_type, ., struct_type, ., was_slice, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., not_subsliceable, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., _type, =, expanded_super_type, ,, }, }, ), ;, return, error, ., CompileError, ;, }, return, expanded_super_type, ;, }, ,, ., enum_value, =>, {, if, (, ast, ., enum_value, ., base, ==, null, and, expected, ==, null, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., msg, =, "cannot infer type for initializer", }, }, ), ;, return, error, ., CompileError, ;, }, else, if, (, ast, ., enum_value, ., base, ==, null, ), {, ast, ., enum_value, ., base, =, expected, ;, }, const, expanded_base, :, *, Type_AST, =, ast, ., enum_value, ., base, .?, ., expand_identifier, (, ), ;, if, (, expanded_base, .*, !=, ., enum_type, ), {, return, typing_, ., throw_wrong_from, (, "enum", ,, "enum value", ,, expanded_base, ,, ast, ., token, (, ), ., span, ,, &, self, ., ctx, ., errors, ), ;, }, const, pos, =, expanded_base, ., get_pos, (, ast, ., token, (, ), ., data, ), ;, if, (, pos, ==, null, and, expanded_base, .*, ==, ., enum_type, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., member_not_in_type, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., identifier, =, ast, ., token, (, ), ., data, ,, ., name, =, "enum", ,, ., type, =, expanded_base, }, }, ), ;, return, error, ., CompileError, ;, }, ast, ., set_pos, (, expanded_base, ., get_pos, (, ast, ., token, (, ), ., data, ), ), ;, ast, ., enum_value, ., domain, =, expanded_base, ., children, (, ), ., items, [, ast, ., pos, (, ), .?, ], ;, if, (, ast, ., enum_value, ., init, ==, null, ), {, ast, ., enum_value, ., init, =, ast, ., enum_value, ., domain, .?, ., annotation, ., init, orelse, try, defaults_, ., generate_default, (, ast, ., enum_value, ., domain, .?, ., child, (, ), ,, ast, ., token, (, ), ., span, ,, &, self, ., ctx, ., errors, ,, self, ., ctx, ., allocator, (, ), ), ;, }, _, =, self, ., typecheck_AST, (, ast, ., enum_value, ., init, .?, ,, ast, ., enum_value, ., domain, .?, ., child, (, ), ), catch, return, error, ., CompileError, ;, return, ast, ., enum_value, ., base, .?, ;, }, ,, ., @, "if", =>, {, if, (, ast, ., @, "if", ., let, ), |, let, |, {, _, =, self, ., typecheck_AST, (, let, ,, null, ), catch, return, error, ., CompileError, ;, }, _, =, self, ., typecheck_AST, (, ast, ., @, "if", ., condition, ,, prelude_, ., bool_type, ), catch, return, error, ., CompileError, ;, var, expected_type, :, ?, *, Type_AST, =, undefined, ;, var, expanded_expected, :, *, Type_AST, =, undefined, ;, var, is_result_optional, :, bool, =, false, ;, if, (, expected, ==, null, ), {, expected_type, =, null, ;, }, else, {, expanded_expected, =, expected, .?, ., expand_identifier, (, ), ;, is_result_optional, =, expanded_expected, .*, ==, ., enum_type, and, expanded_expected, ., enum_type, ., from, ==, ., optional, and, !, expanded_expected, ., types_match, (, prelude_, ., void_type, ), ;, if, (, ast, ., else_block, (, ), !=, null, ), {, expected_type, =, expected, .?, ;, }, else, if, (, is_result_optional, ), {, expected_type, =, expanded_expected, ., get_some_type, (, ), ;, }, else, {, return, typing_, ., throw_unexpected_type, (, ast, ., token, (, ), ., span, ,, expected, .?, ,, poison_, ., poisoned_type, ,, &, self, ., ctx, ., errors, ), ;, }, }, const, body_type, =, self, ., typecheck_AST, (, ast, ., body_block, (, ), ,, expected_type, ), catch, return, error, ., CompileError, ;, var, else_type, :, ?, *, Type_AST, =, null, ;, if, (, ast, ., else_block, (, ), !=, null, ), {, else_type, =, self, ., typecheck_AST, (, ast, ., else_block, (, ), .?, ,, expected_type, ), catch, return, error, ., CompileError, ;, }, if, (, body_type, ., is_ident_type, (, "Void", ), and, ast, ., else_block, (, ), !=, null, ), {, return, else_type, .?, ;, }, else, if, (, ast, ., else_block, (, ), !=, null, or, prelude_, ., unit_type, ., types_match, (, body_type, ., expand_identifier, (, ), ), or, body_type, ., expand_identifier, (, ), ., types_match, (, prelude_, ., void_type, ), ), {, return, body_type, ;, }, else, {, return, Type_AST, ., create_optional_type, (, body_type, ,, self, ., ctx, ., allocator, (, ), ), ;, }, }, ,, ., match, =>, {, if, (, ast, ., match, ., let, !=, null, ), {, _, =, self, ., typecheck_AST, (, ast, ., match, ., let, .?, ,, null, ), catch, return, error, ., CompileError, ;, }, const, expr_type, =, self, ., typecheck_AST, (, ast, ., expr, (, ), ,, null, ), catch, return, error, ., CompileError, ;, const, expanded_expr_type, =, expr_type, ., expand_identifier, (, ), ;, var, retval, :, ?, *, Type_AST, =, null, ;, for, (, 0..ast.children, (, ), ., items, ., len, ), |, i, |, {, const, child_type, =, self, ., typecheck_AST, (, ast, ., children, (, ), ., items, [, i, ], ,, expected, ), catch, return, error, ., CompileError, ;, if, (, !, child_type, ., is_ident_type, (, "Void", ), ), {, retval, =, child_type, ;, }, try, self, ., ctx, ., validate_pattern, ., assert_pattern_matches, (, ast, ., children, (, ), ., items, [, i, ], ., lhs, (, ), ,, expanded_expr_type, ), ;, }, try, self, ., ctx, ., validate_pattern, ., exhaustive_check, (, expanded_expr_type, ,, ast, ., children, (, ), ,, ast, ., token, (, ), ., span, ), ;, return, retval, orelse, prelude_, ., void_type, ;, }, ,, ., mapping, =>, return, self, ., typecheck_AST, (, ast, ., rhs, (, ), ,, expected, ), ,, ., @, "while", =>, {, if, (, ast, ., @, "while", ., let, ), |, let, |, {, _, =, self, ., typecheck_AST, (, let, ,, null, ), catch, return, error, ., CompileError, ;, }, if, (, ast, ., @, "while", ., post, ), |, post, |, {, _, =, self, ., typecheck_AST, (, post, ,, null, ), catch, return, error, ., CompileError, ;, }, _, =, self, ., typecheck_AST, (, ast, ., @, "while", ., condition, ,, prelude_, ., bool_type, ), catch, return, error, ., CompileError, ;, _, =, self, ., typecheck_AST, (, ast, ., body_block, (, ), ,, null, ), catch, return, error, ., CompileError, ;, if, (, ast, ., else_block, (, ), !=, null, ), {, _, =, self, ., typecheck_AST, (, ast, ., else_block, (, ), .?, ,, null, ), catch, return, error, ., CompileError, ;, }, return, prelude_, ., unit_type, ;, }, ,, ., with, =>, {, for, (, ast, ., with, ., contexts, ., items, ), |, child, |, {, _, =, try, self, ., typecheck_AST, (, child, ,, null, ), ;, }, return, self, ., typecheck_AST, (, ast, ., with, ., _body_block, ,, expected, ), ;, }, ,, ., block, =>, {, var, last_type, :, ?, *, Type_AST, =, null, ;, for, (, 0..ast.children, (, ), ., items, ., len, ), |, i, |, {, const, expected_type, :, ?, *, Type_AST, =, if, (, ast, ., block, ., final, ==, null, and, i, ==, ast, ., children, (, ), ., items, ., len, -, 1, ), expected, else, null, ;, const, statement_type, =, self, ., typecheck_AST, (, ast, ., children, (, ), ., items, [, i, ], ,, expected_type, ), catch, return, error, ., CompileError, ;, const, statement, =, ast, ., children, (, ), ., items, [, i, ], ;, last_type, =, statement_type, ;, const, is_middle_statement, =, if, (, ast, ., block, ., final, ==, null, ), i, <, ast, ., children, (, ), ., items, ., len, -, 1, else, true, ;, if, (, (, statement, .*, !=, ., fn_decl, or, statement, ., fn_decl, ., name, ==, null, ), and, is_middle_statement, ), {, const, expanded_statement_type, =, statement_type, ., expand_identifier, (, ), ;, try, typing_, ., middle_statement_check, (, statement, ., token, (, ), ., span, ,, expanded_statement_type, ,, &, self, ., ctx, ., errors, ), ;, }, }, if, (, ast, ., block, ., final, ), |, final, |, {, _, =, self, ., typecheck_AST, (, final, ,, expected, ), catch, return, error, ., CompileError, ;, return, prelude_, ., void_type, ;, }, else, if, (, ast, ., children, (, ), ., items, ., len, ==, 0, ), {, return, prelude_, ., unit_type, ;, }, else, {, return, last_type, .?, ;, }, }, ,, ., @, "break", ,, ., @, "continue", ,, ., @, "unreachable", =>, return, prelude_, ., void_type, ,, ., @, "return", =>, {, const, inner_fn_ret_type, =, ast, ., symbol, (, ), .?, ., type, (, ), ., rhs, (, ), ;, if, (, ast, ., @, "return", ., _ret_expr, ), |, expr, |, {, _, =, self, ., typecheck_AST, (, expr, ,, inner_fn_ret_type, ), catch, return, error, ., CompileError, ;, }, else, if, (, expected, !=, null, and, (, expected, .?, ., expand_identifier, (, ), ), .*, !=, ., unit_type, ), {, if, (, inner_fn_ret_type, ., expand_identifier, (, ), .*, !=, ., unit_type, ), {, return, typing_, ., throw_unexpected_type, (, ast, ., token, (, ), ., span, ,, expected, .?, ,, prelude_, ., void_type, ,, &, self, ., ctx, ., errors, ), ;, }, }, else, if, (, expected, ==, null, and, inner_fn_ret_type, ., expand_identifier, (, ), .*, !=, ., unit_type, ), {, return, typing_, ., throw_unexpected_type, (, ast, ., token, (, ), ., span, ,, inner_fn_ret_type, ,, prelude_, ., unit_type, ,, &, self, ., ctx, ., errors, ), ;, }, return, prelude_, ., void_type, ;, }, ,, ., @, "defer", ,, ., @, "errdefer", =>, {, _, =, self, ., typecheck_AST, (, ast, ., statement, (, ), ,, null, ), catch, return, error, ., CompileError, ;, return, prelude_, ., unit_type, ;, }, ,, ., fn_decl, =>, {, try, self, ., ctx, ., validate_symbol, ., validate_symbol, (, ast, ., symbol, (, ), .?, ), ;, return, ast, ., decl_type, (, ), ;, }, ,, ., method_decl, =>, {, std, ., debug, ., assert, (, expected, ==, null, ), ;, if, (, ast, ., symbol, (, ), !=, null, ), {, try, self, ., ctx, ., validate_symbol, ., validate_symbol, (, ast, ., symbol, (, ), .?, ), ;, }, return, ast, ., decl_type, (, ), ;, }, ,, ., decl, =>, {, try, self, ., ctx, ., validate_type, ., validate_type, (, ast, ., decl, ., type, ), ;, if, (, ast, ., decl, ., init, ), |, _init, |, {, _, =, self, ., typecheck_AST, (, _init, ,, ast, ., decl, ., type, ), catch, return, error, ., CompileError, ;, }, try, self, ., ctx, ., validate_symbol, ., validate_symbol, (, ast, ., decl, ., name, ., symbol, (, ), .?, ), ;, return, prelude_, ., unit_type, ;, }, ,, ., context_value_decl, =>, {, try, self, ., ctx, ., validate_type, ., validate_type, (, ast, ., context_value_decl, ., parent, ), ;, if, (, ast, ., context_value_decl, ., init, ), |, _init, |, {, _, =, self, ., typecheck_AST, (, _init, ,, ast, ., context_value_decl, ., parent, ), catch, return, error, ., CompileError, ;, }, try, self, ., ctx, ., validate_symbol, ., validate_symbol, (, ast, ., symbol, (, ), .?, ), ;, return, prelude_, ., unit_type, ;, }, ,, ., binding, =>, {, try, self, ., ctx, ., validate_type, ., validate_type, (, ast, ., binding, ., type, ), ;, if, (, ast, ., binding, ., init, ), |, _init, |, {, _, =, self, ., typecheck_AST, (, _init, ,, ast, ., binding, ., type, ), catch, return, error, ., CompileError, ;, }, for, (, ast, ., binding, ., decls, ., items, ), |, decl, |, {, try, self, ., ctx, ., validate_symbol, ., validate_symbol, (, decl, ., decl, ., name, ., symbol, (, ), .?, ), ;, }, try, self, ., ctx, ., validate_pattern, ., assert_pattern_matches, (, ast, ., binding, ., pattern, ,, ast, ., binding, ., type, ), ;, return, prelude_, ., unit_type, ;, }, ,, else, =>, std, ., debug, ., panic, (, "compiler error: typecheck_AST() unimplemented for {s}", ,, ., {, @, tagName, (, ast, .*, ), }, ), ,, }, }, pub, fn, binary_operator_open, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, expected, :, ?, *, Type_AST, ,, ), Validate_Error_Enum, !, *, Type_AST, {, const, lhs_type, =, self, ., typecheck_AST, (, ast, ., lhs, (, ), ,, expected, ), catch, return, error, ., CompileError, ;, if, (, ast, ., lhs, (, ), .*, ==, ., identifier, and, ast, ., lhs, (, ), ., symbol, (, ), .?, ., is_type, (, ), ), {, return, error, ., CompileError, ;, }, _, =, self, ., typecheck_AST, (, ast, ., rhs, (, ), ,, lhs_type, ), catch, return, error, ., CompileError, ;, return, lhs_type, ;, }, pub, fn, validate_args_type, (, self, :, *, Self, ,, args, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, expected, :, *, const, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, variadic, :, bool, ,, ), Validate_Error_Enum, !, std, ., array_list, ., Managed, (, *, Type_AST, ), {, const, expected_length, =, expected, ., items, ., len, ;, var, terms, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, errdefer, terms, ., deinit, (, ), ;, for, (, 0..expected_length, ), |, i, |, {, const, param_type, =, expected, ., items, [, i, ], ;, const, term_type, =, self, ., typecheck_AST, (, args, ., items, [, i, ], ,, param_type, ), catch, return, error, ., CompileError, ;, terms, ., append, (, term_type, ), catch, unreachable, ;, }, if, (, variadic, ), {, for, (, expected_length, .., args, ., items, ., len, ), |, i, |, {, const, term_type, =, self, ., typecheck_AST, (, args, ., items, [, i, ], ,, null, ), catch, return, error, ., CompileError, ;, terms, ., append, (, term_type, ), catch, unreachable, ;, }, }, return, terms, ;, }, fn, validate_context, (, self, :, *, Self, ,, function_type, :, *, Type_AST, ,, ast, :, *, ast_, ., AST, ), Validate_Error_Enum, !, void, {, for, (, function_type, ., function, ., contexts, ., items, ), |, context, |, {, var, fn_ctx, =, context, ;, const, symbol, =, ast, ., scope, (, ), .?, ., context_lookup, (, fn_ctx, ,, self, ., ctx, ), orelse, {, if, (, fn_ctx, .*, ==, ., addr_of, ), {, fn_ctx, =, fn_ctx, ., child, (, ), ;, }, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., missing_context, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., context, =, fn_ctx, ,, }, }, ), ;, return, error, ., CompileError, ;, }, ;, try, ast, ., context_args, (, ), ., append, (, symbol, ), ;, }, }, fn, validate_L_Value, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ), Validate_Error_Enum, !, void, {, switch, (, ast, .*, ), {, ., select, ,, ., identifier, ,, ., array_value, ,, ., context_value, =>, {, }, ,, ., dereference, =>, if, (, ast, ., expr, (, ), .*, !=, ., addr_of, ), {, try, self, ., validate_L_Value, (, ast, ., expr, (, ), ), ;, }, ,, ., index, =>, try, self, ., validate_L_Value, (, ast, ., lhs, (, ), ), ,, ., tuple_value, =>, for, (, ast, ., children, (, ), ., items, ), |, term, |, {, try, self, ., validate_L_Value, (, term, ), ;, }, ,, else, =>, {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., msg, =, "not an l-value", }, }, ), ;, return, error, ., CompileError, ;, }, ,, }, }, fn, implicit_dereference, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ,, old_lhs_type, :, *, Type_AST, ), Validate_Error_Enum, !, *, Type_AST, {, var, lhs_type, =, old_lhs_type, ;, if, (, lhs_type, .*, ==, ., addr_of, and, !, lhs_type, ., addr_of, ., multiptr, ), {, ast, ., set_lhs, (, ast_, ., AST, ., create_dereference, (, ast, ., token, (, ), ,, ast, ., lhs, (, ), ,, self, ., ctx, ., allocator, (, ), ), ), ;, lhs_type, =, (, self, ., typecheck_AST, (, ast, ., lhs, (, ), ,, null, ), catch, return, error, ., CompileError, ), ., expand_identifier, (, ), ;, }, try, poison_, ., assert_none_poisoned, (, ., {, ast, ., lhs, (, ), ,, lhs_type, }, ), ;, return, lhs_type, ;, }, fn, assert_mutable, (, self, :, *, Self, ,, ast, :, *, ast_, ., AST, ), Validate_Error_Enum, !, void, {, switch, (, ast, .*, ), {, ., identifier, =>, {, const, symbol, =, ast, ., symbol, (, ), .?, ;, if, (, !, std, ., mem, ., eql, (, u8, ,, symbol, ., name, ,, "_", ), and, symbol, ., kind, !=, ., mut, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., modify_immutable, =, ., {, ., identifier, =, ast, ., token, (, ), }, }, ), ;, return, error, ., CompileError, ;, }, }, ,, ., dereference, =>, {, const, expr_expanded_type, =, self, ., typeof, (, ast, ., expr, (, ), ), ., expand_identifier, (, ), ;, try, self, ., assert_mutable_address, (, expr_expanded_type, ), ;, }, ,, ., index, =>, {, const, lhs_type, =, self, ., typeof, (, ast, ., lhs, (, ), ), ;, if, (, lhs_type, .*, ==, ., struct_type, and, lhs_type, ., struct_type, ., was_slice, ), {, try, self, ., assert_mutable_address, (, lhs_type, ., children, (, ), ., items, [, 0, ], ., child, (, ), ), ;, }, else, if, (, lhs_type, .*, ==, ., addr_of, and, lhs_type, ., addr_of, ., multiptr, ), {, try, self, ., assert_mutable_address, (, lhs_type, ), ;, }, else, {, try, self, ., assert_mutable, (, ast, ., lhs, (, ), ), ;, }, }, ,, ., tuple_value, =>, for, (, ast, ., children, (, ), ., items, ), |, term, |, {, try, self, ., assert_mutable, (, term, ), ;, }, ,, ., select, =>, try, self, ., assert_mutable, (, ast, ., lhs, (, ), ), ,, else, =>, {, }, ,, }, }, fn, assert_mutable_address, (, self, :, *, const, Self, ,, ast, :, *, Type_AST, ), Validate_Error_Enum, !, void, {, if, (, !, ast, ., addr_of, ., mut, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., msg, =, "cannot modify non-mutable address", }, }, ), ;, return, error, ., CompileError, ;, }, }, fn, get_expanded_expected, (, expected, :, ?, *, Type_AST, ), ?, *, Type_AST, {, return, if, (, expected, ==, null, ), null, else, expected, .?, ., expand_identifier, (, ), ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, args_, =, @, import, (, "args.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Validate_Error_Enum, =, error, {, CompileError, }, ;, pub, fn, type_check, (, span, :, Span, ,, got, :, *, Type_AST, ,, expected, :, ?, *, Type_AST, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, !, void, {, if, (, expected, !=, null, and, !, got, ., types_match, (, expected, .?, ), ), {, return, throw_unexpected_type, (, span, ,, expected, .?, ,, got, ,, errors, ), ;, }, }, pub, fn, middle_statement_check, (, span, :, Span, ,, got, :, *, Type_AST, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, !, void, {, if, (, !, prelude_, ., unit_type, ., types_match, (, got, ), and, !, got, ., types_match, (, prelude_, ., void_type, ), ), {, return, throw_unexpected_type, (, span, ,, prelude_, ., unit_type, ,, got, ,, errors, ), ;, }, }, pub, fn, type_check_int, (, ast, :, *, ast_, ., AST, ,, expected, :, ?, *, Type_AST, ,, errors, :, *, errs_, ., Errors, ,, ), Validate_Error_Enum, !, *, Type_AST, {, const, expanded_expected, =, if, (, expected, !=, null, ), expected, .?, ., expand_identifier, (, ), else, null, ;, if, (, expanded_expected, ==, null, or, prelude_, ., unit_type, ., types_match, (, expanded_expected, .?, ), ), {, return, prelude_, ., int_type, ;, }, if, (, expanded_expected, !=, null, ), {, const, info, =, prelude_, ., info_from_ast, (, expanded_expected, .?, ), ;, if, (, info, !=, null, and, info, .?, ., bounds, !=, null, ), {, if, (, ast, ., int, ., data, <, info, .?, ., bounds, .?, ., lower, or, ast, ., int, ., data, >, info, .?, ., bounds, .?, ., upper, ), {, errors, ., add_error, (, errs_, ., Error, {, ., integer_out_of_bounds, =, ., {, ., span, =, ast, ., token, (, ), ., span, ,, ., expected, =, expected, .?, ,, ., value, =, ast, ., int, ., data, ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, else, {, return, throw_unexpected_type, (, ast, ., token, (, ), ., span, ,, expanded_expected, .?, ,, prelude_, ., int_type, ,, errors, ), ;, }, }, return, expected, orelse, prelude_, ., int_type, ;, }, pub, fn, type_check_float, (, ast, :, *, ast_, ., AST, ,, expected, :, ?, *, Type_AST, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, !, *, Type_AST, {, if, (, expected, !=, null, and, !, expected, .?, ., can_represent_float, (, ), ), {, return, throw_unexpected_type, (, ast, ., token, (, ), ., span, ,, expected, .?, ,, prelude_, ., float_type, ,, errors, ), ;, }, return, expected, orelse, prelude_, ., float_type, ;, }, pub, fn, type_check_eq, (, span, :, Span, ,, got, :, *, Type_AST, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, !, void, {, if, (, !, got, ., is_eq_type, (, ), ), {, errors, ., add_error, (, errs_, ., Error, {, ., expected_builtin_typeclass, =, ., {, ., span, =, span, ,, ., expected, =, "equalable", ,, ., got, =, got, }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, type_check_ord, (, span, :, Span, ,, got, :, *, Type_AST, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, !, void, {, if, (, !, got, ., is_ord_type, (, ), ), {, errors, ., add_error, (, errs_, ., Error, {, ., expected_builtin_typeclass, =, ., {, ., span, =, span, ,, ., expected, =, "orderable", ,, ., got, =, got, }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, type_check_arithmetic, (, span, :, Span, ,, got, :, *, Type_AST, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, !, void, {, if, (, !, got, ., is_num_type, (, ), ), {, errors, ., add_error, (, errs_, ., Error, {, ., expected_builtin_typeclass, =, ., {, ., span, =, span, ,, ., expected, =, "arithmetic", ,, ., got, =, got, }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, type_check_integral, (, span, :, Span, ,, got, :, *, Type_AST, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, !, void, {, if, (, !, got, ., is_int_type, (, ), ), {, errors, ., add_error, (, errs_, ., Error, {, ., expected_builtin_typeclass, =, ., {, ., span, =, span, ,, ., expected, =, "integer", ,, ., got, =, got, }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, type_check_bits, (, span, :, Span, ,, got, :, *, Type_AST, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, !, void, {, if, (, !, got, ., is_bits_type, (, ), ), {, errors, ., add_error, (, errs_, ., Error, {, ., expected_builtin_typeclass, =, ., {, ., span, =, span, ,, ., expected, =, "bits", ,, ., got, =, got, }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, throw_unexpected_type, (, span, :, Span, ,, expected, :, *, Type_AST, ,, got, :, *, Type_AST, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, {, errors, ., add_error, (, errs_, ., Error, {, ., unexpected_type, =, ., {, ., span, =, span, ,, ., expected, =, expected, ,, ., got, =, got, }, }, ), ;, return, error, ., CompileError, ;, }, pub, fn, throw_unexpected_void_type, (, span, :, Span, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, {, errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, span, ,, ., msg, =, "comptime cannot be type `Void`", }, }, ), ;, return, error, ., CompileError, ;, }, fn, throw_not_selectable, (, _type, :, *, Type_AST, ,, span, :, Span, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, {, errors, ., add_error, (, errs_, ., Error, {, ., not_selectable, =, ., {, ., span, =, span, ,, ., _type, =, _type, }, }, ), ;, return, error, ., CompileError, ;, }, pub, fn, throw_wrong_from, (, from_name, :, [, ], const, u8, ,, operator_name, :, [, ], const, u8, ,, got, :, *, Type_AST, ,, span, :, Span, ,, errors, :, *, errs_, ., Errors, ,, ), Validate_Error_Enum, {, errors, ., add_error, (, errs_, ., Error, {, ., wrong_from, =, ., {, ., span, =, span, ,, ., operator, =, operator_name, ,, ., from, =, from_name, ,, ., got, =, got, ,, }, }, ), ;, return, error, ., CompileError, ;, }, pub, fn, coalesce_operator, (, lhs_expanded_type, :, *, Type_AST, ,, ast, :, *, ast_, ., AST, ,, span, :, Span, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, !, void, {, std, ., debug, ., assert, (, ast, .*, ==, ., @, "orelse", or, ast, .*, ==, ., @, "catch", ), ;, const, expected_sum_from, :, Type_AST, ., Sum_From, =, if, (, ast, .*, ==, ., @, "orelse", ), ., optional, else, ., @, "error", ;, if, (, lhs_expanded_type, .*, !=, ., enum_type, or, lhs_expanded_type, ., enum_type, ., from, !=, expected_sum_from, ), {, errors, ., add_error, (, errs_, ., Error, {, ., wrong_from, =, ., {, ., span, =, span, ,, ., operator, =, @, tagName, (, ast, .*, ), ,, ., from, =, @, tagName, (, expected_sum_from, ), ,, ., got, =, lhs_expanded_type, ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, find_select_pos, (, _type, :, *, Type_AST, ,, field, :, [, ], const, u8, ,, span, :, Span, ,, errors, :, *, errs_, ., Errors, ), Validate_Error_Enum, !, usize, {, if, (, _type, .*, !=, ., struct_type, and, _type, .*, !=, ., enum_type, and, _type, .*, !=, ., untagged_sum_type, and, _type, .*, !=, ., context_type, ), {, return, throw_not_selectable, (, _type, ,, span, ,, errors, ), ;, }, for, (, _type, ., children, (, ), ., items, ,, 0.., ), |, term, ,, i, |, {, if, (, term, .*, !=, ., annotation, ), {, return, throw_not_selectable, (, _type, ,, span, ,, errors, ), ;, }, if, (, std, ., mem, ., eql, (, u8, ,, term, ., annotation, ., pattern, ., token, (, ), ., data, ,, field, ), ), {, return, i, ;, }, }, else, {, errors, ., add_error, (, errs_, ., Error, {, ., member_not_in_type, =, ., {, ., span, =, span, ,, ., identifier, =, field, ,, ., name, =, "struct", ,, ., type, =, _type, }, }, ), ;, return, error, ., CompileError, ;, }, }, const, std, =, @, import, (, "std", ), ;, const, anon_name_, =, @, import, (, "../util/anon_name.zig", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, Decorate, =, @, import, (, "../ast/decorate.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Symbol, =, @, import, (, "symbol.zig", ), ;, const, Symbol_Tree, =, @, import, (, "../ast/symbol-tree.zig", ), ;, const, module_, =, @, import, (, "../hierarchy/module.zig", ), ;, const, unification_, =, @, import, (, "../types/unification.zig", ), ;, const, UID_Gen, =, @, import, (, "../util/uid_gen.zig", ), ;, const, walker_, =, @, import, (, "../ast/walker.zig", ), ;, const, Tree_Writer, =, @, import, (, "../ast/tree_writer.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Self, =, @, This, (, ), ;, const, Lookup_Result, =, union, (, enum, ), {, found_but_rt, ,, found_but_fn, ,, not_found, ,, found, :, *, Symbol, }, ;, parent, :, ?, *, Self, ,, children, :, std, ., array_list, ., Managed, (, *, Self, ), ,, symbols, :, std, ., StringArrayHashMap, (, *, Symbol, ), ,, traits, :, std, ., array_hash_map, ., AutoArrayHashMap, (, *, ast_, ., AST, ,, void, ), ,, impls, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, tests, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, module, :, ?, *, module_, ., Module, ,, uid, :, usize, ,, uid_gen, :, *, UID_Gen, ,, function_depth, :, usize, =, 0, ,, inner_function, :, ?, *, Symbol, =, null, ,, pub, fn, init, (, parent, :, ?, *, Self, ,, uid_gen, :, *, UID_Gen, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, allocator, ., create, (, Self, ), catch, unreachable, ;, retval, ., parent, =, parent, ;, retval, ., children, =, std, ., array_list, ., Managed, (, *, Self, ), ., init, (, allocator, ), ;, retval, ., symbols, =, std, ., StringArrayHashMap, (, *, Symbol, ), ., init, (, allocator, ), ;, retval, ., traits, =, std, ., array_hash_map, ., AutoArrayHashMap, (, *, ast_, ., AST, ,, void, ), ., init, (, allocator, ), ;, retval, ., impls, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, allocator, ), ;, retval, ., tests, =, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, allocator, ), ;, retval, ., uid, =, uid_gen, ., uid, (, ), ;, retval, ., uid_gen, =, uid_gen, ;, if, (, parent, ), |, _parent, |, {, _parent, ., children, ., append, (, retval, ), catch, unreachable, ;, retval, ., function_depth, =, _parent, ., function_depth, ;, retval, ., inner_function, =, _parent, ., inner_function, ;, retval, ., module, =, _parent, ., module, ;, }, else, {, retval, ., function_depth, =, 0, ;, retval, ., inner_function, =, null, ;, retval, ., module, =, null, ;, }, return, retval, ;, }, pub, const, Lookup_Flags, =, struct, {, crossed_boundary, :, bool, =, false, ,, allow_modules, :, bool, =, false, ,, look_for_kind, :, ?, Symbol, ., Kind, =, null, ,, }, ;, pub, fn, lookup, (, self, :, *, Self, ,, name, :, [, ], const, u8, ,, flags, :, Lookup_Flags, ), Lookup_Result, {, const, log, :, bool, =, false, ;, if, (, log, ), {, const, found, =, self, ., symbols, ., get, (, name, ), !=, null, ;, std, ., debug, ., print, (, "searching for: {s} {}({})\n", ,, ., {, name, ,, found, ,, flags, }, ), ;, self, ., pprint, (, ), ;, }, if, (, self, ., symbols, ., get, (, name, ), ), |, symbol, |, {, if, (, !, flags, ., allow_modules, and, symbol, ., kind, ==, ., module, ), {, }, else, if, (, flags, ., look_for_kind, !=, null, and, @, intFromEnum, (, flags, ., look_for_kind, .?, ), !=, @, intFromEnum, (, symbol, ., kind, ), ), {, }, else, if, (, flags, ., crossed_boundary, and, (, symbol, ., kind, ==, ., mut, or, symbol, ., kind, ==, ., let, ), ), {, return, ., found_but_fn, ;, }, else, {, if, (, log, ), {, std, ., debug, ., print, (, "Found: {s} {*}\n", ,, ., {, name, ,, symbol, }, ), ;, }, return, Lookup_Result, {, ., found, =, symbol, }, ;, }, }, if, (, self, ., parent, ), |, parent, |, {, var, new_flags, =, flags, ;, new_flags, ., crossed_boundary, =, parent, ., function_depth, <, self, ., function_depth, or, flags, ., crossed_boundary, ;, const, res, =, parent, ., lookup, (, name, ,, new_flags, ), ;, return, res, ;, }, else, {, return, ., not_found, ;, }, }, pub, fn, num_visible_contexts, (, self, :, *, Self, ), usize, {, var, result, :, usize, =, 0, ;, for, (, self, ., symbols, ., keys, (, ), ), |, symbol_name, |, {, const, symbol, =, self, ., symbols, ., get, (, symbol_name, ), .?, ;, if, (, symbol, ., kind, ==, ., let, ), {, var, symbol_type, =, symbol, ., type, (, ), ;, if, (, symbol_type, .*, ==, ., addr_of, ), {, symbol_type, =, symbol_type, ., child, (, ), ;, }, if, (, symbol_type, .*, ==, ., context_type, or, std, ., mem, ., startsWith, (, u8, ,, symbol, ., name, ,, "context_value__", ), ), {, result, +=, 1, ;, }, }, }, const, parent_contrib, =, if, (, self, ., parent, ), |, parent, |, parent, ., num_visible_contexts, (, ), else, 0, ;, return, result, +, parent_contrib, ;, }, pub, fn, context_lookup, (, self, :, *, Self, ,, context_type, :, *, Type_AST, ,, ctx, :, *, Compiler_Context, ), ?, *, Symbol, {, for, (, self, ., symbols, ., keys, (, ), ), |, symbol_name, |, {, const, symbol, =, self, ., symbols, ., get, (, symbol_name, ), .?, ;, if, (, symbol, ., kind, ==, ., let, ), {, var, symbol_type, =, symbol, ., type, (, ), ;, if, (, symbol_type, .*, ==, ., addr_of, and, context_type, .*, !=, ., addr_of, ), {, symbol_type, =, symbol_type, ., child, (, ), ;, }, if, (, context_type, ., types_match, (, symbol_type, ), ), {, return, symbol, ;, }, }, }, else, if, (, self, ., parent, ), |, parent, |, {, return, parent, ., context_lookup, (, context_type, ,, ctx, ), ;, }, else, {, return, null, ;, }, }, const, Impl_Trait_Lookup_Result, =, struct, {, count, :, u8, ,, ast, :, ?, *, ast_, ., AST, }, ;, pub, fn, impl_trait_lookup, (, self, :, *, Self, ,, for_type, :, *, Type_AST, ,, trait, :, *, Symbol, ), Impl_Trait_Lookup_Result, {, if, (, false, ), {, std, ., debug, ., print, (, "searching {} for impls of {s} for {f}\n", ,, ., {, self, ., impls, ., items, ., len, ,, trait, ., name, ,, for_type, .*, }, ), ;, std, ., debug, ., print, (, "is identifier: {}\n", ,, ., {, for_type, .*, ==, ., identifier, }, ), ;, if, (, for_type, .*, ==, ., identifier, ), {, std, ., debug, ., print, (, "symbol isnt null: {}\n", ,, ., {, for_type, ., symbol, (, ), !=, null, }, ), ;, if, (, for_type, ., symbol, (, ), !=, null, ), {, std, ., debug, ., print, (, "symbol kind: {t}\n", ,, ., {, for_type, ., symbol, (, ), .?, ., kind, }, ), ;, }, }, self, ., pprint, (, ), ;, }, var, retval, :, Impl_Trait_Lookup_Result, =, ., {, ., count, =, 0, ,, ., ast, =, null, }, ;, if, (, for_type, .*, ==, ., identifier, and, for_type, ., symbol, (, ), !=, null, and, for_type, ., symbol, (, ), .?, ., decl, .?, .*, ==, ., type_param_decl, ), {, const, type_param_decl, =, for_type, ., symbol, (, ), .?, ., decl, .?, ;, for, (, type_param_decl, ., type_param_decl, ., constraints, ., items, ), |, constraint, |, {, const, trait_symbol, =, constraint, ., symbol, (, ), .?, ;, if, (, trait_symbol, ==, trait, ), {, return, ., {, ., count, =, 1, ,, ., ast, =, null, }, ;, }, }, }, for, (, self, ., impls, ., items, ), |, impl, |, {, const, types_match, =, (, impl, ., impl, ., _type, ., types_match, (, for_type, ), or, for_type, ., types_match, (, impl, ., impl, ., _type, ), ), ;, const, traits_match, =, impl, ., impl, ., trait, .?, ., symbol, (, ), ==, trait, ;, if, (, types_match, and, traits_match, ), {, retval, ., count, +=, 1, ;, retval, ., ast, =, retval, ., ast, orelse, impl, ;, }, }, for, (, self, ., symbols, ., keys, (, ), ), |, symbol_name, |, {, const, symbol, =, self, ., symbols, ., get, (, symbol_name, ), .?, ;, if, (, symbol, ., kind, ==, ., import, ), {, var, res_symbol, :, *, Symbol, =, symbol, ., kind, ., import, ., real_symbol, orelse, self, ., parent, .?, ., lookup, (, symbol, ., kind, ., import, ., real_name, ,, ., {, ., allow_modules, =, true, }, ), ., found, ;, const, module_scope, =, res_symbol, ., init_value, (, ), .?, ., scope, (, ), .?, ;, const, parent_res, =, module_scope, ., impl_trait_lookup, (, for_type, ,, trait, ), ;, if, (, parent_res, ., count, >, 0, ), {, retval, ., count, +=, parent_res, ., count, ;, retval, ., ast, =, retval, ., ast, orelse, parent_res, ., ast, ;, return, parent_res, ;, }, }, }, if, (, self, ., parent, !=, null, ), {, const, parent_res, =, self, ., parent, .?, ., impl_trait_lookup, (, for_type, ,, trait, ), ;, retval, ., count, +=, parent_res, ., count, ;, retval, ., ast, =, retval, ., ast, orelse, parent_res, ., ast, ;, return, retval, ;, }, else, {, return, retval, ;, }, }, pub, fn, lookup_impl_member, (, self, :, *, Self, ,, for_type, :, *, Type_AST, ,, name, :, [, ], const, u8, ,, compiler, :, *, Compiler_Context, ), !, ?, *, ast_, ., AST, {, if, (, false, ), {, std, ., debug, ., print, (, "searching {} impls for {f}::{s}\n", ,, ., {, self, ., impls, ., items, ., len, ,, for_type, .*, ,, name, }, ), ;, self, ., pprint, (, ), ;, }, if, (, for_type, .*, ==, ., identifier, and, for_type, ., symbol, (, ), !=, null, and, for_type, ., symbol, (, ), .?, ., decl, .?, .*, ==, ., type_param_decl, ), {, const, type_param_decl, =, for_type, ., symbol, (, ), .?, ., decl, .?, ;, for, (, type_param_decl, ., type_param_decl, ., constraints, ., items, ), |, constraint, |, {, const, trait_decl, =, constraint, ., symbol, (, ), .?, ., decl, .?, ;, if, (, try, self, ., lookup_member_in_trait, (, trait_decl, ,, for_type, ,, name, ,, compiler, ), ), |, res, |, return, res, ;, }, }, if, (, try, self, ., lookup_impl_member_impls, (, for_type, ,, name, ,, compiler, ), ), |, res, |, return, res, ;, if, (, try, self, ., lookup_impl_member_super_impls, (, for_type, ,, name, ,, compiler, ), ), |, res, |, return, res, ;, if, (, try, self, ., lookup_impl_member_imports, (, for_type, ,, name, ,, compiler, ), ), |, res, |, return, res, ;, if, (, self, ., parent, ), |, p, |, return, p, ., lookup_impl_member, (, for_type, ,, name, ,, compiler, ), ;, return, null, ;, }, fn, lookup_member_in_trait, (, self, :, *, Self, ,, trait_decl, :, *, ast_, ., AST, ,, for_type, :, *, Type_AST, ,, name, :, [, ], const, u8, ,, compiler, :, *, Compiler_Context, ), !, ?, *, ast_, ., AST, {, for, (, trait_decl, ., trait, ., method_decls, ., items, ), |, method_decl, |, {, if, (, !, std, ., mem, ., eql, (, u8, ,, method_decl, ., method_decl, ., name, ., token, (, ), ., data, ,, name, ), ), continue, ;, var, subst, =, unification_, ., Substitutions, ., init, (, compiler, ., allocator, (, ), ), ;, defer, subst, ., deinit, (, ), ;, subst, ., put, (, "Self", ,, for_type, ), catch, unreachable, ;, const, cloned, =, method_decl, ., clone, (, &, subst, ,, compiler, ., allocator, (, ), ), ;, const, new_scope, =, init, (, self, ., parent, .?, ,, self, ., uid_gen, ,, compiler, ., allocator, (, ), ), ;, try, walker_, ., walk_ast, (, cloned, ,, Symbol_Tree, ., new, (, new_scope, ,, &, compiler, ., errors, ,, compiler, ., allocator, (, ), ), ), ;, return, cloned, ;, }, for, (, trait_decl, ., trait, ., const_decls, ., items, ), |, const_decl, |, {, if, (, !, std, ., mem, ., eql, (, u8, ,, const_decl, ., binding, ., decls, ., items, [, 0, ], ., decl, ., name, ., token, (, ), ., data, ,, name, ), ), continue, ;, var, subst, =, unification_, ., Substitutions, ., init, (, compiler, ., allocator, (, ), ), ;, defer, subst, ., deinit, (, ), ;, subst, ., put, (, "Self", ,, for_type, ), catch, unreachable, ;, const, cloned, =, const_decl, ., clone, (, &, subst, ,, compiler, ., allocator, (, ), ), ;, const, new_scope, =, init, (, self, ., parent, .?, ,, self, ., uid_gen, ,, compiler, ., allocator, (, ), ), ;, try, walker_, ., walk_ast, (, cloned, ,, Symbol_Tree, ., new, (, new_scope, ,, &, compiler, ., errors, ,, compiler, ., allocator, (, ), ), ), ;, return, cloned, ;, }, return, null, ;, }, fn, lookup_impl_member_impls, (, self, :, *, Self, ,, for_type, :, *, Type_AST, ,, name, :, [, ], const, u8, ,, compiler, :, *, Compiler_Context, ), !, ?, *, ast_, ., AST, {, for, (, self, ., impls, ., items, ), |, impl, |, {, var, subst, =, unification_, ., Substitutions, ., init, (, compiler, ., allocator, (, ), ), ;, defer, subst, ., deinit, (, ), ;, const, decorate_context, =, Decorate, ., new, (, self, ,, compiler, ), ;, try, walker_, ., walk_type, (, impl, ., impl, ., _type, ,, decorate_context, ), ;, try, compiler, ., validate_type, ., validate_type, (, impl, ., impl, ., _type, ), ;, unification_, ., unify, (, impl, ., impl, ., _type, ,, for_type, ,, impl, ., impl, ., _generic_params, ,, &, subst, ), catch, continue, ;, const, instantiated_impl, =, try, self, ., instantiate_generic_impl, (, impl, ,, &, subst, ,, compiler, ), ;, if, (, search_impl, (, instantiated_impl, ,, name, ), ), |, res, |, return, res, ;, }, return, null, ;, }, fn, lookup_impl_member_super_impls, (, self, :, *, Self, ,, for_type, :, *, Type_AST, ,, name, :, [, ], const, u8, ,, compiler, :, *, Compiler_Context, ), !, ?, *, ast_, ., AST, {, for, (, self, ., impls, ., items, ), |, impl, |, {, if, (, impl, ., impl, ., trait, ), |, trait, |, {, if, (, trait, ., symbol, (, ), ==, null, ), continue, ;, for, (, trait, ., symbol, (, ), .?, ., decl, .?, ., trait, ., super_traits, ., items, ), |, super_trait, |, {, if, (, try, self, ., lookup_member_in_trait, (, super_trait, ., symbol, (, ), .?, ., decl, .?, ,, for_type, ,, name, ,, compiler, ), ), |, res, |, return, res, ;, }, }, }, return, null, ;, }, fn, lookup_impl_member_imports, (, self, :, *, Self, ,, for_type, :, *, Type_AST, ,, name, :, [, ], const, u8, ,, compiler, :, *, Compiler_Context, ), error, {, OutOfMemory, ,, CompileError, }, !, ?, *, ast_, ., AST, {, for, (, self, ., symbols, ., keys, (, ), ), |, symbol_name, |, {, const, symbol, =, self, ., symbols, ., get, (, symbol_name, ), .?, ;, if, (, symbol, ., kind, ==, ., import, ), {, var, res_symbol, :, *, Symbol, =, symbol, ., kind, ., import, ., real_symbol, orelse, self, ., parent, .?, ., lookup, (, symbol, ., kind, ., import, ., real_name, ,, ., {, ., allow_modules, =, true, }, ), ., found, ;, const, module_scope, =, res_symbol, ., init_value, (, ), .?, ., scope, (, ), .?, ;, const, module_scope_lookup, =, try, module_scope, ., lookup_impl_member, (, for_type, ,, name, ,, compiler, ), ;, if, (, module_scope_lookup, !=, null, ), {, return, module_scope_lookup, ;, }, }, }, return, null, ;, }, fn, instantiate_generic_impl, (, self, :, *, Self, ,, impl, :, *, ast_, ., AST, ,, subst, :, *, unification_, ., Substitutions, ,, compiler, :, *, Compiler_Context, ), !, *, ast_, ., AST, {, if, (, impl, ., impl, ., _generic_params, ., items, ., len, ==, 0, ), return, impl, ;, const, subst_contains_generics, =, unification_, ., substitution_contains_generics, (, subst, ), ;, if, (, subst_contains_generics, ), return, impl, ;, const, type_param_list, =, unification_, ., type_param_list_from_subst_map, (, subst, ,, impl, ., impl, ., _generic_params, ,, compiler, ., allocator, (, ), ), ;, if, (, impl, ., impl, ., instantiations, ., get, (, type_param_list, ), ), |, instantiated, |, return, instantiated, ;, const, new_impl, :, *, ast_, ., AST, =, impl, ., clone, (, subst, ,, compiler, ., allocator, (, ), ), ;, if, (, !, subst_contains_generics, ), {, new_impl, ., impl, ., _generic_params, ., clearRetainingCapacity, (, ), ;, }, const, new_scope, =, init, (, self, ,, self, ., uid_gen, ,, compiler, ., allocator, (, ), ), ;, try, walker_, ., walk_ast, (, new_impl, ,, Symbol_Tree, ., new, (, new_scope, ,, &, compiler, ., errors, ,, compiler, ., allocator, (, ), ), ), ;, new_impl, ., set_scope, (, new_scope, ), ;, if, (, new_impl, ., impl, ., trait, ==, null, or, new_impl, ., impl, ., impls_anon_trait, ), {, var, token, =, new_impl, ., token, (, ), ;, token, ., kind, =, ., identifier, ;, token, ., data, =, anon_name_, ., next_anon_name, (, "Trait", ,, compiler, ., allocator, (, ), ), ;, const, anon_trait, =, ast_, ., AST, ., create_trait, (, token, ,, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, compiler, ., allocator, (, ), ), ,, new_impl, ., impl, ., method_defs, ,, new_impl, ., impl, ., const_defs, ,, compiler, ., allocator, (, ), ,, ), ;, try, walker_, ., walk_ast, (, anon_trait, ,, Symbol_Tree, ., new, (, new_scope, ,, &, compiler, ., errors, ,, compiler, ., allocator, (, ), ), ), ;, new_impl, ., impl, ., trait, =, ast_, ., AST, ., create_identifier, (, token, ,, compiler, ., allocator, (, ), ), ;, new_impl, ., impl, ., impls_anon_trait, =, true, ;, }, const, new_decorate_context, =, Decorate, ., new, (, new_scope, ,, compiler, ), ;, try, walker_, ., walk_ast, (, new_impl, ,, new_decorate_context, ), ;, try, compiler, ., validate_scope, ., validate_scope, (, new_scope, ), ;, for, (, new_impl, ., impl, ., method_defs, ., items, ), |, method_def, |, {, method_def, ., symbol, (, ), .?, ., is_monomorphed, =, true, ;, }, impl, ., impl, ., instantiations, ., put, (, type_param_list, ,, new_impl, ), catch, unreachable, ;, return, impl, ., impl, ., instantiations, ., get, (, type_param_list, ), .?, ;, }, fn, search_impl, (, impl, :, *, ast_, ., AST, ,, name, :, [, ], const, u8, ), ?, *, ast_, ., AST, {, for, (, impl, ., impl, ., method_defs, ., items, ), |, method_def, |, {, if, (, std, ., mem, ., eql, (, u8, ,, method_def, ., method_decl, ., name, ., token, (, ), ., data, ,, name, ), ), {, return, method_def, ;, }, }, for, (, impl, ., impl, ., const_defs, ., items, ), |, const_def, |, {, if, (, std, ., mem, ., eql, (, u8, ,, const_def, ., binding, ., pattern, ., symbol, (, ), .?, ., name, ,, name, ), ), {, return, const_def, ;, }, }, return, null, ;, }, pub, fn, pprint, (, self, :, *, Self, ), void, {, std, ., debug, ., print, (, "scope_{}:\n", ,, ., {, self, ., uid, }, ), ;, for, (, self, ., symbols, ., keys, (, ), ), |, name, |, {, const, symbol, =, self, ., symbols, ., get, (, name, ), .?, ;, if, (, symbol, ., kind, ==, ., import, ), {, std, ., debug, ., print, (, "  {s} {s} ({s})\n", ,, ., {, @, tagName, (, symbol, ., kind, ), ,, name, ,, symbol, ., kind, ., import, ., real_name, }, ), ;, }, else, if, (, symbol, ., kind, ==, ., type, ), {, std, ., debug, ., print, (, "  {s} {s} = {?f}\n", ,, ., {, @, tagName, (, symbol, ., kind, ), ,, name, ,, symbol, ., init_typedef, (, ), }, ), ;, }, else, {, std, ., debug, ., print, (, "  {s} {s}\n", ,, ., {, @, tagName, (, symbol, ., kind, ), ,, name, }, ), ;, }, }, }, pub, fn, put_symbol, (, scope, :, *, Self, ,, symbol, :, *, Symbol, ,, errors, :, *, errs_, ., Errors, ), error, {, CompileError, }, !, void, {, const, res, =, scope, ., lookup, (, symbol, ., name, ,, ., {, }, ), ;, switch, (, res, ), {, ., found, =>, {, const, first, =, res, ., found, ;, errors, ., add_error, (, errs_, ., Error, {, ., redefinition, =, ., {, ., first_defined_span, =, first, ., span, (, ), ,, ., redefined_span, =, symbol, ., span, (, ), ,, ., name, =, symbol, ., name, ,, }, }, ), ;, return, error, ., CompileError, ;, }, ,, else, =>, scope, ., symbols, ., put, (, symbol, ., name, ,, symbol, ), catch, unreachable, ,, }, }, pub, fn, put_all_symbols, (, scope, :, *, Self, ,, symbols, :, *, std, ., array_list, ., Managed, (, *, Symbol, ), ,, errors, :, *, errs_, ., Errors, ), error, {, CompileError, }, !, void, {, for, (, symbols, ., items, ), |, symbol, |, {, try, scope, ., put_symbol, (, symbol, ,, errors, ), ;, }, }, pub, fn, collect_traits_and_impls, (, self, :, *, Self, ,, traits, :, *, std, ., array_hash_map, ., AutoArrayHashMap, (, *, ast_, ., AST, ,, void, ), ,, impls, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, ), void, {, for, (, self, ., traits, ., keys, (, ), ), |, trait, |, {, traits, ., put, (, trait, ,, void, {, }, ), catch, unreachable, ;, }, impls, ., appendSlice, (, self, ., impls, ., items, ), catch, unreachable, ;, for, (, self, ., children, ., items, ), |, child, |, {, child, ., collect_traits_and_impls, (, traits, ,, impls, ), ;, }, }, pub, fn, collect_tests, (, self, :, *, Self, ,, tests, :, *, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, ), void, {, tests, ., appendSlice, (, self, ., tests, ., items, ), catch, unreachable, ;, for, (, self, ., children, ., items, ), |, child, |, {, child, ., collect_tests, (, tests, ), ;, }, }, const, std, =, @, import, (, "std", ), ;, const, anon_name_, =, @, import, (, "../util/anon_name.zig", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, CFG, =, @, import, (, "../ir/cfg.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, fmt_, =, @, import, (, "../util/fmt.zig", ), ;, const, Scope, =, @, import, (, "../symbol/scope.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Tree_Writer, =, @, import, (, "../ast/tree_writer.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Monomorph_Map, =, @, import, (, "../types/type_map.zig", ), ., Monomorph_Map, ;, const, unification_, =, @, import, (, "../types/unification.zig", ), ;, const, validation_state_, =, @, import, (, "../util/validation_state.zig", ), ;, const, Self, =, @, This, (, ), ;, pub, const, Kind, =, union, (, enum, ), {, @, "fn", ,, @, "const", ,, @, "comptime", ,, let, ,, mut, ,, type, ,, trait, ,, import, :, struct, {, real_name, :, [, ], const, u8, ,, real_symbol, :, ?, *, Self, =, null, ,, }, ,, import_inner, ,, module, ,, @, "test", ,, context, ,, }, ;, pub, const, Storage, =, union, (, enum, ), {, local, ,, @, "extern", :, struct, {, c_name, :, ?, *, ast_, ., AST, }, ,, }, ;, pub, const, Symbol_Validation_State, =, validation_state_, ., Validation_State, ;, scope, :, *, Scope, ,, name, :, [, ], const, u8, ,, kind, :, Kind, ,, cfg, :, ?, *, CFG, ,, decl, :, ?, *, ast_, ., AST, ,, storage, :, Storage, ,, monomorphs, :, Monomorph_Map, (, *, Self, ), ,, aliases, :, u64, =, 0, ,, roots, :, u64, =, 0, ,, uses, :, u64, =, 0, ,, defs, :, u64, =, 0, ,, defined, :, bool, ,, validation_state, :, Symbol_Validation_State, ,, init_validation_state, :, Symbol_Validation_State, ,, param, :, bool, ,, is_temp, :, bool, =, false, ,, is_monomorphed, :, bool, =, false, ,, offset, :, ?, i64, ,, pub, fn, init, (, scope, :, *, Scope, ,, name, :, [, ], const, u8, ,, decl, :, ?, *, ast_, ., AST, ,, kind, :, Kind, ,, storage, :, Storage, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, Self, {, var, retval, =, allocator, ., create, (, Self, ), catch, unreachable, ;, retval, ., scope, =, scope, ;, retval, ., name, =, name, ;, retval, ., decl, =, decl, ;, retval, ., aliases, =, 0, ;, retval, ., roots, =, 0, ;, retval, ., uses, =, 0, ;, retval, ., offset, =, null, ;, retval, ., kind, =, kind, ;, retval, ., storage, =, storage, ;, retval, ., monomorphs, =, Monomorph_Map, (, *, Self, ), ., init, (, allocator, ), ;, retval, ., cfg, =, null, ;, if, (, kind, ==, ., @, "fn", or, kind, ==, ., @, "const", ), {, retval, ., defined, =, true, ;, }, else, {, retval, ., defined, =, false, ;, }, retval, ., validation_state, =, ., unvalidated, ;, retval, ., init_validation_state, =, ., unvalidated, ;, return, retval, ;, }, pub, fn, assert_symbol_valid, (, self, :, *, Self, ), *, Self, {, self, ., validation_state, =, ., valid, ;, return, self, ;, }, pub, fn, assert_init_valid, (, self, :, *, Self, ), *, Self, {, self, ., init_validation_state, =, ., valid, ;, return, self, ;, }, pub, fn, is_type, (, self, :, *, const, Self, ), bool, {, return, self, ., decl, .?, .*, ==, ., struct_decl, or, self, ., decl, .?, .*, ==, ., enum_decl, or, self, ., decl, .?, .*, ==, ., type_alias, or, self, ., decl, .?, .*, ==, ., type_param_decl, ;, }, pub, fn, is_trait, (, self, :, *, const, Self, ), bool, {, return, self, ., kind, ==, ., trait, ;, }, pub, fn, @, "type", (, self, :, *, const, Self, ), *, Type_AST, {, return, self, ., decl, .?, ., decl_type, (, ), ;, }, pub, fn, init_value, (, self, :, *, const, Self, ), ?, *, ast_, ., AST, {, return, self, ., decl, .?, ., decl_init, (, ), ;, }, pub, fn, init_typedef, (, self, :, *, const, Self, ), ?, *, Type_AST, {, return, self, ., decl, .?, ., decl_typedef, (, ), ;, }, pub, fn, span, (, self, :, *, const, Self, ), Span, {, return, self, ., decl, .?, ., token, (, ), ., span, ;, }, pub, fn, set_span, (, self, :, *, Self, ,, _span, :, Span, ), void, {, self, ., decl, .?, ., common, (, ), ., _token, ., span, =, _span, ;, }, pub, fn, expanded_type, (, self, :, *, const, Self, ), *, Type_AST, {, return, self, ., type, (, ), ., expand_identifier, (, ), ;, }, pub, fn, is_alias, (, self, :, *, Self, ), bool, {, if, (, self, ., decl, !=, null, and, self, ., decl, .?, .*, ==, ., type_alias, ), return, true, ;, return, false, ;, }, pub, fn, lvalue_is_symbol, (, self, :, *, Self, ,, return_symbol, :, *, Self, ), bool, {, return, !, self, ., is_temp, and, self, !=, return_symbol, ;, }, pub, fn, err_if_undefined, (, self, :, *, Self, ,, errors, :, *, errs_, ., Errors, ), error, {, CompileError, }, !, void, {, if, (, self, ., kind, !=, ., import, and, !, self, ., defined, ), {, errors, ., add_error, (, errs_, ., Error, {, ., use_before_def, =, ., {, ., identifier, =, Token, ., init_simple, (, self, ., name, ), }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, err_if_unused, (, self, :, *, Self, ,, errors, :, *, errs_, ., Errors, ), error, {, CompileError, }, !, void, {, if, (, self, ., kind, !=, ., @, "const", and, self, ., uses, ==, 0, ), {, errors, ., add_error, (, errs_, ., Error, {, ., symbol_error, =, ., {, ., span, =, self, ., span, (, ), ,, ., context_span, =, null, ,, ., name, =, self, ., name, ,, ., problem, =, "is never used", ,, ., context_message, =, "", ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, err_if_undefd, (, self, :, *, Self, ,, errors, :, *, errs_, ., Errors, ,, use, :, Span, ), error, {, CompileError, }, !, void, {, if, (, self, ., uses, !=, 0, and, self, ., defs, ==, 0, and, !, self, ., param, and, self, ., storage, !=, ., @, "extern", ), {, errors, ., add_error, (, errs_, ., Error, {, ., symbol_error, =, ., {, ., span, =, use, ,, ., context_span, =, self, ., span, (, ), ,, ., name, =, self, ., name, ,, ., problem, =, "is never defined", ,, ., context_message, =, "declared here", ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, err_if_var_not_mutated, (, self, :, *, Self, ,, errors, :, *, errs_, ., Errors, ), error, {, CompileError, }, !, void, {, if, (, self, ., kind, ==, ., mut, and, self, ., aliases, ==, 0, and, self, ., roots, ==, 0, ), {, errors, ., add_error, (, errs_, ., Error, {, ., symbol_error, =, ., {, ., span, =, self, ., span, (, ), ,, ., context_span, =, null, ,, ., name, =, self, ., name, ,, ., problem, =, "is marked `mut` but is never mutated", ,, ., context_message, =, "", ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, set_offset, (, self, :, *, Self, ,, local_offsets, :, i64, ), i64, {, self, ., offset, =, local_offsets, ;, return, @, as, (, i64, ,, @, intCast, (, self, ., expanded_type, (, ), ., sizeof, (, ), ), ), ;, }, pub, fn, represents_method, (, self, :, *, Self, ,, impl_for_type, :, *, Type_AST, ,, method_name, :, [, ], const, u8, ), bool, {, return, self, ., decl, !=, null, and, self, ., decl, .?, .*, ==, ., method_decl, and, self, ., decl, .?, ., method_decl, ., impl, !=, null, and, self, ., decl, .?, ., method_decl, ., impl, .?, ., impl, ., _type, ., types_match, (, impl_for_type, ), and, std, ., mem, ., eql, (, u8, ,, self, ., name, ,, method_name, ), ;, }, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, pub, fn, monomorphize, (, self, :, *, Self, ,, key, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, ctx, :, *, Compiler_Context, ,, ), error, {, OutOfMemory, ,, CompileError, }, !, *, Self, {, if, (, self, ., monomorphs, ., get, (, key, ), ), |, retval, |, {, return, retval, ;, }, else, {, var, subst, =, unification_, ., Substitutions, ., init, (, ctx, ., allocator, (, ), ), ;, defer, subst, ., deinit, (, ), ;, for, (, self, ., decl, .?, ., generic_params, (, ), ., items, ,, key, ., items, ), |, param, ,, arg, |, {, try, subst, ., put, (, param, ., token, (, ), ., data, ,, arg, ), ;, }, const, name, =, anon_name_, ., next_anon_name, (, self, ., name, ,, ctx, ., allocator, (, ), ), ;, const, decl, =, self, ., decl, .?, ., clone, (, &, subst, ,, ctx, ., allocator, (, ), ), ;, const, Symbol_Tree, =, @, import, (, "../ast/symbol-tree.zig", ), ;, const, Decorate, =, @, import, (, "../ast/decorate.zig", ), ;, const, walker_, =, @, import, (, "../ast/walker.zig", ), ;, var, all_concrete, :, bool, =, true, ;, for, (, key, ., items, ), |, k, |, {, if, (, k, .*, ==, ., identifier, and, k, ., symbol, (, ), .?, ., decl, .?, .*, ==, ., type_param_decl, ), {, all_concrete, =, false, ;, }, }, if, (, all_concrete, ), {, decl, ., set_generic_params, (, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ., init, (, ctx, ., allocator, (, ), ), ), ;, }, const, scope, =, self, ., decl, .?, ., scope, (, ), .?, ., parent, .?, ;, const, symbol_tree_context, =, Symbol_Tree, ., new, (, scope, ,, &, ctx, ., errors, ,, ctx, ., allocator, (, ), ), ;, const, decorate_context, =, Decorate, ., new, (, scope, ,, ctx, ), ;, decl, ., set_decl_name, (, ast_, ., AST, ., create_pattern_symbol, (, Token, ., init_simple, (, name, ), ,, self, ., kind, ,, self, ., storage, ,, name, ,, ctx, ., allocator, (, ), ,, ), ), ;, try, walker_, ., walk_ast, (, decl, ,, symbol_tree_context, ), ;, try, walker_, ., walk_ast, (, decl, ,, decorate_context, ), ;, const, clone, =, decl, ., symbol, (, ), .?, ;, std, ., debug, ., assert, (, clone, ., cfg, ==, null, ), ;, try, self, ., monomorphs, ., put, (, try, key, ., clone, (, ), ,, clone, ), ;, clone, ., is_monomorphed, =, true, ;, return, clone, ;, }, }, const, std, =, @, import, (, "std", ), ;, const, Compiler_Context, =, @, import, (, "hierarchy/compiler.zig", ), ;, const, Codegen_Context, =, @, import, (, "codegen/codegen.zig", ), ;, const, core_, =, @, import, (, "hierarchy/core.zig", ), ;, const, exec, =, @, import, (, "util/exec.zig", ), ., exec, ;, const, module_, =, @, import, (, "hierarchy/module.zig", ), ;, const, prelude_, =, @, import, (, "hierarchy/prelude.zig", ), ;, const, Read_File, =, @, import, (, "lexer/read_file.zig", ), ;, const, String, =, @, import, (, "zig-string/zig-string.zig", ), ., String, ;, const, term_, =, @, import, (, "util/term.zig", ), ;, const, allocator, =, std, ., heap, ., page_allocator, ;, const, revert, =, term_, ., Attr, {, }, ;, const, succeed_color, =, term_, ., Attr, {, ., fg, =, ., green, ,, ., bold, =, true, }, ;, const, fail_color, =, term_, ., Attr, {, ., fg, =, ., red, ,, ., bold, =, true, }, ;, const, not_orng_color, =, term_, ., Attr, {, ., fg, =, ., blue, ,, ., bold, =, true, }, ;, const, Test_Mode, =, enum, {, regular, ,, coverage, ,, bless, }, ;, const, Debug_Allocator, =, std, ., heap, ., DebugAllocator, (, ., {, ., never_unmap, =, false, ,, ., safety, =, true, ,, ., retain_metadata, =, true, ,, ., verbose_log, =, false, ,, ., resize_stack_traces, =, true, ,, ., enable_memory_limit, =, true, ,, }, ), ;, const, Test_Error, =, error, {, CompileError, ,, FileNotFound, ,, LexerError, ,, InvalidRange, ,, OutOfMemory, ,, ParseError, ,, WriteFailed, ,, JsonError, ,, PathError, ,, CreateFileError, ,, MakeDirError, }, ;, const, Test_File_Fn, =, fn, (, [, ], const, u8, ,, Test_Mode, ,, *, Debug_Allocator, ), Test_Error, !, bool, ;, fn, get_std_out, (, ), std, ., fs, ., File, {, return, std, ., fs, ., File, ., stdout, (, ), ;, }, pub, fn, main, (, ), !, void, {, var, args, =, try, std, ., process, ., ArgIterator, ., initWithAllocator, (, allocator, ), ;, _, =, args, ., next, (, ), .?, ;, _, =, try, std, ., fs, ., cwd, (, ), ., realpathAlloc, (, allocator, ,, ".", ), ;, var, arg, :, [, ], const, u8, =, undefined, ;, if, (, args, ., next, (, ), ), |, _arg, |, {, arg, =, _arg, ;, while, (, std, ., mem, ., eql, (, u8, ,, arg, ,, "--", ), ), {, arg, =, args, ., next, (, ), .?, ;, }, if, (, std, ., mem, ., eql, (, u8, ,, "integration", ,, arg, ), ), {, try, parse_args, (, args, ,, ., regular, ,, integrate_test_file, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, "coverage", ,, arg, ), ), {, try, parse_args, (, args, ,, ., coverage, ,, integrate_test_file, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, "negative", ,, arg, ), ), {, try, parse_args, (, args, ,, ., regular, ,, negative_test_file, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, "negative-coverage", ,, arg, ), ), {, try, parse_args, (, args, ,, ., coverage, ,, negative_test_file, ), ;, }, else, if, (, std, ., mem, ., eql, (, u8, ,, "bless", ,, arg, ), ), {, try, parse_args, (, args, ,, ., bless, ,, negative_test_file, ), ;, }, else, {, std, ., debug, ., print, (, "invalid command-line argument: {s}\nusage: orng-test (integration | coverage | fuzz)\n", ,, ., {, arg, }, ), ;, return, error, ., InvalidCliArgument, ;, }, }, }, const, Results, =, struct, {, passed, :, usize, ,, failed, :, usize, }, ;, fn, parse_args, (, old_args, :, std, ., process, ., ArgIterator, ,, mode, :, Test_Mode, ,, comptime, test_file, :, Test_File_Fn, ), !, void, {, var, writer_struct, =, get_std_out, (, ), ., writer, (, &, ., {, }, ), ;, const, writer, =, &, writer_struct, ., interface, ;, var, args, =, old_args, ;, if, (, mode, ==, ., regular, ), {, try, term_, ., outputColor, (, succeed_color, ,, "[==============]\n", ,, writer, ), ;, }, var, failed_tests, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, std, ., heap, ., page_allocator, ), ;, defer, failed_tests, ., deinit, (, ), ;, var, results, =, Results, {, ., passed, =, 0, ,, ., failed, =, 0, }, ;, while, (, args, ., next, (, ), ), |, next, |, {, if, (, next, ., len, <, 4, or, !, std, ., mem, ., eql, (, u8, ,, next, [, next, ., len, -, 4, .., ], ,, "orng", ), ), {, continue, ;, }, var, debug_alloc, =, Debug_Allocator, {, }, ;, const, test_name, =, get_test_name, (, next, ), orelse, continue, ;, if, (, mode, ==, ., regular, ), {, try, term_, ., outputColor, (, succeed_color, ,, "[ RUN      ... ] ", ,, writer, ), ;, try, writer, ., print, (, "{s}\n", ,, ., {, test_name, }, ), ;, }, const, res, =, try, test_file, (, next, ,, mode, ,, &, debug_alloc, ), ;, const, debug_result, =, debug_alloc, ., deinit, (, ), ;, var, memory_leak_detected, :, bool, =, undefined, ;, if, (, debug_result, ==, ., leak, ), {, try, writer, ., print, (, "compiler error: memory leak!\n", ,, ., {, }, ), ;, memory_leak_detected, =, true, ;, }, else, {, memory_leak_detected, =, false, ;, }, if, (, res, and, !, memory_leak_detected, ), {, results, ., passed, +=, 1, ;, if, (, mode, ==, ., regular, ), {, try, term_, ., outputColor, (, succeed_color, ,, "[  ... PASSED  ]\n", ,, writer, ), ;, }, }, else, {, results, ., failed, +=, 1, ;, try, failed_tests, ., append, (, test_name, ), ;, if, (, mode, ==, ., regular, ), {, try, term_, ., outputColor, (, fail_color, ,, "[  ... FAILED  ]\n", ,, writer, ), ;, }, }, }, if, (, mode, ==, ., regular, ), {, try, term_, ., outputColor, (, succeed_color, ,, "[==============]\n", ,, writer, ), ;, try, writer, ., print, (, "Passed tests: {}\n", ,, ., {, results, ., passed, }, ), ;, try, writer, ., print, (, "Failed tests: {}\n", ,, ., {, results, ., failed, }, ), ;, if, (, results, ., failed, >, 0, ), {, try, term_, ., outputColor, (, fail_color, ,, "[ FAILED TESTS ]\n", ,, writer, ), ;, for, (, failed_tests, ., items, ), |, failed_test, |, {, try, writer, ., print, (, "{s} ", ,, ., {, failed_test, }, ), ;, }, try, term_, ., outputColor, (, fail_color, ,, "\n[==============]\n", ,, writer, ), ;, return, error, ., TestsFailed, ;, }, }, }, fn, integrate_test_file, (, filename, :, [, ], const, u8, ,, mode, :, Test_Mode, ,, debug_alloc, :, *, Debug_Allocator, ), Test_Error, !, bool, {, const, absolute_filename, =, std, ., fs, ., cwd, (, ), ., realpathAlloc, (, allocator, ,, filename, ), catch, return, error, ., PathError, ;, var, writer_struct, =, get_std_out, (, ), ., writer, (, &, ., {, }, ), ;, const, writer, =, &, writer_struct, ., interface, ;, var, compiler, =, try, Compiler_Context, ., init, (, if, (, mode, !=, ., coverage, ), get_std_out, (, ), else, null, ,, debug_alloc, ., allocator, (, ), ), ;, defer, compiler, ., deinit, (, ), ;, defer, prelude_, ., deinit, (, ), ;, defer, core_, ., deinit, (, ), ;, const, module, =, module_, ., Module, ., load_from_filename, (, absolute_filename, ,, "main", ,, false, ,, compiler, ), catch, {, if, (, mode, ==, ., regular, ), {, try, writer, ., print, (, "Orange -> C.\n", ,, ., {, }, ), ;, }, return, false, ;, }, ;, const, module_symbol, =, compiler, ., lookup_module, (, module, ., absolute_path, ), .?, ;, const, package_abs_path, =, module, ., get_package_abs_path, (, ), ;, try, compiler, ., register_package, (, package_abs_path, ,, ., executable, ), ;, compiler, ., set_package_root, (, package_abs_path, ,, module_symbol, ), ;, compiler, ., clean_package, (, package_abs_path, ), ;, try, compiler, ., lookup_package, (, package_abs_path, ), .?, ., include_directories, ., put, (, std, ., fs, ., path, ., dirname, (, absolute_filename, ), .?, ,, void, {, }, ), ;, compiler, ., propagate_include_directories, (, package_abs_path, ), ;, try, compiler, ., collect_package_local_modules, (, ), ;, try, compiler, ., determine_if_modified, (, package_abs_path, ), ;, compiler, ., collect_types, (, ), ;, const, package, =, compiler, ., lookup_package, (, package_abs_path, ), .?, ;, package, ., modified, =, true, ;, try, Codegen_Context, ., output_modules, (, compiler, ), ;, if, (, mode, ==, ., coverage, ), {, return, false, ;, }, const, contents, =, try, Read_File, ., init, (, compiler, ., allocator, (, ), ), ., run, (, absolute_filename, ), ;, const, header_comment_contents, =, try, header_comment, (, contents, ,, debug_alloc, ., allocator, (, ), ), ;, defer, debug_alloc, ., allocator, (, ), ., free, (, header_comment_contents, ), ;, var, expected_out, =, try, String, ., init_with_contents, (, debug_alloc, ., allocator, (, ), ,, header_comment_contents, [, 0, ], ), ;, defer, expected_out, ., deinit, (, ), ;, _, =, try, expected_out, ., replace, (, "\r", ,, "", ), ;, _, =, try, expected_out, ., replace, (, "\n", ,, "", ), ;, try, compiler, ., compile, (, package_abs_path, ), ;, var, output_name, =, try, String, ., init_with_contents, (, allocator, ,, "", ), ;, var, output_name_writer, =, output_name, ., writer, (, output_name, ., buffer, .?, ), ;, const, out_name_writer_intfc, =, &, output_name_writer, ., interface, ;, try, out_name_writer_intfc, ., print, (, "{s}/build/{s}", ,, ., {, package_abs_path, ,, module, ., package_name, }, ), ;, const, res, =, exec, (, &, [, _, ], [, ], const, u8, {, output_name, ., str, (, ), }, ,, ., Pipe, ), catch, |, e, |, {, try, writer, ., print, (, "{}\n", ,, ., {, e, }, ), ;, try, writer, ., print, (, "Execution interrupted!\n", ,, ., {, }, ), ;, return, false, ;, }, ;, if, (, !, std, ., mem, ., eql, (, u8, ,, res, ., stdout, ,, expected_out, ., str, (, ), ), ), {, try, writer, ., print, (, "Expected \"{s}\" retcode, got \"{s}\"\n", ,, ., {, expected_out, ., str, (, ), ,, res, ., stdout, }, ), ;, return, false, ;, }, return, true, ;, }, fn, negative_test_file, (, filename, :, [, ], const, u8, ,, mode, :, Test_Mode, ,, debug_alloc, :, *, Debug_Allocator, ), Test_Error, !, bool, {, var, writer_struct, =, get_std_out, (, ), ., writer, (, &, ., {, }, ), ;, const, writer, =, &, writer_struct, ., interface, ;, const, absolute_filename, =, std, ., fs, ., cwd, (, ), ., realpathAlloc, (, allocator, ,, filename, ), catch, return, error, ., PathError, ;, var, compiler, =, try, Compiler_Context, ., init, (, if, (, mode, !=, ., coverage, ), get_std_out, (, ), else, null, ,, debug_alloc, ., allocator, (, ), ), ;, defer, compiler, ., deinit, (, ), ;, defer, prelude_, ., deinit, (, ), ;, defer, core_, ., deinit, (, ), ;, const, contents, =, try, Read_File, ., init, (, compiler, ., allocator, (, ), ), ., run, (, absolute_filename, ), ;, const, head, =, try, header_comment, (, contents, ,, debug_alloc, ., allocator, (, ), ), ;, defer, debug_alloc, ., allocator, (, ), ., free, (, head, ), ;, var, flat_head, =, try, flatten_header_comment, (, head, ,, debug_alloc, ., allocator, (, ), ), ;, defer, flat_head, ., deinit, (, ), ;, const, body, =, test_body, (, contents, ), ;, var, error_string, =, try, String, ., init_with_contents, (, debug_alloc, ., allocator, (, ), ,, "", ), ;, defer, error_string, ., deinit, (, ), ;, _, =, module_, ., Module, ., load_from_filename, (, absolute_filename, ,, "main", ,, false, ,, compiler, ), catch, |, err, |, {, var, error_string_writer, =, error_string, ., writer, (, error_string, ., buffer, .?, ), ;, const, error_string_writer_intfc, =, &, error_string_writer, ., interface, ;, compiler, ., errors, ., print_errors, (, error_string_writer_intfc, ,, ., {, ., print_full_path, =, false, ,, ., print_color, =, false, }, ), ;, if, (, mode, ==, ., bless, ), {, try, bless_file, (, filename, ,, error_string, ., str, (, ), ,, body, ), ;, return, true, ;, }, else, if, (, mode, ==, ., regular, ), {, _, =, try, error_string, ., replace, (, "\r", ,, "", ), ;, _, =, try, error_string, ., replace, (, "\n", ,, "", ), ;, _, =, try, flat_head, ., replace, (, "\r", ,, "", ), ;, _, =, try, flat_head, ., replace, (, "\n", ,, "", ), ;, const, errors_match, =, std, ., mem, ., eql, (, u8, ,, error_string, ., str, (, ), ,, flat_head, ., str, (, ), ), ;, switch, (, err, ), {, error, ., LexerError, ,, error, ., CompileError, ,, error, ., OutOfMemory, ,, =>, {, return, errors_match, ;, }, ,, error, ., ParseError, ,, error, ., FileNotFound, =>, {, var, str, =, try, String, ., init_with_contents, (, allocator, ,, filename, ), ;, defer, str, ., deinit, (, ), ;, if, (, str, ., find, (, "parser", ), !=, null, ), {, return, errors_match, ;, }, else, {, try, writer, ., print, (, "Non-parser negative tests should parse!\n", ,, ., {, }, ), ;, return, false, ;, }, }, ,, }, }, else, {, return, false, ;, }, }, ;, if, (, mode, ==, ., coverage, ), {, return, false, ;, }, try, writer, ., print, (, "Negative test compiled without error.\n", ,, ., {, }, ), ;, return, false, ;, }, fn, bless_file, (, filename, :, [, ], const, u8, ,, error_msg, :, [, ], const, u8, ,, body, :, [, ], const, u8, ), Test_Error, !, void, {, var, file, =, std, ., fs, ., cwd, (, ), ., createFile, (, filename, ,, ., {, }, ), catch, unreachable, ;, defer, file, ., close, (, ), ;, var, file_contents, =, try, String, ., init_with_contents, (, std, ., heap, ., page_allocator, ,, "", ), ;, defer, file_contents, ., deinit, (, ), ;, var, writer_struct, =, file_contents, ., writer, (, file_contents, ., buffer, .?, ), ;, const, writer, =, &, writer_struct, ., interface, ;, _, =, try, writer, ., write, (, "// ", ), ;, for, (, error_msg, ), |, c, |, {, _, =, try, writer, ., write, (, &, [, 1, ], u8, {, c, }, ), ;, if, (, c, ==, '\n', ), {, _, =, try, writer, ., write, (, "// ", ), ;, }, }, _, =, try, writer, ., write, (, &, [, 1, ], u8, {, '\n', }, ), ;, _, =, try, writer, ., write, (, body, ), ;, _, =, file, ., write, (, file_contents, ., str, (, ), ), catch, return, error, ., WriteFailed, ;, }, fn, index_of, (, str, :, [, ], const, u8, ,, c, :, u8, ), ?, usize, {, for, (, 0..str.len, ), |, i, |, {, if, (, str, [, i, ], ==, c, ), {, return, i, ;, }, }, return, null, ;, }, fn, last_index_of, (, str, :, [, ], const, u8, ,, c, :, u8, ), ?, usize, {, var, i, :, usize, =, str, ., len, -, 1, ;, while, (, i, >=, 0, ), :, (, i, -=, 1, ), {, if, (, str, [, i, ], ==, c, ), {, return, i, ;, }, }, return, null, ;, }, fn, nth_last_index_of, (, str, :, [, ], const, u8, ,, c, :, u8, ,, n, :, usize, ), ?, usize, {, var, i, :, usize, =, str, ., len, -, 1, ;, var, m, =, n, ;, while, (, i, >=, 0, ), :, (, i, -=, 1, ), {, if, (, str, [, i, ], ==, c, ), {, if, (, m, ==, 1, ), {, return, i, ;, }, else, {, m, -=, 1, ;, }, }, }, return, null, ;, }, fn, get_test_name, (, filename, :, [, ], const, u8, ), ?, [, ], const, u8, {, const, slash_index, =, nth_last_index_of, (, filename, ,, std, ., fs, ., path, ., sep, ,, 2, ), orelse, {, std, ., debug, ., print, (, "filename {s} doens't contain a '/'", ,, ., {, filename, }, ), ;, return, null, ;, }, ;, return, filename, [, slash_index, +, 1, .., ], ;, }, fn, header_comment, (, contents, :, [, ], const, u8, ,, alloc, :, std, ., mem, ., Allocator, ), !, [, ], [, ], const, u8, {, var, lines, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, alloc, ), ;, var, cursor, :, usize, =, 0, ;, var, next_newline, =, until_newline, (, contents, ), ;, var, line, :, [, ], const, u8, =, contents, [, cursor, .., next_newline, ], ;, while, (, line, ., len, >=, 3, and, line, [, 0, ], ==, '/', and, line, [, 1, ], ==, '/', and, line, [, 2, ], ==, ' ', ), {, try, lines, ., append, (, line, [, 3.., ], ), ;, cursor, =, next_newline, +, 1, ;, next_newline, +=, until_newline, (, contents, [, cursor, .., ], ), +, 1, ;, line, =, contents, [, cursor, .., next_newline, ], ;, }, return, lines, ., toOwnedSlice, (, ), ;, }, fn, flatten_header_comment, (, lines, :, [, ], [, ], const, u8, ,, alloc, :, std, ., mem, ., Allocator, ), !, String, {, var, line, =, try, String, ., init_with_contents, (, alloc, ,, "", ), ;, var, line_writer, =, line, ., writer, (, line, ., buffer, .?, ), ;, const, writer, =, &, line_writer, ., interface, ;, var, i, :, usize, =, 0, ;, for, (, lines, ), |, l, |, {, try, writer, ., print, (, "{s}", ,, ., {, l, }, ), ;, if, (, i, <, lines, ., len, -|, 1, ), {, try, writer, ., print, (, "\n", ,, ., {, }, ), ;, }, i, +=, 1, ;, }, return, line, ;, }, fn, test_body, (, contents, :, [, ], const, u8, ), [, ], const, u8, {, var, cursor, :, usize, =, 0, ;, var, next_newline, =, until_newline, (, contents, ), ;, var, line, :, [, ], const, u8, =, contents, [, cursor, .., next_newline, ], ;, while, (, line, ., len, >=, 3, and, line, [, 0, ], ==, '/', and, line, [, 1, ], ==, '/', and, line, [, 2, ], ==, ' ', ), {, cursor, =, next_newline, +, 1, ;, next_newline, +=, until_newline, (, contents, [, cursor, .., ], ), +, 1, ;, line, =, contents, [, cursor, .., next_newline, ], ;, }, return, contents, [, cursor, .., ], ;, }, fn, until_newline, (, str, :, [, ], const, u8, ), usize, {, var, i, :, usize, =, 0, ;, while, (, i, <, str, ., len, and, str, [, i, ], !=, '\n', ), :, (, i, +=, 1, ), {, }, return, i, ;, }, const, std, =, @, import, (, "std", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, C_Type_Map, =, @, import, (, "../types/type_map.zig", ), ., C_Type_Map, ;, const, Self, =, @, This, (, ), ;, type, :, *, Type_AST, ,, case, :, enum, {, lower, ,, upper, }, =, ., lower, ,, pub, fn, format, (, self, :, *, const, Self, ,, writer, :, *, std, ., io, ., Writer, ), !, void, {, const, hash, =, try, Self, ., hash_type, (, self, ., type, ), ;, switch, (, self, ., case, ), {, ., lower, =>, try, writer, ., print, (, "orange_type_{X}", ,, ., {, hash, }, ), ,, ., upper, =>, try, writer, ., print, (, "ORANGE_TYPE_{X}", ,, ., {, hash, }, ), ,, }, }, pub, fn, hash_type, (, _type, :, *, Type_AST, ), !, usize, {, var, seen_map, =, C_Type_Map, (, usize, ), ., init, (, std, ., heap, ., page_allocator, ), ;, defer, seen_map, ., deinit, (, ), ;, var, next_id, :, usize, =, 0, ;, var, str, =, String, ., init, (, std, ., heap, ., page_allocator, ), ;, defer, str, ., deinit, (, ), ;, var, writer, =, str, ., writer, (, &, ., {, }, ), ;, const, writer_intfc, =, &, writer, ., interface, ;, try, hash_type_internal, (, _type, ,, &, seen_map, ,, &, next_id, ,, writer_intfc, ), ;, return, std, ., hash, ., Fnv1a_64, ., hash, (, str, ., str, (, ), ), ;, }, pub, fn, canonical_rep, (, _type, :, *, Type_AST, ), !, String, {, var, seen_map, =, C_Type_Map, (, usize, ), ., init, (, std, ., heap, ., page_allocator, ), ;, defer, seen_map, ., deinit, (, ), ;, var, next_id, :, usize, =, 0, ;, var, str, =, String, ., init, (, std, ., heap, ., page_allocator, ), ;, var, writer, =, str, ., writer, (, &, ., {, }, ), ;, const, writer_intfc, =, &, writer, ., interface, ;, try, hash_type_internal, (, _type, ,, &, seen_map, ,, &, next_id, ,, writer_intfc, ), ;, return, str, ;, }, fn, hash_type_internal, (, _type, :, *, Type_AST, ,, seen_map, :, *, C_Type_Map, (, usize, ), ,, next_id, :, *, usize, ,, writer, :, *, std, ., io, ., Writer, ,, ), error, {, WriteFailed, }, !, void, {, var, real_type, =, _type, ., expand_identifier, (, ), ;, if, (, seen_map, ., contains, (, real_type, ), ), {, try, writer, ., print, (, "ref{}", ,, ., {, seen_map, ., get, (, real_type, ), .?, }, ), ;, return, ;, }, const, id, =, next_id, .*, ;, next_id, .*, +=, 1, ;, seen_map, ., put, (, real_type, ,, id, ), catch, unreachable, ;, switch, (, real_type, .*, ), {, ., identifier, =>, {, const, info, =, prelude_, ., info_from_name, (, real_type, ., token, (, ), ., data, ), ;, if, (, info, !=, null, ), {, try, writer, ., print, (, "{s}", ,, ., {, info, .?, ., canon_name, }, ), ;, }, else, {, try, writer, ., print, (, "{s}", ,, ., {, real_type, ., token, (, ), ., data, }, ), ;, }, }, ,, ., addr_of, =>, {, try, writer, ., print, (, "p", ,, ., {, }, ), ;, try, hash_type_internal, (, real_type, ., child, (, ), ,, seen_map, ,, next_id, ,, writer, ), ;, }, ,, ., anyptr_type, =>, try, writer, ., print, (, "void", ,, ., {, }, ), ,, ., unit_type, =>, try, writer, ., print, (, "unit", ,, ., {, }, ), ,, ., struct_type, ,, ., tuple_type, =>, {, try, writer, ., print, (, "tuple{}", ,, ., {, non_unit_len, (, real_type, ), }, ), ;, try, append_fields, (, real_type, ,, seen_map, ,, next_id, ,, writer, ), ;, }, ,, ., context_type, =>, {, try, writer, ., print, (, "context{}", ,, ., {, non_unit_len, (, real_type, ), }, ), ;, try, append_fields, (, real_type, ,, seen_map, ,, next_id, ,, writer, ), ;, }, ,, ., array_of, =>, {, try, writer, ., print, (, "array{}_", ,, ., {, real_type, ., array_of, ., len, ., int, ., data, }, ), ;, try, hash_type_internal, (, real_type, ., child, (, ), ,, seen_map, ,, next_id, ,, writer, ), ;, }, ,, ., enum_type, =>, {, try, writer, ., print, (, "enum{}", ,, ., {, non_unit_len, (, real_type, ), }, ), ;, try, append_fields, (, real_type, ,, seen_map, ,, next_id, ,, writer, ), ;, }, ,, ., untagged_sum_type, =>, {, try, writer, ., print, (, "union", ,, ., {, }, ), ;, try, append_fields, (, real_type, ., child, (, ), ., expand_identifier, (, ), ,, seen_map, ,, next_id, ,, writer, ), ;, }, ,, ., dyn_type, =>, {, try, writer, ., print, (, "dyn_{s}", ,, ., {, real_type, ., child, (, ), ., symbol, (, ), .?, ., name, }, ), ;, }, ,, ., function, =>, {, try, writer, ., print, (, "function{}", ,, ., {, non_unit_len, (, real_type, ), }, ), ;, try, append_fields, (, real_type, ,, seen_map, ,, next_id, ,, writer, ), ;, try, writer, ., print, (, "_", ,, ., {, }, ), ;, try, hash_type_internal, (, real_type, ., rhs, (, ), ,, seen_map, ,, next_id, ,, writer, ), ;, }, ,, else, =>, try, writer, ., print, (, "({t})", ,, ., {, real_type, .*, }, ), ,, }, }, fn, non_unit_len, (, real_type, :, *, Type_AST, ), usize, {, var, ret, :, usize, =, 0, ;, for, (, real_type, ., children, (, ), ., items, ), |, child, |, {, if, (, !, child, ., is_c_void_type, (, ), ), ret, +=, 1, ;, }, return, ret, ;, }, fn, append_fields, (, _type, :, *, Type_AST, ,, seen_map, :, *, C_Type_Map, (, usize, ), ,, next_id, :, *, usize, ,, writer, :, *, std, ., io, ., Writer, ,, ), !, void, {, for, (, _type, ., children, (, ), ., items, ), |, child, |, {, if, (, child, ., is_c_void_type, (, ), ), continue, ;, try, writer, ., print, (, "_", ,, ., {, }, ), ;, try, hash_type_internal, (, child, ,, seen_map, ,, next_id, ,, writer, ), ;, }, }, const, std, =, @, import, (, "std", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Canonical_Type_Fmt, =, @, import, (, "../types/canonical_type_fmt.zig", ), ;, const, Self, =, @, This, (, ), ;, base, :, *, Type_AST, ,, uid, :, usize, ,, dependencies, :, std, ., array_list, ., Managed, (, *, Self, ), ,, visited, :, bool, ,, pub, fn, init, (, base, :, *, Type_AST, ,, uid, :, usize, ,, allocator, :, std, ., mem, ., Allocator, ), *, Self, {, var, retval, =, allocator, ., create, (, Self, ), catch, unreachable, ;, retval, ., base, =, base, ;, retval, ., uid, =, uid, ;, retval, ., dependencies, =, std, ., array_list, ., Managed, (, *, Self, ), ., init, (, allocator, ), ;, retval, ., visited, =, false, ;, return, retval, ;, }, pub, fn, add_dependency, (, self, :, *, Self, ,, dependency, :, *, Self, ), void, {, self, ., dependencies, ., append, (, dependency, ), catch, unreachable, ;, }, pub, fn, mark_visited, (, self, :, *, Self, ), void, {, self, ., visited, =, true, ;, }, fn, print, (, self, :, *, Self, ), void, {, std, ., debug, ., print, (, "{} <= ", ,, ., {, self, ., uid, }, ), ;, for, (, self, ., dependencies, ., items, ), |, dep, |, {, std, ., debug, ., print, (, "{} ", ,, ., {, dep, ., uid, }, ), ;, }, std, ., debug, ., print, (, "\n", ,, ., {, }, ), ;, }, pub, fn, graphviz, (, self, :, *, Self, ), void, {, for, (, self, ., dependencies, ., items, ), |, dep, |, {, std, ., debug, ., print, (, "\"{f}\" {f} -> \"{f}\" {f};\n", ,, ., {, self, ., base, ,, dep, ., base, ,, Canonical_Type_Fmt, {, ., type, =, self, ., base, }, ,, Canonical_Type_Fmt, {, ., type, =, dep, ., base, }, }, ), ;, }, }, const, std, =, @, import, (, "std", ), ;, const, alignment_, =, @, import, (, "../util/alignment.zig", ), ;, const, AST, =, @, import, (, "../ast/ast.zig", ), ., AST, ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, Scope, =, @, import, (, "../symbol/scope.zig", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, unification_, =, @, import, (, "unification.zig", ), ;, pub, const, Type_AST_Common, =, struct, {, _token, :, Token, ,, _expanded_type, :, ?, *, Type_AST, =, null, ,, _unexpanded_type, :, ?, *, Type_AST, =, null, ,, _size, :, ?, i64, =, null, ,, _alignof, :, ?, i64, =, null, ,, }, ;, pub, const, Type_AST, =, union, (, enum, ), {, pub, const, Sum_From, =, enum, {, optional, ,, @, "error", ,, none, ,, }, ;, poison, :, struct, {, common, :, Type_AST_Common, }, ,, anyptr_type, :, struct, {, common, :, Type_AST_Common, }, ,, unit_type, :, struct, {, common, :, Type_AST_Common, }, ,, identifier, :, struct, {, common, :, Type_AST_Common, ,, _symbol, :, ?, *, Symbol, =, null, ,, }, ,, access, :, struct, {, common, :, Type_AST_Common, ,, inner_access, :, *, AST, ,, _symbol, :, ?, *, Symbol, =, null, ,, }, ,, generic_apply, :, struct, {, common, :, Type_AST_Common, ,, _lhs, :, *, Type_AST, ,, args, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, _symbol, :, ?, *, Symbol, =, null, ,, state, :, enum, {, unmorphed, ,, morphing, ,, morphed, }, =, ., unmorphed, ,, }, ,, function, :, struct, {, common, :, Type_AST_Common, ,, args, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, _rhs, :, *, Type_AST, ,, contexts, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, variadic, :, bool, =, false, ,, pub, fn, contains_context, (, self, :, *, @, This, (, ), ,, context_type, :, *, Type_AST, ), bool, {, for, (, self, ., contexts, ., items, ), |, ctx, |, {, if, (, context_type, ., types_match, (, ctx, ., child, (, ), ), ), {, return, true, ;, }, }, return, false, ;, }, }, ,, annotation, :, struct, {, common, :, Type_AST_Common, ,, pattern, :, *, AST, ,, _child, :, *, Type_AST, ,, init, :, ?, *, AST, ,, }, ,, enum_type, :, struct, {, common, :, Type_AST_Common, ,, _terms, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, from, :, Sum_From, =, ., none, ,, all_unit, :, ?, bool, =, null, ,, pub, fn, is_all_unit, (, self, :, *, @, This, (, ), ), bool, {, if, (, self, ., all_unit, ), |, all_unit, |, {, return, all_unit, ;, }, var, res, =, true, ;, for, (, self, ., _terms, ., items, ), |, term, |, {, res, =, res, and, term, ., c_types_match, (, prelude_, ., unit_type, ), ;, }, self, ., all_unit, =, res, ;, return, res, ;, }, pub, fn, get_ctor, (, self, :, *, @, This, (, ), ,, name, :, [, ], const, u8, ), ?, *, Type_AST, {, for, (, self, ., _terms, ., items, ), |, term, |, {, if, (, std, ., mem, ., eql, (, u8, ,, term, ., annotation, ., pattern, ., token, (, ), ., data, ,, name, ), ), {, return, term, ;, }, }, return, null, ;, }, }, ,, untagged_sum_type, :, struct, {, common, :, Type_AST_Common, ,, _child, :, *, Type_AST, ,, }, ,, context_type, :, struct, {, common, :, Type_AST_Common, ,, _terms, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, }, ,, struct_type, :, struct, {, common, :, Type_AST_Common, ,, _terms, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, was_slice, :, bool, =, false, ,, pub, fn, get_offset_field, (, self, :, *, @, This, (, ), ,, field_name, :, [, ], const, u8, ), i64, {, for, (, 0.., ,, self, ., _terms, ., items, ), |, i, ,, term, |, {, if, (, term, .*, ==, ., annotation, and, std, ., mem, ., eql, (, u8, ,, field_name, ,, term, ., annotation, ., pattern, ., token, (, ), ., data, ), ), {, return, self, ., get_offset, (, i, ), ;, }, }, std, ., debug, ., panic, (, "compiler error: couldn't get offset; struct didn't have the field `{s}`", ,, ., {, field_name, }, ), ;, }, pub, fn, get_offset, (, self, :, *, @, This, (, ), ,, field, :, usize, ), i64, {, var, offset, :, i64, =, 0, ;, for, (, 0..field, ), |, i, |, {, var, item, =, self, ., _terms, ., items, [, i, ], ., expand_identifier, (, ), ;, if, (, self, ., _terms, ., items, [, i, +, 1, ], ., alignof, (, ), ==, 0, ), {, continue, ;, }, offset, +=, item, ., sizeof, (, ), ;, offset, =, alignment_, ., next_alignment, (, offset, ,, self, ., _terms, ., items, [, i, +, 1, ], ., alignof, (, ), ), ;, }, return, offset, ;, }, }, ,, tuple_type, :, struct, {, common, :, Type_AST_Common, ,, _terms, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, pub, fn, get_offset, (, self, :, *, @, This, (, ), ,, field, :, usize, ), i64, {, var, offset, :, i64, =, 0, ;, for, (, 0..field, ), |, i, |, {, var, item, =, self, ., _terms, ., items, [, i, ], ., expand_identifier, (, ), ;, if, (, self, ., _terms, ., items, [, i, +, 1, ], ., alignof, (, ), ==, 0, ), {, continue, ;, }, offset, +=, item, ., sizeof, (, ), ;, offset, =, alignment_, ., next_alignment, (, offset, ,, self, ., _terms, ., items, [, i, +, 1, ], ., alignof, (, ), ), ;, }, return, offset, ;, }, }, ,, addr_of, :, struct, {, common, :, Type_AST_Common, ,, _child, :, *, Type_AST, ,, mut, :, bool, ,, multiptr, :, bool, =, false, ,, anytptr, :, bool, =, false, ,, _scope, :, ?, *, Scope, =, null, ,, }, ,, dyn_type, :, struct, {, common, :, Type_AST_Common, ,, _child, :, *, Type_AST, ,, mut, :, bool, ,, }, ,, array_of, :, struct, {, common, :, Type_AST_Common, ,, _child, :, *, Type_AST, ,, len, :, *, AST, ,, pub, fn, get_offset, (, self, :, *, @, This, (, ), ,, field, :, usize, ), i64, {, return, self, ., _child, ., sizeof, (, ), *, @, as, (, i64, ,, @, intCast, (, field, ), ), ;, }, }, ,, type_of, :, struct, {, common, :, Type_AST_Common, ,, _expr, :, *, AST, ,, }, ,, domain_of, :, struct, {, common, :, Type_AST_Common, ,, _child, :, *, Type_AST, ,, ctor_name, :, [, ], const, u8, ,, }, ,, index, :, struct, {, common, :, Type_AST_Common, ,, _child, :, *, Type_AST, ,, idx, :, *, AST, ,, }, ,, pub, fn, create_poisoned_type, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., box, (, Type_AST, {, ., poison, =, ., {, ., common, =, Type_AST_Common, {, ., _token, =, _token, }, }, }, ,, allocator, ), ;, }, pub, fn, create_anyptr_type, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., box, (, Type_AST, {, ., anyptr_type, =, ., {, ., common, =, Type_AST_Common, {, ., _token, =, _token, ,, }, }, }, ,, allocator, ), ;, }, pub, fn, create_unit_type, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., box, (, Type_AST, {, ., unit_type, =, ., {, ., common, =, Type_AST_Common, {, ., _token, =, _token, }, }, }, ,, allocator, ), ;, }, pub, fn, create_type_identifier, (, _token, :, Token, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., box, (, Type_AST, {, ., identifier, =, ., {, ., common, =, Type_AST_Common, {, ., _token, =, _token, }, }, }, ,, allocator, ), ;, }, pub, fn, create_type_access, (, _token, :, Token, ,, inner_access, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, const, _common, :, Type_AST_Common, =, ., {, ., _token, =, _token, }, ;, return, Type_AST, ., box, (, Type_AST, {, ., access, =, ., {, ., common, =, _common, ,, ., inner_access, =, inner_access, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_generic_apply_type, (, _token, :, Token, ,, _lhs, :, *, Type_AST, ,, args, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, const, _common, :, Type_AST_Common, =, ., {, ., _token, =, _token, }, ;, return, Type_AST, ., box, (, Type_AST, {, ., generic_apply, =, ., {, ., common, =, _common, ,, ., _lhs, =, _lhs, ,, ., args, =, args, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_enum_type, (, _token, :, Token, ,, terms, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., box, (, Type_AST, {, ., enum_type, =, ., {, ., common, =, Type_AST_Common, {, ., _token, =, _token, }, ,, ., _terms, =, terms, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_untagged_sum_type, (, _token, :, Token, ,, _child, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., box, (, Type_AST, {, ., untagged_sum_type, =, ., {, ., common, =, Type_AST_Common, {, ., _token, =, _token, }, ,, ., _child, =, _child, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_function, (, _token, :, Token, ,, args, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, _rhs, :, *, Type_AST, ,, contexts, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, const, _common, :, Type_AST_Common, =, ., {, ., _token, =, _token, }, ;, return, Type_AST, ., box, (, Type_AST, {, ., function, =, ., {, ., common, =, _common, ,, ., args, =, args, ,, ., _rhs, =, _rhs, ,, ., contexts, =, contexts, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_annotation, (, _token, :, Token, ,, pattern, :, *, AST, ,, _type, :, *, Type_AST, ,, init, :, ?, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ,, ), *, Type_AST, {, const, _common, :, Type_AST_Common, =, ., {, ., _token, =, _token, }, ;, return, Type_AST, ., box, (, Type_AST, {, ., annotation, =, ., {, ., common, =, _common, ,, ., pattern, =, pattern, ,, ., _child, =, _type, ,, ., init, =, init, ,, }, }, ,, allocator, ,, ), ;, }, pub, fn, create_context_type, (, _token, :, Token, ,, terms, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., box, (, Type_AST, {, ., context_type, =, ., {, ., common, =, Type_AST_Common, {, ., _token, =, _token, }, ,, ., _terms, =, terms, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_struct_type, (, _token, :, Token, ,, terms, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., box, (, Type_AST, {, ., struct_type, =, ., {, ., common, =, Type_AST_Common, {, ., _token, =, _token, }, ,, ., _terms, =, terms, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_tuple_type, (, _token, :, Token, ,, terms, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., box, (, Type_AST, {, ., tuple_type, =, ., {, ., common, =, Type_AST_Common, {, ., _token, =, _token, }, ,, ., _terms, =, terms, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_addr_of_type, (, _token, :, Token, ,, _child, :, *, Type_AST, ,, _mut, :, bool, ,, multiptr, :, bool, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, const, _common, :, Type_AST_Common, =, ., {, ., _token, =, _token, }, ;, return, Type_AST, ., box, (, Type_AST, {, ., addr_of, =, ., {, ., common, =, _common, ,, ., _child, =, _child, ,, ., mut, =, _mut, ,, ., multiptr, =, multiptr, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_dyn_type, (, _token, :, Token, ,, _child, :, *, Type_AST, ,, _mut, :, bool, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, const, _common, :, Type_AST_Common, =, ., {, ., _token, =, _token, }, ;, return, Type_AST, ., box, (, Type_AST, {, ., dyn_type, =, ., {, ., common, =, _common, ,, ., _child, =, _child, ,, ., mut, =, _mut, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_array_of, (, _token, :, Token, ,, _child, :, *, Type_AST, ,, len, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, const, _common, :, Type_AST_Common, =, ., {, ., _token, =, _token, }, ;, return, Type_AST, ., box, (, Type_AST, {, ., array_of, =, ., {, ., common, =, _common, ,, ., _child, =, _child, ,, ., len, =, len, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_type_of, (, _token, :, Token, ,, _expr, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., box, (, Type_AST, {, ., type_of, =, ., {, ., common, =, Type_AST_Common, {, ., _token, =, _token, }, ,, ., _expr, =, _expr, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_domain_of, (, _token, :, Token, ,, sum_type, :, *, Type_AST, ,, ctor_name, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, const, _common, :, Type_AST_Common, =, ., {, ., _token, =, _token, }, ;, return, Type_AST, ., box, (, Type_AST, {, ., domain_of, =, ., {, ., common, =, _common, ,, ., _child, =, sum_type, ,, ., ctor_name, =, ctor_name, ,, }, }, ,, allocator, ), ;, }, pub, fn, create_index_type, (, _token, :, Token, ,, _lhs, :, *, Type_AST, ,, _rhs, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, Type_AST, ., box, (, Type_AST, {, ., index, =, ., {, ., common, =, Type_AST_Common, {, ., _token, =, _token, }, ,, ., _child, =, _lhs, ,, ., idx, =, _rhs, ,, }, }, ,, allocator, ), ;, }, fn, box, (, ast, :, Type_AST, ,, alloc, :, std, ., mem, ., Allocator, ), *, Type_AST, {, const, retval, =, alloc, ., create, (, Type_AST, ), catch, unreachable, ;, retval, .*, =, ast, ;, return, retval, ;, }, pub, fn, create_slice_type, (, of, :, *, Type_AST, ,, _mut, :, bool, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, var, term_types, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, const, data_type, =, create_addr_of_type, (, of, ., token, (, ), ,, of, ,, _mut, ,, true, ,, allocator, ,, ), ;, const, annot_type, =, create_annotation, (, of, ., token, (, ), ,, AST, ., create_identifier, (, Token, ., init, (, "data", ,, null, ,, "", ,, "", ,, 0, ,, 0, ), ,, allocator, ), ,, data_type, ,, null, ,, allocator, ,, ), ;, term_types, ., append, (, annot_type, ), catch, unreachable, ;, term_types, ., append, (, create_annotation, (, of, ., token, (, ), ,, AST, ., create_identifier, (, Token, ., init, (, "length", ,, null, ,, "", ,, "", ,, 0, ,, 0, ), ,, allocator, ), ,, prelude_, ., int_type, ,, null, ,, allocator, ,, ), ), catch, unreachable, ;, var, retval, =, create_struct_type, (, of, ., token, (, ), ,, term_types, ,, allocator, ), ;, retval, ., struct_type, ., was_slice, =, true, ;, return, retval, ;, }, pub, fn, create_optional_type, (, of_type, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, var, term_types, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, const, some_type, =, create_annotation, (, of_type, ., token, (, ), ,, AST, ., create_identifier, (, Token, ., init, (, "some", ,, null, ,, "", ,, "", ,, 0, ,, 0, ), ,, allocator, ), ,, of_type, ,, null, ,, allocator, ,, ), ;, term_types, ., append, (, some_type, ), catch, unreachable, ;, const, none_type, =, create_annotation, (, of_type, ., token, (, ), ,, AST, ., create_identifier, (, Token, ., init_simple, (, "none", ), ,, allocator, ), ,, prelude_, ., unit_type, ,, AST, ., create_unit_value, (, Token, ., init_simple, (, "none init", ), ,, allocator, ), ,, allocator, ,, ), ;, term_types, ., append, (, none_type, ), catch, unreachable, ;, var, retval, =, create_enum_type, (, of_type, ., token, (, ), ,, term_types, ,, allocator, ), ;, retval, ., enum_type, ., from, =, ., optional, ;, return, retval, ;, }, pub, fn, create_error_type, (, err_type, :, *, Type_AST, ,, ok_type, :, *, Type_AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, var, retval_sum_terms, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, const, ok_annot, =, create_annotation, (, ok_type, ., token, (, ), ,, AST, ., create_identifier, (, Token, ., init_simple, (, "ok", ), ,, allocator, ), ,, ok_type, ,, null, ,, allocator, ,, ), ;, retval_sum_terms, ., append, (, ok_annot, ), catch, unreachable, ;, const, err_annot, =, create_annotation, (, err_type, ., token, (, ), ,, AST, ., create_identifier, (, Token, ., init_simple, (, "err", ), ,, allocator, ), ,, err_type, ,, null, ,, allocator, ,, ), ;, retval_sum_terms, ., append, (, err_annot, ), catch, unreachable, ;, var, retval, =, create_enum_type, (, ok_type, ., token, (, ), ,, retval_sum_terms, ,, allocator, ), ;, retval, ., enum_type, ., from, =, ., @, "error", ;, return, retval, ;, }, pub, fn, from_ast, (, ast, :, *, AST, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, return, switch, (, ast, .*, ), {, ., identifier, =>, blk, :, {, const, id, =, Type_AST, ., create_type_identifier, (, ast, ., token, (, ), ,, allocator, ), ;, id, ., set_symbol, (, ast, ., symbol, (, ), .?, ), ;, break, :, blk, id, ;, }, ,, ., access, =>, blk, :, {, const, id, =, Type_AST, ., create_type_access, (, ast, ., token, (, ), ,, ast, ,, allocator, ), ;, id, ., set_symbol, (, ast, ., symbol, (, ), .?, ), ;, break, :, blk, id, ;, }, ,, ., index, =>, blk, :, {, const, base, =, from_ast, (, ast, ., lhs, (, ), ,, allocator, ), ;, var, args, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, for, (, ast, ., children, (, ), ., items, ), |, arg, |, {, args, ., append, (, from_ast, (, arg, ,, allocator, ), ), catch, unreachable, ;, }, break, :, blk, Type_AST, ., create_generic_apply_type, (, ast, ., token, (, ), ,, base, ,, args, ,, allocator, ), ;, }, ,, ., generic_apply, =>, blk, :, {, const, _lhs, =, from_ast, (, ast, ., lhs, (, ), ,, allocator, ), ;, const, gen_apply, =, Type_AST, ., create_generic_apply_type, (, ast, ., token, (, ), ,, _lhs, ,, ast, ., generic_apply, ., _children, ,, allocator, ), ;, gen_apply, ., set_symbol, (, ast, ., symbol, (, ), ), ;, break, :, blk, gen_apply, ;, }, ,, ., unit_value, =>, Type_AST, ., create_unit_type, (, ast, ., token, (, ), ,, allocator, ), ,, else, =>, std, ., debug, ., panic, (, "unable to construct type from {t}", ,, ., {, ast, .*, }, ), ,, }, ;, }, pub, fn, common, (, self, :, *, const, Type_AST, ), *, const, Type_AST_Common, {, return, get_field_const_ref, (, self, ,, "common", ), ;, }, pub, fn, set_alignof, (, self, :, *, Type_AST, ,, _alignof, :, i64, ), void, {, get_field_ref, (, self, ,, "common", ), ., _alignof, =, _alignof, ;, }, pub, fn, set_sizeof, (, self, :, *, Type_AST, ,, _sizeof, :, i64, ), void, {, get_field_ref, (, self, ,, "common", ), ., _size, =, _sizeof, ;, }, pub, fn, set_expanded_type, (, self, :, *, Type_AST, ,, _expanded_type, :, *, Type_AST, ), void, {, get_field_ref, (, self, ,, "common", ), ., _expanded_type, =, _expanded_type, ;, }, pub, fn, set_unexpanded_type, (, self, :, *, Type_AST, ,, _unexpanded_type, :, *, Type_AST, ), void, {, get_field_ref, (, self, ,, "common", ), ., _unexpanded_type, =, _unexpanded_type, ;, }, pub, fn, token, (, self, :, *, const, Type_AST, ), Token, {, return, self, ., common, (, ), ., _token, ;, }, fn, Unwrapped, (, comptime, Union, :, type, ,, comptime, field, :, [, ], const, u8, ), type, {, return, inline, for, (, std, ., meta, ., fields, (, Union, ), ), |, variant, |, {, const, Struct, =, variant, ., type, ;, const, s, :, Struct, =, undefined, ;, if, (, @, hasField, (, Struct, ,, field, ), ), break, @, TypeOf, (, @, field, (, s, ,, field, ), ), ;, }, else, @, compileError, (, "No such field in any of the variants!", ), ;, }, fn, get_struct_field, (, u, :, anytype, ,, comptime, field, :, [, ], const, u8, ), Unwrapped, (, @, TypeOf, (, u, ), ,, field, ), {, return, switch, (, u, ), {, inline, else, =>, |, v, |, if, (, @, hasField, (, @, TypeOf, (, v, ), ,, field, ), ), @, field, (, v, ,, field, ), else, error, ., NoField, ,, }, catch, {, std, ., debug, ., panic, (, "compiler error: `{s}` does not have field `{s}` {}", ,, ., {, @, tagName, (, u, ), ,, field, ,, Unwrapped, (, @, TypeOf, (, u, ), ,, field, ), }, ), ;, }, ;, }, fn, get_field_ref, (, u, :, anytype, ,, comptime, field, :, [, ], const, u8, ), *, Unwrapped, (, @, TypeOf, (, u, .*, ), ,, field, ), {, return, switch, (, u, .*, ), {, inline, else, =>, |, *, v, |, &, @, field, (, v, ,, field, ), ,, }, ;, }, fn, get_field_const_ref, (, u, :, anytype, ,, comptime, field, :, [, ], const, u8, ), *, const, Unwrapped, (, @, TypeOf, (, u, .*, ), ,, field, ), {, return, switch, (, u, .*, ), {, inline, else, =>, |, *, v, |, &, @, field, (, v, ,, field, ), ,, }, ;, }, fn, set_field, (, u, :, anytype, ,, comptime, field, :, [, ], const, u8, ,, val, :, Unwrapped, (, @, TypeOf, (, u, .*, ), ,, field, ), ), void, {, switch, (, u, .*, ), {, inline, else, =>, |, *, v, |, if, (, @, hasField, (, @, TypeOf, (, v, .*, ), ,, field, ), ), {, @, field, (, v, ,, field, ), =, val, ;, }, else, {, std, ., debug, ., panic, (, "compiler error: `{s}` does not have field `{s}`", ,, ., {, @, tagName, (, u, .*, ), ,, field, }, ), ;, }, ,, }, }, pub, fn, expr, (, self, :, Type_AST, ), *, AST, {, return, get_struct_field, (, self, ,, "_expr", ), ;, }, pub, fn, child, (, self, :, Type_AST, ), *, Type_AST, {, return, get_struct_field, (, self, ,, "_child", ), ;, }, pub, fn, mut, (, self, :, Type_AST, ), bool, {, return, get_struct_field, (, self, ,, "mut", ), ;, }, pub, fn, set_mut, (, self, :, *, Type_AST, ,, val, :, bool, ), void, {, set_field, (, self, ,, "mut", ,, val, ), ;, }, pub, fn, symbol, (, self, :, Type_AST, ), ?, *, Symbol, {, if, (, self, ==, ., access, ), {, return, self, ., access, ., inner_access, ., symbol, (, ), ;, }, return, get_struct_field, (, self, ,, "_symbol", ), ;, }, pub, fn, set_symbol, (, self, :, *, Type_AST, ,, val, :, ?, *, Symbol, ), void, {, if, (, self, .*, ==, ., access, ), {, self, ., access, ., inner_access, ., set_symbol, (, val, ), ;, return, ;, }, set_field, (, self, ,, "_symbol", ,, val, ), ;, }, pub, fn, lhs, (, self, :, Type_AST, ), *, Type_AST, {, return, get_struct_field, (, self, ,, "_lhs", ), ;, }, pub, fn, set_lhs, (, self, :, *, Type_AST, ,, val, :, *, Type_AST, ), void, {, set_field, (, self, ,, "_lhs", ,, val, ), ;, }, pub, fn, rhs, (, self, :, Type_AST, ), *, Type_AST, {, return, get_struct_field, (, self, ,, "_rhs", ), ;, }, pub, fn, set_rhs, (, self, :, *, Type_AST, ,, val, :, *, Type_AST, ), void, {, set_field, (, self, ,, "_rhs", ,, val, ), ;, }, pub, fn, children, (, self, :, *, const, Type_AST, ), *, const, std, ., array_list, ., Managed, (, *, Type_AST, ), {, return, switch, (, self, .*, ), {, ., function, =>, &, self, ., function, ., args, ,, ., generic_apply, =>, &, self, ., generic_apply, ., args, ,, ., enum_type, =>, &, self, ., enum_type, ., _terms, ,, ., untagged_sum_type, =>, self, ., child, (, ), ., expand_identifier, (, ), ., children, (, ), ,, ., context_type, =>, &, self, ., context_type, ., _terms, ,, ., struct_type, =>, &, self, ., struct_type, ., _terms, ,, ., tuple_type, =>, &, self, ., tuple_type, ., _terms, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.children()` on the Type_AST `{f}`", ,, ., {, self, }, ), ,, }, ;, }, pub, fn, set_children, (, self, :, *, Type_AST, ,, val, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ), void, {, switch, (, self, .*, ), {, ., enum_type, =>, self, ., enum_type, ., _terms, =, val, ,, ., untagged_sum_type, =>, self, ., untagged_sum_type, ., _child, ., enum_type, ., _terms, =, val, ,, ., struct_type, =>, self, ., struct_type, ., _terms, =, val, ,, ., tuple_type, =>, self, ., tuple_type, ., _terms, =, val, ,, else, =>, std, ., debug, ., panic, (, "compiler error: cannot call `.set_children()` on the Type_AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, }, pub, fn, get_nominal_type, (, opt_or_error_sum, :, *, Type_AST, ), *, Type_AST, {, std, ., debug, ., assert, (, opt_or_error_sum, ., enum_type, ., from, ==, ., optional, or, opt_or_error_sum, ., enum_type, ., from, ==, ., @, "error", ), ;, return, opt_or_error_sum, ., children, (, ), ., items, [, 0, ], ;, }, pub, fn, get_some_type, (, opt_sum, :, *, const, Type_AST, ), *, Type_AST, {, std, ., debug, ., assert, (, opt_sum, ., enum_type, ., from, ==, ., optional, ), ;, return, opt_sum, ., children, (, ), ., items, [, 0, ], ;, }, pub, fn, get_none_type, (, opt_sum, :, *, Type_AST, ), *, Type_AST, {, std, ., debug, ., assert, (, opt_sum, ., enum_type, ., from, ==, ., optional, ), ;, return, opt_sum, ., children, (, ), ., items, [, 1, ], ;, }, pub, fn, get_ok_type, (, err_union, :, *, const, Type_AST, ), *, Type_AST, {, std, ., debug, ., assert, (, err_union, ., enum_type, ., from, ==, ., @, "error", ), ;, return, err_union, ., children, (, ), ., items, [, 0, ], ;, }, pub, fn, get_err_type, (, err_union, :, *, const, Type_AST, ), *, Type_AST, {, std, ., debug, ., assert, (, err_union, ., enum_type, ., from, ==, ., @, "error", ), ;, return, err_union, ., children, (, ), ., items, [, 1, ], ;, }, pub, fn, get_pos, (, self, :, *, Type_AST, ,, field_name, :, [, ], const, u8, ), ?, usize, {, for, (, self, ., children, (, ), ., items, ,, 0.., ), |, term, ,, i, |, {, if, (, std, ., mem, ., eql, (, u8, ,, term, ., annotation, ., pattern, ., token, (, ), ., data, ,, field_name, ), ), {, return, i, ;, }, }, return, null, ;, }, pub, fn, expand_identifier, (, self, :, *, Type_AST, ), *, Type_AST, {, var, res, =, self, ;, while, (, true, ), {, if, (, (, res, .*, ==, ., identifier, or, res, .*, ==, ., access, ), and, res, ., symbol, (, ), !=, null, and, res, ., symbol, (, ), .?, ., init_typedef, (, ), !=, null, ), {, const, new, =, res, ., symbol, (, ), .?, ., init_typedef, (, ), .?, ;, new, ., set_unexpanded_type, (, res, ), ;, res, =, new, ;, }, else, if, (, res, .*, ==, ., generic_apply, ), {, const, new, =, res, ., generic_apply, ., _symbol, .?, ., init_typedef, (, ), .?, ;, new, ., set_unexpanded_type, (, res, ), ;, res, =, new, ;, }, else, if, (, res, .*, ==, ., annotation, ), {, res, =, res, ., child, (, ), ;, }, else, {, return, res, ;, }, }, }, pub, fn, unexpand_type, (, self, :, *, Type_AST, ), *, Type_AST, {, if, (, self, ., common, (, ), ., _unexpanded_type, ), |, unexpanded, |, {, return, unexpanded, ., unexpand_type, (, ), ;, }, else, {, return, self, ;, }, }, pub, fn, print_type, (, self, :, *, const, Type_AST, ,, out, :, *, std, ., Io, ., Writer, ), !, void, {, if, (, self, ., common, (, ), ., _unexpanded_type, ), |, unexpanded, |, {, if, (, unexpanded, !=, self, ), {, return, try, unexpanded, ., print_type, (, out, ), ;, }, }, switch, (, self, .*, ), {, ., poison, =>, try, out, ., print, (, "???", ,, ., {, }, ), ,, ., anyptr_type, =>, try, out, ., print, (, "anyptr", ,, ., {, }, ), ,, ., unit_type, =>, try, out, ., print, (, "()", ,, ., {, }, ), ,, ., identifier, =>, try, out, ., print, (, "{s}", ,, ., {, self, ., token, (, ), ., data, }, ), ,, ., addr_of, =>, {, if, (, self, ., addr_of, ., multiptr, ), {, try, out, ., print, (, "[*", ,, ., {, }, ), ;, if, (, self, ., addr_of, ., mut, ), {, try, out, ., print, (, "mut", ,, ., {, }, ), ;, }, try, out, ., print, (, "]", ,, ., {, }, ), ;, }, else, {, try, out, ., print, (, "&", ,, ., {, }, ), ;, if, (, self, ., addr_of, ., mut, ), {, try, out, ., print, (, "mut ", ,, ., {, }, ), ;, }, }, try, self, ., child, (, ), ., print_type, (, out, ), ;, }, ,, ., dyn_type, =>, {, try, out, ., print, (, "&", ,, ., {, }, ), ;, if, (, self, ., dyn_type, ., mut, ), {, try, out, ., print, (, "mut ", ,, ., {, }, ), ;, }, try, out, ., print, (, "dyn ", ,, ., {, }, ), ;, try, self, ., child, (, ), ., print_type, (, out, ), ;, }, ,, ., array_of, =>, {, try, out, ., print, (, "[{f}]", ,, ., {, self, ., array_of, ., len, }, ), ;, try, self, ., child, (, ), ., print_type, (, out, ), ;, }, ,, ., function, =>, {, if, (, self, ., function, ., args, ., items, ., len, !=, 1, ), try, out, ., print, (, "(", ,, ., {, }, ), ;, for, (, self, ., children, (, ), ., items, ,, 0.., ), |, term, ,, i, |, {, try, term, ., print_type, (, out, ), ;, if, (, i, +, 1, <, self, ., children, (, ), ., items, ., len, ), {, try, out, ., print, (, ", ", ,, ., {, }, ), ;, }, }, if, (, self, ., function, ., args, ., items, ., len, !=, 1, ), try, out, ., print, (, ")", ,, ., {, }, ), ;, try, out, ., print, (, "->", ,, ., {, }, ), ;, try, self, ., rhs, (, ), ., print_type, (, out, ), ;, if, (, self, ., function, ., contexts, ., items, ., len, >, 0, ), {, try, out, ., print, (, " with ", ,, ., {, }, ), ;, for, (, self, ., function, ., contexts, ., items, ), |, ctx, |, {, try, ctx, ., print_type, (, out, ), ;, }, }, }, ,, ., struct_type, ,, ., tuple_type, ,, ., context_type, =>, if, (, self, .*, ==, ., struct_type, and, self, ., struct_type, ., was_slice, ), {, const, data_ptr, =, self, ., children, (, ), ., items, [, 0, ], ., child, (, ), ;, if, (, data_ptr, ., addr_of, ., mut, ), {, try, out, ., print, (, "[mut]", ,, ., {, }, ), ;, }, else, {, try, out, ., print, (, "[]", ,, ., {, }, ), ;, }, try, data_ptr, ., child, (, ), ., print_type, (, out, ), ;, }, else, {, try, out, ., print, (, "(", ,, ., {, }, ), ;, for, (, self, ., children, (, ), ., items, ,, 0.., ), |, term, ,, i, |, {, try, term, ., print_type, (, out, ), ;, if, (, i, +, 1, <, self, ., children, (, ), ., items, ., len, ), {, try, out, ., print, (, ", ", ,, ., {, }, ), ;, }, }, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., enum_type, =>, if, (, self, ., enum_type, ., from, ==, ., optional, ), {, try, out, ., print, (, "?", ,, ., {, }, ), ;, try, self, ., get_some_type, (, ), ., child, (, ), ., print_type, (, out, ), ;, }, else, if, (, self, ., enum_type, ., from, ==, ., @, "error", ), {, try, self, ., get_err_type, (, ), ., child, (, ), ., print_type, (, out, ), ;, try, out, ., print, (, "!", ,, ., {, }, ), ;, try, self, ., get_ok_type, (, ), ., child, (, ), ., print_type, (, out, ), ;, }, else, {, try, out, ., print, (, "(", ,, ., {, }, ), ;, for, (, self, ., enum_type, ., _terms, ., items, ,, 0.., ), |, term, ,, i, |, {, try, term, ., print_type, (, out, ), ;, if, (, self, ., enum_type, ., _terms, ., items, ., len, ==, 1, or, i, +, 1, !=, self, ., enum_type, ., _terms, ., items, ., len, ), {, try, out, ., print, (, " | ", ,, ., {, }, ), ;, }, }, try, out, ., print, (, ")", ,, ., {, }, ), ;, }, ,, ., access, =>, {, try, out, ., print, (, "{f}::{s}", ,, ., {, self, ., access, ., inner_access, ., lhs, (, ), ,, self, ., access, ., inner_access, ., rhs, (, ), ., token, (, ), ., data, }, ), ;, }, ,, ., generic_apply, =>, {, try, out, ., print, (, "{f}[{f}", ,, ., {, self, ., generic_apply, ., _lhs, ,, self, ., generic_apply, ., args, ., items, [, 0, ], }, ), ;, for, (, self, ., generic_apply, ., args, ., items, [, 1.., ], ), |, arg, |, {, try, out, ., print, (, ", {f}", ,, ., {, arg, }, ), ;, }, try, out, ., print, (, "]", ,, ., {, }, ), ;, }, ,, ., annotation, =>, {, try, out, ., print, (, "{s}: ", ,, ., {, self, ., annotation, ., pattern, ., token, (, ), ., data, }, ), ;, try, self, ., child, (, ), ., print_type, (, out, ), ;, }, ,, ., type_of, =>, {, try, out, ., print, (, "@typeof({f})", ,, ., {, self, ., type_of, ., _expr, }, ), ;, }, ,, ., domain_of, =>, {, try, out, ., print, (, "@domainof({f}.{s})", ,, ., {, self, ., domain_of, ., _child, ,, self, ., domain_of, ., ctor_name, }, ), ;, }, ,, ., index, =>, try, out, ., print, (, "{f}[{f}]", ,, ., {, self, ., child, (, ), ,, self, ., index, ., idx, }, ), ,, else, =>, try, out, ., print, (, "{s}", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, }, pub, fn, format, (, self, :, *, const, Type_AST, ,, writer, :, *, std, ., io, ., Writer, ), !, void, {, self, ., print_type, (, writer, ), catch, unreachable, ;, }, pub, fn, sizeof, (, self, :, *, Type_AST, ), i64, {, if, (, self, ., common, (, ), ., _size, ==, null, ), {, self, ., set_sizeof, (, self, ., expand_identifier, (, ), ., sizeof_internal, (, ), ), ;, }, return, self, ., common, (, ), ., _size, .?, ;, }, fn, sizeof_internal, (, self, :, *, Type_AST, ), i64, {, switch, (, self, .*, ), {, ., identifier, =>, if, (, self, ., symbol, (, ), !=, null, and, self, ., symbol, (, ), .?, ., init_typedef, (, ), !=, null, ), {, return, self, ., symbol, (, ), .?, ., init_typedef, (, ), .?, ., sizeof, (, ), ;, }, else, {, const, primitive_info, =, prelude_, ., info_from_name, (, self, ., token, (, ), ., data, ), orelse, return, 4, ;, return, primitive_info, ., size, ;, }, ,, ., struct_type, ,, ., tuple_type, ,, ., context_type, =>, {, var, total_size, :, i64, =, 0, ;, for, (, self, ., children, (, ), ., items, ), |, _child, |, {, total_size, =, alignment_, ., next_alignment, (, total_size, ,, _child, ., alignof, (, ), ), ;, total_size, +=, _child, ., sizeof, (, ), ;, }, return, total_size, ;, }, ,, ., array_of, =>, {, const, child_size, =, self, ., child, (, ), ., sizeof, (, ), ;, return, child_size, *, @, as, (, i64, ,, @, intCast, (, self, ., array_of, ., len, ., int, ., data, ), ), ;, }, ,, ., enum_type, =>, {, var, max_size, :, i64, =, 0, ;, for, (, self, ., children, (, ), ., items, ), |, _child, |, {, max_size, =, @, max, (, max_size, ,, _child, ., sizeof, (, ), ), ;, }, return, alignment_, ., next_alignment, (, max_size, ,, 8, ), +, 8, ;, }, ,, ., untagged_sum_type, =>, {, std, ., debug, ., assert, (, self, ., child, (, ), ., expand_identifier, (, ), .*, ==, ., enum_type, ), ;, var, max_size, :, i64, =, 0, ;, for, (, self, ., children, (, ), ., items, ), |, _child, |, {, max_size, =, @, max, (, max_size, ,, _child, ., sizeof, (, ), ), ;, }, return, max_size, ;, }, ,, ., function, ,, ., addr_of, ,, ., dyn_type, ,, ., anyptr_type, =>, return, 8, ,, ., unit_type, =>, return, 0, ,, ., annotation, =>, return, self, ., child, (, ), ., sizeof, (, ), ,, else, =>, std, ., debug, ., panic, (, "compiler error: unimplemented sizeof() for {f}", ,, ., {, self, }, ), ,, }, }, pub, fn, alignof, (, self, :, *, Type_AST, ), i64, {, if, (, self, ., common, (, ), ., _alignof, ==, null, ), {, self, ., set_alignof, (, self, ., expand_identifier, (, ), ., alignof_internal, (, ), ), ;, }, return, self, ., common, (, ), ., _alignof, .?, ;, }, fn, alignof_internal, (, self, :, *, Type_AST, ), i64, {, switch, (, self, .*, ), {, ., identifier, =>, if, (, self, ., symbol, (, ), !=, null, and, self, ., symbol, (, ), .?, ., init_typedef, (, ), !=, null, ), {, return, self, ., symbol, (, ), .?, ., init_typedef, (, ), .?, ., alignof, (, ), ;, }, else, {, const, primitive_info, =, prelude_, ., info_from_name, (, self, ., token, (, ), ., data, ), orelse, return, 4, ;, return, primitive_info, ., _align, ;, }, ,, ., struct_type, ,, ., tuple_type, ,, ., context_type, =>, {, var, max_align, :, i64, =, 0, ;, for, (, self, ., children, (, ), ., items, ), |, _child, |, {, max_align, =, @, max, (, max_align, ,, _child, ., alignof, (, ), ), ;, }, return, max_align, ;, }, ,, ., enum_type, ,, ., function, ,, ., addr_of, ,, ., dyn_type, ,, ., anyptr_type, ,, =>, return, 8, ,, ., untagged_sum_type, =>, {, std, ., debug, ., assert, (, self, ., child, (, ), ., expand_identifier, (, ), .*, ==, ., enum_type, ), ;, var, max_size, :, i64, =, 0, ;, for, (, self, ., children, (, ), ., items, ), |, _child, |, {, max_size, =, @, max, (, max_size, ,, _child, ., alignof, (, ), ), ;, }, return, max_size, ;, }, ,, ., unit_type, =>, return, 1, ,, ., annotation, ,, ., array_of, =>, return, self, ., child, (, ), ., alignof, (, ), ,, else, =>, std, ., debug, ., panic, (, "compiler error: unimplemented alignof for {s}", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, }, pub, fn, types_match, (, A, :, *, Type_AST, ,, B, :, *, Type_AST, ), bool, {, if, (, A, .*, ==, ., annotation, ), {, return, types_match, (, A, ., child, (, ), ,, B, ), ;, }, else, if, (, B, .*, ==, ., annotation, ), {, return, types_match, (, A, ,, B, ., child, (, ), ), ;, }, if, (, A, .*, ==, ., access, ), {, return, types_match, (, A, ., symbol, (, ), .?, ., init_typedef, (, ), .?, ,, B, ), ;, }, else, if, (, B, .*, ==, ., access, ), {, return, types_match, (, A, ,, B, ., symbol, (, ), .?, ., init_typedef, (, ), .?, ), ;, }, if, (, A, .*, ==, ., generic_apply, and, A, ., generic_apply, ., _symbol, !=, null, and, B, .*, !=, ., generic_apply, ), {, return, types_match, (, A, ., generic_apply, ., _symbol, .?, ., init_typedef, (, ), .?, ,, B, ), ;, }, else, if, (, B, .*, ==, ., generic_apply, and, B, ., generic_apply, ., _symbol, !=, null, and, A, .*, !=, ., generic_apply, ), {, return, types_match, (, A, ,, B, ., generic_apply, ., _symbol, .?, ., init_typedef, (, ), .?, ), ;, }, if, (, B, .*, ==, ., anyptr_type, and, (, A, .*, ==, ., addr_of, or, A, .*, ==, ., dyn_type, ), ), {, return, true, ;, }, if, (, A, .*, ==, ., identifier, and, A, ., symbol, (, ), .?, ., is_alias, (, ), and, A, !=, A, ., expand_identifier, (, ), ), {, return, types_match, (, A, ., expand_identifier, (, ), ,, B, ), ;, }, else, if, (, B, .*, ==, ., identifier, and, B, ., symbol, (, ), .?, ., is_alias, (, ), and, B, !=, B, ., expand_identifier, (, ), ), {, return, types_match, (, A, ,, B, ., expand_identifier, (, ), ), ;, }, if, (, A, .*, ==, ., identifier, and, B, .*, !=, ., identifier, and, A, !=, A, ., expand_identifier, (, ), ), {, return, types_match, (, A, ., expand_identifier, (, ), ,, B, ), ;, }, else, if, (, A, .*, !=, ., identifier, and, B, .*, ==, ., identifier, and, B, !=, B, ., expand_identifier, (, ), ), {, return, types_match, (, A, ,, B, ., expand_identifier, (, ), ), ;, }, if, (, A, .*, ==, ., poison, or, B, .*, ==, ., poison, ), {, return, true, ;, }, if, (, A, ., is_ident_type, (, "Void", ), ), {, return, true, ;, }, if, (, @, intFromEnum, (, A, .*, ), !=, @, intFromEnum, (, B, .*, ), ), {, return, false, ;, }, switch, (, A, .*, ), {, ., identifier, =>, {, return, A, ., symbol, (, ), .?, ==, B, ., symbol, (, ), .?, ;, }, ,, ., addr_of, =>, return, (, !, B, ., addr_of, ., mut, or, B, ., addr_of, ., mut, ==, A, ., addr_of, ., mut, ), and, (, B, ., addr_of, ., multiptr, ==, A, ., addr_of, ., multiptr, ), and, types_match, (, A, ., child, (, ), ,, B, ., child, (, ), ), ,, ., array_of, =>, return, types_match, (, A, ., child, (, ), ,, B, ., child, (, ), ), and, A, ., array_of, ., len, ., int, ., data, ==, B, ., array_of, ., len, ., int, ., data, ,, ., anyptr_type, =>, return, B, .*, ==, ., anyptr_type, ,, ., unit_type, =>, return, true, ,, ., struct_type, ,, ., tuple_type, ,, ., context_type, =>, {, if, (, !, lengths_match, (, A, ., children, (, ), ,, B, ., children, (, ), ), ), return, false, ;, var, retval, =, true, ;, for, (, A, ., children, (, ), ., items, ,, B, ., children, (, ), ., items, ), |, term, ,, B_term, |, {, if, (, term, .*, ==, ., annotation, and, B_term, .*, ==, ., annotation, and, term, ., annotation, ., pattern, .*, ==, ., identifier, and, B_term, ., annotation, ., pattern, .*, ==, ., identifier, ), {, if, (, !, std, ., mem, ., eql, (, u8, ,, term, ., annotation, ., pattern, ., token, (, ), ., data, ,, B_term, ., annotation, ., pattern, ., token, (, ), ., data, ), ), {, return, false, ;, }, }, retval, =, retval, and, term, ., types_match, (, B_term, ), ;, }, return, retval, ;, }, ,, ., generic_apply, =>, {, if, (, !, lengths_match, (, A, ., children, (, ), ,, B, ., children, (, ), ), ), return, false, ;, var, retval, =, A, ., lhs, (, ), ., symbol, (, ), ==, B, ., lhs, (, ), ., symbol, (, ), ;, for, (, A, ., children, (, ), ., items, ,, B, ., children, (, ), ., items, ), |, term, ,, B_term, |, {, retval, =, retval, and, term, ., types_match, (, B_term, ), ;, }, return, retval, ;, }, ,, ., enum_type, ,, ., untagged_sum_type, =>, {, if, (, !, lengths_match, (, A, ., children, (, ), ,, B, ., children, (, ), ), ), return, false, ;, var, retval, =, true, ;, for, (, A, ., children, (, ), ., items, ,, B, ., children, (, ), ., items, ), |, term, ,, B_term, |, {, const, this_name, =, term, ., annotation, ., pattern, ., token, (, ), ., data, ;, const, B_name, =, B_term, ., annotation, ., pattern, ., token, (, ), ., data, ;, retval, =, retval, and, std, ., mem, ., eql, (, u8, ,, this_name, ,, B_name, ), and, term, ., types_match, (, B_term, ), ;, }, return, retval, ;, }, ,, ., function, =>, {, if, (, !, lengths_match, (, A, ., children, (, ), ,, B, ., children, (, ), ), ), return, false, ;, var, retval, =, true, ;, for, (, A, ., children, (, ), ., items, ,, B, ., children, (, ), ., items, ), |, term, ,, other_term, |, {, retval, =, retval, and, term, ., types_match, (, other_term, ), ;, }, return, retval, and, A, ., rhs, (, ), ., types_match, (, B, ., rhs, (, ), ), ;, }, ,, ., dyn_type, =>, {, return, A, ., child, (, ), ., symbol, (, ), ==, B, ., child, (, ), ., symbol, (, ), ;, }, ,, else, =>, std, ., debug, ., panic, (, "compiler error: unimplemented types_match() for {s}", ,, ., {, @, tagName, (, A, .*, ), }, ), ,, }, }, fn, lengths_match, (, as, :, *, const, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, bs, :, *, const, std, ., array_list, ., Managed, (, *, Type_AST, ), ), bool, {, return, bs, ., items, ., len, ==, as, ., items, ., len, ;, }, pub, fn, convertible_to, (, from, :, *, Type_AST, ,, to, :, *, Type_AST, ), bool, {, const, from_expanded, =, from, ., expand_identifier, (, ), ;, const, to_expanded, =, to, ., expand_identifier, (, ), ;, const, from_info, =, prelude_, ., info_from_ast, (, from_expanded, ), ;, const, to_info, =, prelude_, ., info_from_ast, (, to_expanded, ), ;, if, (, from_info, ), |, _from_info, |, {, if, (, _from_info, ., type_class, ==, ., int, and, to_expanded, .*, ==, ., addr_of, and, to_expanded, ., addr_of, ., multiptr, ), {, return, true, ;, }, else, if, (, to_info, ), |, _to_info, |, {, if, (, _from_info, ., type_class, ==, _to_info, ., type_class, ), {, return, true, ;, }, }, }, if, (, @, intFromEnum, (, from_expanded, .*, ), !=, @, intFromEnum, (, to_expanded, .*, ), ), {, return, false, ;, }, return, switch, (, from_expanded, .*, ), {, ., addr_of, =>, from_expanded, ., addr_of, ., multiptr, and, to_expanded, ., addr_of, ., multiptr, and, (, !, to_expanded, ., addr_of, ., mut, or, from_expanded, ., addr_of, ., mut, ), ,, ., dyn_type, =>, is_sub_trait, (, from, ., child, (, ), ,, to, ., child, (, ), ), and, (, !, to_expanded, ., dyn_type, ., mut, or, from_expanded, ., dyn_type, ., mut, ), ,, else, =>, false, ,, }, ;, }, fn, is_sub_trait, (, maybe_sub, :, *, Type_AST, ,, maybe_super, :, *, Type_AST, ), bool, {, const, maybe_sub_symbol, =, maybe_sub, ., symbol, (, ), .?, ;, const, maybe_super_symbol, =, maybe_super, ., symbol, (, ), .?, ;, if, (, maybe_sub_symbol, ==, maybe_super_symbol, ), return, true, ;, for, (, maybe_sub, ., symbol, (, ), .?, ., decl, .?, ., trait, ., super_traits, ., items, ), |, super_trait, |, {, if, (, is_sub_trait, (, super_trait, ,, maybe_super, ), ), return, true, ;, }, return, false, ;, }, pub, fn, c_types_match, (, self, :, *, Type_AST, ,, other, :, *, Type_AST, ), bool, {, if, (, self, .*, ==, ., annotation, ), {, return, c_types_match, (, self, ., child, (, ), ,, other, ), ;, }, else, if, (, other, .*, ==, ., annotation, ), {, return, c_types_match, (, self, ,, other, ., child, (, ), ), ;, }, if, (, self, .*, ==, ., access, ), {, return, c_types_match, (, self, ., symbol, (, ), .?, ., init_typedef, (, ), .?, ,, other, ), ;, }, else, if, (, other, .*, ==, ., access, ), {, return, c_types_match, (, self, ,, other, ., symbol, (, ), .?, ., init_typedef, (, ), .?, ), ;, }, if, (, other, .*, ==, ., anyptr_type, and, self, .*, ==, ., addr_of, ), {, return, true, ;, }, if, (, @, intFromEnum, (, self, .*, ), !=, @, intFromEnum, (, other, .*, ), ), {, return, false, ;, }, switch, (, self, .*, ), {, ., identifier, =>, return, std, ., mem, ., eql, (, u8, ,, self, ., token, (, ), ., data, ,, other, ., token, (, ), ., data, ), ,, ., addr_of, =>, return, c_types_match, (, self, ., child, (, ), ,, other, ., child, (, ), ), ,, ., unit_type, =>, return, other, .*, ==, ., unit_type, ,, ., anyptr_type, =>, return, other, .*, ==, ., anyptr_type, ,, ., dyn_type, =>, return, self, ., child, (, ), ., symbol, (, ), ==, other, ., child, (, ), ., symbol, (, ), ,, ., struct_type, ,, ., tuple_type, ,, ., enum_type, ,, ., untagged_sum_type, ,, ., context_type, =>, {, if, (, other, ., children, (, ), ., items, ., len, !=, self, ., children, (, ), ., items, ., len, ), {, return, false, ;, }, var, retval, =, true, ;, for, (, self, ., children, (, ), ., items, ,, other, ., children, (, ), ., items, ), |, term, ,, other_term, |, {, retval, =, retval, and, term, ., c_types_match, (, other_term, ), ;, }, return, retval, ;, }, ,, ., generic_apply, =>, {, if, (, other, ., children, (, ), ., items, ., len, !=, self, ., children, (, ), ., items, ., len, ), {, return, false, ;, }, var, retval, =, self, ., lhs, (, ), ., symbol, (, ), ==, other, ., lhs, (, ), ., symbol, (, ), ;, for, (, self, ., children, (, ), ., items, ,, other, ., children, (, ), ., items, ), |, term, ,, B_term, |, {, retval, =, retval, and, term, ., c_types_match, (, B_term, ), ;, }, return, retval, ;, }, ,, ., function, =>, {, if, (, other, ., children, (, ), ., items, ., len, !=, self, ., children, (, ), ., items, ., len, ), {, return, false, ;, }, var, retval, =, true, ;, for, (, self, ., children, (, ), ., items, ,, other, ., children, (, ), ., items, ), |, term, ,, other_term, |, {, retval, =, retval, and, term, ., c_types_match, (, other_term, ), ;, }, return, retval, and, self, ., rhs, (, ), ., c_types_match, (, other, ., rhs, (, ), ), ;, }, ,, ., array_of, =>, return, self, ., child, (, ), ., c_types_match, (, other, ., child, (, ), ), and, self, ., array_of, ., len, ., int, ., data, ==, other, ., array_of, ., len, ., int, ., data, ,, else, =>, std, ., debug, ., panic, (, "compiler error: c_types_match(): unimplemented for {s}", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, }, pub, fn, clone, (, self, :, *, Type_AST, ,, substs, :, *, unification_, ., Substitutions, ,, allocator, :, std, ., mem, ., Allocator, ), *, Type_AST, {, switch, (, self, .*, ), {, ., anyptr_type, ,, ., dyn_type, ,, ., unit_type, =>, return, self, ,, ., identifier, =>, if, (, substs, ., get, (, self, ., token, (, ), ., data, ), ), |, replacement, |, {, return, replacement, ;, }, else, {, return, self, ;, }, ,, ., access, =>, return, create_type_access, (, self, ., token, (, ), ,, self, ., access, ., inner_access, ., clone, (, substs, ,, allocator, ), ,, allocator, ), ,, ., type_of, =>, {, const, _expr, =, self, ., expr, (, ), ., clone, (, substs, ,, allocator, ), ;, return, create_type_of, (, self, ., token, (, ), ,, _expr, ,, allocator, ), ;, }, ,, ., addr_of, =>, {, const, _expr, =, clone, (, self, ., child, (, ), ,, substs, ,, allocator, ), ;, return, create_addr_of_type, (, self, ., token, (, ), ,, _expr, ,, self, ., addr_of, ., mut, ,, self, ., addr_of, ., multiptr, ,, allocator, ), ;, }, ,, ., array_of, =>, {, const, _expr, =, clone, (, self, ., child, (, ), ,, substs, ,, allocator, ), ;, return, create_array_of, (, self, ., token, (, ), ,, _expr, ,, self, ., array_of, ., len, ,, allocator, ), ;, }, ,, ., annotation, =>, {, const, _type, =, clone, (, self, ., child, (, ), ,, substs, ,, allocator, ), ;, return, create_annotation, (, self, ., token, (, ), ,, self, ., annotation, ., pattern, ,, _type, ,, self, ., annotation, ., init, ,, allocator, ), ;, }, ,, ., function, =>, {, const, args, =, clone_types, (, self, ., function, ., args, ,, substs, ,, allocator, ), ;, const, _rhs, =, clone, (, self, ., rhs, (, ), ,, substs, ,, allocator, ), ;, const, contexts, =, clone_types, (, self, ., function, ., contexts, ,, substs, ,, allocator, ), ;, return, create_function, (, self, ., token, (, ), ,, args, ,, _rhs, ,, contexts, ,, allocator, ), ;, }, ,, ., enum_type, =>, {, const, new_children, =, clone_types, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, var, retval, =, create_enum_type, (, self, ., token, (, ), ,, new_children, ,, allocator, ), ;, retval, ., enum_type, ., from, =, self, ., enum_type, ., from, ;, return, retval, ;, }, ,, ., untagged_sum_type, =>, {, const, _child, =, clone, (, self, ., child, (, ), ,, substs, ,, allocator, ), ;, return, create_untagged_sum_type, (, self, ., token, (, ), ,, _child, ,, allocator, ), ;, }, ,, ., struct_type, =>, {, const, new_children, =, clone_types, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, var, retval, =, create_struct_type, (, self, ., token, (, ), ,, new_children, ,, allocator, ), ;, retval, ., struct_type, ., was_slice, =, self, ., struct_type, ., was_slice, ;, return, retval, ;, }, ,, ., tuple_type, =>, {, const, new_children, =, clone_types, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_tuple_type, (, self, ., token, (, ), ,, new_children, ,, allocator, ), ;, }, ,, ., generic_apply, =>, {, const, new_args, =, clone_types, (, self, ., children, (, ), .*, ,, substs, ,, allocator, ), ;, return, create_generic_apply_type, (, self, ., token, (, ), ,, self, ., lhs, (, ), ., clone, (, substs, ,, allocator, ), ,, new_args, ,, allocator, ,, ), ;, }, ,, else, =>, std, ., debug, ., panic, (, "compiler error: clone doesn't support trait type AST `{s}`", ,, ., {, @, tagName, (, self, .*, ), }, ), ,, }, }, pub, fn, clone_types, (, children_terms, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, substs, :, *, unification_, ., Substitutions, ,, allocator, :, std, ., mem, ., Allocator, ), std, ., array_list, ., Managed, (, *, Type_AST, ), {, var, retval, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, allocator, ), ;, for, (, children_terms, ., items, ), |, _child, |, {, retval, ., append, (, _child, ., clone, (, substs, ,, allocator, ), ), catch, unreachable, ;, }, return, retval, ;, }, pub, fn, refers_to_self, (, _type, :, *, Type_AST, ), bool, {, return, switch, (, _type, .*, ), {, ., anyptr_type, ,, ., unit_type, ,, ., dyn_type, =>, false, ,, ., identifier, =>, std, ., mem, ., eql, (, u8, ,, _type, ., token, (, ), ., data, ,, "Self", ), ,, ., addr_of, ,, ., array_of, =>, _type, ., child, (, ), ., refers_to_self, (, ), ,, ., annotation, =>, _type, ., child, (, ), ., refers_to_self, (, ), ,, ., function, =>, {, for, (, _type, ., function, ., args, ., items, ), |, arg, |, {, if, (, arg, ., refers_to_self, (, ), ), {, return, true, ;, }, }, return, _type, ., rhs, (, ), ., refers_to_self, (, ), ;, }, ,, ., struct_type, ,, ., tuple_type, ,, ., enum_type, =>, {, for, (, _type, ., children, (, ), ., items, ), |, item, |, {, if, (, item, ., refers_to_self, (, ), ), {, return, true, ;, }, }, return, false, ;, }, ,, else, =>, true, ,, }, ;, }, pub, fn, refers_to_trait, (, self, :, *, Type_AST, ), bool, {, return, switch, (, self, .*, ), {, else, =>, false, ,, ., identifier, ,, ., access, =>, self, ., symbol, (, ), .?, ., is_trait, (, ), ,, }, ;, }, pub, fn, can_expanded_represent_int, (, self, :, *, Type_AST, ), bool, {, const, info, =, prelude_, ., info_from_ast, (, self, ), orelse, return, false, ;, return, info, ., type_kind, ==, ., signed_integer, or, info, ., type_kind, ==, ., unsigned_integer, ;, }, pub, fn, can_represent_float, (, self, :, *, Type_AST, ), bool, {, return, can_expanded_represent_float, (, self, ., expand_identifier, (, ), ), ;, }, pub, fn, can_expanded_represent_float, (, self, :, *, Type_AST, ), bool, {, const, info, =, prelude_, ., info_from_ast, (, self, ), orelse, return, false, ;, return, info, ., type_kind, ==, ., floating_point, ;, }, pub, fn, is_eq_type, (, self, :, *, Type_AST, ), bool, {, const, expanded, =, self, ., expand_identifier, (, ), ;, if, (, expanded, .*, ==, ., addr_of, ), {, return, true, ;, }, else, if, (, expanded, .*, ==, ., tuple_type, ), {, for, (, expanded, ., children, (, ), ., items, ), |, term, |, {, if, (, !, term, ., is_eq_type, (, ), ), {, return, false, ;, }, }, return, true, ;, }, else, if, (, expanded, .*, ==, ., enum_type, ), {, return, true, ;, }, const, info, =, prelude_, ., info_from_ast, (, expanded, ), orelse, return, false, ;, return, info, ., type_class, ==, ., eq, or, expanded, ., is_ord_type, (, ), ;, }, pub, fn, is_ord_type, (, self, :, *, Type_AST, ), bool, {, const, expanded, =, self, ., expand_identifier, (, ), ;, const, info, =, prelude_, ., info_from_ast, (, expanded, ), orelse, return, false, ;, return, info, ., type_class, ==, ., ord, or, expanded, ., is_num_type, (, ), ;, }, pub, fn, is_num_type, (, self, :, *, Type_AST, ), bool, {, const, expanded, =, self, ., expand_identifier, (, ), ;, const, info, =, prelude_, ., info_from_ast, (, expanded, ), orelse, return, false, ;, return, info, ., type_class, ==, ., num, or, expanded, ., is_int_type, (, ), ;, }, pub, fn, is_int_type, (, self, :, *, Type_AST, ), bool, {, const, expanded, =, self, ., expand_identifier, (, ), ;, const, info, =, prelude_, ., info_from_ast, (, expanded, ), orelse, return, false, ;, return, info, ., type_class, ==, ., int, ;, }, pub, fn, is_bits_type, (, self, :, *, Type_AST, ), bool, {, const, expanded, =, self, ., expand_identifier, (, ), ;, const, info, =, prelude_, ., info_from_ast, (, expanded, ), orelse, return, false, ;, return, info, ., type_kind, ==, ., unsigned_integer, ;, }, pub, fn, is_c_void_type, (, self, :, *, Type_AST, ), bool, {, return, prelude_, ., unit_type, ., c_types_match, (, self, ), ;, }, pub, fn, is_ident_type, (, self, :, *, Type_AST, ,, name, :, [, ], const, u8, ), bool, {, return, self, .*, ==, ., identifier, and, std, ., mem, ., eql, (, u8, ,, self, ., token, (, ), ., data, ,, name, ), ;, }, pub, fn, is_indirect, (, self, :, *, const, Type_AST, ), bool, {, return, switch, (, self, .*, ), {, ., addr_of, ,, ., dyn_type, =>, true, ,, else, =>, false, ,, }, ;, }, }, ;, const, std, =, @, import, (, "std", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, pub, fn, Type_Map, (, comptime, Value, :, type, ), type, {, return, Linear_Map, (, *, Type_AST, ,, Value, ,, Type_AST, ., types_match, ), ;, }, pub, fn, C_Type_Map, (, comptime, Value, :, type, ), type, {, return, Linear_Map, (, *, Type_AST, ,, Value, ,, Type_AST, ., c_types_match, ), ;, }, pub, fn, Monomorph_Map, (, comptime, Value, :, type, ), type, {, return, Linear_Map, (, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, Value, ,, type_lists_match, ), ;, }, pub, fn, Linear_Map, (, comptime, Key, :, type, ,, comptime, Value, :, type, ,, comptime, eq, :, fn, (, Key, ,, Key, ), bool, ), type, {, return, struct, {, const, Pair, =, struct, {, key, :, Key, ,, value, :, Value, ,, }, ;, const, Self, =, @, This, (, ), ;, pairs, :, std, ., array_list, ., Managed, (, Pair, ), ,, pub, fn, init, (, alloc, :, std, ., mem, ., Allocator, ), Self, {, return, ., {, ., pairs, =, std, ., array_list, ., Managed, (, Pair, ), ., init, (, alloc, ), ,, }, ;, }, pub, fn, deinit, (, self, :, *, Self, ), void, {, self, ., pairs, ., deinit, (, ), ;, }, pub, fn, get, (, self, :, *, const, Self, ,, key, :, Key, ), ?, Value, {, for, (, self, ., pairs, ., items, ), |, pair, |, {, if, (, eq, (, pair, ., key, ,, key, ), ), {, return, pair, ., value, ;, }, }, return, null, ;, }, pub, fn, contains, (, self, :, *, const, Self, ,, key, :, Key, ), bool, {, return, self, ., get, (, key, ), !=, null, ;, }, pub, fn, put, (, self, :, *, Self, ,, key, :, Key, ,, value, :, Value, ), !, void, {, if, (, self, ., get, (, key, ), ), |, _, |, {, return, ;, }, try, self, ., pairs, ., append, (, ., {, ., key, =, key, ,, ., value, =, value, }, ), ;, }, pub, fn, put_many, (, self, :, *, Self, ,, keys, :, [, ], const, Key, ,, value, :, Value, ), !, void, {, for, (, keys, ), |, key, |, {, try, self, ., put, (, key, ,, value, ), ;, }, }, }, ;, }, pub, fn, type_lists_match, (, lhs, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, rhs, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ), bool, {, if, (, lhs, ., items, ., len, !=, rhs, ., items, ., len, ), {, return, false, ;, }, for, (, lhs, ., items, ,, rhs, ., items, ), |, lhs_item, ,, rhs_item, |, {, if, (, !, lhs_item, ., types_match, (, rhs_item, ), or, !, rhs_item, ., types_match, (, lhs_item, ), ), {, return, false, ;, }, }, return, true, ;, }, const, std, =, @, import, (, "std", ), ;, const, Dependency_Node, =, @, import, (, "dependency_node.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, const, Canonical_Type_Fmt, =, @, import, (, "../types/canonical_type_fmt.zig", ), ;, const, Self, =, @, This, (, ), ;, types, :, std, ., array_list, ., Managed, (, *, Dependency_Node, ), ,, allocator, :, std, ., mem, ., Allocator, ,, pub, fn, init, (, allocator, :, std, ., mem, ., Allocator, ), Self, {, return, Self, {, ., types, =, std, ., array_list, ., Managed, (, *, Dependency_Node, ), ., init, (, allocator, ), ,, ., allocator, =, allocator, }, ;, }, pub, fn, deinit, (, self, :, *, Self, ), void, {, self, ., types, ., deinit, (, ), ;, }, pub, fn, add_type, (, self, :, *, Self, ,, oldast_, :, *, Type_AST, ), ?, *, Dependency_Node, {, return, self, ., add_internal, (, oldast_, ,, false, ), ;, }, fn, add_internal, (, self, :, *, Self, ,, oldast_, :, *, Type_AST, ,, from_function, :, bool, ), ?, *, Dependency_Node, {, const, ast, =, oldast_, ., expand_identifier, (, ), ;, std, ., debug, ., assert, (, ast, .*, !=, ., identifier, or, ast, ., symbol, (, ), .?, ., decl, .?, .*, !=, ., type_param_decl, ), ;, if, (, self, ., get_node, (, ast, ), ), |, dag, |, {, return, dag, ;, }, switch, (, ast, .*, ), {, ., function, =>, return, self, ., add_function, (, ast, ), ,, ., struct_type, ,, ., tuple_type, ,, ., enum_type, ,, ., untagged_sum_type, ,, ., context_type, =>, return, self, ., add_aggregate, (, ast, ), ,, ., dyn_type, =>, return, self, ., add_dependency_node, (, ast, ), ,, ., addr_of, =>, {, const, retval, =, self, ., add_type, (, ast, ., child, (, ), ), ;, if, (, from_function, ), {, return, retval, ;, }, else, {, return, null, ;, }, }, ,, ., array_of, =>, return, self, ., add_array, (, ast, ), ,, ., identifier, ,, ., unit_type, ,, ., anyptr_type, =>, return, null, ,, else, =>, std, ., debug, ., panic, (, "error: cannot add unknown typekind `{t}` to set", ,, ., {, ast, .*, }, ), ,, }, }, fn, add_function, (, self, :, *, Self, ,, function_type_ast, :, *, Type_AST, ), ?, *, Dependency_Node, {, var, dag, =, self, ., add_dependency_node, (, function_type_ast, ), ;, for, (, function_type_ast, ., function, ., args, ., items, ), |, arg, |, {, if, (, self, ., add_internal, (, arg, ,, true, ), ), |, domain, |, {, dag, ., add_dependency, (, domain, ), ;, }, }, if, (, self, ., add_type, (, function_type_ast, ., rhs, (, ), ), ), |, codomain, |, {, dag, ., add_dependency, (, codomain, ), ;, }, for, (, function_type_ast, ., function, ., contexts, ., items, ), |, ctx, |, {, if, (, self, ., add_type, (, ctx, ., child, (, ), ), ), |, context_node, |, {, dag, ., add_dependency, (, context_node, ), ;, }, }, return, dag, ;, }, fn, add_aggregate, (, self, :, *, Self, ,, aggregate_ast, :, *, Type_AST, ), ?, *, Dependency_Node, {, var, dag, =, self, ., add_dependency_node, (, aggregate_ast, ), ;, for, (, aggregate_ast, ., children, (, ), ., items, ), |, term, |, {, if, (, self, ., add_type, (, term, ), ), |, dependency, |, {, if, (, term, .*, !=, ., addr_of, ), dag, ., add_dependency, (, dependency, ), ;, }, }, return, dag, ;, }, fn, add_array, (, self, :, *, Self, ,, array_type_ast, :, *, Type_AST, ), ?, *, Dependency_Node, {, var, dag, =, self, ., add_dependency_node, (, array_type_ast, ), ;, if, (, self, ., add_type, (, array_type_ast, ., child, (, ), ), ), |, domain, |, {, dag, ., add_dependency, (, domain, ), ;, }, return, dag, ;, }, pub, fn, union_from, (, self, :, *, Self, ,, other, :, *, const, Self, ), void, {, for, (, other, ., types, ., items, ), |, _type, |, {, _, =, self, ., add_type, (, _type, ., base, ), ;, }, }, pub, fn, get_node, (, self, :, *, const, Self, ,, oldast_, :, *, Type_AST, ), ?, *, Dependency_Node, {, const, ast, =, oldast_, ., expand_identifier, (, ), ;, for, (, self, ., types, ., items, ), |, dag, |, {, if, (, dag, ., base, ., c_types_match, (, ast, ), ), {, return, dag, ;, }, }, return, null, ;, }, pub, fn, print, (, self, :, *, Self, ), void, {, for, (, self, ., types, ., items, ), |, dag, |, {, dag, ., print, (, ), ;, }, }, fn, add_dependency_node, (, self, :, *, Self, ,, ast, :, *, Type_AST, ), *, Dependency_Node, {, const, dag, =, Dependency_Node, ., init, (, ast, ,, self, ., types, ., items, ., len, ,, self, ., allocator, ), ;, self, ., types, ., append, (, dag, ), catch, unreachable, ;, return, dag, ;, }, pub, fn, len, (, self, :, *, const, Self, ), usize, {, return, self, ., types, ., items, ., len, ;, }, pub, fn, graphviz, (, self, :, *, const, Self, ), void, {, for, (, self, ., types, ., items, ), |, dep, |, {, dep, ., graphviz, (, ), ;, }, }, const, std, =, @, import, (, "std", ), ;, const, Const_Eval, =, @, import, (, "../semantic/const_eval.zig", ), ;, const, Type_Decorate, =, @, import, (, "../ast/type_decorate.zig", ), ;, const, Compiler_Context, =, @, import, (, "../hierarchy/compiler.zig", ), ;, const, errs_, =, @, import, (, "../util/errors.zig", ), ;, const, Type_AST, =, @, import, (, "type.zig", ), ., Type_AST, ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, prelude_, =, @, import, (, "../hierarchy/prelude.zig", ), ;, const, walk_, =, @, import, (, "../ast/walker.zig", ), ;, const, Validate_Error_Enum, =, error, {, OutOfMemory, ,, CompileError, }, ;, const, Self, :, type, =, @, This, (, ), ;, ctx, :, *, Compiler_Context, ,, pub, fn, init, (, ctx, :, *, Compiler_Context, ), Self, {, return, Self, {, ., ctx, =, ctx, }, ;, }, pub, fn, validate_type, (, self, :, *, Self, ,, @, "type", :, *, Type_AST, ), Validate_Error_Enum, !, void, {, switch, (, @, "type", .*, ), {, ., generic_apply, =>, {, try, self, ., validate_type, (, @, "type", ., lhs, (, ), ), ;, const, sym, =, @, "type", ., lhs, (, ), ., symbol, (, ), .?, ;, const, params, =, sym, ., decl, .?, ., generic_params, (, ), ;, if, (, params, ., items, ., len, !=, @, "type", ., children, (, ), ., items, ., len, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., mismatch_arity, =, ., {, ., span, =, @, "type", ., token, (, ), ., span, ,, ., takes, =, params, ., items, ., len, ,, ., given, =, @, "type", ., children, (, ), ., items, ., len, ,, ., thing_name, =, sym, ., name, ,, ., takes_name, =, "type parameter", ,, ., given_name, =, "argument", ,, }, }, ), ;, return, error, ., CompileError, ;, }, for, (, @, "type", ., children, (, ), ., items, ,, 0.., ), |, child, ,, i, |, {, try, self, ., ctx, ., validate_type, ., validate_type, (, child, ), ;, const, param, =, params, ., items, [, i, ], ;, for, (, param, ., type_param_decl, ., constraints, ., items, ), |, constraint, |, {, if, (, constraint, ., symbol, (, ), !=, null, ), {, const, trait, =, constraint, ., symbol, (, ), .?, ;, const, res, =, constraint, ., symbol, (, ), .?, ., scope, ., impl_trait_lookup, (, child, ,, trait, ), ;, if, (, res, ., count, ==, 0, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., type_not_impl_trait, =, ., {, ., span, =, child, ., token, (, ), ., span, ,, ., trait_name, =, trait, ., name, ,, ., _type, =, child, ,, }, }, ), ;, return, error, ., CompileError, ;, }, }, }, }, if, (, @, "type", ., generic_apply, ., state, ==, ., unmorphed, ), {, @, "type", ., generic_apply, ., state, =, ., morphing, ;, @, "type", ., generic_apply, ., _symbol, =, try, sym, ., monomorphize, (, @, "type", ., generic_apply, ., args, ,, self, ., ctx, ), ;, @, "type", ., generic_apply, ., state, =, ., morphed, ;, try, self, ., validate_type, (, @, "type", ., generic_apply, ., _symbol, .?, ., init_typedef, (, ), .?, ), ;, }, }, ,, ., identifier, =>, {, const, type_symbol, =, @, "type", ., symbol, (, ), .?, ;, if, (, !, (, type_symbol, ., is_type, (, ), or, type_symbol, ., kind, ==, ., context, ), ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., msg, =, "expected a type", ,, ., span, =, @, "type", ., token, (, ), ., span, }, }, ), ;, return, error, ., CompileError, ;, }, }, ,, ., array_of, =>, {, _, =, self, ., ctx, ., typecheck, ., typecheck_AST, (, @, "type", ., array_of, ., len, ,, prelude_, ., int_type, ), catch, return, error, ., CompileError, ;, try, walk_, ., walk_ast, (, @, "type", ., array_of, ., len, ,, Const_Eval, ., new, (, self, ., ctx, ), ), ;, if, (, @, "type", ., array_of, ., len, .*, !=, ., int, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, @, "type", ., token, (, ), ., span, ,, ., msg, =, "not a constant integer", }, }, ), ;, return, error, ., CompileError, ;, }, try, self, ., validate_type, (, @, "type", ., child, (, ), ), ;, }, ,, ., untagged_sum_type, =>, {, if, (, @, "type", ., child, (, ), ., expand_identifier, (, ), .*, !=, ., enum_type, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, @, "type", ., token, (, ), ., span, ,, ., msg, =, "not an enum type", }, }, ), ;, return, error, ., CompileError, ;, }, try, self, ., validate_type, (, @, "type", ., child, (, ), ), ;, }, ,, ., dyn_type, =>, {, if, (, (, @, "type", ., child, (, ), .*, !=, ., identifier, and, @, "type", ., child, (, ), .*, !=, ., access, ), or, @, "type", ., child, (, ), ., symbol, (, ), .?, ., kind, !=, ., trait, ), {, self, ., ctx, ., errors, ., add_error, (, errs_, ., Error, {, ., basic, =, ., {, ., span, =, @, "type", ., child, (, ), ., token, (, ), ., span, ,, ., msg, =, "not a trait", }, }, ), ;, return, error, ., CompileError, ;, }, }, ,, ., type_of, =>, {, try, walk_, ., walk_type, (, @, "type", ,, Type_Decorate, ., new, (, self, ., ctx, ), ), ;, }, ,, ., domain_of, =>, {, try, self, ., validate_type, (, @, "type", ., child, (, ), ), ;, try, walk_, ., walk_type, (, @, "type", ,, Type_Decorate, ., new, (, self, ., ctx, ), ), ;, }, ,, ., annotation, ,, ., addr_of, ,, ., index, ,, =>, {, try, self, ., validate_type, (, @, "type", ., child, (, ), ), ;, }, ,, ., function, =>, {, for, (, @, "type", ., function, ., args, ., items, ), |, arg, |, {, try, self, ., validate_type, (, arg, ), ;, }, try, self, ., validate_type, (, @, "type", ., rhs, (, ), ), ;, }, ,, ., enum_type, ,, ., struct_type, ,, ., tuple_type, ,, =>, {, for, (, @, "type", ., children, (, ), ., items, ), |, child, |, {, try, self, ., validate_type, (, child, ), ;, }, }, ,, else, =>, {, }, ,, }, }, pub, fn, detect_cycle, (, self, :, *, Self, ,, ty, :, *, Type_AST, ,, append_me, :, ?, *, Symbol, ), bool, {, _, =, append_me, ;, var, visiting, =, std, ., AutoArrayHashMap, (, *, Type_AST, ,, bool, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, visiting, ., deinit, (, ), ;, var, visited, =, std, ., AutoArrayHashMap, (, *, Type_AST, ,, bool, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, visited, ., deinit, (, ), ;, var, path, =, std, ., AutoArrayHashMap, (, *, Symbol, ,, bool, ), ., init, (, self, ., ctx, ., allocator, (, ), ), ;, defer, path, ., deinit, (, ), ;, return, dfs, (, ty, ,, &, visiting, ,, &, path, ,, &, visited, ,, false, ), ;, }, fn, dfs, (, ty, :, *, Type_AST, ,, visiting, :, *, std, ., AutoArrayHashMap, (, *, Type_AST, ,, bool, ), ,, path, :, *, std, ., AutoArrayHashMap, (, *, Symbol, ,, bool, ), ,, visited, :, *, std, ., AutoArrayHashMap, (, *, Type_AST, ,, bool, ), ,, has_indirection, :, bool, ,, ), bool, {, if, (, visited, ., contains, (, ty, ), ), return, false, ;, if, (, visiting, ., contains, (, ty, ), and, ty, .*, ==, ., identifier, and, ty, ., symbol, (, ), .?, ., decl, .?, .*, ==, ., type_alias, ), return, true, ;, if, (, visiting, ., contains, (, ty, ), and, ty, .*, ==, ., identifier, ), return, !, has_indirection, ;, visiting, ., put, (, ty, ,, true, ), catch, unreachable, ;, switch, (, ty, .*, ), {, ., identifier, =>, if, (, ty, ., symbol, (, ), ), |, sym, |, {, if, (, path, ., contains, (, sym, ), ), {, if, (, sym, ., decl, .?, .*, ==, ., type_alias, ), {, return, true, ;, }, }, else, {, path, ., put, (, sym, ,, true, ), catch, unreachable, ;, if, (, ty, ., symbol, (, ), .?, ., init_typedef, (, ), ), |, inner, |, {, if, (, dfs, (, inner, ,, visiting, ,, path, ,, visited, ,, has_indirection, ), ), return, true, ;, }, _, =, path, ., swapRemove, (, sym, ), ;, }, }, ,, ., struct_type, ,, ., tuple_type, ,, ., enum_type, =>, {, for, (, ty, ., children, (, ), ., items, ), |, child, |, {, if, (, dfs, (, child, ,, visiting, ,, path, ,, visited, ,, has_indirection, ), ), return, true, ;, }, }, ,, ., array_of, ,, ., index, ,, ., addr_of, ,, ., annotation, =>, {, if, (, dfs, (, ty, ., child, (, ), ,, visiting, ,, path, ,, visited, ,, has_indirection, or, ty, .*, ==, ., addr_of, ), ), return, true, ;, }, ,, else, =>, {, }, ,, }, _, =, visiting, ., swapRemove, (, ty, ), ;, visited, ., put, (, ty, ,, true, ), catch, unreachable, ;, return, false, ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, pub, const, Substitutions, =, std, ., StringArrayHashMap, (, *, Type_AST, ), ;, pub, fn, unify, (, lhs, :, *, Type_AST, ,, rhs, :, *, Type_AST, ,, withs, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, subst, :, *, Substitutions, ), !, void, {, if, (, lhs, .*, ==, ., identifier, and, lhs, ., symbol, (, ), .?, ., init_typedef, (, ), !=, null, ), {, return, try, unify, (, lhs, ., symbol, (, ), .?, ., init_typedef, (, ), .?, ,, rhs, ,, withs, ,, subst, ), ;, }, else, if, (, rhs, .*, ==, ., identifier, and, rhs, ., symbol, (, ), .?, ., init_typedef, (, ), !=, null, ), {, return, try, unify, (, lhs, ,, rhs, ., symbol, (, ), .?, ., init_typedef, (, ), .?, ,, withs, ,, subst, ), ;, }, if, (, rhs, .*, ==, ., access, and, rhs, ., symbol, (, ), .?, ., init_typedef, (, ), !=, null, ), {, return, try, unify, (, lhs, ,, rhs, ., symbol, (, ), .?, ., init_typedef, (, ), .?, ,, withs, ,, subst, ), ;, }, switch, (, lhs, .*, ), {, ., identifier, =>, {, std, ., debug, ., assert, (, lhs, ., token, (, ), ., data, ., len, >, 0, ), ;, if, (, identifier_is_type_param, (, lhs, ,, withs, ), ), |, _, |, {, try, subst, ., put, (, lhs, ., token, (, ), ., data, ,, rhs, ), ;, return, ;, }, if, (, rhs, .*, !=, ., identifier, or, !, std, ., mem, ., eql, (, u8, ,, lhs, ., token, (, ), ., data, ,, rhs, ., token, (, ), ., data, ), ), {, return, error, ., TypesMismatch, ;, }, }, ,, ., struct_type, =>, {, if, (, rhs, .*, !=, ., struct_type, ), {, return, error, ., TypesMismatch, ;, }, if, (, lhs, ., children, (, ), ., items, ., len, !=, rhs, ., children, (, ), ., items, ., len, ), {, return, error, ., TypesMismatch, ;, }, for, (, lhs, ., children, (, ), ., items, ,, rhs, ., children, (, ), ., items, ), |, l_arg, ,, r_arg, |, {, try, unify, (, l_arg, ,, r_arg, ,, withs, ,, subst, ), ;, }, }, ,, ., annotation, =>, {, if, (, rhs, .*, !=, ., annotation, ), {, return, error, ., TypesMismatch, ;, }, try, unify, (, lhs, ., child, (, ), ,, rhs, ., child, (, ), ,, withs, ,, subst, ), ;, }, ,, ., unit_type, =>, {, if, (, rhs, .*, !=, ., unit_type, ), {, return, error, ., TypesMismatch, ;, }, }, ,, ., generic_apply, =>, {, if, (, rhs, .*, !=, ., generic_apply, ), {, return, error, ., TypesMismatch, ;, }, const, lhs_constructor, =, lhs, ., lhs, (, ), ;, const, rhs_constructor, =, rhs, ., lhs, (, ), ;, if, (, !, std, ., mem, ., eql, (, u8, ,, lhs_constructor, ., token, (, ), ., data, ,, rhs_constructor, ., token, (, ), ., data, ), ), {, return, error, ., TypesMismatch, ;, }, if, (, lhs, ., children, (, ), ., items, ., len, !=, rhs, ., children, (, ), ., items, ., len, ), {, return, error, ., TypesMismatch, ;, }, for, (, lhs, ., children, (, ), ., items, ,, rhs, ., children, (, ), ., items, ), |, l_arg, ,, r_arg, |, {, try, unify, (, l_arg, ,, r_arg, ,, withs, ,, subst, ), ;, }, }, ,, else, =>, return, ,, }, }, pub, fn, type_param_list_from_subst_map, (, subst, :, *, Substitutions, ,, generic_params, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ,, alloc, :, std, ., mem, ., Allocator, ), std, ., array_list, ., Managed, (, *, Type_AST, ), {, var, retval, =, std, ., array_list, ., Managed, (, *, Type_AST, ), ., init, (, alloc, ), ;, for, (, generic_params, ., items, ), |, type_param, |, {, const, with_value, =, subst, ., get, (, type_param, ., token, (, ), ., data, ), .?, ;, retval, ., append, (, with_value, ), catch, unreachable, ;, }, return, retval, ;, }, fn, identifier_is_type_param, (, ident, :, *, Type_AST, ,, generic_params, :, std, ., array_list, ., Managed, (, *, ast_, ., AST, ), ), ?, *, ast_, ., AST, {, for, (, generic_params, ., items, ), |, type_param, |, {, if, (, std, ., mem, ., eql, (, u8, ,, type_param, ., token, (, ), ., data, ,, ident, ., token, (, ), ., data, ), ), {, return, type_param, ;, }, }, return, null, ;, }, pub, fn, substitution_contains_generics, (, subst, :, *, const, Substitutions, ), bool, {, for, (, subst, ., keys, (, ), ), |, key, |, {, const, ty, =, subst, ., get, (, key, ), .?, ;, const, bad, =, ty, .*, ==, ., identifier, and, ty, ., symbol, (, ), .?, ., decl, .?, .*, ==, ., type_param_decl, ;, if, (, bad, ), {, return, true, ;, }, }, return, false, ;, }, pub, fn, print_substitutions, (, subst, :, *, const, Substitutions, ), void, {, std, ., debug, ., print, (, "{} substitutions: {{\n", ,, ., {, subst, ., keys, (, ), ., len, }, ), ;, for, (, subst, ., keys, (, ), ), |, key, |, {, const, ty, =, subst, ., get, (, key, ), .?, ;, const, bad, =, ty, .*, ==, ., identifier, and, ty, ., symbol, (, ), .?, ., decl, .?, .*, ==, ., type_param_decl, ;, std, ., debug, ., print, (, "    {s}: {?f} ({})\n", ,, ., {, key, ,, subst, ., get, (, key, ), ,, bad, }, ), ;, }, std, ., debug, ., print, (, "}}\n", ,, ., {, }, ), ;, }, const, std, =, @, import, (, "std", ), ;, pub, fn, next_alignment, (, address, :, i64, ,, align_to, :, i64, ), i64, {, std, ., debug, ., assert, (, align_to, ==, 1, or, align_to, ==, 2, or, align_to, ==, 4, or, align_to, ==, 8, ), ;, if, (, address, ==, 0, ), {, return, address, ;, }, else, if, (, address, >, 0, ), {, const, div, =, @, divTrunc, (, address, -, 1, ,, align_to, ), ;, return, div, *, align_to, +, align_to, ;, }, else, {, const, div, =, @, divTrunc, (, address, +, 1, ,, align_to, ), ;, return, div, *, align_to, -, align_to, ;, }, }, const, std, =, @, import, (, "std", ), ;, var, num_anons, :, usize, =, 0, ;, pub, fn, next_anon_name, (, class, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), [, ], const, u8, {, defer, num_anons, +=, 1, ;, var, out, =, std, ., array_list, ., Managed, (, u8, ), ., init, (, allocator, ), ;, defer, out, ., deinit, (, ), ;, out, ., print, (, "{s}__{}", ,, ., {, class, ,, num_anons, }, ), catch, unreachable, ;, return, out, ., toOwnedSlice, (, ), catch, unreachable, ;, }, const, std, =, @, import, (, "std", ), ;, pub, fn, Dfs_Iterator, (, comptime, T, :, type, ), type, {, return, struct, {, const, Self, =, @, This, (, ), ;, current, :, ?, T, ,, stack, :, std, ., array_list, ., Managed, (, T, ), ,, visited, :, std, ., AutoHashMap, (, T, ,, void, ), ,, pub, fn, init, (, start, :, T, ,, allocator, :, std, ., mem, ., Allocator, ), Self, {, return, Self, {, ., current, =, start, ,, ., stack, =, std, ., array_list, ., Managed, (, T, ), ., init, (, allocator, ), ,, ., visited, =, std, ., AutoHashMap, (, T, ,, void, ), ., init, (, allocator, ), ,, }, ;, }, pub, fn, deinit, (, self, :, *, Self, ), void, {, self, ., stack, ., deinit, (, ), ;, self, ., visited, ., deinit, (, ), ;, }, pub, fn, next, (, self, :, *, Self, ), ?, T, {, if, (, self, ., current, ==, null, ), return, null, ;, const, result, =, self, ., current, .?, ;, self, ., visited, ., put, (, result, ,, {, }, ), catch, unreachable, ;, const, adjacent, :, [, ], T, =, self, ., current, .?, ., get_adjacent, (, ), ;, for, (, adjacent, ), |, target, |, {, if, (, !, self, ., visited, ., contains, (, target, ), ), {, self, ., stack, ., append, (, target, ), catch, unreachable, ;, }, }, if, (, @, typeInfo, (, T, ), ==, ., @, "struct", and, @, hasDecl, (, T, ,, "free_adjacent", ), ), {, self, ., current, .?, ., free_adjacent, (, adjacent, ), ;, }, else, if, (, @, typeInfo, (, T, ), ==, ., pointer, and, @, typeInfo, (, @, typeInfo, (, T, ), ., pointer, ., child, ), ==, ., @, "struct", and, @, hasDecl, (, @, typeInfo, (, T, ), ., pointer, ., child, ,, "free_adjacent", ), ), {, self, ., current, .?, ., free_adjacent, (, adjacent, ), ;, }, self, ., current, =, null, ;, while, (, self, ., stack, ., pop, (, ), ), |, next_val, |, {, if, (, !, self, ., visited, ., contains, (, next_val, ), ), {, self, ., current, =, next_val, ;, break, ;, }, }, return, result, ;, }, }, ;, }, const, std, =, @, import, (, "std", ), ;, const, ast_, =, @, import, (, "../ast/ast.zig", ), ;, const, Span, =, @, import, (, "../util/span.zig", ), ;, const, Symbol, =, @, import, (, "../symbol/symbol.zig", ), ;, const, term_, =, @, import, (, "term.zig", ), ;, const, Token, =, @, import, (, "../lexer/token.zig", ), ;, const, Type_AST, =, @, import, (, "../types/type.zig", ), ., Type_AST, ;, pub, const, Error_Config, =, struct, {, print_full_path, :, bool, =, true, ,, print_color, :, bool, =, true, ,, }, ;, pub, const, Error, =, union, (, enum, ), {, basic, :, struct, {, span, :, Span, ,, msg, :, [, ], const, u8, ,, }, ,, cannot_open, :, struct, {, span, :, Span, ,, filename, :, [, ], const, u8, ,, }, ,, invalid_digit, :, struct, {, span, :, Span, ,, digit, :, u8, ,, base, :, [, ], const, u8, ,, }, ,, invalid_escape, :, struct, {, span, :, Span, ,, digit, :, u8, ,, }, ,, expected_basic_token, :, struct, {, expected, :, [, ], const, u8, ,, got, :, Token, ,, }, ,, expected2token, :, struct, {, expected, :, Token, ., Kind, ,, got, :, Token, ,, }, ,, missing_close, :, struct, {, expected, :, Token, ., Kind, ,, got, :, Token, ,, open, :, Token, ,, }, ,, comptime_known, :, struct, {, span, :, Span, ,, what, :, [, ], const, u8, ,, }, ,, redefinition, :, struct, {, first_defined_span, :, Span, ,, redefined_span, :, Span, ,, name, :, [, ], const, u8, ,, }, ,, symbol_error, :, struct, {, span, :, Span, ,, context_span, :, ?, Span, =, null, ,, name, :, [, ], const, u8, ,, problem, :, [, ], const, u8, ,, context_message, :, [, ], const, u8, =, "", ,, }, ,, discard_marked, :, struct, {, span, :, Span, ,, kind, :, Symbol, ., Kind, ,, }, ,, not_inside_loop, :, struct, {, span, :, Span, ,, name, :, [, ], const, u8, ,, }, ,, not_inside_function, :, struct, {, span, :, Span, ,, name, :, [, ], const, u8, ,, }, ,, import_file_not_found, :, struct, {, span, :, Span, ,, filename, :, [, ], const, u8, ,, }, ,, unapplied_generic, :, struct, {, span, :, Span, ,, symbol_name, :, [, ], const, u8, ,, num_generics, :, usize, ,, }, ,, reimpl, :, struct, {, first_defined_span, :, Span, ,, redefined_span, :, Span, ,, name, :, ?, [, ], const, u8, ,, _type, :, *, Type_AST, ,, }, ,, type_not_impl_method, :, struct, {, span, :, Span, ,, method_name, :, [, ], const, u8, ,, _type, :, *, Type_AST, ,, }, ,, type_not_impl_trait, :, struct, {, span, :, Span, ,, trait_name, :, [, ], const, u8, ,, _type, :, *, Type_AST, ,, }, ,, method_not_in_trait, :, struct, {, method_span, :, Span, ,, method_name, :, [, ], const, u8, ,, trait_name, :, [, ], const, u8, ,, }, ,, method_not_in_impl, :, struct, {, impl_span, :, Span, ,, method_span, :, Span, ,, method_name, :, [, ], const, u8, ,, trait_name, :, [, ], const, u8, ,, }, ,, impl_receiver_mismatch, :, struct, {, receiver_span, :, Span, ,, impl_receiver, :, ?, ast_, ., Receiver_Kind, ,, trait_receiver, :, ?, ast_, ., Receiver_Kind, ,, method_name, :, [, ], const, u8, ,, trait_name, :, [, ], const, u8, ,, }, ,, invoke_receiver_mismatch, :, struct, {, receiver_span, :, Span, ,, method_receiver, :, ast_, ., Receiver_Kind, ,, method_name, :, [, ], const, u8, ,, lhs_type, :, *, Type_AST, ,, }, ,, mismatch_method_param_arity, :, struct, {, span, :, Span, ,, trait_arity, :, usize, ,, impl_arity, :, usize, ,, method_name, :, [, ], const, u8, ,, trait_name, :, [, ], const, u8, ,, }, ,, mismatch_method_type, :, struct, {, span, :, Span, ,, trait_type, :, *, Type_AST, ,, impl_type, :, *, Type_AST, ,, method_name, :, [, ], const, u8, ,, trait_name, :, [, ], const, u8, ,, }, ,, mismatch_method_virtuality, :, struct, {, span, :, Span, ,, trait_method_is_virtual, :, bool, ,, impl_method_is_virtual, :, bool, ,, method_name, :, [, ], const, u8, ,, trait_name, :, [, ], const, u8, ,, }, ,, trait_virtual_refers_to_self, :, struct, {, span, :, Span, ,, method_name, :, [, ], const, u8, ,, trait_name, :, [, ], const, u8, ,, }, ,, invoke_not_virtual, :, struct, {, span, :, Span, ,, method_name, :, [, ], const, u8, ,, trait_name, :, [, ], const, u8, ,, }, ,, missing_context, :, struct, {, span, :, Span, ,, context, :, *, Type_AST, ,, }, ,, unexpected_type, :, struct, {, span, :, Span, ,, expected, :, *, Type_AST, ,, got, :, *, Type_AST, ,, }, ,, non_convertible, :, struct, {, span, :, Span, ,, from, :, *, Type_AST, ,, to, :, *, Type_AST, ,, }, ,, unexpected_type_type, :, struct, {, span, :, Span, ,, expected, :, ?, *, Type_AST, ,, }, ,, expected_builtin_typeclass, :, struct, {, span, :, Span, ,, expected, :, [, ], const, u8, ,, got, :, *, Type_AST, ,, }, ,, duplicate, :, struct, {, span, :, Span, ,, thing, :, [, ], const, u8, ,, identifier, :, [, ], const, u8, ,, first, :, ?, Span, ,, }, ,, member_not_in_type, :, struct, {, span, :, Span, ,, identifier, :, [, ], const, u8, ,, name, :, [, ], const, u8, ,, type, :, *, Type_AST, ,, }, ,, member_not_in_module, :, struct, {, span, :, Span, ,, identifier, :, [, ], const, u8, ,, name, :, [, ], const, u8, ,, module_name, :, [, ], const, u8, ,, }, ,, undeclared_identifier, :, struct, {, identifier, :, Token, ,, expected, :, ?, *, ast_, ., AST, ,, }, ,, comptime_access_runtime, :, struct, {, identifier, :, Token, ,, }, ,, inner_fn_access_runtime, :, struct, {, identifier, :, Token, ,, }, ,, use_before_def, :, struct, {, identifier, :, Token, ,, }, ,, modify_immutable, :, struct, {, identifier, :, Token, ,, }, ,, not_selectable, :, struct, {, span, :, Span, ,, _type, :, *, Type_AST, ,, }, ,, not_indexable, :, struct, {, span, :, Span, ,, _type, :, *, Type_AST, ,, }, ,, not_subsliceable, :, struct, {, span, :, Span, ,, _type, :, *, Type_AST, ,, }, ,, bad_index, :, struct, {, span, :, Span, ,, _type, :, *, Type_AST, ,, index, :, i128, ,, length, :, usize, ,, }, ,, non_exhaustive_sum, :, struct, {, span, :, Span, ,, forgotten, :, std, ., array_list, ., Managed, (, *, Type_AST, ), ,, }, ,, mismatch_arity, :, struct, {, span, :, Span, ,, takes, :, usize, ,, given, :, usize, ,, thing_name, :, [, ], const, u8, ,, takes_name, :, [, ], const, u8, ,, given_name, :, [, ], const, u8, ,, }, ,, no_default, :, struct, {, span, :, Span, ,, _type, :, *, Type_AST, ,, }, ,, wrong_from, :, struct, {, span, :, Span, ,, operator, :, [, ], const, u8, ,, from, :, [, ], const, u8, ,, got, :, *, Type_AST, ,, }, ,, integer_out_of_bounds, :, struct, {, span, :, Span, ,, expected, :, *, Type_AST, ,, value, :, i128, ,, }, ,, invalid_type, :, struct, {, span, :, Span, ,, got, :, *, Type_AST, ,, }, ,, recursive_definition, :, struct, {, span, :, Span, ,, symbol_name, :, ?, [, ], const, u8, ,, }, ,, not_constraint, :, struct, {, span, :, Span, ,, got, :, *, Type_AST, ,, }, ,, fn, get_span, (, self, :, *, const, Error, ), ?, Span, {, switch, (, self, .*, ), {, ., basic, =>, return, self, ., basic, ., span, ,, ., cannot_open, =>, return, self, ., cannot_open, ., span, ,, ., invalid_digit, =>, return, self, ., invalid_digit, ., span, ,, ., invalid_escape, =>, return, self, ., invalid_escape, ., span, ,, ., expected_basic_token, =>, return, self, ., expected_basic_token, ., got, ., span, ,, ., expected2token, =>, return, self, ., expected2token, ., got, ., span, ,, ., missing_close, =>, return, self, ., missing_close, ., got, ., span, ,, ., comptime_known, =>, return, self, ., comptime_known, ., span, ,, ., redefinition, =>, return, self, ., redefinition, ., redefined_span, ,, ., symbol_error, =>, return, self, ., symbol_error, ., span, ,, ., discard_marked, =>, return, self, ., discard_marked, ., span, ,, ., not_inside_loop, =>, return, self, ., not_inside_loop, ., span, ,, ., not_inside_function, =>, return, self, ., not_inside_function, ., span, ,, ., import_file_not_found, =>, return, self, ., import_file_not_found, ., span, ,, ., unapplied_generic, =>, return, self, ., unapplied_generic, ., span, ,, ., reimpl, =>, return, self, ., reimpl, ., redefined_span, ,, ., type_not_impl_method, =>, return, self, ., type_not_impl_method, ., span, ,, ., type_not_impl_trait, =>, return, self, ., type_not_impl_trait, ., span, ,, ., method_not_in_trait, =>, return, self, ., method_not_in_trait, ., method_span, ,, ., method_not_in_impl, =>, return, self, ., method_not_in_impl, ., impl_span, ,, ., impl_receiver_mismatch, =>, return, self, ., impl_receiver_mismatch, ., receiver_span, ,, ., invoke_receiver_mismatch, =>, return, self, ., invoke_receiver_mismatch, ., receiver_span, ,, ., mismatch_method_param_arity, =>, return, self, ., mismatch_method_param_arity, ., span, ,, ., mismatch_method_type, =>, return, self, ., mismatch_method_type, ., span, ,, ., mismatch_method_virtuality, =>, return, self, ., mismatch_method_virtuality, ., span, ,, ., trait_virtual_refers_to_self, =>, return, self, ., trait_virtual_refers_to_self, ., span, ,, ., invoke_not_virtual, =>, return, self, ., invoke_not_virtual, ., span, ,, ., missing_context, =>, return, self, ., missing_context, ., span, ,, ., unexpected_type, =>, return, self, ., unexpected_type, ., span, ,, ., non_convertible, =>, return, self, ., non_convertible, ., span, ,, ., unexpected_type_type, =>, return, self, ., unexpected_type_type, ., span, ,, ., expected_builtin_typeclass, =>, return, self, ., expected_builtin_typeclass, ., span, ,, ., duplicate, =>, return, self, ., duplicate, ., span, ,, ., member_not_in_type, =>, return, self, ., member_not_in_type, ., span, ,, ., member_not_in_module, =>, return, self, ., member_not_in_module, ., span, ,, ., undeclared_identifier, =>, return, self, ., undeclared_identifier, ., identifier, ., span, ,, ., comptime_access_runtime, =>, return, self, ., comptime_access_runtime, ., identifier, ., span, ,, ., inner_fn_access_runtime, =>, return, self, ., inner_fn_access_runtime, ., identifier, ., span, ,, ., use_before_def, =>, return, self, ., use_before_def, ., identifier, ., span, ,, ., modify_immutable, =>, return, self, ., modify_immutable, ., identifier, ., span, ,, ., not_indexable, =>, return, self, ., not_indexable, ., span, ,, ., not_subsliceable, =>, return, self, ., not_subsliceable, ., span, ,, ., bad_index, =>, return, self, ., bad_index, ., span, ,, ., not_selectable, =>, return, self, ., not_selectable, ., span, ,, ., non_exhaustive_sum, =>, return, self, ., non_exhaustive_sum, ., span, ,, ., mismatch_arity, =>, return, self, ., mismatch_arity, ., span, ,, ., no_default, =>, return, self, ., no_default, ., span, ,, ., wrong_from, =>, return, self, ., wrong_from, ., span, ,, ., integer_out_of_bounds, =>, return, self, ., integer_out_of_bounds, ., span, ,, ., invalid_type, =>, return, self, ., invalid_type, ., span, ,, ., recursive_definition, =>, return, self, ., recursive_definition, ., span, ,, ., not_constraint, =>, return, self, ., not_constraint, ., span, ,, }, }, pub, fn, fatal_error, (, self, :, Error, ,, writer, :, *, std, ., io, ., Writer, ,, conf, :, Error_Config, ), noreturn, {, self, ., print_error, (, writer, ,, conf, ), ;, std, ., process, ., exit, (, 1, ), ;, }, pub, fn, print_error, (, self, :, Error, ,, writer, :, *, std, ., io, ., Writer, ,, conf, :, Error_Config, ), void, {, print_color, (, bold, ,, writer, ,, conf, ), ;, print_label, (, self, ., get_span, (, ), ,, "error: ", ,, ., red, ,, writer, ,, conf, ), ;, self, ., print_msg, (, writer, ), ;, print_color, (, not_bold, ,, writer, ,, conf, ), ;, print_epilude, (, self, ., get_span, (, ), ,, writer, ,, conf, ), ;, self, ., print_extra_info, (, writer, ,, conf, ), ;, }, fn, print_msg, (, err, :, Error, ,, writer, :, *, std, ., io, ., Writer, ), void, {, switch, (, err, ), {, ., basic, =>, writer, ., print, (, "{s}\n", ,, ., {, err, ., basic, ., msg, }, ), catch, unreachable, ,, ., cannot_open, =>, writer, ., print, (, "cannot open file {s}\n", ,, ., {, err, ., cannot_open, ., filename, }, ), catch, unreachable, ,, ., invalid_digit, =>, writer, ., print, (, "'{c}' is not a valid {s} digit\n", ,, ., {, err, ., invalid_digit, ., digit, ,, err, ., invalid_digit, ., base, }, ), catch, unreachable, ,, ., invalid_escape, =>, writer, ., print, (, "invalid escape sequence '\\{c}'\n", ,, ., {, err, ., invalid_escape, ., digit, }, ), catch, unreachable, ,, ., expected_basic_token, =>, writer, ., print, (, "expected {s}, got `{s}`\n", ,, ., {, err, ., expected_basic_token, ., expected, ,, err, ., expected_basic_token, ., got, ., kind, ., repr, (, ), orelse, err, ., expected_basic_token, ., got, ., data, ,, }, ), catch, unreachable, ,, ., expected2token, =>, writer, ., print, (, "expected `{s}`, got `{s}`\n", ,, ., {, err, ., expected2token, ., expected, ., repr, (, ), orelse, "identifier", ,, err, ., expected2token, ., got, ., kind, ., repr, (, ), orelse, err, ., expected2token, ., got, ., data, ,, }, ), catch, unreachable, ,, ., missing_close, =>, {, writer, ., print, (, "expected closing `{s}` to match opening `{s}` here, got `{s}`\n", ,, ., {, err, ., missing_close, ., expected, ., repr, (, ), orelse, "", ,, err, ., missing_close, ., open, ., kind, ., repr, (, ), orelse, err, ., missing_close, ., open, ., data, ,, err, ., missing_close, ., got, ., kind, ., repr, (, ), orelse, err, ., missing_close, ., got, ., data, ,, }, ), catch, unreachable, ;, }, ,, ., comptime_known, =>, writer, ., print, (, "{s} must be compile-time known\n", ,, ., {, err, ., comptime_known, ., what, }, ), catch, unreachable, ,, ., redefinition, =>, writer, ., print, (, "redefinition of symbol `{s}`\n", ,, ., {, err, ., redefinition, ., name, }, ), catch, unreachable, ,, ., symbol_error, =>, writer, ., print, (, "symbol `{s}` {s}\n", ,, ., {, err, ., symbol_error, ., name, ,, err, ., symbol_error, ., problem, }, ), catch, unreachable, ,, ., discard_marked, =>, writer, ., print, (, "discarded symbol marked as `{s}`\n", ,, ., {, @, tagName, (, err, ., discard_marked, ., kind, ), }, ), catch, unreachable, ,, ., not_inside_loop, =>, writer, ., print, (, "`{s}` is not inside a loop\n", ,, ., {, err, ., not_inside_loop, ., name, }, ), catch, unreachable, ,, ., not_inside_function, =>, writer, ., print, (, "`{s}` is not inside a function\n", ,, ., {, err, ., not_inside_function, ., name, }, ), catch, unreachable, ,, ., import_file_not_found, =>, writer, ., print, (, "file `{s}.orng` not found\n", ,, ., {, err, ., import_file_not_found, ., filename, }, ), catch, unreachable, ,, ., unapplied_generic, =>, writer, ., print, (, "symbol `{s}` requires {} generic arguments\n", ,, ., {, err, ., unapplied_generic, ., symbol_name, ,, err, ., unapplied_generic, ., num_generics, }, ), catch, unreachable, ,, ., reimpl, =>, if, (, err, ., reimpl, ., name, !=, null, ), {, writer, ., print, (, "duplicate implementation of trait `{s}` for the type `", ,, ., {, err, ., reimpl, ., name, .?, }, ), catch, unreachable, ;, err, ., reimpl, ., _type, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "`\n", ,, ., {, }, ), catch, unreachable, ;, }, else, {, writer, ., print, (, "duplicate implementation for the type `", ,, ., {, }, ), catch, unreachable, ;, err, ., reimpl, ., _type, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "`\n", ,, ., {, }, ), catch, unreachable, ;, }, ,, ., type_not_impl_method, =>, {, writer, ., print, (, "the type `", ,, ., {, }, ), catch, unreachable, ;, err, ., type_not_impl_method, ., _type, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "` does not implement the method `{s}`\n", ,, ., {, err, ., type_not_impl_method, ., method_name, }, ), catch, unreachable, ;, }, ,, ., type_not_impl_trait, =>, {, writer, ., print, (, "the type `", ,, ., {, }, ), catch, unreachable, ;, err, ., type_not_impl_trait, ., _type, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "` does not implement the trait `{s}`\n", ,, ., {, err, ., type_not_impl_trait, ., trait_name, }, ), catch, unreachable, ;, }, ,, ., method_not_in_trait, =>, writer, ., print, (, "method `{s}` is not in trait `{s}`\n", ,, ., {, err, ., method_not_in_trait, ., method_name, ,, err, ., method_not_in_trait, ., trait_name, ,, }, ), catch, unreachable, ,, ., method_not_in_impl, =>, {, writer, ., print, (, "missing implementation of method `{s}` from trait `{s}`\n", ,, ., {, err, ., method_not_in_impl, ., method_name, ,, err, ., method_not_in_impl, ., trait_name, ,, }, ), catch, unreachable, ;, }, ,, ., impl_receiver_mismatch, =>, if, (, err, ., impl_receiver_mismatch, ., trait_receiver, !=, null, and, err, ., impl_receiver_mismatch, ., impl_receiver, !=, null, ), {, writer, ., print, (, "trait `{s}` specifies receiver `{s}` for method `{s}`, got receiver `{s}`\n", ,, ., {, err, ., impl_receiver_mismatch, ., trait_name, ,, err, ., impl_receiver_mismatch, ., trait_receiver, .?, ., to_string, (, ), ,, err, ., impl_receiver_mismatch, ., method_name, ,, err, ., impl_receiver_mismatch, ., impl_receiver, .?, ., to_string, (, ), ,, }, ), catch, unreachable, ;, }, else, if, (, err, ., impl_receiver_mismatch, ., trait_receiver, ==, null, and, err, ., impl_receiver_mismatch, ., impl_receiver, !=, null, ), {, writer, ., print, (, "trait `{s}` does not specify a receiver for method `{s}`, got receiver `{s}`\n", ,, ., {, err, ., impl_receiver_mismatch, ., trait_name, ,, err, ., impl_receiver_mismatch, ., method_name, ,, err, ., impl_receiver_mismatch, ., impl_receiver, .?, ., to_string, (, ), ,, }, ), catch, unreachable, ;, }, else, if, (, err, ., impl_receiver_mismatch, ., trait_receiver, !=, null, and, err, ., impl_receiver_mismatch, ., impl_receiver, ==, null, ), {, writer, ., print, (, "trait `{s}` specifies receiver `{s}` for method `{s}`\n", ,, ., {, err, ., impl_receiver_mismatch, ., trait_name, ,, err, ., impl_receiver_mismatch, ., trait_receiver, .?, ., to_string, (, ), ,, err, ., impl_receiver_mismatch, ., method_name, ,, }, ), catch, unreachable, ;, }, ,, ., invoke_receiver_mismatch, =>, {, writer, ., print, (, "receiver `{s}` of method `{s}` incompatible with type `", ,, ., {, err, ., invoke_receiver_mismatch, ., method_receiver, ., to_string, (, ), ,, err, ., invoke_receiver_mismatch, ., method_name, ,, }, ), catch, unreachable, ;, err, ., invoke_receiver_mismatch, ., lhs_type, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "`\n", ,, ., {, }, ), catch, unreachable, ;, }, ,, ., mismatch_method_param_arity, =>, writer, ., print, (, "trait `{s}` specifies {} parameter{s} for method `{s}`, got {}\n", ,, ., {, err, ., mismatch_method_param_arity, ., trait_name, ,, err, ., mismatch_method_param_arity, ., trait_arity, ,, if, (, err, ., mismatch_method_param_arity, ., trait_arity, !=, 1, ), "s", else, "", ,, err, ., mismatch_method_param_arity, ., method_name, ,, err, ., mismatch_method_param_arity, ., impl_arity, ,, }, ), catch, unreachable, ,, ., mismatch_method_type, =>, {, writer, ., print, (, "trait `{s}` specifies type `", ,, ., {, err, ., mismatch_method_type, ., trait_name, }, ), catch, unreachable, ;, err, ., mismatch_method_type, ., trait_type, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "` for method `{s}`, got `", ,, ., {, err, ., mismatch_method_type, ., method_name, }, ), catch, unreachable, ;, err, ., mismatch_method_type, ., impl_type, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "`\n", ,, ., {, }, ), catch, unreachable, ;, }, ,, ., mismatch_method_virtuality, =>, {, writer, ., print, (, "trait `{s}` specifies the method `{s}` as {s}, got {s}\n", ,, ., {, err, ., mismatch_method_virtuality, ., trait_name, ,, err, ., mismatch_method_virtuality, ., method_name, ,, if, (, err, ., mismatch_method_virtuality, ., trait_method_is_virtual, ), "virtual", else, "non-virtual", ,, if, (, err, ., mismatch_method_virtuality, ., impl_method_is_virtual, ), "virtual", else, "non-virtual", ,, }, ), catch, unreachable, ;, }, ,, ., trait_virtual_refers_to_self, =>, {, writer, ., print, (, "virtual method `{s}` of trait `{s}` refers to `Self` type\n", ,, ., {, err, ., trait_virtual_refers_to_self, ., method_name, ,, err, ., trait_virtual_refers_to_self, ., trait_name, ,, }, ), catch, unreachable, ;, }, ,, ., invoke_not_virtual, =>, {, writer, ., print, (, "cannot invoke non-virtual method `{s}` of trait `{s}` through dyn value\n", ,, ., {, err, ., invoke_not_virtual, ., method_name, ,, err, ., invoke_not_virtual, ., trait_name, ,, }, ), catch, unreachable, ;, }, ,, ., missing_context, =>, {, writer, ., print, (, "missing context `{f}`\n", ,, ., {, err, ., missing_context, ., context, ,, }, ), catch, unreachable, ;, }, ,, ., unexpected_type, =>, if, (, err, ., unexpected_type, ., expected, .*, ==, ., identifier, and, std, ., mem, ., eql, (, u8, ,, err, ., unexpected_type, ., expected, ., token, (, ), ., data, ,, "Void", ), ), {, std, ., debug, ., assert, (, err, ., unexpected_type, ., expected, .*, !=, ., poison, ), ;, writer, ., print, (, "cannot assign a value of type `", ,, ., {, }, ), catch, unreachable, ;, err, ., unexpected_type, ., got, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "` to type `Void`\n", ,, ., {, }, ), catch, unreachable, ;, }, else, {, std, ., debug, ., assert, (, err, ., unexpected_type, ., expected, .*, !=, ., poison, ), ;, writer, ., print, (, "expected a value of type `", ,, ., {, }, ), catch, unreachable, ;, err, ., unexpected_type, ., expected, ., print_type, (, writer, ), catch, unreachable, ;, if, (, err, ., unexpected_type, ., got, .*, !=, ., poison, ), {, writer, ., print, (, "`, got a value of type `", ,, ., {, }, ), catch, unreachable, ;, err, ., unexpected_type, ., got, ., print_type, (, writer, ), catch, unreachable, ;, }, writer, ., print, (, "`\n", ,, ., {, }, ), catch, unreachable, ;, }, ,, ., non_convertible, =>, {, writer, ., print, (, "cannot cast type `{f}` to type `{f}`\n", ,, ., {, err, ., non_convertible, ., from, ,, err, ., non_convertible, ., to, }, ), catch, unreachable, ;, }, ,, ., unexpected_type_type, =>, {, if, (, err, ., unexpected_type_type, ., expected, ), |, expected, |, {, writer, ., print, (, "expected a value of type `{f}`, got a type\n", ,, ., {, expected, }, ), catch, unreachable, ;, }, else, {, writer, ., print, (, "unexpected type\n", ,, ., {, }, ), catch, unreachable, ;, }, }, ,, ., expected_builtin_typeclass, =>, {, writer, ., print, (, "expected a value of a(n) {s} type, got `", ,, ., {, err, ., expected_builtin_typeclass, ., expected, }, ), catch, unreachable, ;, err, ., expected_builtin_typeclass, ., got, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "`\n", ,, ., {, }, ), catch, unreachable, ;, }, ,, ., duplicate, =>, writer, ., print, (, "duplicate {s} `{s}`\n", ,, ., {, err, ., duplicate, ., thing, ,, err, ., duplicate, ., identifier, }, ), catch, unreachable, ,, ., member_not_in_type, =>, {, writer, ., print, (, "member `{s}` not in {s} `{f}`\n", ,, ., {, err, ., member_not_in_type, ., identifier, ,, err, ., member_not_in_type, ., name, ,, err, ., member_not_in_type, ., type, }, ), catch, unreachable, ;, }, ,, ., member_not_in_module, =>, {, writer, ., print, (, "member `{s}` not in {s} `{s}`\n", ,, ., {, err, ., member_not_in_module, ., identifier, ,, err, ., member_not_in_module, ., name, ,, err, ., member_not_in_module, ., module_name, }, ), catch, unreachable, ;, }, ,, ., undeclared_identifier, =>, writer, ., print, (, "use of undeclared identifier `{s}`\n", ,, ., {, err, ., undeclared_identifier, ., identifier, ., data, }, ), catch, unreachable, ,, ., comptime_access_runtime, =>, writer, ., print, (, "cannot access non-const variable `{s}` in a comptime context\n", ,, ., {, err, ., comptime_access_runtime, ., identifier, ., data, ,, }, ), catch, unreachable, ,, ., inner_fn_access_runtime, =>, writer, ., print, (, "cannot access non-const variable `{s}` from an inner-function\n", ,, ., {, err, ., inner_fn_access_runtime, ., identifier, ., data, ,, }, ), catch, unreachable, ,, ., use_before_def, =>, writer, ., print, (, "use of identifier `{s}` before its definition\n", ,, ., {, err, ., use_before_def, ., identifier, ., data, }, ), catch, unreachable, ,, ., modify_immutable, =>, writer, ., print, (, "cannot modify non-mutable symbol `{s}`\n", ,, ., {, err, ., modify_immutable, ., identifier, ., data, }, ), catch, unreachable, ,, ., not_indexable, =>, {, writer, ., print, (, "the type `", ,, ., {, }, ), catch, unreachable, ;, err, ., not_indexable, ., _type, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "` is not indexable\n", ,, ., {, }, ), catch, unreachable, ;, }, ,, ., not_subsliceable, =>, {, writer, ., print, (, "cannot take a sub-slice of the type `", ,, ., {, }, ), catch, unreachable, ;, err, ., not_subsliceable, ., _type, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "`\n", ,, ., {, }, ), catch, unreachable, ;, }, ,, ., bad_index, =>, {, writer, ., print, (, "cannot index the type `{f}`, which has length {}, with index {}\n", ,, ., {, err, ., bad_index, ., _type, ,, err, ., bad_index, ., length, ,, err, ., bad_index, ., index, }, ), catch, unreachable, ;, }, ,, ., not_selectable, =>, {, writer, ., print, (, "the type `", ,, ., {, }, ), catch, unreachable, ;, err, ., not_selectable, ., _type, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "` is not selectable\n", ,, ., {, }, ), catch, unreachable, ;, }, ,, ., non_exhaustive_sum, =>, writer, ., print, (, "match over enum type is not exhaustive\n", ,, ., {, }, ), catch, unreachable, ,, ., mismatch_arity, =>, {, writer, ., print, (, "{s} takes {} {s}{s}, {} {s}{s} given\n", ,, ., {, err, ., mismatch_arity, ., thing_name, ,, err, ., mismatch_arity, ., takes, ,, err, ., mismatch_arity, ., takes_name, ,, if, (, err, ., mismatch_arity, ., takes, ==, 1, ), "", else, "s", ,, err, ., mismatch_arity, ., given, ,, err, ., mismatch_arity, ., given_name, ,, if, (, err, ., mismatch_arity, ., given, ==, 1, ), "", else, "s", ,, }, ), catch, unreachable, ;, }, ,, ., no_default, =>, {, writer, ., print, (, "no default value for type `", ,, ., {, }, ), catch, unreachable, ;, err, ., no_default, ., _type, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "`\n", ,, ., {, }, ), catch, unreachable, ;, }, ,, ., wrong_from, =>, {, writer, ., print, (, "expected {s} type for {s}, got `", ,, ., {, err, ., wrong_from, ., from, ,, err, ., wrong_from, ., operator, ,, }, ), catch, unreachable, ;, err, ., wrong_from, ., got, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "`\n", ,, ., {, }, ), catch, unreachable, ;, }, ,, ., integer_out_of_bounds, =>, {, writer, ., print, (, "error: integer is out of bounds for type `", ,, ., {, }, ), catch, unreachable, ;, err, ., integer_out_of_bounds, ., expected, ., print_type, (, writer, ), catch, unreachable, ;, writer, ., print, (, "`; value={}\n", ,, ., {, err, ., integer_out_of_bounds, ., value, }, ), catch, unreachable, ;, }, ,, ., invalid_type, =>, {, writer, ., print, (, "error: expected a compile-time constant type, got {s}\n", ,, ., {, @, tagName, (, err, ., invalid_type, ., got, .*, ), }, ), catch, unreachable, ;, }, ,, ., recursive_definition, =>, if, (, err, ., recursive_definition, ., symbol_name, ), |, symbol_name, |, {, writer, ., print, (, "error: recursive definition of symbol `{s}` detected\n", ,, ., {, symbol_name, }, ), catch, unreachable, ;, }, else, {, writer, ., print, (, "error: recursive definition detected\n", ,, ., {, }, ), catch, unreachable, ;, }, ,, ., not_constraint, =>, {, writer, ., print, (, "error: expected a trait impl constraint, got {s}\n", ,, ., {, @, tagName, (, err, ., not_constraint, ., got, .*, ), }, ), catch, unreachable, ;, }, ,, }, }, fn, print_extra_info, (, self, :, Error, ,, writer, :, *, std, ., io, ., Writer, ,, conf, :, Error_Config, ), void, {, switch, (, self, ), {, ., missing_close, =>, {, print_color, (, bold, ,, writer, ,, conf, ), ;, print_note_label, (, self, ., missing_close, ., open, ., span, ,, writer, ,, conf, ), ;, print_color, (, bold, ,, writer, ,, conf, ), ;, writer, ., print, (, "opening `{s}` here:\n", ,, ., {, self, ., missing_close, ., open, ., kind, ., repr, (, ), orelse, self, ., missing_close, ., open, ., data, }, ), catch, unreachable, ;, print_color, (, not_bold, ,, writer, ,, conf, ), ;, print_epilude, (, self, ., missing_close, ., open, ., span, ,, writer, ,, conf, ), ;, }, ,, ., comptime_known, =>, {, print_color, (, bold, ,, writer, ,, conf, ), ;, print_note_label, (, self, ., comptime_known, ., span, ,, writer, ,, conf, ), ;, print_color, (, bold, ,, writer, ,, conf, ), ;, writer, ., print, (, "consider wrapping with `comptime`\n", ,, ., {, }, ), catch, unreachable, ;, print_color, (, not_bold, ,, writer, ,, conf, ), ;, }, ,, ., redefinition, =>, {, if, (, self, ., redefinition, ., first_defined_span, ., line_number, !=, 0, ), {, print_color, (, bold, ,, writer, ,, conf, ), ;, print_note_label, (, self, ., redefinition, ., first_defined_span, ,, writer, ,, conf, ), ;, print_color, (, bold, ,, writer, ,, conf, ), ;, writer, ., print, (, "other definition of `{s}` here:\n", ,, ., {, self, ., redefinition, ., name, }, ), catch, unreachable, ;, print_color, (, not_bold, ,, writer, ,, conf, ), ;, print_epilude, (, self, ., redefinition, ., first_defined_span, ,, writer, ,, conf, ), ;, }, }, ,, ., symbol_error, =>, {, if, (, self, ., symbol_error, ., context_span, !=, null, ), {, print_color, (, bold, ,, writer, ,, conf, ), ;, print_note_label, (, self, ., symbol_error, ., context_span, .?, ,, writer, ,, conf, ), ;, print_color, (, bold, ,, writer, ,, conf, ), ;, writer, ., print, (, "{s}\n", ,, ., {, self, ., symbol_error, ., context_message, }, ), catch, unreachable, ;, print_color, (, not_bold, ,, writer, ,, conf, ), ;, print_epilude, (, self, ., symbol_error, ., context_span, .?, ,, writer, ,, conf, ), ;, }, }, ,, ., duplicate, =>, if, (, self, ., duplicate, ., first, !=, null, ), {, print_color, (, bold, ,, writer, ,, conf, ), ;, print_note_label, (, self, ., duplicate, ., first, ,, writer, ,, conf, ), ;, print_color, (, bold, ,, writer, ,, conf, ), ;, writer, ., print, (, "other definition of `{s}` here:\n", ,, ., {, self, ., duplicate, ., identifier, }, ), catch, unreachable, ;, print_color, (, not_bold, ,, writer, ,, conf, ), ;, print_epilude, (, self, ., duplicate, ., first, ,, writer, ,, conf, ), ;, }, ,, ., non_exhaustive_sum, =>, {, for, (, self, ., non_exhaustive_sum, ., forgotten, ., items, ), |, _type, |, {, print_color, (, bold, ,, writer, ,, conf, ), ;, print_note_label, (, _type, ., token, (, ), ., span, ,, writer, ,, conf, ), ;, print_color, (, bold, ,, writer, ,, conf, ), ;, writer, ., print, (, "term not handled: `{s}`\n", ,, ., {, _type, ., annotation, ., pattern, ., token, (, ), ., data, }, ), catch, unreachable, ;, print_color, (, not_bold, ,, writer, ,, conf, ), ;, print_epilude, (, _type, ., token, (, ), ., span, ,, writer, ,, conf, ), ;, }, }, ,, ., reimpl, =>, {, if, (, self, ., reimpl, ., first_defined_span, ., line_number, !=, 0, ), {, print_color, (, bold, ,, writer, ,, conf, ), ;, print_note_label, (, self, ., reimpl, ., first_defined_span, ,, writer, ,, conf, ), ;, print_color, (, bold, ,, writer, ,, conf, ), ;, if, (, self, ., reimpl, ., name, !=, null, ), {, writer, ., print, (, "other implementation of `{s}` here:\n", ,, ., {, self, ., reimpl, ., name, .?, }, ), catch, unreachable, ;, }, else, {, writer, ., print, (, "other implementation here:\n", ,, ., {, }, ), catch, unreachable, ;, }, print_color, (, not_bold, ,, writer, ,, conf, ), ;, print_epilude, (, self, ., reimpl, ., first_defined_span, ,, writer, ,, conf, ), ;, }, }, ,, ., method_not_in_impl, =>, {, print_color, (, bold, ,, writer, ,, conf, ), ;, print_note_label, (, self, ., method_not_in_impl, ., method_span, ,, writer, ,, conf, ), ;, print_color, (, bold, ,, writer, ,, conf, ), ;, writer, ., print, (, "method specification here:\n", ,, ., {, }, ), catch, unreachable, ;, print_color, (, not_bold, ,, writer, ,, conf, ), ;, print_epilude, (, self, ., method_not_in_impl, ., method_span, ,, writer, ,, conf, ), ;, }, ,, else, =>, {, }, ,, }, }, fn, peek_error, (, err, :, Error, ), void, {, var, writer, =, std, ., fs, ., File, ., stderr, (, ), ., writer, (, &, ., {, }, ), ;, const, writer_intfc, =, &, writer, ., interface, ;, err, ., print_error, (, writer_intfc, ,, ., {, }, ), ;, unreachable, ;, }, }, ;, pub, fn, get_std_err, (, ), std, ., fs, ., File, {, return, std, ., fs, ., File, ., stderr, (, ), ;, }, const, bold, =, term_, ., Attr, {, ., bold, =, true, }, ;, const, not_bold, =, term_, ., Attr, {, ., bold, =, false, }, ;, pub, const, Errors, =, struct, {, errors_list, :, std, ., array_list, ., Managed, (, Error, ), ,, pub, fn, init, (, allocator, :, std, ., mem, ., Allocator, ), Errors, {, return, ., {, ., errors_list, =, std, ., array_list, ., Managed, (, Error, ), ., init, (, allocator, ), ,, }, ;, }, pub, fn, deinit, (, self, :, *, Errors, ), void, {, self, ., errors_list, ., deinit, (, ), ;, }, pub, fn, add_error, (, self, :, *, Errors, ,, err, :, Error, ), void, {, self, ., errors_list, ., append, (, err, ), catch, unreachable, ;, }, pub, fn, print_errors, (, self, :, *, Errors, ,, writer, :, *, std, ., io, ., Writer, ,, conf, :, Error_Config, ), void, {, for, (, self, ., errors_list, ., items, ), |, err, |, {, err, ., print_error, (, writer, ,, conf, ), ;, }, }, }, ;, fn, print_note_label, (, maybe_span, :, ?, Span, ,, writer, :, *, std, ., io, ., Writer, ,, conf, :, Error_Config, ), void, {, print_label, (, maybe_span, ,, "note: ", ,, ., cyan, ,, writer, ,, conf, ), ;, }, fn, print_epilude, (, maybe_span, :, ?, Span, ,, writer, :, *, std, ., io, ., Writer, ,, conf, :, Error_Config, ), void, {, if, (, maybe_span, ), |, old_span, |, {, const, span, =, old_span, ;, if, (, span, ., line_number, ==, 0, ), {, return, ;, }, else, if, (, span, ., line_text, ., len, >, 0, ), {, print_color, (, not_bold, ,, writer, ,, conf, ), ;, writer, ., print, (, "{s}\n", ,, ., {, span, ., line_text, }, ), catch, unreachable, ;, }, if, (, span, ., col, >, 2, ), {, for, (, 2..span.col, ), |, _, |, {, writer, ., print, (, " ", ,, ., {, }, ), catch, unreachable, ;, }, }, if, (, conf, ., print_color, ), {, term_, ., outputColor, (, term_, ., Attr, {, ., fg, =, ., green, ,, ., bold, =, true, }, ,, "^\n", ,, writer, ), catch, unreachable, ;, }, else, {, writer, ., print, (, "^\n", ,, ., {, }, ), catch, unreachable, ;, }, }, }, fn, print_label, (, maybe_span, :, ?, Span, ,, label, :, [, ], const, u8, ,, color, :, term_, ., Color, ,, writer, :, *, std, ., io, ., Writer, ,, conf, :, Error_Config, ), void, {, if, (, maybe_span, ), |, span, |, {, const, filename, =, if, (, conf, ., print_full_path, ), span, ., filename, else, std, ., fs, ., path, ., basename, (, span, ., filename, ), ;, if, (, span, ., line_number, >, 0, and, span, ., col, >, 0, ), {, writer, ., print, (, "{s}:{}:{}: ", ,, ., {, filename, ,, span, ., line_number, ,, span, ., col, }, ), catch, unreachable, ;, }, else, if, (, filename, ., len, >, 0, ), {, writer, ., print, (, "{s}: ", ,, ., {, filename, }, ), catch, unreachable, ;, }, }, if, (, conf, ., print_color, ), {, term_, ., outputColor, (, term_, ., Attr, {, ., fg, =, color, ,, ., bold, =, true, }, ,, label, ,, writer, ), catch, unreachable, ;, }, else, {, writer, ., print, (, "{s}", ,, ., {, label, }, ), catch, unreachable, ;, }, }, fn, print_color, (, attr, :, term_, ., Attr, ,, writer, :, *, std, ., io, ., Writer, ,, conf, :, Error_Config, ), void, {, if, (, conf, ., print_color, ), {, attr, ., dump, (, writer, ), catch, unreachable, ;, }, }, const, std, =, @, import, (, "std", ), ;, pub, fn, exec, (, argv, :, [, ], const, [, ], const, u8, ,, behavior, :, std, ., process, ., Child, ., StdIo, ), !, struct, {, stdout, :, [, ], u8, ,, retcode, :, i64, }, {, const, allocator, =, std, ., heap, ., page_allocator, ;, var, child_process, =, std, ., process, ., Child, ., init, (, argv, ,, allocator, ), ;, child_process, ., stdin_behavior, =, behavior, ;, child_process, ., stdout_behavior, =, behavior, ;, child_process, ., stderr_behavior, =, behavior, ;, defer, _, =, child_process, ., kill, (, ), catch, unreachable, ;, child_process, ., spawn, (, ), catch, |, err, |, {, return, err, ;, }, ;, var, buffer, :, [, 100, *, 1024, ], u8, =, undefined, ;, var, writer_alloc, =, std, ., Io, ., Writer, ., Allocating, ., init, (, allocator, ), ;, errdefer, writer_alloc, ., deinit, (, ), ;, if, (, child_process, ., stdout, ), |, stdout, |, {, var, child_stdout_reader, =, stdout, ., reader, (, &, buffer, ), ;, const, reader_intfc, :, *, std, ., Io, ., Reader, =, &, child_stdout_reader, ., interface, ;, const, writer, =, &, writer_alloc, ., writer, ;, _, =, reader_intfc, ., stream, (, writer, ,, ., unlimited, ), catch, |, e, |, switch, (, e, ), {, error, ., EndOfStream, =>, {, }, ,, else, =>, return, e, ,, }, ;, }, var, retcode, :, i64, =, 0, ;, const, child, =, try, child_process, ., wait, (, ), ;, switch, (, child, ), {, ., Exited, =>, |, c, |, {, retcode, =, c, ;, }, ,, ., Signal, =>, |, c, |, switch, (, c, ), {, 11, =>, return, error, ., SegmentationFault, ,, else, =>, return, error, ., UnknownSignal, ,, }, ,, else, =>, return, error, ., CommandFailed, ,, }, return, ., {, ., stdout, =, writer_alloc, ., written, (, ), ,, ., retcode, =, retcode, }, ;, }, const, std, =, @, import, (, "std", ), ;, pub, fn, List_Printer, (, Elem, :, type, ), type, {, return, struct, {, list, :, *, const, std, ., array_list, ., Managed, (, *, Elem, ), ,, pub, fn, format, (, self, :, *, const, @, This, (, ), ,, writer, :, *, std, ., io, ., Writer, ), !, void, {, try, writer, ., print, (, "[", ,, ., {, }, ), ;, for, (, self, ., list, ., items, ,, 0.., ), |, item, ,, i, |, {, try, writer, ., print, (, "{f}", ,, ., {, item, }, ), ;, if, (, i, <, self, ., list, ., items, ., len, -|, 1, ), {, try, writer, ., print, (, ", ", ,, ., {, }, ), ;, }, }, try, writer, ., print, (, "]", ,, ., {, }, ), ;, }, }, ;, }, pub, fn, indirect_format, (, obj, :, anytype, ,, writer, :, *, std, ., io, ., Writer, ), !, void, {, const, T, =, @, TypeOf, (, obj, ), ;, std, ., debug, ., assert, (, @, hasDecl, (, T, ,, "pprint", ), ), ;, var, arena, =, std, ., heap, ., ArenaAllocator, ., init, (, std, ., heap, ., page_allocator, ), ;, defer, arena, ., deinit, (, ), ;, const, out, =, obj, ., pprint, (, arena, ., allocator, (, ), ), catch, unreachable, ;, try, writer, ., print, (, "{s}", ,, ., {, out, }, ), ;, }, const, std, =, @, import, (, "std", ), ;, pub, fn, run, (, initial_value, :, anytype, ,, pipeline, :, anytype, ), !, ProcessResult, (, @, TypeOf, (, pipeline, ), ,, @, TypeOf, (, initial_value, ), ,, pipeline, ., len, -|, 1, ), {, if, (, pipeline, ., len, ==, 0, ), {, return, initial_value, ;, }, else, {, return, run_inner, (, initial_value, ,, pipeline, ,, 0, ), ;, }, }, fn, run_inner, (, previous_value, :, anytype, ,, pipeline, :, anytype, ,, comptime, step_index, :, usize, ), !, ProcessResult, (, @, TypeOf, (, pipeline, ), ,, @, TypeOf, (, previous_value, ), ,, pipeline, ., len, -|, 1, ), {, const, PipelineType, =, @, TypeOf, (, pipeline, ), ;, const, fields, =, std, ., meta, ., fields, (, PipelineType, ), ;, const, field, =, fields, [, step_index, ], ;, var, step, =, @, field, (, pipeline, ,, field, ., name, ), ;, if, (, !, @, hasDecl, (, @, TypeOf, (, step, ), ,, "run", ), ), {, @, compileError, (, std, ., fmt, ., comptimePrint, (, "the step `{}` does not have a public run() method!", ,, ., {, @, TypeOf, (, step, ), }, ), ), ;, }, const, run_result, =, try, step, ., run, (, previous_value, ), ;, if, (, step_index, +, 1, ==, fields, ., len, ), {, return, run_result, ;, }, else, {, return, run_inner, (, run_result, ,, pipeline, ,, step_index, +, 1, ), ;, }, }, fn, ProcessResult, (, comptime, PipelineType, :, type, ,, comptime, InitialType, :, type, ,, comptime, i, :, usize, ), type, {, const, fields, =, std, ., meta, ., fields, (, PipelineType, ), ;, if, (, fields, ., len, ==, 0, ), {, return, InitialType, ;, }, const, Step_Type, =, fields, [, i, ], ., type, ;, const, RunFnType, =, @, TypeOf, (, Step_Type, ., run, ), ;, const, fn_info, =, @, typeInfo, (, RunFnType, ), ., @, "fn", ;, const, return_type, =, fn_info, ., return_type, .?, ;, return, switch, (, @, typeInfo, (, return_type, ), ), {, ., error_union, =>, |, eu, |, eu, ., payload, ,, else, =>, return_type, ,, }, ;, }, test, "test-pipeline", {, const, Get_Length, :, type, =, struct, {, const, Self, :, type, =, @, This, (, ), ;, pub, fn, init, (, ), Self, {, return, ., {, }, ;, }, pub, fn, run, (, self, :, *, Self, ,, str, :, [, ], const, u8, ), error, {, CompileError, }, !, usize, {, _, =, self, ;, return, str, ., len, ;, }, }, ;, const, Add, :, type, =, struct, {, const, Self, :, type, =, @, This, (, ), ;, addend, :, usize, ,, pub, fn, init, (, addend, :, usize, ), Self, {, return, ., {, ., addend, =, addend, }, ;, }, pub, fn, run, (, self, :, *, Self, ,, x, :, usize, ), error, {, CompileError, }, !, usize, {, return, self, ., addend, +, x, ;, }, }, ;, const, res, =, try, run, (, "Hello, World!", ,, ., {, Get_Length, ., init, (, ), ,, Add, ., init, (, 4, ), }, ), ;, try, std, ., testing, ., expectEqual, (, res, ,, 17, ), ;, }, test, "empty-pipeline", {, const, res, =, try, run, (, 435, ,, ., {, }, ), ;, try, std, ., testing, ., expectEqual, (, res, ,, 435, ), ;, }, const, std, =, @, import, (, "std", ), ;, const, builtin, =, @, import, (, "builtin", ), ;, const, Error, =, error, {, CompileError, }, ;, pub, fn, git_clone, (, repo_url, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), Error, !, void, {, ensure_packages_dir_exists, (, allocator, ), ;, if, (, repo_exists, (, repo_url, ,, allocator, ), ), {, return, ;, }, const, cwd, =, get_packages_dir, (, allocator, ), ;, std, ., debug, ., print, (, "cloning package `{s}`\n", ,, ., {, repo_url, }, ), ;, var, cmd, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, allocator, ), ;, cmd, ., appendSlice, (, &, [, _, ], [, ], const, u8, {, "git", ,, "clone", ,, }, ), catch, unreachable, ;, cmd, ., append, (, repo_url, ), catch, unreachable, ;, const, run_res, =, std, ., process, ., Child, ., run, (, ., {, ., allocator, =, allocator, ,, ., argv, =, cmd, ., items, ,, ., cwd, =, cwd, ,, }, ), catch, unreachable, ;, var, retcode, :, u8, =, 0, ;, switch, (, run_res, ., term, ), {, ., Exited, =>, |, c, |, {, retcode, =, c, ;, }, ,, ., Signal, =>, |, c, |, switch, (, c, ), {, 11, =>, return, error, ., CompileError, ,, else, =>, return, error, ., CompileError, ,, }, ,, else, =>, {, std, ., debug, ., print, (, "{s}\n", ,, ., {, run_res, ., stderr, }, ), ;, return, error, ., CompileError, ;, }, ,, }, if, (, retcode, !=, 0, ), {, std, ., debug, ., print, (, "git error: {} {s}\n", ,, ., {, retcode, ,, run_res, ., stderr, }, ), ;, return, error, ., CompileError, ;, }, }, pub, fn, ensure_packages_dir_exists, (, allocator, :, std, ., mem, ., Allocator, ), void, {, const, orng_dir, =, get_orng_dir, (, allocator, ), ;, defer, allocator, ., free, (, orng_dir, ), ;, _, =, std, ., fs, ., Dir, ., openDir, (, std, ., fs, ., cwd, (, ), ,, orng_dir, ,, ., {, }, ), catch, {, std, ., fs, ., makeDirAbsolute, (, orng_dir, ), catch, unreachable, ;, }, ;, const, repo_dir, =, get_packages_dir, (, allocator, ), ;, defer, allocator, ., free, (, repo_dir, ), ;, _, =, std, ., fs, ., Dir, ., openDir, (, std, ., fs, ., cwd, (, ), ,, repo_dir, ,, ., {, }, ), catch, {, std, ., fs, ., makeDirAbsolute, (, repo_dir, ), catch, unreachable, ;, }, ;, }, pub, fn, ensure_inc_dir_exists, (, allocator, :, std, ., mem, ., Allocator, ), void, {, const, orng_dir, =, get_orng_dir, (, allocator, ), ;, defer, allocator, ., free, (, orng_dir, ), ;, _, =, std, ., fs, ., Dir, ., openDir, (, std, ., fs, ., cwd, (, ), ,, orng_dir, ,, ., {, }, ), catch, {, std, ., fs, ., makeDirAbsolute, (, orng_dir, ), catch, unreachable, ;, }, ;, const, inc_dir, =, get_inc_dir, (, allocator, ), ;, defer, allocator, ., free, (, inc_dir, ), ;, _, =, std, ., fs, ., Dir, ., openDir, (, std, ., fs, ., cwd, (, ), ,, inc_dir, ,, ., {, }, ), catch, {, std, ., fs, ., makeDirAbsolute, (, inc_dir, ), catch, unreachable, ;, }, ;, const, filenames, =, [, _, ], [, ], const, u8, {, "alloc.inc", ,, "debug.inc", ,, "io.inc", ,, "args.inc", ,, "file_io.inc", ,, }, ;, inline, for, (, filenames, ), |, filename, |, {, const, inc_dest_file_paths, =, [, _, ], [, ], const, u8, {, inc_dir, ,, filename, }, ;, const, inc_dest_file_path, =, std, ., fs, ., path, ., join, (, allocator, ,, &, inc_dest_file_paths, ), catch, unreachable, ;, _, =, if, (, std, ., fs, ., openFileAbsolute, (, inc_dest_file_path, ,, ., {, }, ), ), |, _, |, {, }, else, |, err, |, {, switch, (, err, ), {, error, ., FileNotFound, =>, {, }, ,, else, =>, std, ., debug, ., panic, (, "whoa: {}", ,, ., {, err, }, ), ,, }, }, ;, var, file, =, std, ., fs, ., createFileAbsolute, (, inc_dest_file_path, ,, ., {, }, ), catch, unreachable, ;, defer, file, ., close, (, ), ;, _, =, file, ., write, (, @, embedFile, (, "../codegen/inc/", ++, filename, ), ), catch, unreachable, ;, }, }, pub, fn, get_orng_dir, (, allocator, :, std, ., mem, ., Allocator, ), [, ], const, u8, {, var, env_map, =, std, ., process, ., getEnvMap, (, allocator, ), catch, unreachable, ;, defer, env_map, ., deinit, (, ), ;, const, home_dir, =, env_map, ., get, (, if, (, builtin, ., target, ., os, ., tag, ==, ., windows, ), "USERPROFILE", else, "HOME", ), .?, ;, const, root_file_paths, =, [, _, ], [, ], const, u8, {, home_dir, ,, ".orng", }, ;, return, std, ., fs, ., path, ., join, (, allocator, ,, &, root_file_paths, ), catch, unreachable, ;, }, pub, fn, get_packages_dir, (, allocator, :, std, ., mem, ., Allocator, ), [, ], const, u8, {, const, orng_dir, =, get_orng_dir, (, allocator, ), ;, defer, allocator, ., free, (, orng_dir, ), ;, const, root_file_paths, =, [, _, ], [, ], const, u8, {, orng_dir, ,, "packages", }, ;, return, std, ., fs, ., path, ., join, (, allocator, ,, &, root_file_paths, ), catch, unreachable, ;, }, pub, fn, get_inc_dir, (, allocator, :, std, ., mem, ., Allocator, ), [, ], const, u8, {, const, orng_dir, =, get_orng_dir, (, allocator, ), ;, defer, allocator, ., free, (, orng_dir, ), ;, const, root_file_paths, =, [, _, ], [, ], const, u8, {, orng_dir, ,, "inc", }, ;, return, std, ., fs, ., path, ., join, (, allocator, ,, &, root_file_paths, ), catch, unreachable, ;, }, pub, fn, get_repo_dir, (, repo_url, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), [, ], const, u8, {, const, repo_dir, =, get_packages_dir, (, allocator, ), ;, var, dirs, =, std, ., array_list, ., Managed, (, [, ], const, u8, ), ., init, (, allocator, ), ;, defer, dirs, ., deinit, (, ), ;, dirs, ., append, (, repo_dir, ), catch, unreachable, ;, dirs, ., append, (, std, ., fs, ., path, ., basename, (, repo_url, ), ), catch, unreachable, ;, return, std, ., fs, ., path, ., join, (, allocator, ,, dirs, ., items, ), catch, unreachable, ;, }, fn, repo_exists, (, repo_url, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), bool, {, const, repo_dir, =, get_repo_dir, (, repo_url, ,, allocator, ), ;, defer, allocator, ., free, (, repo_dir, ), ;, var, dir, =, std, ., fs, ., Dir, ., openDir, (, std, ., fs, ., cwd, (, ), ,, repo_dir, ,, ., {, }, ), catch, {, return, false, ;, }, ;, dir, ., close, (, ), ;, return, true, ;, }, const, std, =, @, import, (, "std", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, fmt_, =, @, import, (, "../util/fmt.zig", ), ;, const, Self, =, @, This, (, ), ;, pub, const, Span_Print_Error, =, error, {, OutOfMemory, }, ;, const, Span_Format, =, struct, {, fmt_str, :, [, ], const, u8, ,, sanitize, :, bool, ,, }, ;, pub, const, c_format, :, Span_Format, =, ., {, ., fmt_str, =, "\"{s}:{}:{}:\\n{s}\\n{s}^\"", ,, ., sanitize, =, true, ,, }, ;, pub, const, interpreter_format, :, Span_Format, =, ., {, ., fmt_str, =, "{s}:{}:{}:\n{s}\n{s}^\n", ,, ., sanitize, =, false, ,, }, ;, pub, const, phony, =, Self, {, ., filename, =, "", ,, ., line_text, =, "", ,, ., line_number, =, 0, ,, ., col, =, 0, }, ;, filename, :, [, ], const, u8, ,, line_text, :, [, ], const, u8, ,, line_number, :, usize, ,, col, :, usize, ,, pub, fn, print_debug_line, (, self, :, *, const, Self, ,, writer, :, *, std, ., array_list, ., Managed, (, u8, ), ,, comptime, span_format, :, Span_Format, ), Span_Print_Error, !, void, {, var, spaces, =, String, ., init_with_contents, (, std, ., heap, ., page_allocator, ,, "", ), catch, unreachable, ;, defer, spaces, ., deinit, (, ), ;, if, (, self, ., col, >, 0, ), {, for, (, 1..self.col, -|, 1, ), |, _, |, {, spaces, ., insert, (, " ", ,, spaces, ., size, ), catch, unreachable, ;, }, }, const, sanitized_filename, =, if, (, span_format, ., sanitize, ), sanitize_string, (, self, ., filename, ,, std, ., heap, ., page_allocator, ), else, self, ., filename, ;, const, text_to_write, =, if, (, span_format, ., sanitize, ), sanitize_string, (, self, ., line_text, ,, std, ., heap, ., page_allocator, ), else, self, ., line_text, ;, try, writer, ., print, (, span_format, ., fmt_str, ,, ., {, sanitized_filename, ,, self, ., line_number, ,, self, ., col, ,, text_to_write, ,, spaces, ., str, (, ), ,, }, ), ;, }, pub, fn, format, (, self, :, Self, ,, writer, :, *, std, ., io, ., Writer, ), !, void, {, try, writer, ., print, (, "{s}:{}:{}", ,, ., {, self, ., filename, ,, self, ., line_number, ,, self, ., col, }, ), ;, }, fn, sanitize_string, (, str, :, [, ], const, u8, ,, allocator, :, std, ., mem, ., Allocator, ), [, ], const, u8, {, var, builder, =, String, ., init_with_contents, (, allocator, ,, "", ), catch, unreachable, ;, for, (, str, ), |, byte, |, {, if, (, byte, ==, '\\', or, byte, ==, '"', ), {, builder, ., insert, (, "\\", ,, builder, ., len, (, ), ), catch, unreachable, ;, }, if, (, byte, ==, '\r', ), {, builder, ., insert, (, "\\r", ,, builder, ., len, (, ), ), catch, unreachable, ;, }, else, if, (, byte, ==, '\n', ), {, builder, ., insert, (, "\\n", ,, builder, ., len, (, ), ), catch, unreachable, ;, }, else, {, const, insert_me, :, [, 1, ], u8, =, ., {, byte, }, ;, builder, ., insert, (, &, insert_me, ,, builder, ., len, (, ), ), catch, unreachable, ;, }, }, return, (, builder, ., toOwned, (, ), catch, unreachable, ), .?, ;, }, const, std, =, @, import, (, "std", ), ;, pub, const, Color, =, enum, {, none, ,, black, ,, red, ,, green, ,, yellow, ,, blue, ,, magenta, ,, cyan, ,, white, ,, bright_black, ,, bright_red, ,, bright_green, ,, bright_yellow, ,, bright_blue, ,, bright_magenta, ,, bright_cyan, ,, bright_white, ,, }, ;, pub, const, Attr, =, struct, {, fg, :, Color, =, ., white, ,, bg, :, Color, =, ., none, ,, bold, :, bool, =, false, ,, dimmed, :, bool, =, false, ,, italic, :, bool, =, false, ,, underline, :, bool, =, false, ,, blinking, :, bool, =, false, ,, reverse, :, bool, =, false, ,, hidden, :, bool, =, false, ,, overline, :, bool, =, false, ,, strikethrough, :, bool, =, false, ,, fn, eql, (, self, :, Attr, ,, other, :, Attr, ), bool, {, inline, for, (, @, typeInfo, (, Attr, ), ., Struct, ., fields, ), |, field, |, {, if, (, @, field, (, self, ,, field, ., name, ), !=, @, field, (, other, ,, field, ., name, ), ), return, false, ;, }, return, true, ;, }, pub, fn, dump, (, self, :, Attr, ,, writer, :, anytype, ), !, void, {, try, writer, ., writeAll, (, "\x1B[0", ), ;, if, (, self, ., bold, ), try, writer, ., writeAll, (, ";1", ), ;, if, (, self, ., dimmed, ), try, writer, ., writeAll, (, ";2", ), ;, if, (, self, ., italic, ), try, writer, ., writeAll, (, ";3", ), ;, if, (, self, ., underline, ), try, writer, ., writeAll, (, ";4", ), ;, if, (, self, ., blinking, ), try, writer, ., writeAll, (, ";5", ), ;, if, (, self, ., reverse, ), try, writer, ., writeAll, (, ";7", ), ;, if, (, self, ., hidden, ), try, writer, ., writeAll, (, ";8", ), ;, if, (, self, ., overline, ), try, writer, ., writeAll, (, ";53", ), ;, if, (, self, ., strikethrough, ), try, writer, ., writeAll, (, ";9", ), ;, switch, (, self, ., fg, ), {, ., none, =>, {, }, ,, ., black, =>, try, writer, ., writeAll, (, ";30", ), ,, ., red, =>, try, writer, ., writeAll, (, ";31", ), ,, ., green, =>, try, writer, ., writeAll, (, ";32", ), ,, ., yellow, =>, try, writer, ., writeAll, (, ";33", ), ,, ., blue, =>, try, writer, ., writeAll, (, ";34", ), ,, ., magenta, =>, try, writer, ., writeAll, (, ";35", ), ,, ., cyan, =>, try, writer, ., writeAll, (, ";36", ), ,, ., white, =>, try, writer, ., writeAll, (, ";37", ), ,, ., bright_black, =>, try, writer, ., writeAll, (, ";90", ), ,, ., bright_red, =>, try, writer, ., writeAll, (, ";91", ), ,, ., bright_green, =>, try, writer, ., writeAll, (, ";92", ), ,, ., bright_yellow, =>, try, writer, ., writeAll, (, ";93", ), ,, ., bright_blue, =>, try, writer, ., writeAll, (, ";94", ), ,, ., bright_magenta, =>, try, writer, ., writeAll, (, ";95", ), ,, ., bright_cyan, =>, try, writer, ., writeAll, (, ";96", ), ,, ., bright_white, =>, try, writer, ., writeAll, (, ";97", ), ,, }, switch, (, self, ., bg, ), {, ., none, =>, {, }, ,, ., black, =>, try, writer, ., writeAll, (, ";40", ), ,, ., red, =>, try, writer, ., writeAll, (, ";41", ), ,, ., green, =>, try, writer, ., writeAll, (, ";42", ), ,, ., yellow, =>, try, writer, ., writeAll, (, ";43", ), ,, ., blue, =>, try, writer, ., writeAll, (, ";44", ), ,, ., magenta, =>, try, writer, ., writeAll, (, ";45", ), ,, ., cyan, =>, try, writer, ., writeAll, (, ";46", ), ,, ., white, =>, try, writer, ., writeAll, (, ";74", ), ,, ., bright_black, =>, try, writer, ., writeAll, (, ";100", ), ,, ., bright_red, =>, try, writer, ., writeAll, (, ";101", ), ,, ., bright_green, =>, try, writer, ., writeAll, (, ";102", ), ,, ., bright_yellow, =>, try, writer, ., writeAll, (, ";103", ), ,, ., bright_blue, =>, try, writer, ., writeAll, (, ";104", ), ,, ., bright_magenta, =>, try, writer, ., writeAll, (, ";105", ), ,, ., bright_cyan, =>, try, writer, ., writeAll, (, ";106", ), ,, ., bright_white, =>, try, writer, ., writeAll, (, ";107", ), ,, }, try, writer, ., writeAll, (, "m", ), ;, }, }, ;, pub, fn, outputColor, (, attr, :, Attr, ,, contents, :, [, ], const, u8, ,, writer, :, *, std, ., io, ., Writer, ), !, void, {, try, attr, ., dump, (, writer, ), ;, try, writer, ., print, (, "{s}", ,, ., {, contents, }, ), ;, try, (, Attr, {, }, ), ., dump, (, writer, ), ;, }, const, std, =, @, import, (, "std", ), ;, const, String, =, @, import, (, "../zig-string/zig-string.zig", ), ., String, ;, const, Tree_Writer, =, @, This, (, ), ;, out, :, String, ,, indentation, :, i16, ,, tab_size, :, i16, ,, pub, fn, init, (, tab_size, :, i16, ,, alloc, :, std, ., mem, ., Allocator, ), Tree_Writer, {, return, ., {, ., out, =, String, ., init_with_contents, (, alloc, ,, "", ), catch, unreachable, ,, ., indentation, =, 0, ,, ., tab_size, =, tab_size, ,, }, ;, }, pub, fn, deinit, (, self, :, *, Tree_Writer, ), void, {, self, ., out, ., deinit, (, ), ;, }, pub, fn, to_owned, (, self, :, *, Tree_Writer, ), [, ], u8, {, defer, self, ., deinit, (, ), ;, return, (, self, ., out, ., toOwned, (, ), catch, unreachable, ), .?, ;, }, pub, fn, print, (, self, :, *, Tree_Writer, ,, comptime, fmt, :, [, ], const, u8, ,, args, :, anytype, ), void, {, self, ., out, ., writer, (, ), ., print, (, fmt, ,, args, ), catch, unreachable, ;, }, pub, fn, println, (, self, :, *, Tree_Writer, ,, comptime, fmt, :, [, ], const, u8, ,, args, :, anytype, ,, change_in_tabs, :, i16, ), void, {, self, ., print, (, fmt, ,, args, ), ;, self, ., newline, (, change_in_tabs, ), ;, }, pub, fn, newline, (, self, :, *, Tree_Writer, ,, change_in_tabs, :, i16, ), void, {, self, ., indentation, +=, change_in_tabs, *, self, ., tab_size, ;, self, ., out, ., writer, (, ), ., writeByte, (, '\n', ), catch, unreachable, ;, for, (, 0.., @, intCast, (, self, ., indentation, ), ), |, _, |, {, self, ., out, ., writer, (, ), ., writeByte, (, ' ', ), catch, unreachable, ;, }, }, const, Self, =, @, This, (, ), ;, scope_uid, :, usize, =, 0, ,, pub, fn, init, (, ), Self, {, return, ., {, ., scope_uid, =, 0, }, ;, }, pub, fn, uid, (, self, :, *, @, This, (, ), ), usize, {, const, retval, =, self, ., scope_uid, ;, self, ., scope_uid, +=, 1, ;, return, retval, ;, }, pub, const, Validation_State, =, union, (, enum, ), {, unvalidated, ,, validating, ,, valid, ,, invalid, ,, }, ;]